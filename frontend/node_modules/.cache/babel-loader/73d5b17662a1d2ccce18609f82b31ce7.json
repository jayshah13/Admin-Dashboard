{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\nimport { parentsUntil, addRemoveEventListener } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * FocusStrategy class\n *\n * @hidden\n */\n\nvar FocusStrategy =\n/** @class */\nfunction () {\n  function FocusStrategy(parent) {\n    this.currentInfo = {};\n    this.oneTime = true;\n    this.swap = {};\n    /** @hidden */\n\n    this.isInfiniteScroll = false;\n    this.forget = false;\n    this.skipFocus = true;\n    this.focusByClick = false;\n    this.prevIndexes = {};\n    this.refMatrix = this.refreshMatrix(true);\n    this.actions = ['downArrow', 'upArrow'];\n    this.isVirtualScroll = false;\n    this.parent = parent;\n    this.rowModelGen = new RowModelGenerator(this.parent);\n    this.addEventListener();\n  }\n\n  FocusStrategy.prototype.focusCheck = function (e) {\n    var target = e.target;\n    this.focusByClick = true;\n    this.skipFocus = target.classList.contains('e-grid');\n  };\n\n  FocusStrategy.prototype.onFocus = function (e) {\n    if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization) {\n      return;\n    }\n\n    this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0, this.parent.isFrozenGrid());\n\n    if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && (this.parent.editSettings.mode !== 'Batch' || this.parent.editSettings.mode === 'Batch' && !this.parent.editModule.getBatchChanges()[literals.addedRecords].length)) {\n      this.getContent().matrix.generate(this.rowModelGen.generateRows({\n        rows: [new Row({\n          isDataRow: true\n        })]\n      }), this.getContent().selector, false);\n    }\n\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n\n    if (this.skipFocus) {\n      this.focus(e);\n      this.skipFocus = false;\n    }\n  };\n\n  FocusStrategy.prototype.passiveFocus = function (e) {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (e.target && e.target.classList.contains('e-detailcell')) {\n      this.currentInfo.skipAction = false;\n      addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n    }\n  };\n\n  FocusStrategy.prototype.onBlur = function (e) {\n    if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid'))) && !(isNullOrUndefined(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) === 0 && parseInt(e.target.getAttribute('index'), 10) === 0)) {\n      return;\n    }\n\n    this.removeFocus();\n    this.skipFocus = true;\n    this.currentInfo.skipAction = false;\n    this.parent.element.tabIndex = 0;\n  };\n\n  FocusStrategy.prototype.onClick = function (e, force) {\n    if (parentsUntil(e.target, 'e-filterbarcell') && (parentsUntil(e.target, 'e-multiselect') || e.target.classList.contains('e-input-group-icon'))) {\n      return;\n    }\n\n    var isContent = !isNullOrUndefined(closest(e.target, '.' + literals.gridContent));\n    var isHeader = !isNullOrUndefined(closest(e.target, '.' + literals.gridHeader));\n    isContent = isContent && isHeader ? !isContent : isContent;\n    var isFrozen = !isNullOrUndefined(closest(e.target, '.' + literals.frozenContent)) || !isNullOrUndefined(closest(e.target, '.' + literals.frozenHeader));\n    var isFrozenRight = false;\n\n    if (this.parent.getFrozenMode() === literals.leftRight) {\n      isFrozenRight = !isNullOrUndefined(closest(e.target, '.e-frozen-right-content')) || !isNullOrUndefined(closest(e.target, '.e-frozen-right-header'));\n      isFrozen = isFrozen && !isFrozenRight;\n    }\n\n    if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader)) || e.target.classList.contains(literals.content) || !isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n      return;\n    }\n\n    this.setActive(isContent, isFrozen, isFrozenRight);\n\n    if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader))) {\n      this.clearOutline();\n      return;\n    }\n\n    var beforeArgs = {\n      cancel: false,\n      byKey: false,\n      byClick: !isNullOrUndefined(e.target),\n      clickArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n\n    if (beforeArgs.cancel || closest(e.target, '.e-inline-edit')) {\n      return;\n    }\n\n    this.setActive(isContent, isFrozen, isFrozenRight);\n\n    if (this.getContent()) {\n      var returnVal = this.getContent().onClick(e, force);\n\n      if (returnVal === false) {\n        return;\n      }\n\n      this.focus();\n    }\n  };\n\n  FocusStrategy.prototype.onKeyPress = function (e) {\n    if (this.skipOn(e)) {\n      return;\n    }\n\n    this.activeKey = e.action;\n    var beforeArgs = {\n      cancel: false,\n      byKey: true,\n      byClick: false,\n      keyArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n\n    if (beforeArgs.cancel) {\n      return;\n    }\n\n    var bValue = this.getContent().matrix.current;\n    this.currentInfo.outline = true;\n    var swapInfo = this.getContent().jump(e.action, bValue);\n    this.swap = swapInfo;\n\n    if (swapInfo.swap) {\n      this.setActive(!swapInfo.toHeader, swapInfo.toFrozen, swapInfo.toFrozenRight);\n      this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n      this.prevIndexes = {};\n    }\n\n    this.setActiveByKey(e.action, this.getContent());\n    var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n\n    if (returnVal === false) {\n      this.clearIndicator();\n\n      if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n        this.parent.element.tabIndex = -1;\n      }\n\n      return;\n    }\n\n    e.preventDefault();\n    this.focus(e);\n  };\n\n  FocusStrategy.prototype.skipOn = function (e) {\n    var target = e.target;\n\n    if (!target) {\n      return false;\n    }\n\n    if (this.currentInfo.skipAction) {\n      this.clearIndicator();\n      return true;\n    }\n\n    if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n      this.clearIndicator();\n      return true;\n    }\n\n    var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n\n    if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n      var inputTarget = closest(e.target, '.e-filterbarcell');\n      inputTarget.querySelector('input').focus();\n    }\n\n    if (th && closest(document.activeElement, '.e-filterbarcell') !== null) {\n      this.removeFocus();\n    }\n\n    var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n\n    if (this.parent.enableHeaderFocus && filterCell) {\n      var matrix = this.active.matrix;\n      var current = matrix.current;\n      filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n    }\n\n    return e.action === 'delete' || this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit || ['insert', 'f2'].indexOf(e.action) > -1) || filterCell || closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null && ['enter', 'leftArrow', 'rightArrow', 'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1 || closest(target, '.' + literals.gridContent) === null && closest(target, '.' + literals.gridHeader) === null || e.action === 'space' && !target.classList.contains(literals.gridChkBox) && closest(target, '.' + literals.gridChkBox) === null && closest(target, '.e-headerchkcelldiv') === null || closest(target, '.e-filter-popup') !== null;\n  };\n\n  FocusStrategy.prototype.focusVirtualElement = function (e) {\n    var _this = this;\n\n    if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n      var data = {\n        virtualData: {},\n        isAdd: false,\n        isCancel: false\n      };\n      this.parent.notify(event.getVirtualData, data);\n      var isKeyFocus = this.actions.some(function (value) {\n        return value === _this.activeKey;\n      });\n      var isSelected = this.parent.contentModule ? this.parent.contentModule.selectedRowIndex > -1 : false;\n\n      if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n        this.parent.notify(event.resetVirtualFocus, {\n          isCancel: false\n        });\n        data.isCancel = false;\n        this.parent.contentModule.selectedRowIndex = -1;\n\n        if (isKeyFocus) {\n          this.activeKey = this.empty;\n          this.parent.notify('virtaul-key-handler', e);\n        } // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n        this.currentInfo.elementToFocus.focus({\n          preventScroll: true\n        });\n      } else {\n        if (this.isVirtualScroll || this.isInfiniteScroll) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          this.currentInfo.elementToFocus.focus({\n            preventScroll: true\n          });\n        } else {\n          this.currentInfo.elementToFocus.focus();\n        }\n      }\n    }\n\n    this.isVirtualScroll = this.isInfiniteScroll = false;\n  };\n\n  FocusStrategy.prototype.getFocusedElement = function () {\n    return this.currentInfo.elementToFocus;\n  };\n\n  FocusStrategy.prototype.getContent = function () {\n    return this.active || this.content;\n  };\n\n  FocusStrategy.prototype.setActive = function (content, isFrozen, isFrozenRight) {\n    this.active = content ? isFrozen ? this.fContent : isFrozenRight ? this.frContent : this.content : isFrozen ? this.fHeader : isFrozenRight ? this.frHeader : this.header;\n  };\n\n  FocusStrategy.prototype.setFocusedElement = function (element, e) {\n    var _this = this;\n\n    this.currentInfo.elementToFocus = element;\n    setTimeout(function () {\n      if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n        if (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) {\n          _this.focusVirtualElement(e);\n        } else {\n          _this.currentInfo.elementToFocus.focus();\n        }\n      }\n    }, 0);\n  };\n\n  FocusStrategy.prototype.focus = function (e) {\n    this.parent.notify(event.virtaulCellFocus, e);\n    this.removeFocus();\n    this.addFocus(this.getContent().getFocusInfo(), e);\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  FocusStrategy.prototype.removeFocus = function (e) {\n    if (!this.currentInfo.element) {\n      return;\n    }\n\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n    this.currentInfo.element.tabIndex = -1;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  FocusStrategy.prototype.addOutline = function () {\n    var info = this.getContent().getFocusInfo();\n\n    if (info.element) {\n      addClass([info.element], ['e-focused']);\n      addClass([info.elementToFocus], ['e-focus']);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  FocusStrategy.prototype.focusHeader = function () {\n    this.setActive(false, this.parent.isFrozenGrid());\n    this.resetFocus();\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  FocusStrategy.prototype.focusContent = function () {\n    this.setActive(true, this.parent.isFrozenGrid());\n    this.resetFocus();\n  };\n\n  FocusStrategy.prototype.resetFocus = function () {\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n    this.focus();\n  };\n\n  FocusStrategy.prototype.addFocus = function (info, e) {\n    this.currentInfo = info;\n    this.currentInfo.outline = info.outline && !isNullOrUndefined(e);\n\n    if (this.isInfiniteScroll) {\n      this.currentInfo.outline = true;\n    }\n\n    if (!info.element) {\n      return;\n    }\n\n    var isFocused = info.elementToFocus.classList.contains('e-focus');\n\n    if (isFocused) {\n      return;\n    }\n\n    if (this.currentInfo.outline) {\n      addClass([info.element], ['e-focused']);\n    }\n\n    addClass([info.elementToFocus], ['e-focus']);\n    info.element.tabIndex = 0;\n\n    if (!isFocused) {\n      this.setFocusedElement(info.elementToFocus, e);\n    }\n\n    this.parent.notify(event.cellFocused, {\n      element: info.elementToFocus,\n      parent: info.element,\n      indexes: this.getContent().matrix.current,\n      byKey: !isNullOrUndefined(e),\n      byClick: isNullOrUndefined(e),\n      keyArgs: e,\n      isJump: this.swap.swap,\n      container: this.getContent().getInfo(e),\n      outline: !isNullOrUndefined(e),\n      swapInfo: this.swap\n    });\n    var _a = this.getContent().matrix.current,\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    this.prevIndexes = {\n      rowIndex: rowIndex,\n      cellIndex: cellIndex\n    };\n    this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n    this.focusByClick = false;\n  };\n\n  FocusStrategy.prototype.refreshMatrix = function (content) {\n    var _this = this;\n\n    return function (e) {\n      if (content && e.args && e.args.isFrozen && !_this.fContent) {\n        _this.fContent = new FixedContentFocus(_this.parent);\n      } else if (content && !_this.frContent && e.args && e.args.renderFrozenRightContent) {\n        _this.frContent = new FixedRightContentFocus(_this.parent);\n      } else if (content && !_this.content) {\n        _this.content = new ContentFocus(_this.parent);\n      }\n\n      if (!content && e.args && e.args.isFrozen && !_this.fHeader) {\n        _this.fHeader = new FixedHeaderFocus(_this.parent);\n      } else if (!content && e.args && e.args.renderFrozenRightContent && !_this.frHeader) {\n        _this.frHeader = new FixedRightHeaderFocus(_this.parent);\n      } else if (!content && !_this.header) {\n        _this.header = new HeaderFocus(_this.parent);\n      }\n\n      var cFocus = content ? e.args && e.args.isFrozen ? _this.fContent : e.args && e.args.renderFrozenRightContent ? _this.frContent : _this.content : e.args && e.args.isFrozen ? _this.fHeader : e.args && e.args.renderFrozenRightContent ? _this.frHeader : _this.header;\n      var rows = content ? e.rows.slice(_this.parent.frozenRows) : e.rows;\n      var updateRow = content ? e.rows.slice(0, _this.parent.frozenRows) : e.rows;\n\n      if (_this.parent.isCollapseStateEnabled() && content) {\n        rows = rows.filter(function (x) {\n          return x.visible !== false;\n        });\n      }\n\n      var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n      var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n\n      if (e.name === 'batchAdd' && _this.parent.isFrozenGrid()) {\n        var mRows = _this.parent.getMovableRowsObject();\n\n        var newMovableRows = mRows.map(function (row) {\n          return row.clone();\n        });\n        var newFrozenRows = rows.map(function (row) {\n          return row.clone();\n        });\n\n        _this.fContent.matrix.generate(newFrozenRows, _this.fContent.selector, isRowTemplate);\n\n        _this.content.matrix.generate(newMovableRows, _this.content.selector, isRowTemplate);\n\n        if (_this.parent.getFrozenMode() === literals.leftRight) {\n          var frRows = _this.parent.getFrozenRightRowsObject();\n\n          var newfrRows = frRows.map(function (row) {\n            return row.clone();\n          });\n\n          _this.frContent.matrix.generate(newfrRows, _this.frContent.selector, isRowTemplate);\n        }\n      } else {\n        cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n      }\n\n      cFocus.generateRows(updateRow, {\n        matrix: matrix,\n        handlerInstance: e.args && e.args.isFrozen ? _this.fHeader : e.args && e.args.renderFrozenRightContent ? _this.frHeader : _this.header\n      });\n\n      if (!Browser.isDevice && e && e.args) {\n        if (!_this.focusByClick && e.args.requestType === 'paging') {\n          _this.skipFocus = false;\n\n          _this.parent.element.focus();\n        }\n\n        if (e.args.requestType === 'grouping') {\n          _this.skipFocus = true;\n        }\n      }\n\n      if (e && e.args && e.args.requestType === 'virtualscroll') {\n        if (_this.currentInfo.uid) {\n          var index_1;\n          var bool = e.rows.some(function (row, i) {\n            index_1 = i;\n            return row.uid === _this.currentInfo.uid;\n          });\n\n          if (bool) {\n            _this.content.matrix.current[0] = index_1;\n            _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n\n            var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n\n            if (focusElement) {\n              var cellPosition = focusElement.getBoundingClientRect();\n\n              var gridPosition = _this.parent.element.getBoundingClientRect();\n\n              if (cellPosition.top >= 0 && cellPosition.left >= 0 && cellPosition.right <= Math.min(gridPosition.right, window.innerWidth || document.documentElement.clientWidth) && cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight || document.documentElement.clientHeight)) {\n                _this.isVirtualScroll = true;\n\n                _this.focus();\n              }\n            }\n          }\n        } else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n          var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n\n          if (focusElement) {\n            focusElement.focus();\n          }\n        }\n      }\n    };\n  };\n\n  FocusStrategy.prototype.addEventListener = function () {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n    EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n    this.parent.element.addEventListener('focus', this.passiveHandler = function (e) {\n      return _this.passiveFocus(e);\n    }, true);\n    EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n    this.evtHandlers = [{\n      event: event.keyPressed,\n      handler: this.onKeyPress\n    }, {\n      event: event.click,\n      handler: this.onClick\n    }, {\n      event: event.contentReady,\n      handler: this.refMatrix\n    }, {\n      event: event.partialRefresh,\n      handler: this.refMatrix\n    }, {\n      event: event.refreshExpandandCollapse,\n      handler: this.refMatrix\n    }, {\n      event: event.headerRefreshed,\n      handler: this.refreshMatrix()\n    }, {\n      event: event.closeEdit,\n      handler: this.restoreFocus\n    }, {\n      event: event.restoreFocus,\n      handler: this.restoreFocus\n    }, {\n      event: 'start-edit',\n      handler: this.clearIndicator\n    }, {\n      event: 'start-add',\n      handler: this.clearIndicator\n    }, {\n      event: 'sorting-complete',\n      handler: this.restoreFocus\n    }, {\n      event: 'filtering-complete',\n      handler: this.filterfocus\n    }, {\n      event: 'grouping-complete',\n      handler: this.restoreFocusWithAction\n    }, {\n      event: 'ungrouping-complete',\n      handler: this.restoreFocusWithAction\n    }, {\n      event: event.batchAdd,\n      handler: this.refMatrix\n    }, {\n      event: event.batchCancel,\n      handler: this.refMatrix\n    }, {\n      event: event.batchDelete,\n      handler: this.refMatrix\n    }, {\n      event: event.detailDataBound,\n      handler: this.refMatrix\n    }, {\n      event: event.onEmpty,\n      handler: this.refMatrix\n    }, {\n      event: event.cellFocused,\n      handler: this.internalCellFocus\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n  };\n\n  FocusStrategy.prototype.filterfocus = function () {\n    if (this.parent.filterSettings.type !== 'FilterBar') {\n      this.restoreFocus();\n    }\n  };\n\n  FocusStrategy.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n    EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n    EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n    this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n  };\n\n  FocusStrategy.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n\n  FocusStrategy.prototype.restoreFocus = function () {\n    this.addFocus(this.getContent().getFocusInfo());\n  };\n\n  FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n    if (!this.parent.enableInfiniteScrolling) {\n      var matrix = this.getContent().matrix;\n      var current = matrix.current;\n\n      switch (e.requestType) {\n        case 'grouping':\n        case 'ungrouping':\n          current[1] = current.length && !this.parent.groupSettings.showGroupedColumn && !isNullOrUndefined(matrix.matrix[current[0]]) ? matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n          break;\n      }\n\n      this.getContent().matrix.current = current;\n      this.addFocus(this.getContent().getFocusInfo());\n    }\n  };\n\n  FocusStrategy.prototype.clearOutline = function () {\n    this.getContent().matrix.current = this.getContent().matrix.get(0, -1, [0, 1], 'downArrow', this.getContent().validator());\n    this.clearIndicator();\n  };\n\n  FocusStrategy.prototype.clearIndicator = function () {\n    if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n      return;\n    }\n\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n  };\n\n  FocusStrategy.prototype.getPrevIndexes = function () {\n    var forget = this.forget;\n    this.forget = false;\n    return forget || !Object.keys(this.prevIndexes).length ? {\n      rowIndex: null,\n      cellIndex: null\n    } : this.prevIndexes;\n  };\n\n  FocusStrategy.prototype.forgetPrevious = function () {\n    this.forget = true;\n  };\n\n  FocusStrategy.prototype.setActiveByKey = function (action, active) {\n    var _this = this;\n\n    if (!this.parent.isFrozenGrid() && this.parent.frozenRows === 0) {\n      return;\n    } // eslint-disable-next-line prefer-const\n\n\n    var info;\n    var actions = {\n      'home': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: true\n        };\n      },\n      'end': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: false\n        };\n      },\n      'ctrlHome': function () {\n        return {\n          toHeader: true,\n          toFrozen: _this.parent.isFrozenGrid()\n        };\n      },\n      'ctrlEnd': function () {\n        return {\n          toHeader: false,\n          toFrozen: false\n        };\n      }\n    };\n\n    if (!(action in actions)) {\n      return;\n    }\n\n    info = active.getInfo();\n    var swap = actions[action]();\n    this.setActive(!swap.toHeader, swap.toFrozen);\n    this.getContent().matrix.current = active.matrix.current;\n  };\n\n  FocusStrategy.prototype.internalCellFocus = function (e) {\n    if (!(e.byKey && e.container.isContent && e.keyArgs.action === 'enter' && (e.parent.classList.contains('e-detailcell') || e.parent.classList.contains('e-unboundcell') || e.parent.classList.contains('e-templatecell')))) {\n      return;\n    }\n\n    this.clearIndicator();\n    var focusEle = this.getContent().getFocusable(this.getFocusedElement());\n    this.setFocusedElement(focusEle);\n    this.currentInfo.skipAction = true;\n  };\n\n  return FocusStrategy;\n}();\n\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\n\nvar Matrix =\n/** @class */\nfunction () {\n  function Matrix() {\n    this.matrix = [];\n    this.current = [];\n  }\n\n  Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n    this.matrix[rowIndex] = this.matrix[rowIndex] || [];\n    this.matrix[rowIndex][columnIndex] = allow ? 1 : 0;\n  };\n\n  Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator) {\n    var tmp = columnIndex;\n\n    if (rowIndex + navigator[0] < 0) {\n      return [rowIndex, columnIndex];\n    }\n\n    rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n    var emptyTable = true;\n\n    if (isNullOrUndefined(this.matrix[rowIndex])) {\n      return null;\n    }\n\n    columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[rowIndex].length - 1));\n\n    if (tmp + navigator[1] > this.matrix[rowIndex].length - 1 && validator(rowIndex, columnIndex, action)) {\n      return [rowIndex, tmp];\n    }\n\n    var first = this.first(this.matrix[rowIndex], columnIndex, navigator, true, action);\n    columnIndex = first === null ? tmp : first;\n    var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n\n    if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n      navigator[0] = -1;\n    }\n\n    if (first === null) {\n      for (var i = 0; i < this.rows; i++) {\n        if (this.matrix[i].some(function (v) {\n          return v === 1;\n        })) {\n          emptyTable = false;\n          break;\n        }\n      }\n\n      if (emptyTable) {\n        rowIndex = this.current[0];\n        return [rowIndex, columnIndex];\n      }\n    }\n\n    return this.inValid(val) || !validator(rowIndex, columnIndex, action) ? this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n  };\n\n  Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n    if ((index < 0 || index === vector.length) && this.inValid(vector[index]) && action !== 'upArrow' && action !== 'downArrow' || !vector.some(function (v) {\n      return v === 1;\n    })) {\n      return null;\n    }\n\n    return !this.inValid(vector[index]) ? index : this.first(vector, ['upArrow', 'downArrow', 'shiftUp', 'shiftDown'].indexOf(action) !== -1 ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n  };\n\n  Matrix.prototype.select = function (rowIndex, columnIndex) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[rowIndex].length - 1));\n    this.current = [rowIndex, columnIndex];\n  };\n\n  Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n    this.rows = rows.length - 1;\n    this.matrix = [];\n\n    for (var i = 0; i < rows.length; i++) {\n      var cells = rows[i].cells.filter(function (c) {\n        return c.isSpanned !== true;\n      });\n      this.columns = Math.max(cells.length - 1, this.columns | 0);\n\n      for (var j = 0; j < cells.length; j++) {\n        this.set(i, j, rows[i].visible === false ? false : selector(rows[i], cells[j], isRowTemplate));\n      }\n    }\n\n    return this.matrix;\n  };\n\n  Matrix.prototype.inValid = function (value) {\n    return value === 0 || value === undefined;\n  };\n\n  return Matrix;\n}();\n\nexport { Matrix };\n/**\n * @hidden\n */\n\nvar ContentFocus =\n/** @class */\nfunction () {\n  function ContentFocus(parent) {\n    var _this = this;\n\n    this.matrix = new Matrix();\n    this.lastIdxCell = false;\n    this.parent = parent;\n    this.keyActions = {\n      'rightArrow': [0, 1],\n      'tab': [0, 1],\n      'leftArrow': [0, -1],\n      'shiftTab': [0, -1],\n      'upArrow': [-1, 0],\n      'downArrow': [1, 0],\n      'shiftUp': [-1, 0],\n      'shiftDown': [1, 0],\n      'shiftRight': [0, 1],\n      'shiftLeft': [0, -1],\n      'enter': [1, 0],\n      'shiftEnter': [-1, 0]\n    };\n\n    this.indexesByKey = function (action) {\n      var opt = {\n        'home': [_this.matrix.current[0], -1, 0, 1],\n        'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n        'ctrlHome': [0, -1, 0, 1],\n        'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n      };\n      return opt[action] || null;\n    };\n  }\n\n  ContentFocus.prototype.getTable = function () {\n    return this.parent.isFrozenGrid() ? this.parent.getContent().querySelector('.e-movablecontent .e-table') : this.parent.getContentTable();\n  };\n\n  ContentFocus.prototype.onKeyPress = function (e) {\n    var navigator = this.keyActions[e.action];\n    var current = this.getCurrentFromAction(e.action, navigator, e.action in this.keyActions, e);\n\n    if (!current) {\n      return;\n    }\n\n    if ((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString()) {\n      if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() || current.toString() === [0, 0].toString() || this.matrix.current[0] === this.matrix.rows && this.matrix.current.toString() === current.toString()) {\n        return false;\n      } else {\n        current = this.editNextRow(current[0], current[1], e.action);\n      }\n    }\n\n    this.matrix.select(current[0], current[1]);\n  };\n\n  ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n    var gObj = this.parent;\n    var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n    var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n    var cell = this.getTable().rows[rowIndex].cells[cellIndex];\n\n    if (action === 'tab' && editNextRow) {\n      rowIndex++;\n      var index = this.getTable().rows[rowIndex].getElementsByClassName('e-indentcell').length + this.getTable().rows[rowIndex].getElementsByClassName('e-detailrowcollapse').length;\n      cellIndex = visibleIndex + index;\n    }\n\n    if (action === 'shiftTab' && editNextRow) {\n      rowIndex--;\n      cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n    }\n\n    return !cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-headercell') && !cell.classList.contains('e-groupcaption') ? this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n  };\n\n  ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n    if (navigator === void 0) {\n      navigator = [0, 0];\n    }\n\n    if (!isPresent && !this.indexesByKey(action) || this.matrix.current.length === 0) {\n      return null;\n    }\n\n    if (!this.shouldFocusChange(e)) {\n      return this.matrix.current;\n    }\n\n    var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator),\n        rowIndex = _a[0],\n        cellIndex = _a[1],\n        rN = _a[2],\n        cN = _a[3];\n\n    var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator());\n    return current;\n  };\n\n  ContentFocus.prototype.onClick = function (e, force) {\n    var target = e.target;\n    this.target = target;\n    target = target.classList.contains(literals.rowCell) ? target : closest(target, 'td');\n    target = target ? target : closest(e.target, 'td.e-detailrowcollapse') || closest(e.target, 'td.e-detailrowexpand');\n    target = closest(e.target, 'td.e-detailcell') ? isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n    target = target && closest(target, 'table').classList.contains(literals.table) ? target : null;\n\n    if (!target) {\n      return false;\n    }\n\n    var _a = [target.parentElement.rowIndex, target.cellIndex],\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    var _b = this.matrix.current,\n        oRowIndex = _b[0],\n        oCellIndex = _b[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n\n    if (this.matrix.inValid(val) || !force && oRowIndex === rowIndex && oCellIndex === cellIndex || !parentsUntil(e.target, literals.rowCell) && !parentsUntil(e.target, 'e-groupcaption')) {\n      return false;\n    }\n\n    this.matrix.select(rowIndex, cellIndex);\n  };\n\n  ContentFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rowIndex = _b === void 0 ? 0 : _b,\n        _c = _a[1],\n        cellIndex = _c === void 0 ? 0 : _c;\n    this.matrix.current = [rowIndex, cellIndex];\n    info.element = !isNullOrUndefined(this.getTable().rows[rowIndex]) ? this.getTable().rows[rowIndex].cells[cellIndex] : null;\n\n    if (!info.element) {\n      return info;\n    }\n\n    info.elementToFocus = !info.element.classList.contains('e-unboundcell') && !info.element.classList.contains('e-detailcell') ? this.getFocusable(info.element) : info.element;\n    info.outline = true;\n    info.uid = info.element.parentElement.getAttribute('data-uid');\n    return info;\n  };\n\n  ContentFocus.prototype.getFocusable = function (element) {\n    var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n    var isTemplate = !isNullOrUndefined(closest(element, '.e-templatecell'));\n\n    if (this.parent.isEdit) {\n      query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea';\n    }\n\n    var child = [].slice.call(element.querySelectorAll(query));\n    /* Select the first focusable child element\n     * if no child found then select the cell itself.\n     * if Grid is in editable state, check for editable control inside child.\n     */\n\n    return child.length ? isTemplate && child.length > 1 ? this.target : child[0] : element;\n  };\n\n  ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n    var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n    return (row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate) || row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible) || !row.isDataRow && types.indexOf(cell.cellType) > -1 || cell.column && cell.visible && cell.column.type === 'checkbox' || cell.cellType === CellType.CommandColumn || row.isDataRow && isRowTemplate) && !(row.edit === 'delete' && row.isDirty);\n  };\n\n  ContentFocus.prototype.nextRowFocusValidate = function (index) {\n    var lastIndex = index;\n\n    for (var i = index, len = this.matrix.rows; i <= len; i++) {\n      if (this.matrix.matrix[index].indexOf(1) === -1) {\n        index = index + 1;\n      } else {\n        return index;\n      }\n    }\n\n    this.lastIdxCell = true;\n    return lastIndex;\n  };\n\n  ContentFocus.prototype.previousRowFocusValidate = function (index) {\n    var firstIndex = index;\n\n    for (var i = index, len = 0; i >= len; i--) {\n      if (this.matrix.matrix[index].indexOf(1) === -1) {\n        index = index - 1;\n\n        if (index < 0) {\n          this.lastIdxCell = true;\n          return firstIndex;\n        }\n      } else {\n        return index;\n      }\n    }\n\n    return firstIndex;\n  };\n\n  ContentFocus.prototype.jump = function (action, current) {\n    var frozenSwap = this.parent.getFrozenLeftCount() && (action === 'leftArrow' || action === 'shiftTab') && current[1] === 0;\n    var right = (action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns;\n    var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      frozenSwap = right;\n    }\n\n    this.lastIdxCell = false;\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n\n    if (action === 'tab' && !this.parent.isEdit && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n      this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n      this.matrix.current[1] = -1;\n      frozenSwap = this.parent.isFrozenGrid();\n    }\n\n    if (action === 'shiftTab' && !this.parent.isEdit && current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n      this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n      this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n    }\n\n    var isHeaderFocus = false;\n    var row = document.activeElement.parentElement;\n\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && row.classList.contains(literals.row)) {\n      var rowIndex = parseInt(row.getAttribute(literals.ariaRowIndex), 10);\n      isHeaderFocus = rowIndex > 0;\n    }\n\n    var info = {\n      swap: !isHeaderFocus ? (action === 'upArrow' || enterFrozen) && current[0] === 0 || frozenSwap || frSwap : false,\n      toHeader: (action === 'upArrow' || enterFrozen) && current[0] === 0,\n      toFrozen: frozenSwap,\n      toFrozenRight: frSwap\n    };\n    return info;\n  };\n\n  ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current = [];\n\n    if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n      if (action === 'leftArrow' || action === 'shiftTab') {\n        current[0] = previous[0];\n        current[1] = active.matrix.columns + 1;\n      }\n\n      if (this.parent.getFrozenMode() === literals.leftRight && (action === 'rightArrow' || action === 'tab')) {\n        current[0] = previous[0];\n        current[1] = -1;\n      }\n    } else if (action === 'rightArrow' || action === 'tab') {\n      current[0] = previous[0];\n      current[1] = -1;\n    }\n\n    if (action === 'downArrow' || action === 'enter') {\n      current[0] = -1;\n      current[1] = previous[1];\n    }\n\n    return current;\n  };\n\n  ContentFocus.prototype.generateRows = function (rows, optionals) {\n    var _a;\n\n    var matrix = optionals.matrix,\n        handlerInstance = optionals.handlerInstance;\n    var len = handlerInstance.matrix.matrix.length;\n    var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n    handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n\n    handlerInstance.matrix.rows = defaultLen;\n\n    (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n\n    handlerInstance.matrix.rows += matrix.length;\n  };\n\n  ContentFocus.prototype.getInfo = function (e) {\n    var info = this.getFocusInfo();\n    var _a = this.matrix.current,\n        rIndex = _a[0],\n        cIndex = _a[1];\n    var isData = info.element.classList.contains(literals.rowCell);\n    var isSelectable = isData || e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse') || info.element.classList.contains('e-detailrowexpand')); // eslint-disable-next-line max-len\n\n    var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(literals.ariaRowIndex), 10), rIndex), Math.min(parseInt(info.element.getAttribute(literals.ariaColIndex), 10), cIndex)],\n        rowIndex = _b[0],\n        cellIndex = _b[1];\n    return {\n      isContent: true,\n      isDataCell: isData,\n      indexes: [rowIndex, cellIndex],\n      isSelectable: isSelectable\n    };\n  };\n\n  ContentFocus.prototype.validator = function () {\n    var table = this.getTable();\n    return function (rowIndex, cellIndex, action) {\n      if (!isNullOrUndefined(table.rows[rowIndex])) {\n        var cell = void 0;\n        cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n\n        if (table.rows[rowIndex].cells[0].classList.contains('e-editcell')) {\n          cell = table.rows[rowIndex].cells[0].querySelectorAll('td')[cellIndex];\n        } else {\n          cell = table.rows[rowIndex].cells[cellIndex];\n        }\n\n        var isCellWidth = cell.getBoundingClientRect().width !== 0;\n\n        if (action === 'enter' || action === 'shiftEnter') {\n          return isCellWidth && cell.classList.contains(literals.rowCell);\n        }\n\n        if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(literals.rowCell)) {\n          return isCellWidth;\n        } else if (action !== 'shiftUp' && action !== 'shiftDown') {\n          return isCellWidth;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  ContentFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rIndex = _b === void 0 ? -1 : _b,\n        _c = _a[1],\n        cIndex = _c === void 0 ? -1 : _c;\n\n    if (rIndex < 0 || cIndex < 0) {\n      return true;\n    }\n\n    var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n\n    if (!cell) {\n      return true;\n    }\n\n    return e.action === 'enter' || e.action === 'shiftEnter' ? cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-unboundcell') && (!cell.classList.contains('e-templatecell') || cell.classList.contains('e-editedbatchcell')) && !cell.classList.contains('e-detailcell') : true;\n  };\n\n  ContentFocus.prototype.getGridSeletion = function () {\n    return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n  };\n\n  return ContentFocus;\n}();\n\nexport { ContentFocus };\n/**\n * @hidden\n */\n\nvar HeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(HeaderFocus, _super);\n\n  function HeaderFocus(parent) {\n    return _super.call(this, parent) || this;\n  }\n\n  HeaderFocus.prototype.getTable = function () {\n    return this.parent.isFrozenGrid() ? this.parent.getHeaderContent().querySelector('.e-movableheader .e-table') : this.parent.getHeaderTable();\n  };\n\n  HeaderFocus.prototype.onClick = function (e) {\n    var target = e.target;\n    this.target = target;\n    target = target.classList.contains('e-headercell') ? target : closest(target, 'th');\n\n    if (!target && this.parent.frozenRows !== 0) {\n      target = e.target.classList.contains(literals.rowCell) ? e.target : closest(e.target, 'td');\n    }\n\n    if (e.target.classList.contains('e-columnheader') || e.target.querySelector('.e-stackedheadercell')) {\n      return false;\n    }\n\n    if (!target) {\n      return;\n    }\n\n    var _a = [target.parentElement.rowIndex, target.cellIndex],\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n\n    if (this.matrix.inValid(val)) {\n      return false;\n    }\n\n    this.matrix.select(target.parentElement.rowIndex, target.cellIndex);\n  };\n\n  HeaderFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rowIndex = _b === void 0 ? 0 : _b,\n        _c = _a[1],\n        cellIndex = _c === void 0 ? 0 : _c;\n    info.element = this.getTable().rows[rowIndex].cells[cellIndex];\n\n    if (!isNullOrUndefined(info.element)) {\n      info.elementToFocus = this.getFocusable(info.element);\n      info.outline = !info.element.classList.contains('e-filterbarcell');\n    }\n\n    return info;\n  };\n\n  HeaderFocus.prototype.selector = function (row, cell) {\n    return cell.visible && (cell.column.field !== undefined || cell.isTemplate || !isNullOrUndefined(cell.column.template)) || cell.column.type === 'checkbox' || cell.cellType === CellType.StackedHeader;\n  };\n\n  HeaderFocus.prototype.jump = function (action, current) {\n    var frozenSwap = this.parent.getFrozenLeftCount() && (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') && current[1] === 0;\n    var right = (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') && current[1] === this.matrix.columns;\n    var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      frozenSwap = right;\n    }\n\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var isLastCell;\n    var lastRow;\n    var headerSwap = frozenSwap || frSwap;\n    var fMatrix = this.parent.focusModule.fHeader && this.parent.focusModule.fHeader.matrix.matrix;\n    var isPresent = fMatrix && !isNullOrUndefined(fMatrix[current[0]]);\n\n    if (this.parent.enableHeaderFocus && action === 'tab') {\n      lastRow = this.matrix.matrix.length - 1 === current[0];\n      isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n\n      if (isLastCell) {\n        if (!lastRow) {\n          this.matrix.current[0] = this.matrix.current[0] + 1;\n        } else {\n          this.matrix.current[0] = 0;\n        }\n\n        this.matrix.current[1] = -1;\n      }\n\n      if (this.parent.isFrozenGrid() && lastRow && isLastCell) {\n        frozenSwap = true;\n        headerSwap = false;\n      }\n    }\n\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || isPresent && (frozenSwap || frSwap) || action === 'tab' && lastRow && isLastCell,\n      toHeader: headerSwap,\n      toFrozen: frozenSwap,\n      toFrozenRight: frSwap\n    };\n  };\n\n  HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current1 = [];\n\n    if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n      if (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') {\n        current1[0] = previous[0];\n        current1[1] = active.matrix.columns + 1;\n      }\n\n      if (this.parent.getFrozenMode() === literals.leftRight && (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab')) {\n        current1[0] = previous[0];\n        current1[1] = -1;\n      }\n    } else if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n      current1[0] = previous[0];\n      current1[1] = -1;\n    }\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current1[0] = this.matrix.matrix.length;\n      current1[1] = previous[1];\n    }\n\n    return current1;\n  };\n\n  HeaderFocus.prototype.generateRows = function (rows) {\n    var length = this.matrix.matrix.length;\n\n    if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n      this.matrix.rows = ++this.matrix.rows;\n      var cells = rows[0].cells;\n\n      for (var i = 0; i < cells.length; i++) {\n        this.matrix.set(length, i, cells[i].visible && cells[i].column.allowFiltering !== false);\n      }\n    }\n  };\n\n  HeaderFocus.prototype.getInfo = function (e) {\n    return extend(_super.prototype.getInfo.call(this, e), {\n      isContent: false,\n      isHeader: true\n    });\n  };\n\n  HeaderFocus.prototype.validator = function () {\n    return function () {\n      return true;\n    };\n  };\n\n  HeaderFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n        rowIndex = _a[0],\n        columnIndex = _a[1];\n\n    if (rowIndex < 0 || columnIndex < 0) {\n      return true;\n    }\n\n    var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n\n    if (!cell) {\n      return true;\n    }\n\n    return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n  };\n\n  return HeaderFocus;\n}(ContentFocus);\n\nexport { HeaderFocus };\n\nvar FixedContentFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedContentFocus, _super);\n\n  function FixedContentFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedContentFocus.prototype.getTable = function () {\n    return this.parent.getContent().querySelector('.e-frozencontent .e-table');\n  };\n\n  FixedContentFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      var swap = toHeader || (action === 'shiftTab' || action === 'leftArrow') && current[1] === 0;\n      return {\n        swap: swap,\n        toHeader: toHeader,\n        toFrozen: toHeader\n      };\n    }\n\n    return {\n      swap: toHeader || (action === 'tab' || action === 'rightArrow') && current[1] === this.matrix.columns,\n      toHeader: toHeader,\n      toFrozen: toHeader\n    };\n  };\n\n  FixedContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current2 = [];\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      if (action === 'rightArrow' || action === 'tab') {\n        current2[0] = previous[0];\n        current2[1] = -1;\n      }\n    } else {\n      if (action === 'tab' && this.parent.enableHeaderFocus) {\n        current2[0] = previous[0];\n        current2[1] = -1;\n      }\n\n      if (action === 'leftArrow' || action === 'shiftTab') {\n        current2[0] = previous[0];\n        current2[1] = active.matrix.columns + 1;\n      }\n    }\n\n    if (action === 'downArrow' || action === 'enter') {\n      current2[0] = -1;\n      current2[1] = previous[1];\n    }\n\n    return current2;\n  };\n\n  return FixedContentFocus;\n}(ContentFocus);\n\nexport { FixedContentFocus };\n\nvar FixedHeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedHeaderFocus, _super);\n\n  function FixedHeaderFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedHeaderFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var hMatrix = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n    var isPresent = hMatrix && !isNullOrUndefined(hMatrix[current[0]]);\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      var frSwap = (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') && current[1] === 0;\n      var swap = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || isPresent && frSwap;\n      var toFrozen = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n      return {\n        swap: swap,\n        toHeader: frSwap,\n        toFrozen: toFrozen\n      };\n    }\n\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') && current[1] === this.matrix.columns && isPresent,\n      toHeader: (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') && current[1] === this.matrix.columns,\n      toFrozen: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1\n    };\n  };\n\n  FixedHeaderFocus.prototype.getTable = function () {\n    return this.parent.getHeaderContent().querySelector('.e-frozenheader .e-table');\n  };\n\n  FixedHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current3 = [];\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n        current3[0] = previous[0];\n        current3[1] = -1;\n      }\n    } else {\n      if (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') {\n        current3[0] = previous[0];\n        current3[1] = active.matrix.columns + 1;\n      }\n    }\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current3[0] = this.matrix.matrix.length;\n      current3[1] = previous[1];\n    }\n\n    return current3;\n  };\n\n  return FixedHeaderFocus;\n}(HeaderFocus);\n\nexport { FixedHeaderFocus };\n/** @hidden */\n\nvar SearchBox =\n/** @class */\nfunction () {\n  function SearchBox(searchBox) {\n    this.searchBox = searchBox;\n  }\n\n  SearchBox.prototype.searchFocus = function (args) {\n    args.target.parentElement.classList.add('e-input-focus');\n  };\n\n  SearchBox.prototype.searchBlur = function (args) {\n    args.target.parentElement.classList.remove('e-input-focus');\n  };\n\n  SearchBox.prototype.wireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n      EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n    }\n  };\n\n  SearchBox.prototype.unWireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n      EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n    }\n  };\n\n  return SearchBox;\n}();\n\nexport { SearchBox };\n\nvar FixedRightContentFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedRightContentFocus, _super);\n\n  function FixedRightContentFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedRightContentFocus.prototype.getTable = function () {\n    return this.parent.getContent().querySelector('.e-frozen-right-content .e-table');\n  };\n\n  FixedRightContentFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n    return {\n      swap: toHeader || (action === 'shiftTab' || action === 'leftArrow') && current[1] === 0,\n      toHeader: toHeader,\n      toFrozenRight: toHeader\n    };\n  };\n\n  FixedRightContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current2 = [];\n\n    if (action === 'rightArrow' || action === 'tab') {\n      current2[0] = previous[0];\n      current2[1] = -1;\n    }\n\n    if (action === 'downArrow' || action === 'enter') {\n      current2[0] = -1;\n      current2[1] = previous[1];\n    }\n\n    return current2;\n  };\n\n  return FixedRightContentFocus;\n}(ContentFocus);\n\nexport { FixedRightContentFocus };\n\nvar FixedRightHeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedRightHeaderFocus, _super);\n\n  function FixedRightHeaderFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedRightHeaderFocus.prototype.jump = function (action, current) {\n    var headerMat = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n    var isPresent = headerMat && !isNullOrUndefined(headerMat[current[0]]);\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var frozenSwap = (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') && current[1] === 0;\n    var swap = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || isPresent && frozenSwap;\n    var toFrozen = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n    return {\n      swap: swap,\n      toHeader: frozenSwap,\n      toFrozenRight: toFrozen\n    };\n  };\n\n  FixedRightHeaderFocus.prototype.getTable = function () {\n    return this.parent.getHeaderContent().querySelector('.e-frozen-right-header .e-table');\n  };\n\n  FixedRightHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current3 = [];\n\n    if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n      current3[0] = previous[0];\n      current3[1] = 0;\n    }\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current3[0] = this.matrix.matrix.length;\n      current3[1] = previous[1];\n    }\n\n    return current3;\n  };\n\n  return FixedRightHeaderFocus;\n}(HeaderFocus);\n\nexport { FixedRightHeaderFocus };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EventHandler","getValue","closest","isNullOrUndefined","addClass","removeClass","extend","Browser","CellType","event","Row","RowModelGenerator","parentsUntil","addRemoveEventListener","literals","FocusStrategy","parent","currentInfo","oneTime","swap","isInfiniteScroll","forget","skipFocus","focusByClick","prevIndexes","refMatrix","refreshMatrix","actions","isVirtualScroll","rowModelGen","addEventListener","focusCheck","e","target","classList","contains","onFocus","isDestroyed","isDevice","enableVirtualization","setActive","enableHeaderFocus","frozenRows","isFrozenGrid","getCurrentViewRecords","length","editSettings","mode","editModule","getBatchChanges","addedRecords","getContent","matrix","generate","generateRows","rows","isDataRow","selector","current","get","validator","select","focus","passiveFocus","skipAction","element","onBlur","isEdit","relatedTarget","parseInt","getAttribute","removeFocus","tabIndex","onClick","force","isContent","gridContent","isHeader","gridHeader","isFrozen","frozenContent","frozenHeader","isFrozenRight","getFrozenMode","leftRight","content","clearOutline","beforeArgs","cancel","byKey","byClick","clickArgs","notify","beforeCellFocused","returnVal","onKeyPress","skipOn","activeKey","action","keyArgs","bValue","outline","swapInfo","jump","toHeader","toFrozen","toFrozenRight","getNextCurrent","active","setActiveByKey","lastIdxCell","clearIndicator","toString","preventDefault","indexOf","th","keyCode","inputTarget","querySelector","document","activeElement","filterCell","lastIndexOf","id","gridChkBox","focusVirtualElement","_this","enableInfiniteScrolling","data","virtualData","isAdd","isCancel","getVirtualData","isKeyFocus","some","value","isSelected","contentModule","selectedRowIndex","keys","resetVirtualFocus","empty","elementToFocus","preventScroll","getFocusedElement","fContent","frContent","fHeader","frHeader","header","setFocusedElement","setTimeout","virtaulCellFocus","addFocus","getFocusInfo","addOutline","info","focusHeader","resetFocus","focusContent","isFocused","cellFocused","indexes","isJump","container","getInfo","_a","rowIndex","cellIndex","focusedColumnUid","getColumnByIndex","uid","args","FixedContentFocus","renderFrozenRightContent","FixedRightContentFocus","ContentFocus","FixedHeaderFocus","FixedRightHeaderFocus","HeaderFocus","cFocus","slice","updateRow","isCollapseStateEnabled","filter","x","visible","isRowTemplate","rowTemplate","name","mRows","getMovableRowsObject","newMovableRows","map","row","clone","newFrozenRows","frRows","getFrozenRightRowsObject","newfrRows","handlerInstance","requestType","index_1","bool","i","getColumnIndexByUid","focusElement","cellPosition","getBoundingClientRect","gridPosition","top","left","right","Math","min","window","innerWidth","documentElement","clientWidth","bottom","innerHeight","clientHeight","add","passiveHandler","evtHandlers","keyPressed","handler","click","contentReady","partialRefresh","refreshExpandandCollapse","headerRefreshed","closeEdit","restoreFocus","filterfocus","restoreFocusWithAction","batchAdd","batchCancel","batchDelete","detailDataBound","onEmpty","internalCellFocus","filterSettings","type","removeEventListener","remove","destroy","groupSettings","showGroupedColumn","getPrevIndexes","forgetPrevious","focusEle","getFocusable","Matrix","set","columnIndex","allow","max","columns","navigator","tmp","emptyTable","first","val","v","inValid","vector","index","moveTo","cells","c","isSpanned","j","undefined","keyActions","indexesByKey","opt","getTable","getContentTable","getCurrentFromAction","editNextRow","gObj","allowNextRowEdit","isLastCellPrimaryKey","visibleIndex","getColumnIndexByField","getVisibleColumns","field","cell","getElementsByClassName","rowCell","isPresent","shouldFocusChange","concat","rN","cN","table","parentElement","_b","oRowIndex","oCellIndex","_c","query","isTemplate","child","call","querySelectorAll","types","Expand","GroupCaption","CaptionSummary","GroupSummary","isDataCell","cellType","DetailExpand","column","CommandColumn","edit","isDirty","nextRowFocusValidate","lastIndex","len","previousRowFocusValidate","firstIndex","frozenSwap","getFrozenLeftCount","frSwap","enterFrozen","isHeaderFocus","infiniteScrollSettings","enableCache","ariaRowIndex","previous","optionals","defaultLen","allowFiltering","push","apply","rIndex","cIndex","isData","isSelectable","ariaColIndex","isCellWidth","width","getGridSeletion","allowSelection","selectionSettings","allowColumnSelection","_super","getHeaderContent","getHeaderTable","template","StackedHeader","isLastCell","lastRow","headerSwap","fMatrix","focusModule","current1","arguments","current2","hMatrix","current3","SearchBox","searchBox","searchFocus","searchBlur","wireEvent","unWireEvent","headerMat"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Admin Dashboard/frontend/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\nimport { parentsUntil, addRemoveEventListener } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * FocusStrategy class\n *\n * @hidden\n */\nvar FocusStrategy = /** @class */ (function () {\n    function FocusStrategy(parent) {\n        this.currentInfo = {};\n        this.oneTime = true;\n        this.swap = {};\n        /** @hidden */\n        this.isInfiniteScroll = false;\n        this.forget = false;\n        this.skipFocus = true;\n        this.focusByClick = false;\n        this.prevIndexes = {};\n        this.refMatrix = this.refreshMatrix(true);\n        this.actions = ['downArrow', 'upArrow'];\n        this.isVirtualScroll = false;\n        this.parent = parent;\n        this.rowModelGen = new RowModelGenerator(this.parent);\n        this.addEventListener();\n    }\n    FocusStrategy.prototype.focusCheck = function (e) {\n        var target = e.target;\n        this.focusByClick = true;\n        this.skipFocus = target.classList.contains('e-grid');\n    };\n    FocusStrategy.prototype.onFocus = function (e) {\n        if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization) {\n            return;\n        }\n        this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0, this.parent.isFrozenGrid());\n        if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && ((this.parent.editSettings.mode !== 'Batch')\n            || (this.parent.editSettings.mode === 'Batch' && !this.parent.editModule.getBatchChanges()[literals.addedRecords].length))) {\n            this.getContent().matrix.\n                generate(this.rowModelGen.generateRows({ rows: [new Row({ isDataRow: true })] }), this.getContent().selector, false);\n        }\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        if (this.skipFocus) {\n            this.focus(e);\n            this.skipFocus = false;\n        }\n    };\n    FocusStrategy.prototype.passiveFocus = function (e) {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (e.target && e.target.classList.contains('e-detailcell')) {\n            this.currentInfo.skipAction = false;\n            addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.onBlur = function (e) {\n        if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid')))\n            && !(isNullOrUndefined(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) === 0 &&\n                parseInt(e.target.getAttribute('index'), 10) === 0)) {\n            return;\n        }\n        this.removeFocus();\n        this.skipFocus = true;\n        this.currentInfo.skipAction = false;\n        this.parent.element.tabIndex = 0;\n    };\n    FocusStrategy.prototype.onClick = function (e, force) {\n        if (parentsUntil(e.target, 'e-filterbarcell') && (parentsUntil(e.target, 'e-multiselect') ||\n            e.target.classList.contains('e-input-group-icon'))) {\n            return;\n        }\n        var isContent = !isNullOrUndefined(closest(e.target, '.' + literals.gridContent));\n        var isHeader = !isNullOrUndefined(closest(e.target, '.' + literals.gridHeader));\n        isContent = isContent && isHeader ? !isContent : isContent;\n        var isFrozen = !isNullOrUndefined(closest(e.target, '.' + literals.frozenContent)) ||\n            !isNullOrUndefined(closest(e.target, '.' + literals.frozenHeader));\n        var isFrozenRight = false;\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n            isFrozenRight = !isNullOrUndefined(closest(e.target, '.e-frozen-right-content')) ||\n                !isNullOrUndefined(closest(e.target, '.e-frozen-right-header'));\n            isFrozen = isFrozen && !isFrozenRight;\n        }\n        if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader)) ||\n            e.target.classList.contains(literals.content) ||\n            !isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n            return;\n        }\n        this.setActive(isContent, isFrozen, isFrozenRight);\n        if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader))) {\n            this.clearOutline();\n            return;\n        }\n        var beforeArgs = { cancel: false, byKey: false, byClick: !isNullOrUndefined(e.target), clickArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel || closest(e.target, '.e-inline-edit')) {\n            return;\n        }\n        this.setActive(isContent, isFrozen, isFrozenRight);\n        if (this.getContent()) {\n            var returnVal = this.getContent().onClick(e, force);\n            if (returnVal === false) {\n                return;\n            }\n            this.focus();\n        }\n    };\n    FocusStrategy.prototype.onKeyPress = function (e) {\n        if (this.skipOn(e)) {\n            return;\n        }\n        this.activeKey = e.action;\n        var beforeArgs = { cancel: false, byKey: true, byClick: false, keyArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        var bValue = this.getContent().matrix.current;\n        this.currentInfo.outline = true;\n        var swapInfo = this.getContent().jump(e.action, bValue);\n        this.swap = swapInfo;\n        if (swapInfo.swap) {\n            this.setActive(!swapInfo.toHeader, swapInfo.toFrozen, swapInfo.toFrozenRight);\n            this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n            this.prevIndexes = {};\n        }\n        this.setActiveByKey(e.action, this.getContent());\n        var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n        if (returnVal === false) {\n            this.clearIndicator();\n            if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n                this.parent.element.tabIndex = -1;\n            }\n            return;\n        }\n        e.preventDefault();\n        this.focus(e);\n    };\n    FocusStrategy.prototype.skipOn = function (e) {\n        var target = e.target;\n        if (!target) {\n            return false;\n        }\n        if (this.currentInfo.skipAction) {\n            this.clearIndicator();\n            return true;\n        }\n        if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n            this.clearIndicator();\n            return true;\n        }\n        var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n        if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n            var inputTarget = closest(e.target, '.e-filterbarcell');\n            inputTarget.querySelector('input').focus();\n        }\n        if (th && closest(document.activeElement, '.e-filterbarcell') !== null) {\n            this.removeFocus();\n        }\n        var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n        if (this.parent.enableHeaderFocus && filterCell) {\n            var matrix = this.active.matrix;\n            var current = matrix.current;\n            filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n        }\n        return (e.action === 'delete'\n            || (this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit || ['insert', 'f2'].indexOf(e.action) > -1))\n            || (filterCell ||\n                closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null\n                    && ['enter', 'leftArrow', 'rightArrow',\n                        'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1)\n            || (closest(target, '.' + literals.gridContent) === null && closest(target, '.' + literals.gridHeader) === null)\n            || (e.action === 'space' && (!target.classList.contains(literals.gridChkBox) && closest(target, '.' + literals.gridChkBox) === null\n                && closest(target, '.e-headerchkcelldiv') === null))) || closest(target, '.e-filter-popup') !== null;\n    };\n    FocusStrategy.prototype.focusVirtualElement = function (e) {\n        var _this = this;\n        if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n            var data = { virtualData: {}, isAdd: false, isCancel: false };\n            this.parent.notify(event.getVirtualData, data);\n            var isKeyFocus = this.actions.some(function (value) { return value === _this.activeKey; });\n            var isSelected = this.parent.contentModule ?\n                this.parent.contentModule.selectedRowIndex > -1 : false;\n            if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n                this.parent.notify(event.resetVirtualFocus, { isCancel: false });\n                data.isCancel = false;\n                this.parent.contentModule.selectedRowIndex = -1;\n                if (isKeyFocus) {\n                    this.activeKey = this.empty;\n                    this.parent.notify('virtaul-key-handler', e);\n                }\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                this.currentInfo.elementToFocus.focus({ preventScroll: true });\n            }\n            else {\n                if (this.isVirtualScroll || this.isInfiniteScroll) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    this.currentInfo.elementToFocus.focus({ preventScroll: true });\n                }\n                else {\n                    this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }\n        this.isVirtualScroll = this.isInfiniteScroll = false;\n    };\n    FocusStrategy.prototype.getFocusedElement = function () {\n        return this.currentInfo.elementToFocus;\n    };\n    FocusStrategy.prototype.getContent = function () {\n        return this.active || this.content;\n    };\n    FocusStrategy.prototype.setActive = function (content, isFrozen, isFrozenRight) {\n        this.active = content ? isFrozen ? this.fContent : isFrozenRight ? this.frContent : this.content :\n            isFrozen ? this.fHeader : isFrozenRight ? this.frHeader : this.header;\n    };\n    FocusStrategy.prototype.setFocusedElement = function (element, e) {\n        var _this = this;\n        this.currentInfo.elementToFocus = element;\n        setTimeout(function () {\n            if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n                if (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) {\n                    _this.focusVirtualElement(e);\n                }\n                else {\n                    _this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }, 0);\n    };\n    FocusStrategy.prototype.focus = function (e) {\n        this.parent.notify(event.virtaulCellFocus, e);\n        this.removeFocus();\n        this.addFocus(this.getContent().getFocusInfo(), e);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    FocusStrategy.prototype.removeFocus = function (e) {\n        if (!this.currentInfo.element) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n        this.currentInfo.element.tabIndex = -1;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.addOutline = function () {\n        var info = this.getContent().getFocusInfo();\n        if (info.element) {\n            addClass([info.element], ['e-focused']);\n            addClass([info.elementToFocus], ['e-focus']);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusHeader = function () {\n        this.setActive(false, this.parent.isFrozenGrid());\n        this.resetFocus();\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusContent = function () {\n        this.setActive(true, this.parent.isFrozenGrid());\n        this.resetFocus();\n    };\n    FocusStrategy.prototype.resetFocus = function () {\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        this.focus();\n    };\n    FocusStrategy.prototype.addFocus = function (info, e) {\n        this.currentInfo = info;\n        this.currentInfo.outline = info.outline && !isNullOrUndefined(e);\n        if (this.isInfiniteScroll) {\n            this.currentInfo.outline = true;\n        }\n        if (!info.element) {\n            return;\n        }\n        var isFocused = info.elementToFocus.classList.contains('e-focus');\n        if (isFocused) {\n            return;\n        }\n        if (this.currentInfo.outline) {\n            addClass([info.element], ['e-focused']);\n        }\n        addClass([info.elementToFocus], ['e-focus']);\n        info.element.tabIndex = 0;\n        if (!isFocused) {\n            this.setFocusedElement(info.elementToFocus, e);\n        }\n        this.parent.notify(event.cellFocused, {\n            element: info.elementToFocus,\n            parent: info.element,\n            indexes: this.getContent().matrix.current,\n            byKey: !isNullOrUndefined(e),\n            byClick: isNullOrUndefined(e),\n            keyArgs: e,\n            isJump: this.swap.swap,\n            container: this.getContent().getInfo(e),\n            outline: !isNullOrUndefined(e),\n            swapInfo: this.swap\n        });\n        var _a = this.getContent().matrix.current, rowIndex = _a[0], cellIndex = _a[1];\n        this.prevIndexes = { rowIndex: rowIndex, cellIndex: cellIndex };\n        this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n        this.focusByClick = false;\n    };\n    FocusStrategy.prototype.refreshMatrix = function (content) {\n        var _this = this;\n        return function (e) {\n            if (content && (e.args && e.args.isFrozen) && !_this.fContent) {\n                _this.fContent = new FixedContentFocus(_this.parent);\n            }\n            else if (content && !_this.frContent && (e.args && e.args.renderFrozenRightContent)) {\n                _this.frContent = new FixedRightContentFocus(_this.parent);\n            }\n            else if (content && !_this.content) {\n                _this.content = new ContentFocus(_this.parent);\n            }\n            if (!content && (e.args && e.args.isFrozen) && !_this.fHeader) {\n                _this.fHeader = new FixedHeaderFocus(_this.parent);\n            }\n            else if (!content && (e.args && e.args.renderFrozenRightContent) && !_this.frHeader) {\n                _this.frHeader = new FixedRightHeaderFocus(_this.parent);\n            }\n            else if (!content && !_this.header) {\n                _this.header = new HeaderFocus(_this.parent);\n            }\n            var cFocus = content ? (e.args && e.args.isFrozen) ? _this.fContent : (e.args && e.args.renderFrozenRightContent)\n                ? _this.frContent : _this.content : (e.args && e.args.isFrozen) ? _this.fHeader : (e.args && e.args.renderFrozenRightContent)\n                ? _this.frHeader : _this.header;\n            var rows = content ? e.rows.slice(_this.parent.frozenRows) : e.rows;\n            var updateRow = content ? e.rows.slice(0, _this.parent.frozenRows) : e.rows;\n            if (_this.parent.isCollapseStateEnabled() && content) {\n                rows = rows.filter(function (x) { return x.visible !== false; });\n            }\n            var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n            var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n            if (e.name === 'batchAdd' && _this.parent.isFrozenGrid()) {\n                var mRows = _this.parent.getMovableRowsObject();\n                var newMovableRows = mRows.map(function (row) { return row.clone(); });\n                var newFrozenRows = rows.map(function (row) { return row.clone(); });\n                _this.fContent.matrix.generate(newFrozenRows, _this.fContent.selector, isRowTemplate);\n                _this.content.matrix.generate(newMovableRows, _this.content.selector, isRowTemplate);\n                if (_this.parent.getFrozenMode() === literals.leftRight) {\n                    var frRows = _this.parent.getFrozenRightRowsObject();\n                    var newfrRows = frRows.map(function (row) { return row.clone(); });\n                    _this.frContent.matrix.generate(newfrRows, _this.frContent.selector, isRowTemplate);\n                }\n            }\n            else {\n                cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n            }\n            cFocus.generateRows(updateRow, {\n                matrix: matrix, handlerInstance: (e.args && e.args.isFrozen) ? _this.fHeader\n                    : (e.args && e.args.renderFrozenRightContent) ? _this.frHeader : _this.header\n            });\n            if (!Browser.isDevice && e && e.args) {\n                if (!_this.focusByClick && e.args.requestType === 'paging') {\n                    _this.skipFocus = false;\n                    _this.parent.element.focus();\n                }\n                if (e.args.requestType === 'grouping') {\n                    _this.skipFocus = true;\n                }\n            }\n            if (e && e.args && e.args.requestType === 'virtualscroll') {\n                if (_this.currentInfo.uid) {\n                    var index_1;\n                    var bool = e.rows.some(function (row, i) {\n                        index_1 = i;\n                        return row.uid === _this.currentInfo.uid;\n                    });\n                    if (bool) {\n                        _this.content.matrix.current[0] = index_1;\n                        _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n                        var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n                        if (focusElement) {\n                            var cellPosition = focusElement.getBoundingClientRect();\n                            var gridPosition = _this.parent.element.getBoundingClientRect();\n                            if (cellPosition.top >= 0 && cellPosition.left >= 0 &&\n                                cellPosition.right <= Math.min(gridPosition.right, window.innerWidth ||\n                                    document.documentElement.clientWidth) &&\n                                cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight ||\n                                    document.documentElement.clientHeight)) {\n                                _this.isVirtualScroll = true;\n                                _this.focus();\n                            }\n                        }\n                    }\n                }\n                else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n                    var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n                    if (focusElement) {\n                        focusElement.focus();\n                    }\n                }\n            }\n        };\n    };\n    FocusStrategy.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n        EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n        this.parent.element.addEventListener('focus', this.passiveHandler = function (e) { return _this.passiveFocus(e); }, true);\n        EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n        this.evtHandlers = [{ event: event.keyPressed, handler: this.onKeyPress },\n            { event: event.click, handler: this.onClick },\n            { event: event.contentReady, handler: this.refMatrix },\n            { event: event.partialRefresh, handler: this.refMatrix },\n            { event: event.refreshExpandandCollapse, handler: this.refMatrix },\n            { event: event.headerRefreshed, handler: this.refreshMatrix() },\n            { event: event.closeEdit, handler: this.restoreFocus },\n            { event: event.restoreFocus, handler: this.restoreFocus },\n            { event: 'start-edit', handler: this.clearIndicator },\n            { event: 'start-add', handler: this.clearIndicator },\n            { event: 'sorting-complete', handler: this.restoreFocus },\n            { event: 'filtering-complete', handler: this.filterfocus },\n            { event: 'grouping-complete', handler: this.restoreFocusWithAction },\n            { event: 'ungrouping-complete', handler: this.restoreFocusWithAction },\n            { event: event.batchAdd, handler: this.refMatrix },\n            { event: event.batchCancel, handler: this.refMatrix },\n            { event: event.batchDelete, handler: this.refMatrix },\n            { event: event.detailDataBound, handler: this.refMatrix },\n            { event: event.onEmpty, handler: this.refMatrix },\n            { event: event.cellFocused, handler: this.internalCellFocus }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    };\n    FocusStrategy.prototype.filterfocus = function () {\n        if (this.parent.filterSettings.type !== 'FilterBar') {\n            this.restoreFocus();\n        }\n    };\n    FocusStrategy.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n        EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n        EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n        this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n    };\n    FocusStrategy.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    FocusStrategy.prototype.restoreFocus = function () {\n        this.addFocus(this.getContent().getFocusInfo());\n    };\n    FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n        if (!this.parent.enableInfiniteScrolling) {\n            var matrix = this.getContent().matrix;\n            var current = matrix.current;\n            switch (e.requestType) {\n                case 'grouping':\n                case 'ungrouping':\n                    current[1] = current.length &&\n                        !this.parent.groupSettings.showGroupedColumn && !isNullOrUndefined(matrix.matrix[current[0]]) ?\n                        matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n                    break;\n            }\n            this.getContent().matrix.current = current;\n            this.addFocus(this.getContent().getFocusInfo());\n        }\n    };\n    FocusStrategy.prototype.clearOutline = function () {\n        this.getContent().matrix.current = this.getContent().matrix.get(0, -1, [0, 1], 'downArrow', this.getContent().validator());\n        this.clearIndicator();\n    };\n    FocusStrategy.prototype.clearIndicator = function () {\n        if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n    };\n    FocusStrategy.prototype.getPrevIndexes = function () {\n        var forget = this.forget;\n        this.forget = false;\n        return forget || !Object.keys(this.prevIndexes).length ? { rowIndex: null, cellIndex: null } : this.prevIndexes;\n    };\n    FocusStrategy.prototype.forgetPrevious = function () {\n        this.forget = true;\n    };\n    FocusStrategy.prototype.setActiveByKey = function (action, active) {\n        var _this = this;\n        if (!this.parent.isFrozenGrid() && this.parent.frozenRows === 0) {\n            return;\n        }\n        // eslint-disable-next-line prefer-const\n        var info;\n        var actions = {\n            'home': function () { return ({ toHeader: !info.isContent, toFrozen: true }); },\n            'end': function () { return ({ toHeader: !info.isContent, toFrozen: false }); },\n            'ctrlHome': function () { return ({ toHeader: true, toFrozen: _this.parent.isFrozenGrid() }); },\n            'ctrlEnd': function () { return ({ toHeader: false, toFrozen: false }); }\n        };\n        if (!(action in actions)) {\n            return;\n        }\n        info = active.getInfo();\n        var swap = actions[action]();\n        this.setActive(!swap.toHeader, swap.toFrozen);\n        this.getContent().matrix.current = active.matrix.current;\n    };\n    FocusStrategy.prototype.internalCellFocus = function (e) {\n        if (!(e.byKey && e.container.isContent && e.keyArgs.action === 'enter'\n            && (e.parent.classList.contains('e-detailcell') ||\n                e.parent.classList.contains('e-unboundcell') || e.parent.classList.contains('e-templatecell')))) {\n            return;\n        }\n        this.clearIndicator();\n        var focusEle = this.getContent().getFocusable(this.getFocusedElement());\n        this.setFocusedElement(focusEle);\n        this.currentInfo.skipAction = true;\n    };\n    return FocusStrategy;\n}());\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\nvar Matrix = /** @class */ (function () {\n    function Matrix() {\n        this.matrix = [];\n        this.current = [];\n    }\n    Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n        this.matrix[rowIndex] = this.matrix[rowIndex] || [];\n        this.matrix[rowIndex][columnIndex] = allow ? 1 : 0;\n    };\n    Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator) {\n        var tmp = columnIndex;\n        if (rowIndex + navigator[0] < 0) {\n            return [rowIndex, columnIndex];\n        }\n        rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n        var emptyTable = true;\n        if (isNullOrUndefined(this.matrix[rowIndex])) {\n            return null;\n        }\n        columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[rowIndex].length - 1));\n        if (tmp + navigator[1] > this.matrix[rowIndex].length - 1 && validator(rowIndex, columnIndex, action)) {\n            return [rowIndex, tmp];\n        }\n        var first = this.first(this.matrix[rowIndex], columnIndex, navigator, true, action);\n        columnIndex = first === null ? tmp : first;\n        var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n        if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n            navigator[0] = -1;\n        }\n        if (first === null) {\n            for (var i = 0; i < this.rows; i++) {\n                if (this.matrix[i].some(function (v) { return v === 1; })) {\n                    emptyTable = false;\n                    break;\n                }\n            }\n            if (emptyTable) {\n                rowIndex = this.current[0];\n                return [rowIndex, columnIndex];\n            }\n        }\n        return this.inValid(val) || !validator(rowIndex, columnIndex, action) ?\n            this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n    };\n    Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n        if (((index < 0 || index === vector.length) && this.inValid(vector[index])\n            && (action !== 'upArrow' && action !== 'downArrow')) || !vector.some(function (v) { return v === 1; })) {\n            return null;\n        }\n        return !this.inValid(vector[index]) ? index :\n            this.first(vector, (['upArrow', 'downArrow', 'shiftUp', 'shiftDown'].indexOf(action) !== -1) ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n    };\n    Matrix.prototype.select = function (rowIndex, columnIndex) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[rowIndex].length - 1));\n        this.current = [rowIndex, columnIndex];\n    };\n    Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n        this.rows = rows.length - 1;\n        this.matrix = [];\n        for (var i = 0; i < rows.length; i++) {\n            var cells = rows[i].cells.filter(function (c) { return c.isSpanned !== true; });\n            this.columns = Math.max(cells.length - 1, this.columns | 0);\n            for (var j = 0; j < cells.length; j++) {\n                this.set(i, j, rows[i].visible === false ? false : selector(rows[i], cells[j], isRowTemplate));\n            }\n        }\n        return this.matrix;\n    };\n    Matrix.prototype.inValid = function (value) {\n        return value === 0 || value === undefined;\n    };\n    return Matrix;\n}());\nexport { Matrix };\n/**\n * @hidden\n */\nvar ContentFocus = /** @class */ (function () {\n    function ContentFocus(parent) {\n        var _this = this;\n        this.matrix = new Matrix();\n        this.lastIdxCell = false;\n        this.parent = parent;\n        this.keyActions = {\n            'rightArrow': [0, 1],\n            'tab': [0, 1],\n            'leftArrow': [0, -1],\n            'shiftTab': [0, -1],\n            'upArrow': [-1, 0],\n            'downArrow': [1, 0],\n            'shiftUp': [-1, 0],\n            'shiftDown': [1, 0],\n            'shiftRight': [0, 1],\n            'shiftLeft': [0, -1],\n            'enter': [1, 0],\n            'shiftEnter': [-1, 0]\n        };\n        this.indexesByKey = function (action) {\n            var opt = {\n                'home': [_this.matrix.current[0], -1, 0, 1],\n                'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n                'ctrlHome': [0, -1, 0, 1],\n                'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n            };\n            return opt[action] || null;\n        };\n    }\n    ContentFocus.prototype.getTable = function () {\n        return (this.parent.isFrozenGrid() ?\n            this.parent.getContent().querySelector('.e-movablecontent .e-table') :\n            this.parent.getContentTable());\n    };\n    ContentFocus.prototype.onKeyPress = function (e) {\n        var navigator = this.keyActions[e.action];\n        var current = this.getCurrentFromAction(e.action, navigator, e.action in this.keyActions, e);\n        if (!current) {\n            return;\n        }\n        if ((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString()) {\n            if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() ||\n                current.toString() === [0, 0].toString() || (this.matrix.current[0] === this.matrix.rows &&\n                this.matrix.current.toString() === current.toString())) {\n                return false;\n            }\n            else {\n                current = this.editNextRow(current[0], current[1], e.action);\n            }\n        }\n        this.matrix.select(current[0], current[1]);\n    };\n    ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n        var gObj = this.parent;\n        var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n        var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n        var cell = this.getTable().rows[rowIndex].cells[cellIndex];\n        if (action === 'tab' && editNextRow) {\n            rowIndex++;\n            var index = (this.getTable().rows[rowIndex].getElementsByClassName('e-indentcell').length +\n                this.getTable().rows[rowIndex].getElementsByClassName('e-detailrowcollapse').length);\n            cellIndex = visibleIndex + index;\n        }\n        if (action === 'shiftTab' && editNextRow) {\n            rowIndex--;\n            cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n        }\n        return !cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-headercell') &&\n            !cell.classList.contains('e-groupcaption') ?\n            this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n    };\n    ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n        if (navigator === void 0) { navigator = [0, 0]; }\n        if (!isPresent && !this.indexesByKey(action) || (this.matrix.current.length === 0)) {\n            return null;\n        }\n        if (!this.shouldFocusChange(e)) {\n            return this.matrix.current;\n        }\n        var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator), rowIndex = _a[0], cellIndex = _a[1], rN = _a[2], cN = _a[3];\n        var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator());\n        return current;\n    };\n    ContentFocus.prototype.onClick = function (e, force) {\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains(literals.rowCell) ? target : closest(target, 'td'));\n        target = target ? target : closest(e.target, 'td.e-detailrowcollapse')\n            || closest(e.target, 'td.e-detailrowexpand');\n        target = closest(e.target, 'td.e-detailcell') ?\n            isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n        target = target && closest(target, 'table').classList.contains(literals.table) ? target : null;\n        if (!target) {\n            return false;\n        }\n        var _a = [target.parentElement.rowIndex, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var _b = this.matrix.current, oRowIndex = _b[0], oCellIndex = _b[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val) || (!force && oRowIndex === rowIndex && oCellIndex === cellIndex) ||\n            (!parentsUntil(e.target, literals.rowCell) && !parentsUntil(e.target, 'e-groupcaption'))) {\n            return false;\n        }\n        this.matrix.select(rowIndex, cellIndex);\n    };\n    ContentFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        this.matrix.current = [rowIndex, cellIndex];\n        info.element = !isNullOrUndefined(this.getTable().rows[rowIndex]) ? this.getTable().rows[rowIndex].cells[cellIndex] : null;\n        if (!info.element) {\n            return info;\n        }\n        info.elementToFocus = !info.element.classList.contains('e-unboundcell') && !info.element.classList.contains('e-detailcell')\n            ? this.getFocusable(info.element) : info.element;\n        info.outline = true;\n        info.uid = info.element.parentElement.getAttribute('data-uid');\n        return info;\n    };\n    ContentFocus.prototype.getFocusable = function (element) {\n        var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n        var isTemplate = !isNullOrUndefined(closest(element, '.e-templatecell'));\n        if (this.parent.isEdit) {\n            query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea';\n        }\n        var child = [].slice.call(element.querySelectorAll(query));\n        /* Select the first focusable child element\n         * if no child found then select the cell itself.\n         * if Grid is in editable state, check for editable control inside child.\n         */\n        return child.length ? isTemplate && child.length > 1 ? this.target : child[0] : element;\n    };\n    ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n        var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n        return ((row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate))\n            || (row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible))\n            || (!row.isDataRow && types.indexOf(cell.cellType) > -1)\n            || (cell.column && cell.visible && cell.column.type === 'checkbox')\n            || (cell.cellType === CellType.CommandColumn)\n            || (row.isDataRow && isRowTemplate))\n            && !(row.edit === 'delete' && row.isDirty);\n    };\n    ContentFocus.prototype.nextRowFocusValidate = function (index) {\n        var lastIndex = index;\n        for (var i = index, len = this.matrix.rows; i <= len; i++) {\n            if (this.matrix.matrix[index].indexOf(1) === -1) {\n                index = index + 1;\n            }\n            else {\n                return index;\n            }\n        }\n        this.lastIdxCell = true;\n        return lastIndex;\n    };\n    ContentFocus.prototype.previousRowFocusValidate = function (index) {\n        var firstIndex = index;\n        for (var i = index, len = 0; i >= len; i--) {\n            if (this.matrix.matrix[index].indexOf(1) === -1) {\n                index = index - 1;\n                if (index < 0) {\n                    this.lastIdxCell = true;\n                    return firstIndex;\n                }\n            }\n            else {\n                return index;\n            }\n        }\n        return firstIndex;\n    };\n    ContentFocus.prototype.jump = function (action, current) {\n        var frozenSwap = this.parent.getFrozenLeftCount() &&\n            ((action === 'leftArrow' || action === 'shiftTab') && current[1] === 0);\n        var right = ((action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns);\n        var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n        if (this.parent.getFrozenMode() === 'Right') {\n            frozenSwap = right;\n        }\n        this.lastIdxCell = false;\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        if (action === 'tab' && !this.parent.isEdit &&\n            current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n            this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n            this.matrix.current[1] = -1;\n            frozenSwap = this.parent.isFrozenGrid();\n        }\n        if (action === 'shiftTab' && !this.parent.isEdit &&\n            current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n            this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n            this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n        }\n        var isHeaderFocus = false;\n        var row = document.activeElement.parentElement;\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && row.classList.contains(literals.row)) {\n            var rowIndex = parseInt(row.getAttribute(literals.ariaRowIndex), 10);\n            isHeaderFocus = rowIndex > 0;\n        }\n        var info = {\n            swap: !isHeaderFocus ? ((action === 'upArrow' || enterFrozen) && current[0] === 0) || frozenSwap || frSwap : false,\n            toHeader: (action === 'upArrow' || enterFrozen) && current[0] === 0,\n            toFrozen: frozenSwap,\n            toFrozenRight: frSwap\n        };\n        return info;\n    };\n    ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current = [];\n        if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n            if (action === 'leftArrow' || action === 'shiftTab') {\n                current[0] = previous[0];\n                current[1] = active.matrix.columns + 1;\n            }\n            if (this.parent.getFrozenMode() === literals.leftRight && (action === 'rightArrow' || action === 'tab')) {\n                current[0] = previous[0];\n                current[1] = -1;\n            }\n        }\n        else if (action === 'rightArrow' || action === 'tab') {\n            current[0] = previous[0];\n            current[1] = -1;\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current[0] = -1;\n            current[1] = previous[1];\n        }\n        return current;\n    };\n    ContentFocus.prototype.generateRows = function (rows, optionals) {\n        var _a;\n        var matrix = optionals.matrix, handlerInstance = optionals.handlerInstance;\n        var len = handlerInstance.matrix.matrix.length;\n        var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n        handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n        handlerInstance.matrix.rows = defaultLen;\n        (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n        handlerInstance.matrix.rows += matrix.length;\n    };\n    ContentFocus.prototype.getInfo = function (e) {\n        var info = this.getFocusInfo();\n        var _a = this.matrix.current, rIndex = _a[0], cIndex = _a[1];\n        var isData = info.element.classList.contains(literals.rowCell);\n        var isSelectable = isData || (e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse')\n            || info.element.classList.contains('e-detailrowexpand')));\n        // eslint-disable-next-line max-len\n        var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(literals.ariaRowIndex), 10), rIndex),\n            Math.min(parseInt(info.element.getAttribute(literals.ariaColIndex), 10), cIndex)], rowIndex = _b[0], cellIndex = _b[1];\n        return { isContent: true, isDataCell: isData, indexes: [rowIndex, cellIndex], isSelectable: isSelectable };\n    };\n    ContentFocus.prototype.validator = function () {\n        var table = this.getTable();\n        return function (rowIndex, cellIndex, action) {\n            if (!isNullOrUndefined(table.rows[rowIndex])) {\n                var cell = void 0;\n                cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n                if (table.rows[rowIndex].cells[0].classList.contains('e-editcell')) {\n                    cell = table.rows[rowIndex].cells[0].querySelectorAll('td')[cellIndex];\n                }\n                else {\n                    cell = table.rows[rowIndex].cells[cellIndex];\n                }\n                var isCellWidth = cell.getBoundingClientRect().width !== 0;\n                if (action === 'enter' || action === 'shiftEnter') {\n                    return isCellWidth && cell.classList.contains(literals.rowCell);\n                }\n                if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(literals.rowCell)) {\n                    return isCellWidth;\n                }\n                else if (action !== 'shiftUp' && action !== 'shiftDown') {\n                    return isCellWidth;\n                }\n            }\n            return false;\n        };\n    };\n    ContentFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, _b = _a[0], rIndex = _b === void 0 ? -1 : _b, _c = _a[1], cIndex = _c === void 0 ? -1 : _c;\n        if (rIndex < 0 || cIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'shiftEnter' ?\n            cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-unboundcell')\n                && (!cell.classList.contains('e-templatecell') || cell.classList.contains('e-editedbatchcell'))\n                && !cell.classList.contains('e-detailcell') : true;\n    };\n    ContentFocus.prototype.getGridSeletion = function () {\n        return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n    };\n    return ContentFocus;\n}());\nexport { ContentFocus };\n/**\n * @hidden\n */\nvar HeaderFocus = /** @class */ (function (_super) {\n    __extends(HeaderFocus, _super);\n    function HeaderFocus(parent) {\n        return _super.call(this, parent) || this;\n    }\n    HeaderFocus.prototype.getTable = function () {\n        return (this.parent.isFrozenGrid() ?\n            this.parent.getHeaderContent().querySelector('.e-movableheader .e-table') :\n            this.parent.getHeaderTable());\n    };\n    HeaderFocus.prototype.onClick = function (e) {\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains('e-headercell') ? target : closest(target, 'th'));\n        if (!target && this.parent.frozenRows !== 0) {\n            target = (e.target.classList.contains(literals.rowCell) ? e.target :\n                closest(e.target, 'td'));\n        }\n        if (e.target.classList.contains('e-columnheader') ||\n            e.target.querySelector('.e-stackedheadercell')) {\n            return false;\n        }\n        if (!target) {\n            return;\n        }\n        var _a = [target.parentElement.rowIndex, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val)) {\n            return false;\n        }\n        this.matrix.select(target.parentElement.rowIndex, target.cellIndex);\n    };\n    HeaderFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        info.element = this.getTable().rows[rowIndex].cells[cellIndex];\n        if (!isNullOrUndefined(info.element)) {\n            info.elementToFocus = this.getFocusable(info.element);\n            info.outline = !info.element.classList.contains('e-filterbarcell');\n        }\n        return info;\n    };\n    HeaderFocus.prototype.selector = function (row, cell) {\n        return (cell.visible && (cell.column.field !== undefined || cell.isTemplate || !isNullOrUndefined(cell.column.template))) ||\n            cell.column.type === 'checkbox' || cell.cellType === CellType.StackedHeader;\n    };\n    HeaderFocus.prototype.jump = function (action, current) {\n        var frozenSwap = this.parent.getFrozenLeftCount() &&\n            (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion()) || action === 'shiftTab') && current[1] === 0;\n        var right = (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion())\n            || action === 'tab') && current[1] === this.matrix.columns;\n        var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n        if (this.parent.getFrozenMode() === 'Right') {\n            frozenSwap = right;\n        }\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var isLastCell;\n        var lastRow;\n        var headerSwap = frozenSwap || frSwap;\n        var fMatrix = this.parent.focusModule.fHeader && this.parent.focusModule.fHeader.matrix.matrix;\n        var isPresent = fMatrix && !isNullOrUndefined(fMatrix[current[0]]);\n        if (this.parent.enableHeaderFocus && action === 'tab') {\n            lastRow = this.matrix.matrix.length - 1 === current[0];\n            isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n            if (isLastCell) {\n                if (!lastRow) {\n                    this.matrix.current[0] = this.matrix.current[0] + 1;\n                }\n                else {\n                    this.matrix.current[0] = 0;\n                }\n                this.matrix.current[1] = -1;\n            }\n            if (this.parent.isFrozenGrid() && lastRow && isLastCell) {\n                frozenSwap = true;\n                headerSwap = false;\n            }\n        }\n        return {\n            swap: ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n                (isPresent && (frozenSwap || frSwap)) || (action === 'tab' && lastRow && isLastCell),\n            toHeader: headerSwap,\n            toFrozen: frozenSwap,\n            toFrozenRight: frSwap\n        };\n    };\n    HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current1 = [];\n        if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n            if (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion()) || action === 'shiftTab') {\n                current1[0] = previous[0];\n                current1[1] = active.matrix.columns + 1;\n            }\n            if (this.parent.getFrozenMode() === literals.leftRight\n                && (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab')) {\n                current1[0] = previous[0];\n                current1[1] = -1;\n            }\n        }\n        else if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n            current1[0] = previous[0];\n            current1[1] = -1;\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current1[0] = this.matrix.matrix.length;\n            current1[1] = previous[1];\n        }\n        return current1;\n    };\n    HeaderFocus.prototype.generateRows = function (rows) {\n        var length = this.matrix.matrix.length;\n        if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n            this.matrix.rows = ++this.matrix.rows;\n            var cells = rows[0].cells;\n            for (var i = 0; i < cells.length; i++) {\n                this.matrix.set(length, i, cells[i].visible && cells[i].column.allowFiltering !== false);\n            }\n        }\n    };\n    HeaderFocus.prototype.getInfo = function (e) {\n        return extend(_super.prototype.getInfo.call(this, e), { isContent: false, isHeader: true });\n    };\n    HeaderFocus.prototype.validator = function () {\n        return function () { return true; };\n    };\n    HeaderFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, rowIndex = _a[0], columnIndex = _a[1];\n        if (rowIndex < 0 || columnIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n    };\n    return HeaderFocus;\n}(ContentFocus));\nexport { HeaderFocus };\nvar FixedContentFocus = /** @class */ (function (_super) {\n    __extends(FixedContentFocus, _super);\n    function FixedContentFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedContentFocus.prototype.getTable = function () {\n        return this.parent.getContent().querySelector('.e-frozencontent .e-table');\n    };\n    FixedContentFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n        if (this.parent.getFrozenMode() === 'Right') {\n            var swap = toHeader || ((action === 'shiftTab' || action === 'leftArrow') && current[1] === 0);\n            return { swap: swap, toHeader: toHeader, toFrozen: toHeader };\n        }\n        return {\n            swap: toHeader || ((action === 'tab' || action === 'rightArrow') && current[1] === this.matrix.columns),\n            toHeader: toHeader,\n            toFrozen: toHeader\n        };\n    };\n    FixedContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current2 = [];\n        if (this.parent.getFrozenMode() === 'Right') {\n            if (action === 'rightArrow' || action === 'tab') {\n                current2[0] = previous[0];\n                current2[1] = -1;\n            }\n        }\n        else {\n            if (action === 'tab' && this.parent.enableHeaderFocus) {\n                current2[0] = previous[0];\n                current2[1] = -1;\n            }\n            if (action === 'leftArrow' || action === 'shiftTab') {\n                current2[0] = previous[0];\n                current2[1] = active.matrix.columns + 1;\n            }\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current2[0] = -1;\n            current2[1] = previous[1];\n        }\n        return current2;\n    };\n    return FixedContentFocus;\n}(ContentFocus));\nexport { FixedContentFocus };\nvar FixedHeaderFocus = /** @class */ (function (_super) {\n    __extends(FixedHeaderFocus, _super);\n    function FixedHeaderFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedHeaderFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var hMatrix = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n        var isPresent = hMatrix && !isNullOrUndefined(hMatrix[current[0]]);\n        if (this.parent.getFrozenMode() === 'Right') {\n            var frSwap = (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion())\n                || action === 'shiftTab') && current[1] === 0;\n            var swap = ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n                (isPresent && frSwap);\n            var toFrozen = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n            return { swap: swap, toHeader: frSwap, toFrozen: toFrozen };\n        }\n        return {\n            swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || ((action === 'rightArrow' ||\n                (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') &&\n                current[1] === this.matrix.columns && isPresent),\n            toHeader: (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') &&\n                current[1] === this.matrix.columns,\n            toFrozen: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1\n        };\n    };\n    FixedHeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderContent().querySelector('.e-frozenheader .e-table'));\n    };\n    FixedHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current3 = [];\n        if (this.parent.getFrozenMode() === 'Right') {\n            if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n                current3[0] = previous[0];\n                current3[1] = -1;\n            }\n        }\n        else {\n            if (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion()) || action === 'shiftTab') {\n                current3[0] = previous[0];\n                current3[1] = active.matrix.columns + 1;\n            }\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current3[0] = this.matrix.matrix.length;\n            current3[1] = previous[1];\n        }\n        return current3;\n    };\n    return FixedHeaderFocus;\n}(HeaderFocus));\nexport { FixedHeaderFocus };\n/** @hidden */\nvar SearchBox = /** @class */ (function () {\n    function SearchBox(searchBox) {\n        this.searchBox = searchBox;\n    }\n    SearchBox.prototype.searchFocus = function (args) {\n        args.target.parentElement.classList.add('e-input-focus');\n    };\n    SearchBox.prototype.searchBlur = function (args) {\n        args.target.parentElement.classList.remove('e-input-focus');\n    };\n    SearchBox.prototype.wireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n            EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n        }\n    };\n    SearchBox.prototype.unWireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n            EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n        }\n    };\n    return SearchBox;\n}());\nexport { SearchBox };\nvar FixedRightContentFocus = /** @class */ (function (_super) {\n    __extends(FixedRightContentFocus, _super);\n    function FixedRightContentFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedRightContentFocus.prototype.getTable = function () {\n        return this.parent.getContent().querySelector('.e-frozen-right-content .e-table');\n    };\n    FixedRightContentFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n        return {\n            swap: toHeader || ((action === 'shiftTab' || action === 'leftArrow') && current[1] === 0),\n            toHeader: toHeader,\n            toFrozenRight: toHeader\n        };\n    };\n    FixedRightContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current2 = [];\n        if (action === 'rightArrow' || action === 'tab') {\n            current2[0] = previous[0];\n            current2[1] = -1;\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current2[0] = -1;\n            current2[1] = previous[1];\n        }\n        return current2;\n    };\n    return FixedRightContentFocus;\n}(ContentFocus));\nexport { FixedRightContentFocus };\nvar FixedRightHeaderFocus = /** @class */ (function (_super) {\n    __extends(FixedRightHeaderFocus, _super);\n    function FixedRightHeaderFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedRightHeaderFocus.prototype.jump = function (action, current) {\n        var headerMat = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n        var isPresent = headerMat && !isNullOrUndefined(headerMat[current[0]]);\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var frozenSwap = (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion())\n            || action === 'shiftTab') && current[1] === 0;\n        var swap = ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n            (isPresent && frozenSwap);\n        var toFrozen = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n        return { swap: swap, toHeader: frozenSwap, toFrozenRight: toFrozen };\n    };\n    FixedRightHeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderContent().querySelector('.e-frozen-right-header .e-table'));\n    };\n    FixedRightHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current3 = [];\n        if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n            current3[0] = previous[0];\n            current3[1] = 0;\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current3[0] = this.matrix.matrix.length;\n            current3[1] = previous[1];\n        }\n        return current3;\n    };\n    return FixedRightHeaderFocus;\n}(HeaderFocus));\nexport { FixedRightHeaderFocus };\n"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;EACrD,IAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;IAChCF,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;MAAEC,SAAS,EAAE;IAAb,aAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;MAAED,CAAC,CAACI,SAAF,GAAcH,CAAd;IAAkB,CAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;MAAE,KAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;IAAc,CAF9E;;IAGA,OAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;EACH,CALD;;EAMA,OAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;IACnBF,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;IACA,SAASO,EAAT,GAAc;MAAE,KAAKC,WAAL,GAAmBT,CAAnB;IAAuB;;IACvCA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;EACH,CAJD;AAKH,CAZ2C,EAA5C;;AAaA,SAASI,YAAT,EAAuBC,QAAvB,EAAiCC,OAAjC,EAA0CC,iBAA1C,QAAmE,sBAAnE;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,MAAhC,EAAwCC,OAAxC,QAAuD,sBAAvD;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,OAAO,KAAKC,KAAZ,MAAuB,kBAAvB;AACA,SAASC,GAAT,QAAoB,eAApB;AACA,SAASC,iBAAT,QAAkC,uBAAlC;AACA,SAASC,YAAT,EAAuBC,sBAAvB,QAAqD,cAArD;AACA,OAAO,KAAKC,QAAZ,MAA0B,yBAA1B;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,aAAa;AAAG;AAAe,YAAY;EAC3C,SAASA,aAAT,CAAuBC,MAAvB,EAA+B;IAC3B,KAAKC,WAAL,GAAmB,EAAnB;IACA,KAAKC,OAAL,GAAe,IAAf;IACA,KAAKC,IAAL,GAAY,EAAZ;IACA;;IACA,KAAKC,gBAAL,GAAwB,KAAxB;IACA,KAAKC,MAAL,GAAc,KAAd;IACA,KAAKC,SAAL,GAAiB,IAAjB;IACA,KAAKC,YAAL,GAAoB,KAApB;IACA,KAAKC,WAAL,GAAmB,EAAnB;IACA,KAAKC,SAAL,GAAiB,KAAKC,aAAL,CAAmB,IAAnB,CAAjB;IACA,KAAKC,OAAL,GAAe,CAAC,WAAD,EAAc,SAAd,CAAf;IACA,KAAKC,eAAL,GAAuB,KAAvB;IACA,KAAKZ,MAAL,GAAcA,MAAd;IACA,KAAKa,WAAL,GAAmB,IAAIlB,iBAAJ,CAAsB,KAAKK,MAA3B,CAAnB;IACA,KAAKc,gBAAL;EACH;;EACDf,aAAa,CAACjB,SAAd,CAAwBiC,UAAxB,GAAqC,UAAUC,CAAV,EAAa;IAC9C,IAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;IACA,KAAKV,YAAL,GAAoB,IAApB;IACA,KAAKD,SAAL,GAAiBW,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0B,QAA1B,CAAjB;EACH,CAJD;;EAKApB,aAAa,CAACjB,SAAd,CAAwBsC,OAAxB,GAAkC,UAAUJ,CAAV,EAAa;IAC3C,IAAI,KAAKhB,MAAL,CAAYqB,WAAZ,IAA2B9B,OAAO,CAAC+B,QAAnC,IAA+C,KAAKtB,MAAL,CAAYuB,oBAA/D,EAAqF;MACjF;IACH;;IACD,KAAKC,SAAL,CAAe,CAAC,KAAKxB,MAAL,CAAYyB,iBAAb,IAAkC,KAAKzB,MAAL,CAAY0B,UAAZ,KAA2B,CAA5E,EAA+E,KAAK1B,MAAL,CAAY2B,YAAZ,EAA/E;;IACA,IAAI,CAAC,KAAK3B,MAAL,CAAYyB,iBAAb,IAAkC,CAAC,KAAKzB,MAAL,CAAY4B,qBAAZ,GAAoCC,MAAvE,KAAmF,KAAK7B,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAnC,IAC9E,KAAK/B,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAlC,IAA6C,CAAC,KAAK/B,MAAL,CAAYgC,UAAZ,CAAuBC,eAAvB,GAAyCnC,QAAQ,CAACoC,YAAlD,EAAgEL,MADlH,CAAJ,EACgI;MAC5H,KAAKM,UAAL,GAAkBC,MAAlB,CACIC,QADJ,CACa,KAAKxB,WAAL,CAAiByB,YAAjB,CAA8B;QAAEC,IAAI,EAAE,CAAC,IAAI7C,GAAJ,CAAQ;UAAE8C,SAAS,EAAE;QAAb,CAAR,CAAD;MAAR,CAA9B,CADb,EACsF,KAAKL,UAAL,GAAkBM,QADxG,EACkH,KADlH;IAEH;;IACD,IAAIC,OAAO,GAAG,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBO,GAAzB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC,CAAC,CAAD,EAAI,CAAJ,CAApC,EAA4C,IAA5C,EAAkD,KAAKR,UAAL,GAAkBS,SAAlB,EAAlD,CAAd;IACA,KAAKT,UAAL,GAAkBC,MAAlB,CAAyBS,MAAzB,CAAgCH,OAAO,CAAC,CAAD,CAAvC,EAA4CA,OAAO,CAAC,CAAD,CAAnD;;IACA,IAAI,KAAKpC,SAAT,EAAoB;MAChB,KAAKwC,KAAL,CAAW9B,CAAX;MACA,KAAKV,SAAL,GAAiB,KAAjB;IACH;EACJ,CAhBD;;EAiBAP,aAAa,CAACjB,SAAd,CAAwBiE,YAAxB,GAAuC,UAAU/B,CAAV,EAAa;IAChD,IAAI,KAAKhB,MAAL,CAAYqB,WAAhB,EAA6B;MACzB;IACH;;IACD,IAAIL,CAAC,CAACC,MAAF,IAAYD,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,cAA5B,CAAhB,EAA6D;MACzD,KAAKlB,WAAL,CAAiB+C,UAAjB,GAA8B,KAA9B;MACA5D,QAAQ,CAAC,CAAC,KAAKa,WAAL,CAAiBgD,OAAlB,CAAD,EAA6B,CAAC,WAAD,EAAc,SAAd,CAA7B,CAAR;IACH;EACJ,CARD;;EASAlD,aAAa,CAACjB,SAAd,CAAwBoE,MAAxB,GAAiC,UAAUlC,CAAV,EAAa;IAC1C,IAAI,CAAC,KAAKhB,MAAL,CAAYmD,MAAZ,IAAsBnC,CAAC,KAAK,CAACA,CAAC,CAACoC,aAAH,IAAoBlE,OAAO,CAAC8B,CAAC,CAACoC,aAAH,EAAkB,SAAlB,CAAhC,CAAxB,KACG,EAAEjE,iBAAiB,CAAC6B,CAAC,CAACoC,aAAH,CAAjB,IAAsCC,QAAQ,CAACrC,CAAC,CAACC,MAAF,CAASqC,YAAT,CAAsB,eAAtB,CAAD,EAAyC,EAAzC,CAAR,KAAyD,CAA/F,IACDD,QAAQ,CAACrC,CAAC,CAACC,MAAF,CAASqC,YAAT,CAAsB,OAAtB,CAAD,EAAiC,EAAjC,CAAR,KAAiD,CADlD,CADP,EAE6D;MACzD;IACH;;IACD,KAAKC,WAAL;IACA,KAAKjD,SAAL,GAAiB,IAAjB;IACA,KAAKL,WAAL,CAAiB+C,UAAjB,GAA8B,KAA9B;IACA,KAAKhD,MAAL,CAAYiD,OAAZ,CAAoBO,QAApB,GAA+B,CAA/B;EACH,CAVD;;EAWAzD,aAAa,CAACjB,SAAd,CAAwB2E,OAAxB,GAAkC,UAAUzC,CAAV,EAAa0C,KAAb,EAAoB;IAClD,IAAI9D,YAAY,CAACoB,CAAC,CAACC,MAAH,EAAW,iBAAX,CAAZ,KAA8CrB,YAAY,CAACoB,CAAC,CAACC,MAAH,EAAW,eAAX,CAAZ,IAC9CD,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,oBAA5B,CADA,CAAJ,EACwD;MACpD;IACH;;IACD,IAAIwC,SAAS,GAAG,CAACxE,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAAC8D,WAA1B,CAAR,CAAlC;IACA,IAAIC,QAAQ,GAAG,CAAC1E,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACgE,UAA1B,CAAR,CAAjC;IACAH,SAAS,GAAGA,SAAS,IAAIE,QAAb,GAAwB,CAACF,SAAzB,GAAqCA,SAAjD;IACA,IAAII,QAAQ,GAAG,CAAC5E,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACkE,aAA1B,CAAR,CAAlB,IACX,CAAC7E,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACmE,YAA1B,CAAR,CADtB;IAEA,IAAIC,aAAa,GAAG,KAApB;;IACA,IAAI,KAAKlE,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAA7C,EAAwD;MACpDF,aAAa,GAAG,CAAC/E,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,yBAAX,CAAR,CAAlB,IACZ,CAAC9B,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,wBAAX,CAAR,CADtB;MAEA8C,QAAQ,GAAGA,QAAQ,IAAI,CAACG,aAAxB;IACH;;IACD,IAAI,CAACP,SAAD,IAAcxE,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACgE,UAA1B,CAAR,CAA/B,IACA9C,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4BrB,QAAQ,CAACuE,OAArC,CADA,IAEA,CAAClF,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAR,CAFtB,EAE6D;MACzD;IACH;;IACD,KAAKO,SAAL,CAAemC,SAAf,EAA0BI,QAA1B,EAAoCG,aAApC;;IACA,IAAI,CAACP,SAAD,IAAcxE,iBAAiB,CAACD,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACgE,UAA1B,CAAR,CAAnC,EAAmF;MAC/E,KAAKQ,YAAL;MACA;IACH;;IACD,IAAIC,UAAU,GAAG;MAAEC,MAAM,EAAE,KAAV;MAAiBC,KAAK,EAAE,KAAxB;MAA+BC,OAAO,EAAE,CAACvF,iBAAiB,CAAC6B,CAAC,CAACC,MAAH,CAA1D;MAAsE0D,SAAS,EAAE3D;IAAjF,CAAjB;IACA,KAAKhB,MAAL,CAAY4E,MAAZ,CAAmBnF,KAAK,CAACoF,iBAAzB,EAA4CN,UAA5C;;IACA,IAAIA,UAAU,CAACC,MAAX,IAAqBtF,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAhC,EAA8D;MAC1D;IACH;;IACD,KAAKO,SAAL,CAAemC,SAAf,EAA0BI,QAA1B,EAAoCG,aAApC;;IACA,IAAI,KAAK/B,UAAL,EAAJ,EAAuB;MACnB,IAAI2C,SAAS,GAAG,KAAK3C,UAAL,GAAkBsB,OAAlB,CAA0BzC,CAA1B,EAA6B0C,KAA7B,CAAhB;;MACA,IAAIoB,SAAS,KAAK,KAAlB,EAAyB;QACrB;MACH;;MACD,KAAKhC,KAAL;IACH;EACJ,CAvCD;;EAwCA/C,aAAa,CAACjB,SAAd,CAAwBiG,UAAxB,GAAqC,UAAU/D,CAAV,EAAa;IAC9C,IAAI,KAAKgE,MAAL,CAAYhE,CAAZ,CAAJ,EAAoB;MAChB;IACH;;IACD,KAAKiE,SAAL,GAAiBjE,CAAC,CAACkE,MAAnB;IACA,IAAIX,UAAU,GAAG;MAAEC,MAAM,EAAE,KAAV;MAAiBC,KAAK,EAAE,IAAxB;MAA8BC,OAAO,EAAE,KAAvC;MAA8CS,OAAO,EAAEnE;IAAvD,CAAjB;IACA,KAAKhB,MAAL,CAAY4E,MAAZ,CAAmBnF,KAAK,CAACoF,iBAAzB,EAA4CN,UAA5C;;IACA,IAAIA,UAAU,CAACC,MAAf,EAAuB;MACnB;IACH;;IACD,IAAIY,MAAM,GAAG,KAAKjD,UAAL,GAAkBC,MAAlB,CAAyBM,OAAtC;IACA,KAAKzC,WAAL,CAAiBoF,OAAjB,GAA2B,IAA3B;IACA,IAAIC,QAAQ,GAAG,KAAKnD,UAAL,GAAkBoD,IAAlB,CAAuBvE,CAAC,CAACkE,MAAzB,EAAiCE,MAAjC,CAAf;IACA,KAAKjF,IAAL,GAAYmF,QAAZ;;IACA,IAAIA,QAAQ,CAACnF,IAAb,EAAmB;MACf,KAAKqB,SAAL,CAAe,CAAC8D,QAAQ,CAACE,QAAzB,EAAmCF,QAAQ,CAACG,QAA5C,EAAsDH,QAAQ,CAACI,aAA/D;MACA,KAAKvD,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmC,KAAKP,UAAL,GAAkBwD,cAAlB,CAAiCP,MAAjC,EAAyCE,QAAzC,EAAmD,KAAKM,MAAxD,EAAgE5E,CAAC,CAACkE,MAAlE,CAAnC;MACA,KAAK1E,WAAL,GAAmB,EAAnB;IACH;;IACD,KAAKqF,cAAL,CAAoB7E,CAAC,CAACkE,MAAtB,EAA8B,KAAK/C,UAAL,EAA9B;IACA,IAAI2C,SAAS,GAAG,KAAKT,OAAL,CAAayB,WAAb,GAA2B,KAA3B,GAAmC,KAAK3D,UAAL,GAAkB4C,UAAlB,CAA6B/D,CAA7B,CAAnD;;IACA,IAAI8D,SAAS,KAAK,KAAlB,EAAyB;MACrB,KAAKiB,cAAL;;MACA,IAAI/E,CAAC,CAACkE,MAAF,KAAa,UAAb,IAA2BE,MAAM,CAACY,QAAP,OAAsB,CAAC,CAAD,EAAI,CAAJ,EAAOA,QAAP,EAArD,EAAwE;QACpE,KAAKhG,MAAL,CAAYiD,OAAZ,CAAoBO,QAApB,GAA+B,CAAC,CAAhC;MACH;;MACD;IACH;;IACDxC,CAAC,CAACiF,cAAF;IACA,KAAKnD,KAAL,CAAW9B,CAAX;EACH,CA9BD;;EA+BAjB,aAAa,CAACjB,SAAd,CAAwBkG,MAAxB,GAAiC,UAAUhE,CAAV,EAAa;IAC1C,IAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;;IACA,IAAI,CAACA,MAAL,EAAa;MACT,OAAO,KAAP;IACH;;IACD,IAAI,KAAKhB,WAAL,CAAiB+C,UAArB,EAAiC;MAC7B,KAAK+C,cAAL;MACA,OAAO,IAAP;IACH;;IACD,IAAI,CAAC,QAAD,EAAW,UAAX,EAAuB,cAAvB,EAAuCG,OAAvC,CAA+ClF,CAAC,CAACkE,MAAjD,IAA2D,CAAC,CAAhE,EAAmE;MAC/D,KAAKa,cAAL;MACA,OAAO,IAAP;IACH;;IACD,IAAII,EAAE,GAAGjH,OAAO,CAAC+B,MAAD,EAAS,IAAT,CAAP,IAAyB,CAAC/B,OAAO,CAAC+B,MAAD,EAAS,IAAT,CAAP,CAAsBuC,QAAzD;;IACA,IAAIxC,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,qBAA5B,MAAuDH,CAAC,CAACoF,OAAF,KAAc,EAAd,IAAoBpF,CAAC,CAACoF,OAAF,KAAc,EAAzF,CAAJ,EAAkG;MAC9F,IAAIC,WAAW,GAAGnH,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,kBAAX,CAAzB;MACAoF,WAAW,CAACC,aAAZ,CAA0B,OAA1B,EAAmCxD,KAAnC;IACH;;IACD,IAAIqD,EAAE,IAAIjH,OAAO,CAACqH,QAAQ,CAACC,aAAV,EAAyB,kBAAzB,CAAP,KAAwD,IAAlE,EAAwE;MACpE,KAAKjD,WAAL;IACH;;IACD,IAAIkD,UAAU,GAAGvH,OAAO,CAACqH,QAAQ,CAACC,aAAV,EAAyB,kBAAzB,CAAP,KAAwD,IAAzE;;IACA,IAAI,KAAKxG,MAAL,CAAYyB,iBAAZ,IAAiCgF,UAArC,EAAiD;MAC7C,IAAIrE,MAAM,GAAG,KAAKwD,MAAL,CAAYxD,MAAzB;MACA,IAAIM,OAAO,GAAGN,MAAM,CAACM,OAArB;MACA+D,UAAU,GAAGrE,MAAM,CAACA,MAAP,CAAcM,OAAO,CAAC,CAAD,CAArB,EAA0BgE,WAA1B,CAAsC,CAAtC,MAA6ChE,OAAO,CAAC,CAAD,CAAjE;IACH;;IACD,OAAQ1B,CAAC,CAACkE,MAAF,KAAa,QAAb,IACA,KAAKlF,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAlC,KAA8C,KAAK/B,MAAL,CAAYmD,MAAZ,IAAsB,CAAC,QAAD,EAAW,IAAX,EAAiB+C,OAAjB,CAAyBlF,CAAC,CAACkE,MAA3B,IAAqC,CAAC,CAA1G,CADA,IAEAuB,UAAU,IACVvH,OAAO,CAACqH,QAAQ,CAACC,aAAV,EAAyB,MAAM,KAAKxG,MAAL,CAAYiD,OAAZ,CAAoB0D,EAA1B,GAA+B,YAAxD,CAAP,KAAiF,IAAjF,IACO,CAAC,OAAD,EAAU,WAAV,EAAuB,YAAvB,EACC,WADD,EACc,YADd,EAC4B,WAD5B,EACyCT,OADzC,CACiDlF,CAAC,CAACkE,MADnD,IAC6D,CAAC,CALrE,IAMAhG,OAAO,CAAC+B,MAAD,EAAS,MAAMnB,QAAQ,CAAC8D,WAAxB,CAAP,KAAgD,IAAhD,IAAwD1E,OAAO,CAAC+B,MAAD,EAAS,MAAMnB,QAAQ,CAACgE,UAAxB,CAAP,KAA+C,IANvG,IAOA9C,CAAC,CAACkE,MAAF,KAAa,OAAb,IAAyB,CAACjE,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BrB,QAAQ,CAAC8G,UAAnC,CAAD,IAAmD1H,OAAO,CAAC+B,MAAD,EAAS,MAAMnB,QAAQ,CAAC8G,UAAxB,CAAP,KAA+C,IAAlG,IACtB1H,OAAO,CAAC+B,MAAD,EAAS,qBAAT,CAAP,KAA2C,IAR/C,IAQ0D/B,OAAO,CAAC+B,MAAD,EAAS,iBAAT,CAAP,KAAuC,IARxG;EASH,CApCD;;EAqCAlB,aAAa,CAACjB,SAAd,CAAwB+H,mBAAxB,GAA8C,UAAU7F,CAAV,EAAa;IACvD,IAAI8F,KAAK,GAAG,IAAZ;;IACA,IAAI,KAAK9G,MAAL,CAAYuB,oBAAZ,IAAoC,KAAKvB,MAAL,CAAY+G,uBAApD,EAA6E;MACzE,IAAIC,IAAI,GAAG;QAAEC,WAAW,EAAE,EAAf;QAAmBC,KAAK,EAAE,KAA1B;QAAiCC,QAAQ,EAAE;MAA3C,CAAX;MACA,KAAKnH,MAAL,CAAY4E,MAAZ,CAAmBnF,KAAK,CAAC2H,cAAzB,EAAyCJ,IAAzC;MACA,IAAIK,UAAU,GAAG,KAAK1G,OAAL,CAAa2G,IAAb,CAAkB,UAAUC,KAAV,EAAiB;QAAE,OAAOA,KAAK,KAAKT,KAAK,CAAC7B,SAAvB;MAAmC,CAAxE,CAAjB;MACA,IAAIuC,UAAU,GAAG,KAAKxH,MAAL,CAAYyH,aAAZ,GACb,KAAKzH,MAAL,CAAYyH,aAAZ,CAA0BC,gBAA1B,GAA6C,CAAC,CADjC,GACqC,KADtD;;MAEA,IAAIV,IAAI,CAACE,KAAL,IAAc5I,MAAM,CAACqJ,IAAP,CAAYX,IAAI,CAACC,WAAjB,EAA8BpF,MAA5C,IAAsDwF,UAAtD,IAAoEL,IAAI,CAACG,QAAzE,IAAqFK,UAAzF,EAAqG;QACjG,KAAKxH,MAAL,CAAY4E,MAAZ,CAAmBnF,KAAK,CAACmI,iBAAzB,EAA4C;UAAET,QAAQ,EAAE;QAAZ,CAA5C;QACAH,IAAI,CAACG,QAAL,GAAgB,KAAhB;QACA,KAAKnH,MAAL,CAAYyH,aAAZ,CAA0BC,gBAA1B,GAA6C,CAAC,CAA9C;;QACA,IAAIL,UAAJ,EAAgB;UACZ,KAAKpC,SAAL,GAAiB,KAAK4C,KAAtB;UACA,KAAK7H,MAAL,CAAY4E,MAAZ,CAAmB,qBAAnB,EAA0C5D,CAA1C;QACH,CAPgG,CAQjG;;;QACA,KAAKf,WAAL,CAAiB6H,cAAjB,CAAgChF,KAAhC,CAAsC;UAAEiF,aAAa,EAAE;QAAjB,CAAtC;MACH,CAVD,MAWK;QACD,IAAI,KAAKnH,eAAL,IAAwB,KAAKR,gBAAjC,EAAmD;UAC/C;UACA,KAAKH,WAAL,CAAiB6H,cAAjB,CAAgChF,KAAhC,CAAsC;YAAEiF,aAAa,EAAE;UAAjB,CAAtC;QACH,CAHD,MAIK;UACD,KAAK9H,WAAL,CAAiB6H,cAAjB,CAAgChF,KAAhC;QACH;MACJ;IACJ;;IACD,KAAKlC,eAAL,GAAuB,KAAKR,gBAAL,GAAwB,KAA/C;EACH,CA9BD;;EA+BAL,aAAa,CAACjB,SAAd,CAAwBkJ,iBAAxB,GAA4C,YAAY;IACpD,OAAO,KAAK/H,WAAL,CAAiB6H,cAAxB;EACH,CAFD;;EAGA/H,aAAa,CAACjB,SAAd,CAAwBqD,UAAxB,GAAqC,YAAY;IAC7C,OAAO,KAAKyD,MAAL,IAAe,KAAKvB,OAA3B;EACH,CAFD;;EAGAtE,aAAa,CAACjB,SAAd,CAAwB0C,SAAxB,GAAoC,UAAU6C,OAAV,EAAmBN,QAAnB,EAA6BG,aAA7B,EAA4C;IAC5E,KAAK0B,MAAL,GAAcvB,OAAO,GAAGN,QAAQ,GAAG,KAAKkE,QAAR,GAAmB/D,aAAa,GAAG,KAAKgE,SAAR,GAAoB,KAAK7D,OAApE,GACjBN,QAAQ,GAAG,KAAKoE,OAAR,GAAkBjE,aAAa,GAAG,KAAKkE,QAAR,GAAmB,KAAKC,MADnE;EAEH,CAHD;;EAIAtI,aAAa,CAACjB,SAAd,CAAwBwJ,iBAAxB,GAA4C,UAAUrF,OAAV,EAAmBjC,CAAnB,EAAsB;IAC9D,IAAI8F,KAAK,GAAG,IAAZ;;IACA,KAAK7G,WAAL,CAAiB6H,cAAjB,GAAkC7E,OAAlC;IACAsF,UAAU,CAAC,YAAY;MACnB,IAAI,CAACpJ,iBAAiB,CAAC2H,KAAK,CAAC7G,WAAN,CAAkB6H,cAAnB,CAAtB,EAA0D;QACtD,IAAIhB,KAAK,CAAC9G,MAAN,CAAauB,oBAAb,IAAqCuF,KAAK,CAAC9G,MAAN,CAAa+G,uBAAtD,EAA+E;UAC3ED,KAAK,CAACD,mBAAN,CAA0B7F,CAA1B;QACH,CAFD,MAGK;UACD8F,KAAK,CAAC7G,WAAN,CAAkB6H,cAAlB,CAAiChF,KAAjC;QACH;MACJ;IACJ,CATS,EASP,CATO,CAAV;EAUH,CAbD;;EAcA/C,aAAa,CAACjB,SAAd,CAAwBgE,KAAxB,GAAgC,UAAU9B,CAAV,EAAa;IACzC,KAAKhB,MAAL,CAAY4E,MAAZ,CAAmBnF,KAAK,CAAC+I,gBAAzB,EAA2CxH,CAA3C;IACA,KAAKuC,WAAL;IACA,KAAKkF,QAAL,CAAc,KAAKtG,UAAL,GAAkBuG,YAAlB,EAAd,EAAgD1H,CAAhD;EACH,CAJD,CA/N2C,CAoO3C;;;EACAjB,aAAa,CAACjB,SAAd,CAAwByE,WAAxB,GAAsC,UAAUvC,CAAV,EAAa;IAC/C,IAAI,CAAC,KAAKf,WAAL,CAAiBgD,OAAtB,EAA+B;MAC3B;IACH;;IACD5D,WAAW,CAAC,CAAC,KAAKY,WAAL,CAAiBgD,OAAlB,EAA2B,KAAKhD,WAAL,CAAiB6H,cAA5C,CAAD,EAA8D,CAAC,WAAD,EAAc,SAAd,CAA9D,CAAX;IACA,KAAK7H,WAAL,CAAiBgD,OAAjB,CAAyBO,QAAzB,GAAoC,CAAC,CAArC;EACH,CAND;EAOA;AACJ;AACA;;;EACIzD,aAAa,CAACjB,SAAd,CAAwB6J,UAAxB,GAAqC,YAAY;IAC7C,IAAIC,IAAI,GAAG,KAAKzG,UAAL,GAAkBuG,YAAlB,EAAX;;IACA,IAAIE,IAAI,CAAC3F,OAAT,EAAkB;MACd7D,QAAQ,CAAC,CAACwJ,IAAI,CAAC3F,OAAN,CAAD,EAAiB,CAAC,WAAD,CAAjB,CAAR;MACA7D,QAAQ,CAAC,CAACwJ,IAAI,CAACd,cAAN,CAAD,EAAwB,CAAC,SAAD,CAAxB,CAAR;IACH;EACJ,CAND;EAOA;AACJ;AACA;;;EACI/H,aAAa,CAACjB,SAAd,CAAwB+J,WAAxB,GAAsC,YAAY;IAC9C,KAAKrH,SAAL,CAAe,KAAf,EAAsB,KAAKxB,MAAL,CAAY2B,YAAZ,EAAtB;IACA,KAAKmH,UAAL;EACH,CAHD;EAIA;AACJ;AACA;;;EACI/I,aAAa,CAACjB,SAAd,CAAwBiK,YAAxB,GAAuC,YAAY;IAC/C,KAAKvH,SAAL,CAAe,IAAf,EAAqB,KAAKxB,MAAL,CAAY2B,YAAZ,EAArB;IACA,KAAKmH,UAAL;EACH,CAHD;;EAIA/I,aAAa,CAACjB,SAAd,CAAwBgK,UAAxB,GAAqC,YAAY;IAC7C,IAAIpG,OAAO,GAAG,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBO,GAAzB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC,CAAC,CAAD,EAAI,CAAJ,CAApC,EAA4C,IAA5C,EAAkD,KAAKR,UAAL,GAAkBS,SAAlB,EAAlD,CAAd;IACA,KAAKT,UAAL,GAAkBC,MAAlB,CAAyBS,MAAzB,CAAgCH,OAAO,CAAC,CAAD,CAAvC,EAA4CA,OAAO,CAAC,CAAD,CAAnD;IACA,KAAKI,KAAL;EACH,CAJD;;EAKA/C,aAAa,CAACjB,SAAd,CAAwB2J,QAAxB,GAAmC,UAAUG,IAAV,EAAgB5H,CAAhB,EAAmB;IAClD,KAAKf,WAAL,GAAmB2I,IAAnB;IACA,KAAK3I,WAAL,CAAiBoF,OAAjB,GAA2BuD,IAAI,CAACvD,OAAL,IAAgB,CAAClG,iBAAiB,CAAC6B,CAAD,CAA7D;;IACA,IAAI,KAAKZ,gBAAT,EAA2B;MACvB,KAAKH,WAAL,CAAiBoF,OAAjB,GAA2B,IAA3B;IACH;;IACD,IAAI,CAACuD,IAAI,CAAC3F,OAAV,EAAmB;MACf;IACH;;IACD,IAAI+F,SAAS,GAAGJ,IAAI,CAACd,cAAL,CAAoB5G,SAApB,CAA8BC,QAA9B,CAAuC,SAAvC,CAAhB;;IACA,IAAI6H,SAAJ,EAAe;MACX;IACH;;IACD,IAAI,KAAK/I,WAAL,CAAiBoF,OAArB,EAA8B;MAC1BjG,QAAQ,CAAC,CAACwJ,IAAI,CAAC3F,OAAN,CAAD,EAAiB,CAAC,WAAD,CAAjB,CAAR;IACH;;IACD7D,QAAQ,CAAC,CAACwJ,IAAI,CAACd,cAAN,CAAD,EAAwB,CAAC,SAAD,CAAxB,CAAR;IACAc,IAAI,CAAC3F,OAAL,CAAaO,QAAb,GAAwB,CAAxB;;IACA,IAAI,CAACwF,SAAL,EAAgB;MACZ,KAAKV,iBAAL,CAAuBM,IAAI,CAACd,cAA5B,EAA4C9G,CAA5C;IACH;;IACD,KAAKhB,MAAL,CAAY4E,MAAZ,CAAmBnF,KAAK,CAACwJ,WAAzB,EAAsC;MAClChG,OAAO,EAAE2F,IAAI,CAACd,cADoB;MAElC9H,MAAM,EAAE4I,IAAI,CAAC3F,OAFqB;MAGlCiG,OAAO,EAAE,KAAK/G,UAAL,GAAkBC,MAAlB,CAAyBM,OAHA;MAIlC+B,KAAK,EAAE,CAACtF,iBAAiB,CAAC6B,CAAD,CAJS;MAKlC0D,OAAO,EAAEvF,iBAAiB,CAAC6B,CAAD,CALQ;MAMlCmE,OAAO,EAAEnE,CANyB;MAOlCmI,MAAM,EAAE,KAAKhJ,IAAL,CAAUA,IAPgB;MAQlCiJ,SAAS,EAAE,KAAKjH,UAAL,GAAkBkH,OAAlB,CAA0BrI,CAA1B,CARuB;MASlCqE,OAAO,EAAE,CAAClG,iBAAiB,CAAC6B,CAAD,CATO;MAUlCsE,QAAQ,EAAE,KAAKnF;IAVmB,CAAtC;IAYA,IAAImJ,EAAE,GAAG,KAAKnH,UAAL,GAAkBC,MAAlB,CAAyBM,OAAlC;IAAA,IAA2C6G,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAAxD;IAAA,IAA6DE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA3E;IACA,KAAK9I,WAAL,GAAmB;MAAE+I,QAAQ,EAAEA,QAAZ;MAAsBC,SAAS,EAAEA;IAAjC,CAAnB;IACA,KAAKC,gBAAL,GAAwB,KAAKzJ,MAAL,CAAY0J,gBAAZ,CAA6BF,SAA7B,EAAwCG,GAAhE;IACA,KAAKpJ,YAAL,GAAoB,KAApB;EACH,CArCD;;EAsCAR,aAAa,CAACjB,SAAd,CAAwB4B,aAAxB,GAAwC,UAAU2D,OAAV,EAAmB;IACvD,IAAIyC,KAAK,GAAG,IAAZ;;IACA,OAAO,UAAU9F,CAAV,EAAa;MAChB,IAAIqD,OAAO,IAAKrD,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAO7F,QAA7B,IAA0C,CAAC+C,KAAK,CAACmB,QAArD,EAA+D;QAC3DnB,KAAK,CAACmB,QAAN,GAAiB,IAAI4B,iBAAJ,CAAsB/C,KAAK,CAAC9G,MAA5B,CAAjB;MACH,CAFD,MAGK,IAAIqE,OAAO,IAAI,CAACyC,KAAK,CAACoB,SAAlB,IAAgClH,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAOE,wBAArD,EAAgF;QACjFhD,KAAK,CAACoB,SAAN,GAAkB,IAAI6B,sBAAJ,CAA2BjD,KAAK,CAAC9G,MAAjC,CAAlB;MACH,CAFI,MAGA,IAAIqE,OAAO,IAAI,CAACyC,KAAK,CAACzC,OAAtB,EAA+B;QAChCyC,KAAK,CAACzC,OAAN,GAAgB,IAAI2F,YAAJ,CAAiBlD,KAAK,CAAC9G,MAAvB,CAAhB;MACH;;MACD,IAAI,CAACqE,OAAD,IAAarD,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAO7F,QAA9B,IAA2C,CAAC+C,KAAK,CAACqB,OAAtD,EAA+D;QAC3DrB,KAAK,CAACqB,OAAN,GAAgB,IAAI8B,gBAAJ,CAAqBnD,KAAK,CAAC9G,MAA3B,CAAhB;MACH,CAFD,MAGK,IAAI,CAACqE,OAAD,IAAarD,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAOE,wBAA9B,IAA2D,CAAChD,KAAK,CAACsB,QAAtE,EAAgF;QACjFtB,KAAK,CAACsB,QAAN,GAAiB,IAAI8B,qBAAJ,CAA0BpD,KAAK,CAAC9G,MAAhC,CAAjB;MACH,CAFI,MAGA,IAAI,CAACqE,OAAD,IAAY,CAACyC,KAAK,CAACuB,MAAvB,EAA+B;QAChCvB,KAAK,CAACuB,MAAN,GAAe,IAAI8B,WAAJ,CAAgBrD,KAAK,CAAC9G,MAAtB,CAAf;MACH;;MACD,IAAIoK,MAAM,GAAG/F,OAAO,GAAIrD,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAO7F,QAAlB,GAA8B+C,KAAK,CAACmB,QAApC,GAAgDjH,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAOE,wBAAlB,GAChEhD,KAAK,CAACoB,SAD0D,GAC9CpB,KAAK,CAACzC,OADV,GACqBrD,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAO7F,QAAlB,GAA8B+C,KAAK,CAACqB,OAApC,GAA+CnH,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAOE,wBAAlB,GAChFhD,KAAK,CAACsB,QAD0E,GAC/DtB,KAAK,CAACuB,MAF7B;MAGA,IAAI9F,IAAI,GAAG8B,OAAO,GAAGrD,CAAC,CAACuB,IAAF,CAAO8H,KAAP,CAAavD,KAAK,CAAC9G,MAAN,CAAa0B,UAA1B,CAAH,GAA2CV,CAAC,CAACuB,IAA/D;MACA,IAAI+H,SAAS,GAAGjG,OAAO,GAAGrD,CAAC,CAACuB,IAAF,CAAO8H,KAAP,CAAa,CAAb,EAAgBvD,KAAK,CAAC9G,MAAN,CAAa0B,UAA7B,CAAH,GAA8CV,CAAC,CAACuB,IAAvE;;MACA,IAAIuE,KAAK,CAAC9G,MAAN,CAAauK,sBAAb,MAAyClG,OAA7C,EAAsD;QAClD9B,IAAI,GAAGA,IAAI,CAACiI,MAAL,CAAY,UAAUC,CAAV,EAAa;UAAE,OAAOA,CAAC,CAACC,OAAF,KAAc,KAArB;QAA6B,CAAxD,CAAP;MACH;;MACD,IAAIC,aAAa,GAAG,CAACxL,iBAAiB,CAAC2H,KAAK,CAAC9G,MAAN,CAAa4K,WAAd,CAAtC;MACA,IAAIxI,MAAM,GAAGgI,MAAM,CAAChI,MAAP,CAAcC,QAAd,CAAuBiI,SAAvB,EAAkCF,MAAM,CAAC3H,QAAzC,EAAmDkI,aAAnD,CAAb;;MACA,IAAI3J,CAAC,CAAC6J,IAAF,KAAW,UAAX,IAAyB/D,KAAK,CAAC9G,MAAN,CAAa2B,YAAb,EAA7B,EAA0D;QACtD,IAAImJ,KAAK,GAAGhE,KAAK,CAAC9G,MAAN,CAAa+K,oBAAb,EAAZ;;QACA,IAAIC,cAAc,GAAGF,KAAK,CAACG,GAAN,CAAU,UAAUC,GAAV,EAAe;UAAE,OAAOA,GAAG,CAACC,KAAJ,EAAP;QAAqB,CAAhD,CAArB;QACA,IAAIC,aAAa,GAAG7I,IAAI,CAAC0I,GAAL,CAAS,UAAUC,GAAV,EAAe;UAAE,OAAOA,GAAG,CAACC,KAAJ,EAAP;QAAqB,CAA/C,CAApB;;QACArE,KAAK,CAACmB,QAAN,CAAe7F,MAAf,CAAsBC,QAAtB,CAA+B+I,aAA/B,EAA8CtE,KAAK,CAACmB,QAAN,CAAexF,QAA7D,EAAuEkI,aAAvE;;QACA7D,KAAK,CAACzC,OAAN,CAAcjC,MAAd,CAAqBC,QAArB,CAA8B2I,cAA9B,EAA8ClE,KAAK,CAACzC,OAAN,CAAc5B,QAA5D,EAAsEkI,aAAtE;;QACA,IAAI7D,KAAK,CAAC9G,MAAN,CAAamE,aAAb,OAAiCrE,QAAQ,CAACsE,SAA9C,EAAyD;UACrD,IAAIiH,MAAM,GAAGvE,KAAK,CAAC9G,MAAN,CAAasL,wBAAb,EAAb;;UACA,IAAIC,SAAS,GAAGF,MAAM,CAACJ,GAAP,CAAW,UAAUC,GAAV,EAAe;YAAE,OAAOA,GAAG,CAACC,KAAJ,EAAP;UAAqB,CAAjD,CAAhB;;UACArE,KAAK,CAACoB,SAAN,CAAgB9F,MAAhB,CAAuBC,QAAvB,CAAgCkJ,SAAhC,EAA2CzE,KAAK,CAACoB,SAAN,CAAgBzF,QAA3D,EAAqEkI,aAArE;QACH;MACJ,CAXD,MAYK;QACDP,MAAM,CAAChI,MAAP,CAAcC,QAAd,CAAuBE,IAAvB,EAA6B6H,MAAM,CAAC3H,QAApC,EAA8CkI,aAA9C;MACH;;MACDP,MAAM,CAAC9H,YAAP,CAAoBgI,SAApB,EAA+B;QAC3BlI,MAAM,EAAEA,MADmB;QACXoJ,eAAe,EAAGxK,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAO7F,QAAlB,GAA8B+C,KAAK,CAACqB,OAApC,GAC1BnH,CAAC,CAAC4I,IAAF,IAAU5I,CAAC,CAAC4I,IAAF,CAAOE,wBAAlB,GAA8ChD,KAAK,CAACsB,QAApD,GAA+DtB,KAAK,CAACuB;MAFhD,CAA/B;;MAIA,IAAI,CAAC9I,OAAO,CAAC+B,QAAT,IAAqBN,CAArB,IAA0BA,CAAC,CAAC4I,IAAhC,EAAsC;QAClC,IAAI,CAAC9C,KAAK,CAACvG,YAAP,IAAuBS,CAAC,CAAC4I,IAAF,CAAO6B,WAAP,KAAuB,QAAlD,EAA4D;UACxD3E,KAAK,CAACxG,SAAN,GAAkB,KAAlB;;UACAwG,KAAK,CAAC9G,MAAN,CAAaiD,OAAb,CAAqBH,KAArB;QACH;;QACD,IAAI9B,CAAC,CAAC4I,IAAF,CAAO6B,WAAP,KAAuB,UAA3B,EAAuC;UACnC3E,KAAK,CAACxG,SAAN,GAAkB,IAAlB;QACH;MACJ;;MACD,IAAIU,CAAC,IAAIA,CAAC,CAAC4I,IAAP,IAAe5I,CAAC,CAAC4I,IAAF,CAAO6B,WAAP,KAAuB,eAA1C,EAA2D;QACvD,IAAI3E,KAAK,CAAC7G,WAAN,CAAkB0J,GAAtB,EAA2B;UACvB,IAAI+B,OAAJ;UACA,IAAIC,IAAI,GAAG3K,CAAC,CAACuB,IAAF,CAAO+E,IAAP,CAAY,UAAU4D,GAAV,EAAeU,CAAf,EAAkB;YACrCF,OAAO,GAAGE,CAAV;YACA,OAAOV,GAAG,CAACvB,GAAJ,KAAY7C,KAAK,CAAC7G,WAAN,CAAkB0J,GAArC;UACH,CAHU,CAAX;;UAIA,IAAIgC,IAAJ,EAAU;YACN7E,KAAK,CAACzC,OAAN,CAAcjC,MAAd,CAAqBM,OAArB,CAA6B,CAA7B,IAAkCgJ,OAAlC;YACA5E,KAAK,CAACzC,OAAN,CAAcjC,MAAd,CAAqBM,OAArB,CAA6B,CAA7B,IAAkCoE,KAAK,CAAC9G,MAAN,CAAa6L,mBAAb,CAAiC/E,KAAK,CAAC2C,gBAAvC,KAA4D,CAA9F;;YACA,IAAIqC,YAAY,GAAGhF,KAAK,CAAC3E,UAAN,GAAmBuG,YAAnB,GAAkCZ,cAArD;;YACA,IAAIgE,YAAJ,EAAkB;cACd,IAAIC,YAAY,GAAGD,YAAY,CAACE,qBAAb,EAAnB;;cACA,IAAIC,YAAY,GAAGnF,KAAK,CAAC9G,MAAN,CAAaiD,OAAb,CAAqB+I,qBAArB,EAAnB;;cACA,IAAID,YAAY,CAACG,GAAb,IAAoB,CAApB,IAAyBH,YAAY,CAACI,IAAb,IAAqB,CAA9C,IACAJ,YAAY,CAACK,KAAb,IAAsBC,IAAI,CAACC,GAAL,CAASL,YAAY,CAACG,KAAtB,EAA6BG,MAAM,CAACC,UAAP,IAC/CjG,QAAQ,CAACkG,eAAT,CAAyBC,WADP,CADtB,IAGAX,YAAY,CAACY,MAAb,IAAuBN,IAAI,CAACC,GAAL,CAASL,YAAY,CAACU,MAAtB,EAA8BJ,MAAM,CAACK,WAAP,IACjDrG,QAAQ,CAACkG,eAAT,CAAyBI,YADN,CAH3B,EAIgD;gBAC5C/F,KAAK,CAAClG,eAAN,GAAwB,IAAxB;;gBACAkG,KAAK,CAAChE,KAAN;cACH;YACJ;UACJ;QACJ,CAvBD,MAwBK,IAAI9B,CAAC,CAAC4I,IAAF,CAAOkC,YAAP,IAAuB9K,CAAC,CAAC4I,IAAF,CAAOkC,YAAP,CAAoB5K,SAApB,CAA8BC,QAA9B,CAAuC,cAAvC,CAA3B,EAAmF;UACpF,IAAI2K,YAAY,GAAGhF,KAAK,CAAC9G,MAAN,CAAaiD,OAAb,CAAqBqD,aAArB,CAAmC,MAAMtF,CAAC,CAAC4I,IAAF,CAAOkC,YAAP,CAAoBnF,EAA7D,CAAnB;;UACA,IAAImF,YAAJ,EAAkB;YACdA,YAAY,CAAChJ,KAAb;UACH;QACJ;MACJ;IACJ,CAzFD;EA0FH,CA5FD;;EA6FA/C,aAAa,CAACjB,SAAd,CAAwBgC,gBAAxB,GAA2C,YAAY;IACnD,IAAIgG,KAAK,GAAG,IAAZ;;IACA,IAAI,KAAK9G,MAAL,CAAYqB,WAAhB,EAA6B;MACzB;IACH;;IACDrC,YAAY,CAAC8N,GAAb,CAAiB,KAAK9M,MAAL,CAAYiD,OAA7B,EAAsC,WAAtC,EAAmD,KAAKlC,UAAxD,EAAoE,IAApE;IACA/B,YAAY,CAAC8N,GAAb,CAAiB,KAAK9M,MAAL,CAAYiD,OAA7B,EAAsC,OAAtC,EAA+C,KAAK7B,OAApD,EAA6D,IAA7D;IACA,KAAKpB,MAAL,CAAYiD,OAAZ,CAAoBnC,gBAApB,CAAqC,OAArC,EAA8C,KAAKiM,cAAL,GAAsB,UAAU/L,CAAV,EAAa;MAAE,OAAO8F,KAAK,CAAC/D,YAAN,CAAmB/B,CAAnB,CAAP;IAA+B,CAAlH,EAAoH,IAApH;IACAhC,YAAY,CAAC8N,GAAb,CAAiB,KAAK9M,MAAL,CAAYiD,OAA7B,EAAsC,UAAtC,EAAkD,KAAKC,MAAvD,EAA+D,IAA/D;IACA,KAAK8J,WAAL,GAAmB,CAAC;MAAEvN,KAAK,EAAEA,KAAK,CAACwN,UAAf;MAA2BC,OAAO,EAAE,KAAKnI;IAAzC,CAAD,EACf;MAAEtF,KAAK,EAAEA,KAAK,CAAC0N,KAAf;MAAsBD,OAAO,EAAE,KAAKzJ;IAApC,CADe,EAEf;MAAEhE,KAAK,EAAEA,KAAK,CAAC2N,YAAf;MAA6BF,OAAO,EAAE,KAAKzM;IAA3C,CAFe,EAGf;MAAEhB,KAAK,EAAEA,KAAK,CAAC4N,cAAf;MAA+BH,OAAO,EAAE,KAAKzM;IAA7C,CAHe,EAIf;MAAEhB,KAAK,EAAEA,KAAK,CAAC6N,wBAAf;MAAyCJ,OAAO,EAAE,KAAKzM;IAAvD,CAJe,EAKf;MAAEhB,KAAK,EAAEA,KAAK,CAAC8N,eAAf;MAAgCL,OAAO,EAAE,KAAKxM,aAAL;IAAzC,CALe,EAMf;MAAEjB,KAAK,EAAEA,KAAK,CAAC+N,SAAf;MAA0BN,OAAO,EAAE,KAAKO;IAAxC,CANe,EAOf;MAAEhO,KAAK,EAAEA,KAAK,CAACgO,YAAf;MAA6BP,OAAO,EAAE,KAAKO;IAA3C,CAPe,EAQf;MAAEhO,KAAK,EAAE,YAAT;MAAuByN,OAAO,EAAE,KAAKnH;IAArC,CARe,EASf;MAAEtG,KAAK,EAAE,WAAT;MAAsByN,OAAO,EAAE,KAAKnH;IAApC,CATe,EAUf;MAAEtG,KAAK,EAAE,kBAAT;MAA6ByN,OAAO,EAAE,KAAKO;IAA3C,CAVe,EAWf;MAAEhO,KAAK,EAAE,oBAAT;MAA+ByN,OAAO,EAAE,KAAKQ;IAA7C,CAXe,EAYf;MAAEjO,KAAK,EAAE,mBAAT;MAA8ByN,OAAO,EAAE,KAAKS;IAA5C,CAZe,EAaf;MAAElO,KAAK,EAAE,qBAAT;MAAgCyN,OAAO,EAAE,KAAKS;IAA9C,CAbe,EAcf;MAAElO,KAAK,EAAEA,KAAK,CAACmO,QAAf;MAAyBV,OAAO,EAAE,KAAKzM;IAAvC,CAde,EAef;MAAEhB,KAAK,EAAEA,KAAK,CAACoO,WAAf;MAA4BX,OAAO,EAAE,KAAKzM;IAA1C,CAfe,EAgBf;MAAEhB,KAAK,EAAEA,KAAK,CAACqO,WAAf;MAA4BZ,OAAO,EAAE,KAAKzM;IAA1C,CAhBe,EAiBf;MAAEhB,KAAK,EAAEA,KAAK,CAACsO,eAAf;MAAgCb,OAAO,EAAE,KAAKzM;IAA9C,CAjBe,EAkBf;MAAEhB,KAAK,EAAEA,KAAK,CAACuO,OAAf;MAAwBd,OAAO,EAAE,KAAKzM;IAAtC,CAlBe,EAmBf;MAAEhB,KAAK,EAAEA,KAAK,CAACwJ,WAAf;MAA4BiE,OAAO,EAAE,KAAKe;IAA1C,CAnBe,CAAnB;IAoBApO,sBAAsB,CAAC,KAAKG,MAAN,EAAc,KAAKgN,WAAnB,EAAgC,IAAhC,EAAsC,IAAtC,CAAtB;EACH,CA9BD;;EA+BAjN,aAAa,CAACjB,SAAd,CAAwB4O,WAAxB,GAAsC,YAAY;IAC9C,IAAI,KAAK1N,MAAL,CAAYkO,cAAZ,CAA2BC,IAA3B,KAAoC,WAAxC,EAAqD;MACjD,KAAKV,YAAL;IACH;EACJ,CAJD;;EAKA1N,aAAa,CAACjB,SAAd,CAAwBsP,mBAAxB,GAA8C,YAAY;IACtD,IAAI,KAAKpO,MAAL,CAAYqB,WAAhB,EAA6B;MACzB;IACH;;IACDrC,YAAY,CAACqP,MAAb,CAAoB,KAAKrO,MAAL,CAAYiD,OAAhC,EAAyC,WAAzC,EAAsD,KAAKlC,UAA3D;IACA/B,YAAY,CAACqP,MAAb,CAAoB,KAAKrO,MAAL,CAAYiD,OAAhC,EAAyC,OAAzC,EAAkD,KAAK7B,OAAvD;IACApC,YAAY,CAACqP,MAAb,CAAoB,KAAKrO,MAAL,CAAYiD,OAAhC,EAAyC,UAAzC,EAAqD,KAAKC,MAA1D;IACA,KAAKlD,MAAL,CAAYiD,OAAZ,CAAoBmL,mBAApB,CAAwC,OAAxC,EAAiD,KAAKrB,cAAtD,EAAsE,IAAtE;IACAlN,sBAAsB,CAAC,KAAKG,MAAN,EAAc,KAAKgN,WAAnB,EAAgC,KAAhC,CAAtB;EACH,CATD;;EAUAjN,aAAa,CAACjB,SAAd,CAAwBwP,OAAxB,GAAkC,YAAY;IAC1C,KAAKF,mBAAL;EACH,CAFD;;EAGArO,aAAa,CAACjB,SAAd,CAAwB2O,YAAxB,GAAuC,YAAY;IAC/C,KAAKhF,QAAL,CAAc,KAAKtG,UAAL,GAAkBuG,YAAlB,EAAd;EACH,CAFD;;EAGA3I,aAAa,CAACjB,SAAd,CAAwB6O,sBAAxB,GAAiD,UAAU3M,CAAV,EAAa;IAC1D,IAAI,CAAC,KAAKhB,MAAL,CAAY+G,uBAAjB,EAA0C;MACtC,IAAI3E,MAAM,GAAG,KAAKD,UAAL,GAAkBC,MAA/B;MACA,IAAIM,OAAO,GAAGN,MAAM,CAACM,OAArB;;MACA,QAAQ1B,CAAC,CAACyK,WAAV;QACI,KAAK,UAAL;QACA,KAAK,YAAL;UACI/I,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAACb,MAAR,IACT,CAAC,KAAK7B,MAAL,CAAYuO,aAAZ,CAA0BC,iBADlB,IACuC,CAACrP,iBAAiB,CAACiD,MAAM,CAACA,MAAP,CAAcM,OAAO,CAAC,CAAD,CAArB,CAAD,CADzD,GAETN,MAAM,CAACA,MAAP,CAAcM,OAAO,CAAC,CAAD,CAArB,EAA0BwD,OAA1B,CAAkC,CAAlC,CAFS,GAE8BlF,CAAC,CAACyK,WAAF,KAAkB,UAAlB,GAA+B/I,OAAO,CAAC,CAAD,CAAP,GAAa,CAA5C,GAAgDA,OAAO,CAAC,CAAD,CAAP,GAAa,CAFxG;UAGA;MANR;;MAQA,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmCA,OAAnC;MACA,KAAK+F,QAAL,CAAc,KAAKtG,UAAL,GAAkBuG,YAAlB,EAAd;IACH;EACJ,CAfD;;EAgBA3I,aAAa,CAACjB,SAAd,CAAwBwF,YAAxB,GAAuC,YAAY;IAC/C,KAAKnC,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmC,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBO,GAAzB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC,CAAC,CAAD,EAAI,CAAJ,CAApC,EAA4C,WAA5C,EAAyD,KAAKR,UAAL,GAAkBS,SAAlB,EAAzD,CAAnC;IACA,KAAKmD,cAAL;EACH,CAHD;;EAIAhG,aAAa,CAACjB,SAAd,CAAwBiH,cAAxB,GAAyC,YAAY;IACjD,IAAI,CAAC,KAAK9F,WAAL,CAAiBgD,OAAlB,IAA6B,CAAC,KAAKhD,WAAL,CAAiB6H,cAAnD,EAAmE;MAC/D;IACH;;IACDzI,WAAW,CAAC,CAAC,KAAKY,WAAL,CAAiBgD,OAAlB,EAA2B,KAAKhD,WAAL,CAAiB6H,cAA5C,CAAD,EAA8D,CAAC,SAAD,EAAY,WAAZ,CAA9D,CAAX;EACH,CALD;;EAMA/H,aAAa,CAACjB,SAAd,CAAwB2P,cAAxB,GAAyC,YAAY;IACjD,IAAIpO,MAAM,GAAG,KAAKA,MAAlB;IACA,KAAKA,MAAL,GAAc,KAAd;IACA,OAAOA,MAAM,IAAI,CAAC/B,MAAM,CAACqJ,IAAP,CAAY,KAAKnH,WAAjB,EAA8BqB,MAAzC,GAAkD;MAAE0H,QAAQ,EAAE,IAAZ;MAAkBC,SAAS,EAAE;IAA7B,CAAlD,GAAwF,KAAKhJ,WAApG;EACH,CAJD;;EAKAT,aAAa,CAACjB,SAAd,CAAwB4P,cAAxB,GAAyC,YAAY;IACjD,KAAKrO,MAAL,GAAc,IAAd;EACH,CAFD;;EAGAN,aAAa,CAACjB,SAAd,CAAwB+G,cAAxB,GAAyC,UAAUX,MAAV,EAAkBU,MAAlB,EAA0B;IAC/D,IAAIkB,KAAK,GAAG,IAAZ;;IACA,IAAI,CAAC,KAAK9G,MAAL,CAAY2B,YAAZ,EAAD,IAA+B,KAAK3B,MAAL,CAAY0B,UAAZ,KAA2B,CAA9D,EAAiE;MAC7D;IACH,CAJ8D,CAK/D;;;IACA,IAAIkH,IAAJ;IACA,IAAIjI,OAAO,GAAG;MACV,QAAQ,YAAY;QAAE,OAAQ;UAAE6E,QAAQ,EAAE,CAACoD,IAAI,CAACjF,SAAlB;UAA6B8B,QAAQ,EAAE;QAAvC,CAAR;MAAyD,CADrE;MAEV,OAAO,YAAY;QAAE,OAAQ;UAAED,QAAQ,EAAE,CAACoD,IAAI,CAACjF,SAAlB;UAA6B8B,QAAQ,EAAE;QAAvC,CAAR;MAA0D,CAFrE;MAGV,YAAY,YAAY;QAAE,OAAQ;UAAED,QAAQ,EAAE,IAAZ;UAAkBC,QAAQ,EAAEqB,KAAK,CAAC9G,MAAN,CAAa2B,YAAb;QAA5B,CAAR;MAAqE,CAHrF;MAIV,WAAW,YAAY;QAAE,OAAQ;UAAE6D,QAAQ,EAAE,KAAZ;UAAmBC,QAAQ,EAAE;QAA7B,CAAR;MAAgD;IAJ/D,CAAd;;IAMA,IAAI,EAAEP,MAAM,IAAIvE,OAAZ,CAAJ,EAA0B;MACtB;IACH;;IACDiI,IAAI,GAAGhD,MAAM,CAACyD,OAAP,EAAP;IACA,IAAIlJ,IAAI,GAAGQ,OAAO,CAACuE,MAAD,CAAP,EAAX;IACA,KAAK1D,SAAL,CAAe,CAACrB,IAAI,CAACqF,QAArB,EAA+BrF,IAAI,CAACsF,QAApC;IACA,KAAKtD,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmCkD,MAAM,CAACxD,MAAP,CAAcM,OAAjD;EACH,CApBD;;EAqBA3C,aAAa,CAACjB,SAAd,CAAwBmP,iBAAxB,GAA4C,UAAUjN,CAAV,EAAa;IACrD,IAAI,EAAEA,CAAC,CAACyD,KAAF,IAAWzD,CAAC,CAACoI,SAAF,CAAYzF,SAAvB,IAAoC3C,CAAC,CAACmE,OAAF,CAAUD,MAAV,KAAqB,OAAzD,KACElE,CAAC,CAAChB,MAAF,CAASkB,SAAT,CAAmBC,QAAnB,CAA4B,cAA5B,KACAH,CAAC,CAAChB,MAAF,CAASkB,SAAT,CAAmBC,QAAnB,CAA4B,eAA5B,CADA,IACgDH,CAAC,CAAChB,MAAF,CAASkB,SAAT,CAAmBC,QAAnB,CAA4B,gBAA5B,CAFlD,CAAF,CAAJ,EAEyG;MACrG;IACH;;IACD,KAAK4E,cAAL;IACA,IAAI4I,QAAQ,GAAG,KAAKxM,UAAL,GAAkByM,YAAlB,CAA+B,KAAK5G,iBAAL,EAA/B,CAAf;IACA,KAAKM,iBAAL,CAAuBqG,QAAvB;IACA,KAAK1O,WAAL,CAAiB+C,UAAjB,GAA8B,IAA9B;EACH,CAVD;;EAWA,OAAOjD,aAAP;AACH,CAngBkC,EAAnC;;AAogBA,SAASA,aAAT;AACA;AACA;AACA;AACA;AACA;;AACA,IAAI8O,MAAM;AAAG;AAAe,YAAY;EACpC,SAASA,MAAT,GAAkB;IACd,KAAKzM,MAAL,GAAc,EAAd;IACA,KAAKM,OAAL,GAAe,EAAf;EACH;;EACDmM,MAAM,CAAC/P,SAAP,CAAiBgQ,GAAjB,GAAuB,UAAUvF,QAAV,EAAoBwF,WAApB,EAAiCC,KAAjC,EAAwC;IAC3DzF,QAAQ,GAAG8C,IAAI,CAAC4C,GAAL,CAAS,CAAT,EAAY5C,IAAI,CAACC,GAAL,CAAS/C,QAAT,EAAmB,KAAKhH,IAAxB,CAAZ,CAAX;IACAwM,WAAW,GAAG1C,IAAI,CAAC4C,GAAL,CAAS,CAAT,EAAY5C,IAAI,CAACC,GAAL,CAASyC,WAAT,EAAsB,KAAKG,OAA3B,CAAZ,CAAd;IACA,KAAK9M,MAAL,CAAYmH,QAAZ,IAAwB,KAAKnH,MAAL,CAAYmH,QAAZ,KAAyB,EAAjD;IACA,KAAKnH,MAAL,CAAYmH,QAAZ,EAAsBwF,WAAtB,IAAqCC,KAAK,GAAG,CAAH,GAAO,CAAjD;EACH,CALD;;EAMAH,MAAM,CAAC/P,SAAP,CAAiB6D,GAAjB,GAAuB,UAAU4G,QAAV,EAAoBwF,WAApB,EAAiCI,SAAjC,EAA4CjK,MAA5C,EAAoDtC,SAApD,EAA+D;IAClF,IAAIwM,GAAG,GAAGL,WAAV;;IACA,IAAIxF,QAAQ,GAAG4F,SAAS,CAAC,CAAD,CAApB,GAA0B,CAA9B,EAAiC;MAC7B,OAAO,CAAC5F,QAAD,EAAWwF,WAAX,CAAP;IACH;;IACDxF,QAAQ,GAAG8C,IAAI,CAAC4C,GAAL,CAAS,CAAT,EAAY5C,IAAI,CAACC,GAAL,CAAS/C,QAAQ,GAAG4F,SAAS,CAAC,CAAD,CAA7B,EAAkC,KAAK5M,IAAvC,CAAZ,CAAX;IACA,IAAI8M,UAAU,GAAG,IAAjB;;IACA,IAAIlQ,iBAAiB,CAAC,KAAKiD,MAAL,CAAYmH,QAAZ,CAAD,CAArB,EAA8C;MAC1C,OAAO,IAAP;IACH;;IACDwF,WAAW,GAAG1C,IAAI,CAAC4C,GAAL,CAAS,CAAT,EAAY5C,IAAI,CAACC,GAAL,CAASyC,WAAW,GAAGI,SAAS,CAAC,CAAD,CAAhC,EAAqC,KAAK/M,MAAL,CAAYmH,QAAZ,EAAsB1H,MAAtB,GAA+B,CAApE,CAAZ,CAAd;;IACA,IAAIuN,GAAG,GAAGD,SAAS,CAAC,CAAD,CAAf,GAAqB,KAAK/M,MAAL,CAAYmH,QAAZ,EAAsB1H,MAAtB,GAA+B,CAApD,IAAyDe,SAAS,CAAC2G,QAAD,EAAWwF,WAAX,EAAwB7J,MAAxB,CAAtE,EAAuG;MACnG,OAAO,CAACqE,QAAD,EAAW6F,GAAX,CAAP;IACH;;IACD,IAAIE,KAAK,GAAG,KAAKA,KAAL,CAAW,KAAKlN,MAAL,CAAYmH,QAAZ,CAAX,EAAkCwF,WAAlC,EAA+CI,SAA/C,EAA0D,IAA1D,EAAgEjK,MAAhE,CAAZ;IACA6J,WAAW,GAAGO,KAAK,KAAK,IAAV,GAAiBF,GAAjB,GAAuBE,KAArC;IACA,IAAIC,GAAG,GAAGtQ,QAAQ,CAACsK,QAAQ,GAAG,GAAX,GAAiBwF,WAAlB,EAA+B,KAAK3M,MAApC,CAAlB;;IACA,IAAImH,QAAQ,KAAK,KAAKhH,IAAlB,KAA2B2C,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAhE,CAAJ,EAA8E;MAC1EiK,SAAS,CAAC,CAAD,CAAT,GAAe,CAAC,CAAhB;IACH;;IACD,IAAIG,KAAK,KAAK,IAAd,EAAoB;MAChB,KAAK,IAAI1D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKrJ,IAAzB,EAA+BqJ,CAAC,EAAhC,EAAoC;QAChC,IAAI,KAAKxJ,MAAL,CAAYwJ,CAAZ,EAAetE,IAAf,CAAoB,UAAUkI,CAAV,EAAa;UAAE,OAAOA,CAAC,KAAK,CAAb;QAAiB,CAApD,CAAJ,EAA2D;UACvDH,UAAU,GAAG,KAAb;UACA;QACH;MACJ;;MACD,IAAIA,UAAJ,EAAgB;QACZ9F,QAAQ,GAAG,KAAK7G,OAAL,CAAa,CAAb,CAAX;QACA,OAAO,CAAC6G,QAAD,EAAWwF,WAAX,CAAP;MACH;IACJ;;IACD,OAAO,KAAKU,OAAL,CAAaF,GAAb,KAAqB,CAAC3M,SAAS,CAAC2G,QAAD,EAAWwF,WAAX,EAAwB7J,MAAxB,CAA/B,GACH,KAAKvC,GAAL,CAAS4G,QAAT,EAAmB6F,GAAnB,EAAwBD,SAAxB,EAAmCjK,MAAnC,EAA2CtC,SAA3C,CADG,GACqD,CAAC2G,QAAD,EAAWwF,WAAX,CAD5D;EAEH,CAlCD;;EAmCAF,MAAM,CAAC/P,SAAP,CAAiBwQ,KAAjB,GAAyB,UAAUI,MAAV,EAAkBC,KAAlB,EAAyBR,SAAzB,EAAoCS,MAApC,EAA4C1K,MAA5C,EAAoD;IACzE,IAAK,CAACyK,KAAK,GAAG,CAAR,IAAaA,KAAK,KAAKD,MAAM,CAAC7N,MAA/B,KAA0C,KAAK4N,OAAL,CAAaC,MAAM,CAACC,KAAD,CAAnB,CAA1C,IACGzK,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,WADvC,IACwD,CAACwK,MAAM,CAACpI,IAAP,CAAY,UAAUkI,CAAV,EAAa;MAAE,OAAOA,CAAC,KAAK,CAAb;IAAiB,CAA5C,CAD7D,EAC4G;MACxG,OAAO,IAAP;IACH;;IACD,OAAO,CAAC,KAAKC,OAAL,CAAaC,MAAM,CAACC,KAAD,CAAnB,CAAD,GAA+BA,KAA/B,GACH,KAAKL,KAAL,CAAWI,MAAX,EAAoB,CAAC,SAAD,EAAY,WAAZ,EAAyB,SAAzB,EAAoC,WAApC,EAAiDxJ,OAAjD,CAAyDhB,MAAzD,MAAqE,CAAC,CAAvE,GAA4E0K,MAAM,GAAG,CAAH,GAAO,EAAED,KAA3F,GAAmGA,KAAK,GAAGR,SAAS,CAAC,CAAD,CAAvI,EAA4IA,SAA5I,EAAuJ,KAAvJ,EAA8JjK,MAA9J,CADJ;EAEH,CAPD;;EAQA2J,MAAM,CAAC/P,SAAP,CAAiB+D,MAAjB,GAA0B,UAAU0G,QAAV,EAAoBwF,WAApB,EAAiC;IACvDxF,QAAQ,GAAG8C,IAAI,CAAC4C,GAAL,CAAS,CAAT,EAAY5C,IAAI,CAACC,GAAL,CAAS/C,QAAT,EAAmB,KAAKhH,IAAxB,CAAZ,CAAX;IACAwM,WAAW,GAAG1C,IAAI,CAAC4C,GAAL,CAAS,CAAT,EAAY5C,IAAI,CAACC,GAAL,CAASyC,WAAT,EAAsB,KAAK3M,MAAL,CAAYmH,QAAZ,EAAsB1H,MAAtB,GAA+B,CAArD,CAAZ,CAAd;IACA,KAAKa,OAAL,GAAe,CAAC6G,QAAD,EAAWwF,WAAX,CAAf;EACH,CAJD;;EAKAF,MAAM,CAAC/P,SAAP,CAAiBuD,QAAjB,GAA4B,UAAUE,IAAV,EAAgBE,QAAhB,EAA0BkI,aAA1B,EAAyC;IACjE,KAAKpI,IAAL,GAAYA,IAAI,CAACV,MAAL,GAAc,CAA1B;IACA,KAAKO,MAAL,GAAc,EAAd;;IACA,KAAK,IAAIwJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrJ,IAAI,CAACV,MAAzB,EAAiC+J,CAAC,EAAlC,EAAsC;MAClC,IAAIiE,KAAK,GAAGtN,IAAI,CAACqJ,CAAD,CAAJ,CAAQiE,KAAR,CAAcrF,MAAd,CAAqB,UAAUsF,CAAV,EAAa;QAAE,OAAOA,CAAC,CAACC,SAAF,KAAgB,IAAvB;MAA8B,CAAlE,CAAZ;MACA,KAAKb,OAAL,GAAe7C,IAAI,CAAC4C,GAAL,CAASY,KAAK,CAAChO,MAAN,GAAe,CAAxB,EAA2B,KAAKqN,OAAL,GAAe,CAA1C,CAAf;;MACA,KAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,KAAK,CAAChO,MAA1B,EAAkCmO,CAAC,EAAnC,EAAuC;QACnC,KAAKlB,GAAL,CAASlD,CAAT,EAAYoE,CAAZ,EAAezN,IAAI,CAACqJ,CAAD,CAAJ,CAAQlB,OAAR,KAAoB,KAApB,GAA4B,KAA5B,GAAoCjI,QAAQ,CAACF,IAAI,CAACqJ,CAAD,CAAL,EAAUiE,KAAK,CAACG,CAAD,CAAf,EAAoBrF,aAApB,CAA3D;MACH;IACJ;;IACD,OAAO,KAAKvI,MAAZ;EACH,CAXD;;EAYAyM,MAAM,CAAC/P,SAAP,CAAiB2Q,OAAjB,GAA2B,UAAUlI,KAAV,EAAiB;IACxC,OAAOA,KAAK,KAAK,CAAV,IAAeA,KAAK,KAAK0I,SAAhC;EACH,CAFD;;EAGA,OAAOpB,MAAP;AACH,CA3E2B,EAA5B;;AA4EA,SAASA,MAAT;AACA;AACA;AACA;;AACA,IAAI7E,YAAY;AAAG;AAAe,YAAY;EAC1C,SAASA,YAAT,CAAsBhK,MAAtB,EAA8B;IAC1B,IAAI8G,KAAK,GAAG,IAAZ;;IACA,KAAK1E,MAAL,GAAc,IAAIyM,MAAJ,EAAd;IACA,KAAK/I,WAAL,GAAmB,KAAnB;IACA,KAAK9F,MAAL,GAAcA,MAAd;IACA,KAAKkQ,UAAL,GAAkB;MACd,cAAc,CAAC,CAAD,EAAI,CAAJ,CADA;MAEd,OAAO,CAAC,CAAD,EAAI,CAAJ,CAFO;MAGd,aAAa,CAAC,CAAD,EAAI,CAAC,CAAL,CAHC;MAId,YAAY,CAAC,CAAD,EAAI,CAAC,CAAL,CAJE;MAKd,WAAW,CAAC,CAAC,CAAF,EAAK,CAAL,CALG;MAMd,aAAa,CAAC,CAAD,EAAI,CAAJ,CANC;MAOd,WAAW,CAAC,CAAC,CAAF,EAAK,CAAL,CAPG;MAQd,aAAa,CAAC,CAAD,EAAI,CAAJ,CARC;MASd,cAAc,CAAC,CAAD,EAAI,CAAJ,CATA;MAUd,aAAa,CAAC,CAAD,EAAI,CAAC,CAAL,CAVC;MAWd,SAAS,CAAC,CAAD,EAAI,CAAJ,CAXK;MAYd,cAAc,CAAC,CAAC,CAAF,EAAK,CAAL;IAZA,CAAlB;;IAcA,KAAKC,YAAL,GAAoB,UAAUjL,MAAV,EAAkB;MAClC,IAAIkL,GAAG,GAAG;QACN,QAAQ,CAACtJ,KAAK,CAAC1E,MAAN,CAAaM,OAAb,CAAqB,CAArB,CAAD,EAA0B,CAAC,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,CADF;QAEN,OAAO,CAACoE,KAAK,CAAC1E,MAAN,CAAaM,OAAb,CAAqB,CAArB,CAAD,EAA0BoE,KAAK,CAAC1E,MAAN,CAAa8M,OAAb,GAAuB,CAAjD,EAAoD,CAApD,EAAuD,CAAC,CAAxD,CAFD;QAGN,YAAY,CAAC,CAAD,EAAI,CAAC,CAAL,EAAQ,CAAR,EAAW,CAAX,CAHN;QAIN,WAAW,CAACpI,KAAK,CAAC1E,MAAN,CAAaG,IAAd,EAAoBuE,KAAK,CAAC1E,MAAN,CAAa8M,OAAb,GAAuB,CAA3C,EAA8C,CAA9C,EAAiD,CAAC,CAAlD;MAJL,CAAV;MAMA,OAAOkB,GAAG,CAAClL,MAAD,CAAH,IAAe,IAAtB;IACH,CARD;EASH;;EACD8E,YAAY,CAAClL,SAAb,CAAuBuR,QAAvB,GAAkC,YAAY;IAC1C,OAAQ,KAAKrQ,MAAL,CAAY2B,YAAZ,KACJ,KAAK3B,MAAL,CAAYmC,UAAZ,GAAyBmE,aAAzB,CAAuC,4BAAvC,CADI,GAEJ,KAAKtG,MAAL,CAAYsQ,eAAZ,EAFJ;EAGH,CAJD;;EAKAtG,YAAY,CAAClL,SAAb,CAAuBiG,UAAvB,GAAoC,UAAU/D,CAAV,EAAa;IAC7C,IAAImO,SAAS,GAAG,KAAKe,UAAL,CAAgBlP,CAAC,CAACkE,MAAlB,CAAhB;IACA,IAAIxC,OAAO,GAAG,KAAK6N,oBAAL,CAA0BvP,CAAC,CAACkE,MAA5B,EAAoCiK,SAApC,EAA+CnO,CAAC,CAACkE,MAAF,IAAY,KAAKgL,UAAhE,EAA4ElP,CAA5E,CAAd;;IACA,IAAI,CAAC0B,OAAL,EAAc;MACV;IACH;;IACD,IAAI,CAAC,CAAC,KAAD,EAAQ,UAAR,EAAoBwD,OAApB,CAA4BlF,CAAC,CAACkE,MAA9B,IAAwC,CAAC,CAAzC,IAA8C,KAAK9C,MAAL,CAAYM,OAA1D,IAAqE,EAAtE,EAA0EsD,QAA1E,OAAyFtD,OAAO,CAACsD,QAAR,EAA7F,EAAiH;MAC7G,IAAItD,OAAO,CAACsD,QAAR,OAAuB,CAAC,KAAK5D,MAAL,CAAYG,IAAb,EAAmB,KAAKH,MAAL,CAAY8M,OAA/B,EAAwClJ,QAAxC,EAAvB,IACAtD,OAAO,CAACsD,QAAR,OAAuB,CAAC,CAAD,EAAI,CAAJ,EAAOA,QAAP,EADvB,IAC6C,KAAK5D,MAAL,CAAYM,OAAZ,CAAoB,CAApB,MAA2B,KAAKN,MAAL,CAAYG,IAAvC,IAC7C,KAAKH,MAAL,CAAYM,OAAZ,CAAoBsD,QAApB,OAAmCtD,OAAO,CAACsD,QAAR,EAFvC,EAE4D;QACxD,OAAO,KAAP;MACH,CAJD,MAKK;QACDtD,OAAO,GAAG,KAAK8N,WAAL,CAAiB9N,OAAO,CAAC,CAAD,CAAxB,EAA6BA,OAAO,CAAC,CAAD,CAApC,EAAyC1B,CAAC,CAACkE,MAA3C,CAAV;MACH;IACJ;;IACD,KAAK9C,MAAL,CAAYS,MAAZ,CAAmBH,OAAO,CAAC,CAAD,CAA1B,EAA+BA,OAAO,CAAC,CAAD,CAAtC;EACH,CAjBD;;EAkBAsH,YAAY,CAAClL,SAAb,CAAuB0R,WAAvB,GAAqC,UAAUjH,QAAV,EAAoBC,SAApB,EAA+BtE,MAA/B,EAAuC;IACxE,IAAIuL,IAAI,GAAG,KAAKzQ,MAAhB;IACA,IAAIwQ,WAAW,GAAGC,IAAI,CAAC3O,YAAL,CAAkB4O,gBAAlB,KAAuCD,IAAI,CAACtN,MAAL,IAAesN,IAAI,CAACE,oBAA3D,CAAlB;IACA,IAAIC,YAAY,GAAGH,IAAI,CAACI,qBAAL,CAA2BJ,IAAI,CAACK,iBAAL,GAAyB,CAAzB,EAA4BC,KAAvD,CAAnB;IACA,IAAIC,IAAI,GAAG,KAAKX,QAAL,GAAgB9N,IAAhB,CAAqBgH,QAArB,EAA+BsG,KAA/B,CAAqCrG,SAArC,CAAX;;IACA,IAAItE,MAAM,KAAK,KAAX,IAAoBsL,WAAxB,EAAqC;MACjCjH,QAAQ;MACR,IAAIoG,KAAK,GAAI,KAAKU,QAAL,GAAgB9N,IAAhB,CAAqBgH,QAArB,EAA+B0H,sBAA/B,CAAsD,cAAtD,EAAsEpP,MAAtE,GACT,KAAKwO,QAAL,GAAgB9N,IAAhB,CAAqBgH,QAArB,EAA+B0H,sBAA/B,CAAsD,qBAAtD,EAA6EpP,MADjF;MAEA2H,SAAS,GAAGoH,YAAY,GAAGjB,KAA3B;IACH;;IACD,IAAIzK,MAAM,KAAK,UAAX,IAAyBsL,WAA7B,EAA0C;MACtCjH,QAAQ;MACRC,SAAS,GAAGiH,IAAI,CAACI,qBAAL,CAA2BJ,IAAI,CAACK,iBAAL,GAAyBL,IAAI,CAACK,iBAAL,GAAyBjP,MAAzB,GAAkC,CAA3D,EAA8DkP,KAAzF,CAAZ;IACH;;IACD,OAAO,CAACC,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACoR,OAAjC,CAAD,IAA8C,CAACF,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAA/C,IACH,CAAC6P,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,gBAAxB,CADE,GAEH,KAAKqP,WAAL,CAAiBjH,QAAjB,EAA2BC,SAA3B,EAAsCtE,MAAtC,CAFG,GAE6C,CAACqE,QAAD,EAAWC,SAAX,CAFpD;EAGH,CAlBD;;EAmBAQ,YAAY,CAAClL,SAAb,CAAuByR,oBAAvB,GAA8C,UAAUrL,MAAV,EAAkBiK,SAAlB,EAA6BgC,SAA7B,EAAwCnQ,CAAxC,EAA2C;IACrF,IAAImO,SAAS,KAAK,KAAK,CAAvB,EAA0B;MAAEA,SAAS,GAAG,CAAC,CAAD,EAAI,CAAJ,CAAZ;IAAqB;;IACjD,IAAI,CAACgC,SAAD,IAAc,CAAC,KAAKhB,YAAL,CAAkBjL,MAAlB,CAAf,IAA6C,KAAK9C,MAAL,CAAYM,OAAZ,CAAoBb,MAApB,KAA+B,CAAhF,EAAoF;MAChF,OAAO,IAAP;IACH;;IACD,IAAI,CAAC,KAAKuP,iBAAL,CAAuBpQ,CAAvB,CAAL,EAAgC;MAC5B,OAAO,KAAKoB,MAAL,CAAYM,OAAnB;IACH;;IACD,IAAI4G,EAAE,GAAG,KAAK6G,YAAL,CAAkBjL,MAAlB,KAA6B,KAAK9C,MAAL,CAAYM,OAAZ,CAAoB2O,MAApB,CAA2BlC,SAA3B,CAAtC;IAAA,IAA6E5F,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAA1F;IAAA,IAA+FE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA7G;IAAA,IAAkHgI,EAAE,GAAGhI,EAAE,CAAC,CAAD,CAAzH;IAAA,IAA8HiI,EAAE,GAAGjI,EAAE,CAAC,CAAD,CAArI;;IACA,IAAI5G,OAAO,GAAG,KAAKN,MAAL,CAAYO,GAAZ,CAAgB4G,QAAhB,EAA0BC,SAA1B,EAAqC,CAAC8H,EAAD,EAAKC,EAAL,CAArC,EAA+CrM,MAA/C,EAAuD,KAAKtC,SAAL,EAAvD,CAAd;IACA,OAAOF,OAAP;EACH,CAXD;;EAYAsH,YAAY,CAAClL,SAAb,CAAuB2E,OAAvB,GAAiC,UAAUzC,CAAV,EAAa0C,KAAb,EAAoB;IACjD,IAAIzC,MAAM,GAAGD,CAAC,CAACC,MAAf;IACA,KAAKA,MAAL,GAAcA,MAAd;IACAA,MAAM,GAAIA,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BrB,QAAQ,CAACoR,OAAnC,IAA8CjQ,MAA9C,GAAuD/B,OAAO,CAAC+B,MAAD,EAAS,IAAT,CAAxE;IACAA,MAAM,GAAGA,MAAM,GAAGA,MAAH,GAAY/B,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,wBAAX,CAAP,IACpB/B,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,sBAAX,CADd;IAEAA,MAAM,GAAG/B,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,iBAAX,CAAP,GACL9B,iBAAiB,CAACD,OAAO,CAACA,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,SAAX,CAAR,EAA+B,iBAA/B,CAAR,CAAjB,GAA8E,IAA9E,GAAqFA,MADhF,GACyFA,MADlG;IAEAA,MAAM,GAAGA,MAAM,IAAI/B,OAAO,CAAC+B,MAAD,EAAS,OAAT,CAAP,CAAyBC,SAAzB,CAAmCC,QAAnC,CAA4CrB,QAAQ,CAAC0R,KAArD,CAAV,GAAwEvQ,MAAxE,GAAiF,IAA1F;;IACA,IAAI,CAACA,MAAL,EAAa;MACT,OAAO,KAAP;IACH;;IACD,IAAIqI,EAAE,GAAG,CAACrI,MAAM,CAACwQ,aAAP,CAAqBlI,QAAtB,EAAgCtI,MAAM,CAACuI,SAAvC,CAAT;IAAA,IAA4DD,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAAzE;IAAA,IAA8EE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA5F;IACA,IAAIoI,EAAE,GAAG,KAAKtP,MAAL,CAAYM,OAArB;IAAA,IAA8BiP,SAAS,GAAGD,EAAE,CAAC,CAAD,CAA5C;IAAA,IAAiDE,UAAU,GAAGF,EAAE,CAAC,CAAD,CAAhE;IACA,IAAInC,GAAG,GAAGtQ,QAAQ,CAACsK,QAAQ,GAAG,GAAX,GAAiBC,SAAlB,EAA6B,KAAKpH,MAAL,CAAYA,MAAzC,CAAlB;;IACA,IAAI,KAAKA,MAAL,CAAYqN,OAAZ,CAAoBF,GAApB,KAA6B,CAAC7L,KAAD,IAAUiO,SAAS,KAAKpI,QAAxB,IAAoCqI,UAAU,KAAKpI,SAAhF,IACC,CAAC5J,YAAY,CAACoB,CAAC,CAACC,MAAH,EAAWnB,QAAQ,CAACoR,OAApB,CAAb,IAA6C,CAACtR,YAAY,CAACoB,CAAC,CAACC,MAAH,EAAW,gBAAX,CAD/D,EAC8F;MAC1F,OAAO,KAAP;IACH;;IACD,KAAKmB,MAAL,CAAYS,MAAZ,CAAmB0G,QAAnB,EAA6BC,SAA7B;EACH,CApBD;;EAqBAQ,YAAY,CAAClL,SAAb,CAAuB4J,YAAvB,GAAsC,YAAY;IAC9C,IAAIE,IAAI,GAAG,EAAX;IACA,IAAIU,EAAE,GAAG,KAAKlH,MAAL,CAAYM,OAArB;IAAA,IAA8BgP,EAAE,GAAGpI,EAAE,CAAC,CAAD,CAArC;IAAA,IAA0CC,QAAQ,GAAGmI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzE;IAAA,IAA6EG,EAAE,GAAGvI,EAAE,CAAC,CAAD,CAApF;IAAA,IAAyFE,SAAS,GAAGqI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzH;IACA,KAAKzP,MAAL,CAAYM,OAAZ,GAAsB,CAAC6G,QAAD,EAAWC,SAAX,CAAtB;IACAZ,IAAI,CAAC3F,OAAL,GAAe,CAAC9D,iBAAiB,CAAC,KAAKkR,QAAL,GAAgB9N,IAAhB,CAAqBgH,QAArB,CAAD,CAAlB,GAAqD,KAAK8G,QAAL,GAAgB9N,IAAhB,CAAqBgH,QAArB,EAA+BsG,KAA/B,CAAqCrG,SAArC,CAArD,GAAuG,IAAtH;;IACA,IAAI,CAACZ,IAAI,CAAC3F,OAAV,EAAmB;MACf,OAAO2F,IAAP;IACH;;IACDA,IAAI,CAACd,cAAL,GAAsB,CAACc,IAAI,CAAC3F,OAAL,CAAa/B,SAAb,CAAuBC,QAAvB,CAAgC,eAAhC,CAAD,IAAqD,CAACyH,IAAI,CAAC3F,OAAL,CAAa/B,SAAb,CAAuBC,QAAvB,CAAgC,cAAhC,CAAtD,GAChB,KAAKyN,YAAL,CAAkBhG,IAAI,CAAC3F,OAAvB,CADgB,GACkB2F,IAAI,CAAC3F,OAD7C;IAEA2F,IAAI,CAACvD,OAAL,GAAe,IAAf;IACAuD,IAAI,CAACe,GAAL,GAAWf,IAAI,CAAC3F,OAAL,CAAawO,aAAb,CAA2BnO,YAA3B,CAAwC,UAAxC,CAAX;IACA,OAAOsF,IAAP;EACH,CAbD;;EAcAoB,YAAY,CAAClL,SAAb,CAAuB8P,YAAvB,GAAsC,UAAU3L,OAAV,EAAmB;IACrD,IAAI6O,KAAK,GAAG,+FAAZ;IACA,IAAIC,UAAU,GAAG,CAAC5S,iBAAiB,CAACD,OAAO,CAAC+D,OAAD,EAAU,iBAAV,CAAR,CAAnC;;IACA,IAAI,KAAKjD,MAAL,CAAYmD,MAAhB,EAAwB;MACpB2O,KAAK,GAAG,wEAAR;IACH;;IACD,IAAIE,KAAK,GAAG,GAAG3H,KAAH,CAAS4H,IAAT,CAAchP,OAAO,CAACiP,gBAAR,CAAyBJ,KAAzB,CAAd,CAAZ;IACA;AACR;AACA;AACA;;IACQ,OAAOE,KAAK,CAACnQ,MAAN,GAAekQ,UAAU,IAAIC,KAAK,CAACnQ,MAAN,GAAe,CAA7B,GAAiC,KAAKZ,MAAtC,GAA+C+Q,KAAK,CAAC,CAAD,CAAnE,GAAyE/O,OAAhF;EACH,CAZD;;EAaA+G,YAAY,CAAClL,SAAb,CAAuB2D,QAAvB,GAAkC,UAAUyI,GAAV,EAAe8F,IAAf,EAAqBrG,aAArB,EAAoC;IAClE,IAAIwH,KAAK,GAAG,CAAC3S,QAAQ,CAAC4S,MAAV,EAAkB5S,QAAQ,CAAC6S,YAA3B,EAAyC7S,QAAQ,CAAC8S,cAAlD,EAAkE9S,QAAQ,CAAC+S,YAA3E,CAAZ;IACA,OAAO,CAAErH,GAAG,CAAC1I,SAAJ,IAAiBwO,IAAI,CAACtG,OAAtB,KAAkCsG,IAAI,CAACwB,UAAL,IAAmBxB,IAAI,CAACe,UAA1D,CAAD,IACA7G,GAAG,CAAC1I,SAAJ,IAAiBwO,IAAI,CAACyB,QAAL,KAAkBjT,QAAQ,CAACkT,YAA5C,IAA4DvT,iBAAiB,CAAC6R,IAAI,CAACtG,OAAN,CAD7E,IAEA,CAACQ,GAAG,CAAC1I,SAAL,IAAkB2P,KAAK,CAACjM,OAAN,CAAc8K,IAAI,CAACyB,QAAnB,IAA+B,CAAC,CAFlD,IAGAzB,IAAI,CAAC2B,MAAL,IAAe3B,IAAI,CAACtG,OAApB,IAA+BsG,IAAI,CAAC2B,MAAL,CAAYxE,IAAZ,KAAqB,UAHpD,IAIA6C,IAAI,CAACyB,QAAL,KAAkBjT,QAAQ,CAACoT,aAJ3B,IAKA1H,GAAG,CAAC1I,SAAJ,IAAiBmI,aALlB,KAMA,EAAEO,GAAG,CAAC2H,IAAJ,KAAa,QAAb,IAAyB3H,GAAG,CAAC4H,OAA/B,CANP;EAOH,CATD;;EAUA9I,YAAY,CAAClL,SAAb,CAAuBiU,oBAAvB,GAA8C,UAAUpD,KAAV,EAAiB;IAC3D,IAAIqD,SAAS,GAAGrD,KAAhB;;IACA,KAAK,IAAI/D,CAAC,GAAG+D,KAAR,EAAesD,GAAG,GAAG,KAAK7Q,MAAL,CAAYG,IAAtC,EAA4CqJ,CAAC,IAAIqH,GAAjD,EAAsDrH,CAAC,EAAvD,EAA2D;MACvD,IAAI,KAAKxJ,MAAL,CAAYA,MAAZ,CAAmBuN,KAAnB,EAA0BzJ,OAA1B,CAAkC,CAAlC,MAAyC,CAAC,CAA9C,EAAiD;QAC7CyJ,KAAK,GAAGA,KAAK,GAAG,CAAhB;MACH,CAFD,MAGK;QACD,OAAOA,KAAP;MACH;IACJ;;IACD,KAAK7J,WAAL,GAAmB,IAAnB;IACA,OAAOkN,SAAP;EACH,CAZD;;EAaAhJ,YAAY,CAAClL,SAAb,CAAuBoU,wBAAvB,GAAkD,UAAUvD,KAAV,EAAiB;IAC/D,IAAIwD,UAAU,GAAGxD,KAAjB;;IACA,KAAK,IAAI/D,CAAC,GAAG+D,KAAR,EAAesD,GAAG,GAAG,CAA1B,EAA6BrH,CAAC,IAAIqH,GAAlC,EAAuCrH,CAAC,EAAxC,EAA4C;MACxC,IAAI,KAAKxJ,MAAL,CAAYA,MAAZ,CAAmBuN,KAAnB,EAA0BzJ,OAA1B,CAAkC,CAAlC,MAAyC,CAAC,CAA9C,EAAiD;QAC7CyJ,KAAK,GAAGA,KAAK,GAAG,CAAhB;;QACA,IAAIA,KAAK,GAAG,CAAZ,EAAe;UACX,KAAK7J,WAAL,GAAmB,IAAnB;UACA,OAAOqN,UAAP;QACH;MACJ,CAND,MAOK;QACD,OAAOxD,KAAP;MACH;IACJ;;IACD,OAAOwD,UAAP;EACH,CAfD;;EAgBAnJ,YAAY,CAAClL,SAAb,CAAuByG,IAAvB,GAA8B,UAAUL,MAAV,EAAkBxC,OAAlB,EAA2B;IACrD,IAAI0Q,UAAU,GAAG,KAAKpT,MAAL,CAAYqT,kBAAZ,MACZ,CAACnO,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,UAAtC,KAAqDxC,OAAO,CAAC,CAAD,CAAP,KAAe,CADzE;IAEA,IAAI0J,KAAK,GAAI,CAAClH,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAAvC,KAAiDxC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY8M,OAAzF;IACA,IAAIoE,MAAM,GAAG,KAAKtT,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAAzC,IAAsDgI,KAAnE;;IACA,IAAI,KAAKpM,MAAL,CAAYmE,aAAZ,OAAgC,OAApC,EAA6C;MACzCiP,UAAU,GAAGhH,KAAb;IACH;;IACD,KAAKtG,WAAL,GAAmB,KAAnB;IACA,IAAIyN,WAAW,GAAG,KAAKvT,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCwD,MAAM,KAAK,YAA7D;;IACA,IAAIA,MAAM,KAAK,KAAX,IAAoB,CAAC,KAAKlF,MAAL,CAAYmD,MAAjC,IACAT,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BgE,WAA/B,CAA2C,CAA3C,CADf,IACgE,KAAKtE,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA5B,KAAkCa,OAAO,CAAC,CAAD,CAD7G,EACkH;MAC9G,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKqQ,oBAAL,CAA0B,KAAK3Q,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAnD,CAAzB;MACA,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;MACA0Q,UAAU,GAAG,KAAKpT,MAAL,CAAY2B,YAAZ,EAAb;IACH;;IACD,IAAIuD,MAAM,KAAK,UAAX,IAAyB,CAAC,KAAKlF,MAAL,CAAYmD,MAAtC,IACAT,OAAO,CAAC,CAAD,CAAP,KAAe,CADf,IACoB,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BwD,OAA/B,CAAuC,CAAvC,MAA8CxD,OAAO,CAAC,CAAD,CAD7E,EACkF;MAC9E,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKwQ,wBAAL,CAA8B,KAAK9Q,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAvD,CAAzB;MACA,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+Bb,MAAxD;IACH;;IACD,IAAI2R,aAAa,GAAG,KAApB;IACA,IAAItI,GAAG,GAAG3E,QAAQ,CAACC,aAAT,CAAuBiL,aAAjC;;IACA,IAAI,CAAC,KAAKzR,MAAL,CAAYuB,oBAAZ,IAAoC,KAAKvB,MAAL,CAAYyT,sBAAZ,CAAmCC,WAAxE,KACGxI,GAAG,CAAChK,SAAJ,CAAcC,QAAd,CAAuBrB,QAAQ,CAACoL,GAAhC,CADP,EAC6C;MACzC,IAAI3B,QAAQ,GAAGlG,QAAQ,CAAC6H,GAAG,CAAC5H,YAAJ,CAAiBxD,QAAQ,CAAC6T,YAA1B,CAAD,EAA0C,EAA1C,CAAvB;MACAH,aAAa,GAAGjK,QAAQ,GAAG,CAA3B;IACH;;IACD,IAAIX,IAAI,GAAG;MACPzI,IAAI,EAAE,CAACqT,aAAD,GAAkB,CAACtO,MAAM,KAAK,SAAX,IAAwBqO,WAAzB,KAAyC7Q,OAAO,CAAC,CAAD,CAAP,KAAe,CAAzD,IAA+D0Q,UAA/D,IAA6EE,MAA9F,GAAuG,KADtG;MAEP9N,QAAQ,EAAE,CAACN,MAAM,KAAK,SAAX,IAAwBqO,WAAzB,KAAyC7Q,OAAO,CAAC,CAAD,CAAP,KAAe,CAF3D;MAGP+C,QAAQ,EAAE2N,UAHH;MAIP1N,aAAa,EAAE4N;IAJR,CAAX;IAMA,OAAO1K,IAAP;EACH,CAnCD;;EAoCAoB,YAAY,CAAClL,SAAb,CAAuB6G,cAAvB,GAAwC,UAAUiO,QAAV,EAAoBzT,IAApB,EAA0ByF,MAA1B,EAAkCV,MAAlC,EAA0C;IAC9E,IAAI0O,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAIlR,OAAO,GAAG,EAAd;;IACA,IAAI,KAAK1C,MAAL,CAAYmE,aAAZ,OAAgC,OAAhC,IAA2C,KAAKnE,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAAxF,EAAmG;MAC/F,IAAIc,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,UAAzC,EAAqD;QACjDxC,OAAO,CAAC,CAAD,CAAP,GAAakR,QAAQ,CAAC,CAAD,CAArB;QACAlR,OAAO,CAAC,CAAD,CAAP,GAAakD,MAAM,CAACxD,MAAP,CAAc8M,OAAd,GAAwB,CAArC;MACH;;MACD,IAAI,KAAKlP,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAAzC,KAAuDc,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA7F,CAAJ,EAAyG;QACrGxC,OAAO,CAAC,CAAD,CAAP,GAAakR,QAAQ,CAAC,CAAD,CAArB;QACAlR,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;MACH;IACJ,CATD,MAUK,IAAIwC,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA1C,EAAiD;MAClDxC,OAAO,CAAC,CAAD,CAAP,GAAakR,QAAQ,CAAC,CAAD,CAArB;MACAlR,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;IACH;;IACD,IAAIwC,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAzC,EAAkD;MAC9CxC,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;MACAA,OAAO,CAAC,CAAD,CAAP,GAAakR,QAAQ,CAAC,CAAD,CAArB;IACH;;IACD,OAAOlR,OAAP;EACH,CAtBD;;EAuBAsH,YAAY,CAAClL,SAAb,CAAuBwD,YAAvB,GAAsC,UAAUC,IAAV,EAAgBsR,SAAhB,EAA2B;IAC7D,IAAIvK,EAAJ;;IACA,IAAIlH,MAAM,GAAGyR,SAAS,CAACzR,MAAvB;IAAA,IAA+BoJ,eAAe,GAAGqI,SAAS,CAACrI,eAA3D;IACA,IAAIyH,GAAG,GAAGzH,eAAe,CAACpJ,MAAhB,CAAuBA,MAAvB,CAA8BP,MAAxC;IACA,IAAIiS,UAAU,GAAG,KAAK9T,MAAL,CAAY+T,cAAZ,IAA8B,KAAK/T,MAAL,CAAYkO,cAAZ,CAA2BC,IAA3B,KAAoC,WAAlE,GAAgF8E,GAAG,GAAG,CAAtF,GAA0FA,GAA3G;IACAzH,eAAe,CAACpJ,MAAhB,CAAuBA,MAAvB,GAAgCoJ,eAAe,CAACpJ,MAAhB,CAAuBA,MAAvB,CAA8BiI,KAA9B,CAAoC,CAApC,EAAuCyJ,UAAvC,CAAhC,CAL6D,CAKuB;;IACpFtI,eAAe,CAACpJ,MAAhB,CAAuBG,IAAvB,GAA8BuR,UAA9B;;IACA,CAACxK,EAAE,GAAGkC,eAAe,CAACpJ,MAAhB,CAAuBA,MAA7B,EAAqC4R,IAArC,CAA0CC,KAA1C,CAAgD3K,EAAhD,EAAoDlH,MAApD;;IACAoJ,eAAe,CAACpJ,MAAhB,CAAuBG,IAAvB,IAA+BH,MAAM,CAACP,MAAtC;EACH,CATD;;EAUAmI,YAAY,CAAClL,SAAb,CAAuBuK,OAAvB,GAAiC,UAAUrI,CAAV,EAAa;IAC1C,IAAI4H,IAAI,GAAG,KAAKF,YAAL,EAAX;IACA,IAAIY,EAAE,GAAG,KAAKlH,MAAL,CAAYM,OAArB;IAAA,IAA8BwR,MAAM,GAAG5K,EAAE,CAAC,CAAD,CAAzC;IAAA,IAA8C6K,MAAM,GAAG7K,EAAE,CAAC,CAAD,CAAzD;IACA,IAAI8K,MAAM,GAAGxL,IAAI,CAAC3F,OAAL,CAAa/B,SAAb,CAAuBC,QAAvB,CAAgCrB,QAAQ,CAACoR,OAAzC,CAAb;IACA,IAAImD,YAAY,GAAGD,MAAM,IAAKpT,CAAC,IAAIA,CAAC,CAACkE,MAAF,KAAa,OAAlB,KAA8B0D,IAAI,CAAC3F,OAAL,CAAa/B,SAAb,CAAuBC,QAAvB,CAAgC,qBAAhC,KACrDyH,IAAI,CAAC3F,OAAL,CAAa/B,SAAb,CAAuBC,QAAvB,CAAgC,mBAAhC,CADuB,CAA9B,CAJ0C,CAM1C;;IACA,IAAIuQ,EAAE,GAAG,CAACrF,IAAI,CAACC,GAAL,CAASjJ,QAAQ,CAACuF,IAAI,CAAC3F,OAAL,CAAawO,aAAb,CAA2BnO,YAA3B,CAAwCxD,QAAQ,CAAC6T,YAAjD,CAAD,EAAiE,EAAjE,CAAjB,EAAuFO,MAAvF,CAAD,EACL7H,IAAI,CAACC,GAAL,CAASjJ,QAAQ,CAACuF,IAAI,CAAC3F,OAAL,CAAaK,YAAb,CAA0BxD,QAAQ,CAACwU,YAAnC,CAAD,EAAmD,EAAnD,CAAjB,EAAyEH,MAAzE,CADK,CAAT;IAAA,IACuF5K,QAAQ,GAAGmI,EAAE,CAAC,CAAD,CADpG;IAAA,IACyGlI,SAAS,GAAGkI,EAAE,CAAC,CAAD,CADvH;IAEA,OAAO;MAAE/N,SAAS,EAAE,IAAb;MAAmB6O,UAAU,EAAE4B,MAA/B;MAAuClL,OAAO,EAAE,CAACK,QAAD,EAAWC,SAAX,CAAhD;MAAuE6K,YAAY,EAAEA;IAArF,CAAP;EACH,CAVD;;EAWArK,YAAY,CAAClL,SAAb,CAAuB8D,SAAvB,GAAmC,YAAY;IAC3C,IAAI4O,KAAK,GAAG,KAAKnB,QAAL,EAAZ;IACA,OAAO,UAAU9G,QAAV,EAAoBC,SAApB,EAA+BtE,MAA/B,EAAuC;MAC1C,IAAI,CAAC/F,iBAAiB,CAACqS,KAAK,CAACjP,IAAN,CAAWgH,QAAX,CAAD,CAAtB,EAA8C;QAC1C,IAAIyH,IAAI,GAAG,KAAK,CAAhB;QACAxH,SAAS,GAAGgI,KAAK,CAAClL,aAAN,CAAoB,aAApB,IAAqC,CAArC,GAAyCkD,SAArD;;QACA,IAAIgI,KAAK,CAACjP,IAAN,CAAWgH,QAAX,EAAqBsG,KAArB,CAA2B,CAA3B,EAA8B3O,SAA9B,CAAwCC,QAAxC,CAAiD,YAAjD,CAAJ,EAAoE;UAChE6P,IAAI,GAAGQ,KAAK,CAACjP,IAAN,CAAWgH,QAAX,EAAqBsG,KAArB,CAA2B,CAA3B,EAA8BqC,gBAA9B,CAA+C,IAA/C,EAAqD1I,SAArD,CAAP;QACH,CAFD,MAGK;UACDwH,IAAI,GAAGQ,KAAK,CAACjP,IAAN,CAAWgH,QAAX,EAAqBsG,KAArB,CAA2BrG,SAA3B,CAAP;QACH;;QACD,IAAI+K,WAAW,GAAGvD,IAAI,CAAChF,qBAAL,GAA6BwI,KAA7B,KAAuC,CAAzD;;QACA,IAAItP,MAAM,KAAK,OAAX,IAAsBA,MAAM,KAAK,YAArC,EAAmD;UAC/C,OAAOqP,WAAW,IAAIvD,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACoR,OAAjC,CAAtB;QACH;;QACD,IAAI,CAAChM,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,WAApC,KAAoD8L,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACoR,OAAjC,CAAxD,EAAmG;UAC/F,OAAOqD,WAAP;QACH,CAFD,MAGK,IAAIrP,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,WAAvC,EAAoD;UACrD,OAAOqP,WAAP;QACH;MACJ;;MACD,OAAO,KAAP;IACH,CAtBD;EAuBH,CAzBD;;EA0BAvK,YAAY,CAAClL,SAAb,CAAuBsS,iBAAvB,GAA2C,UAAUpQ,CAAV,EAAa;IACpD,IAAIsI,EAAE,GAAG,KAAKlH,MAAL,CAAYM,OAArB;IAAA,IAA8BgP,EAAE,GAAGpI,EAAE,CAAC,CAAD,CAArC;IAAA,IAA0C4K,MAAM,GAAGxC,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAC,CAAjB,GAAqBA,EAAxE;IAAA,IAA4EG,EAAE,GAAGvI,EAAE,CAAC,CAAD,CAAnF;IAAA,IAAwF6K,MAAM,GAAGtC,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAC,CAAjB,GAAqBA,EAAtH;;IACA,IAAIqC,MAAM,GAAG,CAAT,IAAcC,MAAM,GAAG,CAA3B,EAA8B;MAC1B,OAAO,IAAP;IACH;;IACD,IAAInD,IAAI,GAAG/R,QAAQ,CAACiV,MAAM,GAAG,SAAT,GAAqBC,MAAtB,EAA8B,KAAK9D,QAAL,GAAgB9N,IAA9C,CAAnB;;IACA,IAAI,CAACyO,IAAL,EAAW;MACP,OAAO,IAAP;IACH;;IACD,OAAOhQ,CAAC,CAACkE,MAAF,KAAa,OAAb,IAAwBlE,CAAC,CAACkE,MAAF,KAAa,YAArC,GACH8L,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACoR,OAAjC,KAA6C,CAACF,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,eAAxB,CAA9C,KACQ,CAAC6P,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,gBAAxB,CAAD,IAA8C6P,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,mBAAxB,CADtD,KAEO,CAAC6P,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAHL,GAG+C,IAHtD;EAIH,CAbD;;EAcA6I,YAAY,CAAClL,SAAb,CAAuB2V,eAAvB,GAAyC,YAAY;IACjD,OAAO,KAAKzU,MAAL,CAAY0U,cAAZ,IAA8B,KAAK1U,MAAL,CAAY2U,iBAAZ,CAA8BC,oBAAnE;EACH,CAFD;;EAGA,OAAO5K,YAAP;AACH,CAvSiC,EAAlC;;AAwSA,SAASA,YAAT;AACA;AACA;AACA;;AACA,IAAIG,WAAW;AAAG;AAAe,UAAU0K,MAAV,EAAkB;EAC/C3W,SAAS,CAACiM,WAAD,EAAc0K,MAAd,CAAT;;EACA,SAAS1K,WAAT,CAAqBnK,MAArB,EAA6B;IACzB,OAAO6U,MAAM,CAAC5C,IAAP,CAAY,IAAZ,EAAkBjS,MAAlB,KAA6B,IAApC;EACH;;EACDmK,WAAW,CAACrL,SAAZ,CAAsBuR,QAAtB,GAAiC,YAAY;IACzC,OAAQ,KAAKrQ,MAAL,CAAY2B,YAAZ,KACJ,KAAK3B,MAAL,CAAY8U,gBAAZ,GAA+BxO,aAA/B,CAA6C,2BAA7C,CADI,GAEJ,KAAKtG,MAAL,CAAY+U,cAAZ,EAFJ;EAGH,CAJD;;EAKA5K,WAAW,CAACrL,SAAZ,CAAsB2E,OAAtB,GAAgC,UAAUzC,CAAV,EAAa;IACzC,IAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;IACA,KAAKA,MAAL,GAAcA,MAAd;IACAA,MAAM,GAAIA,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0B,cAA1B,IAA4CF,MAA5C,GAAqD/B,OAAO,CAAC+B,MAAD,EAAS,IAAT,CAAtE;;IACA,IAAI,CAACA,MAAD,IAAW,KAAKjB,MAAL,CAAY0B,UAAZ,KAA2B,CAA1C,EAA6C;MACzCT,MAAM,GAAID,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4BrB,QAAQ,CAACoR,OAArC,IAAgDlQ,CAAC,CAACC,MAAlD,GACN/B,OAAO,CAAC8B,CAAC,CAACC,MAAH,EAAW,IAAX,CADX;IAEH;;IACD,IAAID,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,gBAA5B,KACAH,CAAC,CAACC,MAAF,CAASqF,aAAT,CAAuB,sBAAvB,CADJ,EACoD;MAChD,OAAO,KAAP;IACH;;IACD,IAAI,CAACrF,MAAL,EAAa;MACT;IACH;;IACD,IAAIqI,EAAE,GAAG,CAACrI,MAAM,CAACwQ,aAAP,CAAqBlI,QAAtB,EAAgCtI,MAAM,CAACuI,SAAvC,CAAT;IAAA,IAA4DD,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAAzE;IAAA,IAA8EE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA5F;IACA,IAAIiG,GAAG,GAAGtQ,QAAQ,CAACsK,QAAQ,GAAG,GAAX,GAAiBC,SAAlB,EAA6B,KAAKpH,MAAL,CAAYA,MAAzC,CAAlB;;IACA,IAAI,KAAKA,MAAL,CAAYqN,OAAZ,CAAoBF,GAApB,CAAJ,EAA8B;MAC1B,OAAO,KAAP;IACH;;IACD,KAAKnN,MAAL,CAAYS,MAAZ,CAAmB5B,MAAM,CAACwQ,aAAP,CAAqBlI,QAAxC,EAAkDtI,MAAM,CAACuI,SAAzD;EACH,CArBD;;EAsBAW,WAAW,CAACrL,SAAZ,CAAsB4J,YAAtB,GAAqC,YAAY;IAC7C,IAAIE,IAAI,GAAG,EAAX;IACA,IAAIU,EAAE,GAAG,KAAKlH,MAAL,CAAYM,OAArB;IAAA,IAA8BgP,EAAE,GAAGpI,EAAE,CAAC,CAAD,CAArC;IAAA,IAA0CC,QAAQ,GAAGmI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzE;IAAA,IAA6EG,EAAE,GAAGvI,EAAE,CAAC,CAAD,CAApF;IAAA,IAAyFE,SAAS,GAAGqI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzH;IACAjJ,IAAI,CAAC3F,OAAL,GAAe,KAAKoN,QAAL,GAAgB9N,IAAhB,CAAqBgH,QAArB,EAA+BsG,KAA/B,CAAqCrG,SAArC,CAAf;;IACA,IAAI,CAACrK,iBAAiB,CAACyJ,IAAI,CAAC3F,OAAN,CAAtB,EAAsC;MAClC2F,IAAI,CAACd,cAAL,GAAsB,KAAK8G,YAAL,CAAkBhG,IAAI,CAAC3F,OAAvB,CAAtB;MACA2F,IAAI,CAACvD,OAAL,GAAe,CAACuD,IAAI,CAAC3F,OAAL,CAAa/B,SAAb,CAAuBC,QAAvB,CAAgC,iBAAhC,CAAhB;IACH;;IACD,OAAOyH,IAAP;EACH,CATD;;EAUAuB,WAAW,CAACrL,SAAZ,CAAsB2D,QAAtB,GAAiC,UAAUyI,GAAV,EAAe8F,IAAf,EAAqB;IAClD,OAAQA,IAAI,CAACtG,OAAL,KAAiBsG,IAAI,CAAC2B,MAAL,CAAY5B,KAAZ,KAAsBd,SAAtB,IAAmCe,IAAI,CAACe,UAAxC,IAAsD,CAAC5S,iBAAiB,CAAC6R,IAAI,CAAC2B,MAAL,CAAYqC,QAAb,CAAzF,CAAD,IACHhE,IAAI,CAAC2B,MAAL,CAAYxE,IAAZ,KAAqB,UADlB,IACgC6C,IAAI,CAACyB,QAAL,KAAkBjT,QAAQ,CAACyV,aADlE;EAEH,CAHD;;EAIA9K,WAAW,CAACrL,SAAZ,CAAsByG,IAAtB,GAA6B,UAAUL,MAAV,EAAkBxC,OAAlB,EAA2B;IACpD,IAAI0Q,UAAU,GAAG,KAAKpT,MAAL,CAAYqT,kBAAZ,OACZnO,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAKuP,eAAL,EAArD,IAAgFvP,MAAM,KAAK,UAD/E,KAC8FxC,OAAO,CAAC,CAAD,CAAP,KAAe,CAD9H;IAEA,IAAI0J,KAAK,GAAG,CAAClH,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EAAvD,IACNvP,MAAM,KAAK,KADN,KACgBxC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY8M,OADvD;IAEA,IAAIoE,MAAM,GAAG,KAAKtT,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAAzC,IAAsDgI,KAAnE;;IACA,IAAI,KAAKpM,MAAL,CAAYmE,aAAZ,OAAgC,OAApC,EAA6C;MACzCiP,UAAU,GAAGhH,KAAb;IACH;;IACD,IAAImH,WAAW,GAAG,KAAKvT,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCwD,MAAM,KAAK,OAA7D;IACA,IAAIgQ,UAAJ;IACA,IAAIC,OAAJ;IACA,IAAIC,UAAU,GAAGhC,UAAU,IAAIE,MAA/B;IACA,IAAI+B,OAAO,GAAG,KAAKrV,MAAL,CAAYsV,WAAZ,CAAwBnN,OAAxB,IAAmC,KAAKnI,MAAL,CAAYsV,WAAZ,CAAwBnN,OAAxB,CAAgC/F,MAAhC,CAAuCA,MAAxF;IACA,IAAI+O,SAAS,GAAGkE,OAAO,IAAI,CAAClW,iBAAiB,CAACkW,OAAO,CAAC3S,OAAO,CAAC,CAAD,CAAR,CAAR,CAA7C;;IACA,IAAI,KAAK1C,MAAL,CAAYyB,iBAAZ,IAAiCyD,MAAM,KAAK,KAAhD,EAAuD;MACnDiQ,OAAO,GAAG,KAAK/S,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA5B,KAAkCa,OAAO,CAAC,CAAD,CAAnD;MACAwS,UAAU,GAAGxS,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BgE,WAA/B,CAA2C,CAA3C,CAA5B;;MACA,IAAIwO,UAAJ,EAAgB;QACZ,IAAI,CAACC,OAAL,EAAc;UACV,KAAK/S,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAlD;QACH,CAFD,MAGK;UACD,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAzB;QACH;;QACD,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;MACH;;MACD,IAAI,KAAK1C,MAAL,CAAY2B,YAAZ,MAA8BwT,OAA9B,IAAyCD,UAA7C,EAAyD;QACrD9B,UAAU,GAAG,IAAb;QACAgC,UAAU,GAAG,KAAb;MACH;IACJ;;IACD,OAAO;MACHjV,IAAI,EAAG,CAAC+E,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAvF,IACDsP,SAAS,KAAKiC,UAAU,IAAIE,MAAnB,CADR,IACwCpO,MAAM,KAAK,KAAX,IAAoBiQ,OAApB,IAA+BD,UAF1E;MAGH1P,QAAQ,EAAE4P,UAHP;MAIH3P,QAAQ,EAAE2N,UAJP;MAKH1N,aAAa,EAAE4N;IALZ,CAAP;EAOH,CAvCD;;EAwCAnJ,WAAW,CAACrL,SAAZ,CAAsB6G,cAAtB,GAAuC,UAAUiO,QAAV,EAAoBzT,IAApB,EAA0ByF,MAA1B,EAAkCV,MAAlC,EAA0C;IAC7E,IAAI0O,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAI2B,QAAQ,GAAG,EAAf;;IACA,IAAI,KAAKvV,MAAL,CAAYmE,aAAZ,OAAgC,OAAhC,IAA2C,KAAKnE,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAAxF,EAAmG;MAC/F,IAAIc,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAKuP,eAAL,EAArD,IAAgFvP,MAAM,KAAK,UAA/F,EAA2G;QACvGqQ,QAAQ,CAAC,CAAD,CAAR,GAAc3B,QAAQ,CAAC,CAAD,CAAtB;QACA2B,QAAQ,CAAC,CAAD,CAAR,GAAc3P,MAAM,CAACxD,MAAP,CAAc8M,OAAd,GAAwB,CAAtC;MACH;;MACD,IAAI,KAAKlP,MAAL,CAAYmE,aAAZ,OAAgCrE,QAAQ,CAACsE,SAAzC,KACIc,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EAAvD,IAAkFvP,MAAM,KAAK,KADjG,CAAJ,EAC6G;QACzGqQ,QAAQ,CAAC,CAAD,CAAR,GAAc3B,QAAQ,CAAC,CAAD,CAAtB;QACA2B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;IACJ,CAVD,MAWK,IAAIrQ,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EAAvD,IAAkFvP,MAAM,KAAK,KAAjG,EAAwG;MACzGqQ,QAAQ,CAAC,CAAD,CAAR,GAAc3B,QAAQ,CAAC,CAAD,CAAtB;MACA2B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,IAAIrQ,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,YAAvC,EAAqD;MACjDqQ,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAKnT,MAAL,CAAYA,MAAZ,CAAmBP,MAAjC;MACA0T,QAAQ,CAAC,CAAD,CAAR,GAAc3B,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,OAAO2B,QAAP;EACH,CAvBD;;EAwBApL,WAAW,CAACrL,SAAZ,CAAsBwD,YAAtB,GAAqC,UAAUC,IAAV,EAAgB;IACjD,IAAIV,MAAM,GAAG,KAAKO,MAAL,CAAYA,MAAZ,CAAmBP,MAAhC;;IACA,IAAI,KAAK7B,MAAL,CAAY+T,cAAZ,IAA8B,KAAK/T,MAAL,CAAYkO,cAAZ,CAA2BC,IAA3B,KAAoC,WAAtE,EAAmF;MAC/E,KAAK/L,MAAL,CAAYG,IAAZ,GAAmB,EAAE,KAAKH,MAAL,CAAYG,IAAjC;MACA,IAAIsN,KAAK,GAAGtN,IAAI,CAAC,CAAD,CAAJ,CAAQsN,KAApB;;MACA,KAAK,IAAIjE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiE,KAAK,CAAChO,MAA1B,EAAkC+J,CAAC,EAAnC,EAAuC;QACnC,KAAKxJ,MAAL,CAAY0M,GAAZ,CAAgBjN,MAAhB,EAAwB+J,CAAxB,EAA2BiE,KAAK,CAACjE,CAAD,CAAL,CAASlB,OAAT,IAAoBmF,KAAK,CAACjE,CAAD,CAAL,CAAS+G,MAAT,CAAgBoB,cAAhB,KAAmC,KAAlF;MACH;IACJ;EACJ,CATD;;EAUA5J,WAAW,CAACrL,SAAZ,CAAsBuK,OAAtB,GAAgC,UAAUrI,CAAV,EAAa;IACzC,OAAO1B,MAAM,CAACuV,MAAM,CAAC/V,SAAP,CAAiBuK,OAAjB,CAAyB4I,IAAzB,CAA8B,IAA9B,EAAoCjR,CAApC,CAAD,EAAyC;MAAE2C,SAAS,EAAE,KAAb;MAAoBE,QAAQ,EAAE;IAA9B,CAAzC,CAAb;EACH,CAFD;;EAGAsG,WAAW,CAACrL,SAAZ,CAAsB8D,SAAtB,GAAkC,YAAY;IAC1C,OAAO,YAAY;MAAE,OAAO,IAAP;IAAc,CAAnC;EACH,CAFD;;EAGAuH,WAAW,CAACrL,SAAZ,CAAsBsS,iBAAtB,GAA0C,UAAUpQ,CAAV,EAAa;IACnD,IAAIsI,EAAE,GAAG,KAAKlH,MAAL,CAAYM,OAArB;IAAA,IAA8B6G,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAA3C;IAAA,IAAgDyF,WAAW,GAAGzF,EAAE,CAAC,CAAD,CAAhE;;IACA,IAAIC,QAAQ,GAAG,CAAX,IAAgBwF,WAAW,GAAG,CAAlC,EAAqC;MACjC,OAAO,IAAP;IACH;;IACD,IAAIiC,IAAI,GAAG/R,QAAQ,CAACsK,QAAQ,GAAG,SAAX,GAAuBwF,WAAxB,EAAqC,KAAKsB,QAAL,GAAgB9N,IAArD,CAAnB;;IACA,IAAI,CAACyO,IAAL,EAAW;MACP,OAAO,IAAP;IACH;;IACD,OAAOhQ,CAAC,CAACkE,MAAF,KAAa,OAAb,IAAwBlE,CAAC,CAACkE,MAAF,KAAa,cAArC,GAAsD,CAAC8L,IAAI,CAAC9P,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAAvD,GAAiG,IAAxG;EACH,CAVD;;EAWA,OAAOgJ,WAAP;AACH,CA1IgC,CA0I/BH,YA1I+B,CAAjC;;AA2IA,SAASG,WAAT;;AACA,IAAIN,iBAAiB;AAAG;AAAe,UAAUgL,MAAV,EAAkB;EACrD3W,SAAS,CAAC2L,iBAAD,EAAoBgL,MAApB,CAAT;;EACA,SAAShL,iBAAT,GAA6B;IACzB,OAAOgL,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACZ,KAAP,CAAa,IAAb,EAAmBuB,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACD3L,iBAAiB,CAAC/K,SAAlB,CAA4BuR,QAA5B,GAAuC,YAAY;IAC/C,OAAO,KAAKrQ,MAAL,CAAYmC,UAAZ,GAAyBmE,aAAzB,CAAuC,2BAAvC,CAAP;EACH,CAFD;;EAGAuD,iBAAiB,CAAC/K,SAAlB,CAA4ByG,IAA5B,GAAmC,UAAUL,MAAV,EAAkBxC,OAAlB,EAA2B;IAC1D,IAAI6Q,WAAW,GAAG,KAAKvT,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCwD,MAAM,KAAK,YAA7D;IACA,IAAIM,QAAQ,GAAG,CAACN,MAAM,KAAK,SAAX,IAAwBqO,WAAzB,KAAyC7Q,OAAO,CAAC,CAAD,CAAP,KAAe,CAAvE;;IACA,IAAI,KAAK1C,MAAL,CAAYmE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAIhE,IAAI,GAAGqF,QAAQ,IAAK,CAACN,MAAM,KAAK,UAAX,IAAyBA,MAAM,KAAK,WAArC,KAAqDxC,OAAO,CAAC,CAAD,CAAP,KAAe,CAA5F;MACA,OAAO;QAAEvC,IAAI,EAAEA,IAAR;QAAcqF,QAAQ,EAAEA,QAAxB;QAAkCC,QAAQ,EAAED;MAA5C,CAAP;IACH;;IACD,OAAO;MACHrF,IAAI,EAAEqF,QAAQ,IAAK,CAACN,MAAM,KAAK,KAAX,IAAoBA,MAAM,KAAK,YAAhC,KAAiDxC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY8M,OAD5F;MAEH1J,QAAQ,EAAEA,QAFP;MAGHC,QAAQ,EAAED;IAHP,CAAP;EAKH,CAZD;;EAaAqE,iBAAiB,CAAC/K,SAAlB,CAA4B6G,cAA5B,GAA6C,UAAUiO,QAAV,EAAoBzT,IAApB,EAA0ByF,MAA1B,EAAkCV,MAAlC,EAA0C;IACnF,IAAI0O,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAI6B,QAAQ,GAAG,EAAf;;IACA,IAAI,KAAKzV,MAAL,CAAYmE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAIe,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA1C,EAAiD;QAC7CuQ,QAAQ,CAAC,CAAD,CAAR,GAAc7B,QAAQ,CAAC,CAAD,CAAtB;QACA6B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;IACJ,CALD,MAMK;MACD,IAAIvQ,MAAM,KAAK,KAAX,IAAoB,KAAKlF,MAAL,CAAYyB,iBAApC,EAAuD;QACnDgU,QAAQ,CAAC,CAAD,CAAR,GAAc7B,QAAQ,CAAC,CAAD,CAAtB;QACA6B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;;MACD,IAAIvQ,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,UAAzC,EAAqD;QACjDuQ,QAAQ,CAAC,CAAD,CAAR,GAAc7B,QAAQ,CAAC,CAAD,CAAtB;QACA6B,QAAQ,CAAC,CAAD,CAAR,GAAc7P,MAAM,CAACxD,MAAP,CAAc8M,OAAd,GAAwB,CAAtC;MACH;IACJ;;IACD,IAAIhK,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAzC,EAAkD;MAC9CuQ,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAc7B,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,OAAO6B,QAAP;EACH,CAxBD;;EAyBA,OAAO5L,iBAAP;AACH,CA/CsC,CA+CrCG,YA/CqC,CAAvC;;AAgDA,SAASH,iBAAT;;AACA,IAAII,gBAAgB;AAAG;AAAe,UAAU4K,MAAV,EAAkB;EACpD3W,SAAS,CAAC+L,gBAAD,EAAmB4K,MAAnB,CAAT;;EACA,SAAS5K,gBAAT,GAA4B;IACxB,OAAO4K,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACZ,KAAP,CAAa,IAAb,EAAmBuB,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACDvL,gBAAgB,CAACnL,SAAjB,CAA2ByG,IAA3B,GAAkC,UAAUL,MAAV,EAAkBxC,OAAlB,EAA2B;IACzD,IAAI6Q,WAAW,GAAG,KAAKvT,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCwD,MAAM,KAAK,OAA7D;IACA,IAAIwQ,OAAO,GAAG,KAAK1V,MAAL,CAAYsV,WAAZ,CAAwBjN,MAAxB,IAAkC,KAAKrI,MAAL,CAAYsV,WAAZ,CAAwBjN,MAAxB,CAA+BjG,MAA/B,CAAsCA,MAAtF;IACA,IAAI+O,SAAS,GAAGuE,OAAO,IAAI,CAACvW,iBAAiB,CAACuW,OAAO,CAAChT,OAAO,CAAC,CAAD,CAAR,CAAR,CAA7C;;IACA,IAAI,KAAK1C,MAAL,CAAYmE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAImP,MAAM,GAAG,CAACpO,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAKuP,eAAL,EAArD,IACPvP,MAAM,KAAK,UADL,KACoBxC,OAAO,CAAC,CAAD,CAAP,KAAe,CADhD;MAEA,IAAIvC,IAAI,GAAI,CAAC+E,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAvF,IACNsP,SAAS,IAAImC,MADlB;MAEA,IAAI7N,QAAQ,GAAG,CAACP,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAArG;MACA,OAAO;QAAE1B,IAAI,EAAEA,IAAR;QAAcqF,QAAQ,EAAE8N,MAAxB;QAAgC7N,QAAQ,EAAEA;MAA1C,CAAP;IACH;;IACD,OAAO;MACHtF,IAAI,EAAE,CAAC+E,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAtF,IAA4F,CAACqD,MAAM,KAAK,YAAX,IAC9FA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EADmE,IACxCvP,MAAM,KAAK,KAD4B,KAE9FxC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY8M,OAFmE,IAExDiC,SAHvC;MAIH3L,QAAQ,EAAE,CAACN,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EAAvD,IAAkFvP,MAAM,KAAK,KAA9F,KACNxC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY8M,OAL5B;MAMHzJ,QAAQ,EAAE,CAACP,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B;IAN7F,CAAP;EAQH,CApBD;;EAqBAoI,gBAAgB,CAACnL,SAAjB,CAA2BuR,QAA3B,GAAsC,YAAY;IAC9C,OAAQ,KAAKrQ,MAAL,CAAY8U,gBAAZ,GAA+BxO,aAA/B,CAA6C,0BAA7C,CAAR;EACH,CAFD;;EAGA2D,gBAAgB,CAACnL,SAAjB,CAA2B6G,cAA3B,GAA4C,UAAUiO,QAAV,EAAoBzT,IAApB,EAA0ByF,MAA1B,EAAkCV,MAAlC,EAA0C;IAClF,IAAI0O,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAI+B,QAAQ,GAAG,EAAf;;IACA,IAAI,KAAK3V,MAAL,CAAYmE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAIe,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EAAvD,IAAkFvP,MAAM,KAAK,KAAjG,EAAwG;QACpGyQ,QAAQ,CAAC,CAAD,CAAR,GAAc/B,QAAQ,CAAC,CAAD,CAAtB;QACA+B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;IACJ,CALD,MAMK;MACD,IAAIzQ,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAKuP,eAAL,EAArD,IAAgFvP,MAAM,KAAK,UAA/F,EAA2G;QACvGyQ,QAAQ,CAAC,CAAD,CAAR,GAAc/B,QAAQ,CAAC,CAAD,CAAtB;QACA+B,QAAQ,CAAC,CAAD,CAAR,GAAc/P,MAAM,CAACxD,MAAP,CAAc8M,OAAd,GAAwB,CAAtC;MACH;IACJ;;IACD,IAAIhK,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,YAAvC,EAAqD;MACjDyQ,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAKvT,MAAL,CAAYA,MAAZ,CAAmBP,MAAjC;MACA8T,QAAQ,CAAC,CAAD,CAAR,GAAc/B,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,OAAO+B,QAAP;EACH,CApBD;;EAqBA,OAAO1L,gBAAP;AACH,CAnDqC,CAmDpCE,WAnDoC,CAAtC;;AAoDA,SAASF,gBAAT;AACA;;AACA,IAAI2L,SAAS;AAAG;AAAe,YAAY;EACvC,SAASA,SAAT,CAAmBC,SAAnB,EAA8B;IAC1B,KAAKA,SAAL,GAAiBA,SAAjB;EACH;;EACDD,SAAS,CAAC9W,SAAV,CAAoBgX,WAApB,GAAkC,UAAUlM,IAAV,EAAgB;IAC9CA,IAAI,CAAC3I,MAAL,CAAYwQ,aAAZ,CAA0BvQ,SAA1B,CAAoC4L,GAApC,CAAwC,eAAxC;EACH,CAFD;;EAGA8I,SAAS,CAAC9W,SAAV,CAAoBiX,UAApB,GAAiC,UAAUnM,IAAV,EAAgB;IAC7CA,IAAI,CAAC3I,MAAL,CAAYwQ,aAAZ,CAA0BvQ,SAA1B,CAAoCmN,MAApC,CAA2C,eAA3C;EACH,CAFD;;EAGAuH,SAAS,CAAC9W,SAAV,CAAoBkX,SAApB,GAAgC,YAAY;IACxC,IAAI,KAAKH,SAAT,EAAoB;MAChB7W,YAAY,CAAC8N,GAAb,CAAiB,KAAK+I,SAAtB,EAAiC,OAAjC,EAA0C,KAAKC,WAA/C,EAA4D,IAA5D;MACA9W,YAAY,CAAC8N,GAAb,CAAiB,KAAK+I,SAAtB,EAAiC,MAAjC,EAAyC,KAAKE,UAA9C,EAA0D,IAA1D;IACH;EACJ,CALD;;EAMAH,SAAS,CAAC9W,SAAV,CAAoBmX,WAApB,GAAkC,YAAY;IAC1C,IAAI,KAAKJ,SAAT,EAAoB;MAChB7W,YAAY,CAACqP,MAAb,CAAoB,KAAKwH,SAAzB,EAAoC,OAApC,EAA6C,KAAKC,WAAlD;MACA9W,YAAY,CAACqP,MAAb,CAAoB,KAAKwH,SAAzB,EAAoC,MAApC,EAA4C,KAAKE,UAAjD;IACH;EACJ,CALD;;EAMA,OAAOH,SAAP;AACH,CAvB8B,EAA/B;;AAwBA,SAASA,SAAT;;AACA,IAAI7L,sBAAsB;AAAG;AAAe,UAAU8K,MAAV,EAAkB;EAC1D3W,SAAS,CAAC6L,sBAAD,EAAyB8K,MAAzB,CAAT;;EACA,SAAS9K,sBAAT,GAAkC;IAC9B,OAAO8K,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACZ,KAAP,CAAa,IAAb,EAAmBuB,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACDzL,sBAAsB,CAACjL,SAAvB,CAAiCuR,QAAjC,GAA4C,YAAY;IACpD,OAAO,KAAKrQ,MAAL,CAAYmC,UAAZ,GAAyBmE,aAAzB,CAAuC,kCAAvC,CAAP;EACH,CAFD;;EAGAyD,sBAAsB,CAACjL,SAAvB,CAAiCyG,IAAjC,GAAwC,UAAUL,MAAV,EAAkBxC,OAAlB,EAA2B;IAC/D,IAAI6Q,WAAW,GAAG,KAAKvT,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCwD,MAAM,KAAK,YAA7D;IACA,IAAIM,QAAQ,GAAG,CAACN,MAAM,KAAK,SAAX,IAAwBqO,WAAzB,KAAyC7Q,OAAO,CAAC,CAAD,CAAP,KAAe,CAAvE;IACA,OAAO;MACHvC,IAAI,EAAEqF,QAAQ,IAAK,CAACN,MAAM,KAAK,UAAX,IAAyBA,MAAM,KAAK,WAArC,KAAqDxC,OAAO,CAAC,CAAD,CAAP,KAAe,CADpF;MAEH8C,QAAQ,EAAEA,QAFP;MAGHE,aAAa,EAAEF;IAHZ,CAAP;EAKH,CARD;;EASAuE,sBAAsB,CAACjL,SAAvB,CAAiC6G,cAAjC,GAAkD,UAAUiO,QAAV,EAAoBzT,IAApB,EAA0ByF,MAA1B,EAAkCV,MAAlC,EAA0C;IACxF,IAAI0O,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAI6B,QAAQ,GAAG,EAAf;;IACA,IAAIvQ,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA1C,EAAiD;MAC7CuQ,QAAQ,CAAC,CAAD,CAAR,GAAc7B,QAAQ,CAAC,CAAD,CAAtB;MACA6B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,IAAIvQ,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAzC,EAAkD;MAC9CuQ,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAc7B,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,OAAO6B,QAAP;EACH,CAZD;;EAaA,OAAO1L,sBAAP;AACH,CA/B2C,CA+B1CC,YA/B0C,CAA5C;;AAgCA,SAASD,sBAAT;;AACA,IAAIG,qBAAqB;AAAG;AAAe,UAAU2K,MAAV,EAAkB;EACzD3W,SAAS,CAACgM,qBAAD,EAAwB2K,MAAxB,CAAT;;EACA,SAAS3K,qBAAT,GAAiC;IAC7B,OAAO2K,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACZ,KAAP,CAAa,IAAb,EAAmBuB,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACDtL,qBAAqB,CAACpL,SAAtB,CAAgCyG,IAAhC,GAAuC,UAAUL,MAAV,EAAkBxC,OAAlB,EAA2B;IAC9D,IAAIwT,SAAS,GAAG,KAAKlW,MAAL,CAAYsV,WAAZ,CAAwBjN,MAAxB,IAAkC,KAAKrI,MAAL,CAAYsV,WAAZ,CAAwBjN,MAAxB,CAA+BjG,MAA/B,CAAsCA,MAAxF;IACA,IAAI+O,SAAS,GAAG+E,SAAS,IAAI,CAAC/W,iBAAiB,CAAC+W,SAAS,CAACxT,OAAO,CAAC,CAAD,CAAR,CAAV,CAA/C;IACA,IAAI6Q,WAAW,GAAG,KAAKvT,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCwD,MAAM,KAAK,OAA7D;IACA,IAAIkO,UAAU,GAAG,CAAClO,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAKuP,eAAL,EAArD,IACXvP,MAAM,KAAK,UADD,KACgBxC,OAAO,CAAC,CAAD,CAAP,KAAe,CADhD;IAEA,IAAIvC,IAAI,GAAI,CAAC+E,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAvF,IACNsP,SAAS,IAAIiC,UADlB;IAEA,IAAI3N,QAAQ,GAAG,CAACP,MAAM,KAAK,WAAX,IAA0BqO,WAA3B,KAA2C7Q,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAArG;IACA,OAAO;MAAE1B,IAAI,EAAEA,IAAR;MAAcqF,QAAQ,EAAE4N,UAAxB;MAAoC1N,aAAa,EAAED;IAAnD,CAAP;EACH,CAVD;;EAWAyE,qBAAqB,CAACpL,SAAtB,CAAgCuR,QAAhC,GAA2C,YAAY;IACnD,OAAQ,KAAKrQ,MAAL,CAAY8U,gBAAZ,GAA+BxO,aAA/B,CAA6C,iCAA7C,CAAR;EACH,CAFD;;EAGA4D,qBAAqB,CAACpL,SAAtB,CAAgC6G,cAAhC,GAAiD,UAAUiO,QAAV,EAAoBzT,IAApB,EAA0ByF,MAA1B,EAAkCV,MAAlC,EAA0C;IACvF,IAAI0O,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAI+B,QAAQ,GAAG,EAAf;;IACA,IAAIzQ,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAKuP,eAAL,EAAvD,IAAkFvP,MAAM,KAAK,KAAjG,EAAwG;MACpGyQ,QAAQ,CAAC,CAAD,CAAR,GAAc/B,QAAQ,CAAC,CAAD,CAAtB;MACA+B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAd;IACH;;IACD,IAAIzQ,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,YAAvC,EAAqD;MACjDyQ,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAKvT,MAAL,CAAYA,MAAZ,CAAmBP,MAAjC;MACA8T,QAAQ,CAAC,CAAD,CAAR,GAAc/B,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,OAAO+B,QAAP;EACH,CAZD;;EAaA,OAAOzL,qBAAP;AACH,CAjC0C,CAiCzCC,WAjCyC,CAA3C;;AAkCA,SAASD,qBAAT"},"metadata":{},"sourceType":"module"}