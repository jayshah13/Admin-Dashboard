{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\n\nvar DragAndDrop =\n/** @class */\nfunction (_super) {\n  __extends(DragAndDrop, _super);\n\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    _this.isCursorAhead = false;\n    return _this;\n  }\n\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.dragArea,\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  };\n\n  DragAndDrop.prototype.setDragArea = function () {\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    this.dragArea = this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n  };\n\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    var elements = [];\n\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n\n      _this.actionObj.cloneElement.push(cloneElement);\n\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n\n    var cloneRight;\n\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n\n    var topValue;\n\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (!isNullOrUndefined(eventObj)) {\n      this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    }\n\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n\n        _this.actionObj.action = '';\n\n        _this.removeCloneElementClasses();\n\n        _this.removeCloneElement();\n\n        return;\n      }\n\n      _this.actionClass('addClass');\n\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n\n        _this.actionObj.pageX = e.event.pageX;\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isStepDragging = !_this.isTimelineDayProcess && _this.actionObj.slotInterval !== _this.actionObj.interval;\n\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n\n        _this.updateOriginalElement(_this.actionObj.clone);\n\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n\n        _this.verticalEvent.initializeValues();\n\n        var splitEvents = _this.splitEvent(_this.actionObj.event);\n\n        splitEvents.forEach(function (event) {\n          var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n\n          if (_this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n          }\n\n          var appWrap = _this.parent.element.querySelector(query);\n\n          if (appWrap) {\n            var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n\n            if (appEle) {\n              addClass([appEle], cls.EVENT_ACTION_CLASS);\n            }\n          }\n        });\n      }\n    });\n  };\n\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n\n    return this.multiData;\n  };\n\n  DragAndDrop.prototype.drag = function (e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(events.drag, dragArgs);\n  };\n\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n\n    this.isCursorAhead = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n\n    var target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n\n      if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n\n              _this.viewNavigation(e);\n\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n\n      if (!isNullOrUndefined(outWrapper)) {\n        var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n        if (!tarWrapper_1) {\n          tarWrapper_1 = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outWrapper.appendChild(tarWrapper_1);\n        }\n\n        this.actionObj.cloneElement.forEach(function (ele) {\n          tarWrapper_1.appendChild(ele);\n        });\n      }\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper);\n  };\n\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = eventEnd.getTime() - eventStart.getTime();\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n\n    var index;\n\n    if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n\n    var td = tr.children[colIndex];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    var dragStart;\n    var dragEnd;\n\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n\n      this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n\n    for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n      var wrapper = dynamicWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n        this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n        var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n\n        if (dayIndex >= 0) {\n          var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n          this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n            remove(this.actionObj.cloneElement[index_1]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n\n  DragAndDrop.prototype.splitEvent = function (event) {\n    var eventFields = this.parent.eventFields;\n    var eventData = [];\n    var startTime = event[eventFields.startTime];\n    var endTime = event[eventFields.endTime];\n\n    if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n      var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n      var endReferenceDate = new Date(startReferenceDate.getTime());\n\n      for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n        endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        var eventObj = extend({}, event, null, true);\n        eventObj[eventFields.startTime] = new Date(startReferenceDate);\n        eventObj[eventFields.endTime] = new Date(endReferenceDate);\n        startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        eventData.push(eventObj);\n      }\n\n      var index = eventData.length - 1;\n      eventData[0][eventFields.startTime] = startTime;\n      eventData[index][eventFields.endTime] = endTime;\n    } else {\n      eventData.push(event);\n    }\n\n    return eventData;\n  };\n\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    this.targetTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n\n    return this.targetTd.cellIndex;\n  };\n\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = 0;\n\n    if (!this.parent.uiStateValues.isGroupAdaptive) {\n      for (var i = 0; i < this.actionObj.groupIndex; i++) {\n        datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n      }\n    }\n\n    var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dynamicIndex = -1;\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime( // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var splitEvents = this.splitEvent(event);\n      var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n\n      for (var i = 0; i < events_1.length; i++) {\n        if (i > 0) {\n          var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n\n          var appWrap = this.parent.element.querySelector(filterQuery);\n\n          if (appWrap) {\n            dayIndex = dayIndex + 1;\n            dynamicIndex = appWrap.cellIndex;\n          } else {\n            dayIndex = -1;\n          }\n        }\n\n        if (dayIndex >= 0) {\n          var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n          var eStart = record[this.verticalEvent.fields.startTime];\n          var eEnd = record[this.verticalEvent.fields.endTime];\n          var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n          var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n\n          if (isNullOrUndefined(index)) {\n            if (i === 0) {\n              this.actionObj.clone.style.top = formatUnit(topValue);\n              this.actionObj.clone.style.height = formatUnit(appHeight);\n            } else {\n              this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n            }\n          } else {\n            var appWidth = this.actionObj.cellWidth;\n\n            if (event[this.parent.eventFields.isAllDay]) {\n              topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n              appHeight = this.getAllDayEventHeight();\n              var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n              var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\n              if (allDayDifference >= 0) {\n                appWidth = allDayDifference * this.actionObj.cellWidth;\n              }\n            }\n\n            if (this.actionObj.cloneElement[index]) {\n              if (i === 0) {\n                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n              } else {\n                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n\n  DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n    var startTime = record[this.parent.eventFields.startTime].getTime();\n    var endTime = record[this.parent.eventFields.endTime].getTime();\n\n    if (startTime !== endTime) {\n      var appointmentElement = this.verticalEvent.createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n      addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': height + 'px',\n        'top': top + 'px',\n        'border': '0px'\n      });\n      var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n      appointmentWrap[index].appendChild(appointmentElement);\n    }\n  };\n\n  DragAndDrop.prototype.getRenderedDates = function () {\n    var _this = this;\n\n    var _a, _b;\n\n    var renderDates = this.parent.activeView.renderDates;\n\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n\n    return renderDates;\n  };\n\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.getRenderedDates();\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex)); // eslint-disable-next-line max-len\n\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.swapDragging = function (e) {\n    var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false; // eslint-disable-next-line max-len\n\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(this.actionObj.target, 'td');\n\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var dragEnd = new Date(dragStart.getTime());\n        var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() - util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])).getTime();\n        dragStart = new Date(dragStart.getTime() + startTimeDiff);\n        dragEnd = new Date(dragStart.getTime() + eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n\n    for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n      var wrapper = eventWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n\n      if (widthDiff !== 0) {\n        var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if (this.isCursorAhead || cursorDrag) {\n        eventStart.setMinutes(eventStart.getMinutes() + (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n        eventStart.setMilliseconds(-eventDuration);\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n\n    eventStart = this.calculateIntervalTime(eventStart);\n\n    if (this.isTimelineDayProcess) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetDate = this.parent.getDateFromElement(e.target);\n\n      if (!isNullOrUndefined(targetDate)) {\n        if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'TimelineMonth') {\n          var eventSrt = eventObj[this.parent.eventFields.startTime];\n          eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n        } else {\n          eventStart = targetDate;\n        }\n      }\n    }\n\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n\n      eventsData = this.updatedData;\n    }\n\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      var eventData = events_2[0].data;\n      var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n      var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData); // eslint-disable-next-line max-len\n\n      var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count); // eslint-disable-next-line max-len\n\n      var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n\n    return offsetLeft;\n  };\n\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[index].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n\n    return 0;\n  };\n\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n\n    if (this.isHeaderRows) {\n      return index;\n    }\n\n    return this.getIndex(index);\n  };\n\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n\n    cloneElement.style.top = formatUnit(top);\n  };\n\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n\n    return eventWrapper;\n  };\n\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n\n    return isAllowDrop;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n\n\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n\n  return DragAndDrop;\n}(ActionBase);\n\nexport { DragAndDrop };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","isCursorAhead","wireDragEvent","element","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTapHold","parent","isAdaptive","enableTailMode","eventDragArea","cursorAt","left","top","dragArea","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","setDragArea","dragElement","document","querySelector","CONTENT_TABLE_CLASS","e","setDragActionDefaultValues","actionObj","action","elements","allowMultiDrag","selectedElements","length","indexOf","forEach","ele","cloneElement","createCloneElement","getAttribute","currentView","activeViewOptions","timeScale","enable","activeView","isTimelineView","classList","contains","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","style","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","cloneRight","Math","ceil","getBoundingClientRect","CONTENT_WRAP_CLASS","contentWrapRight","enableRtl","pageX","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","offsetWidth","cellWidth","height","pointerEvents","top_1","parseInt","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","eventBase","getEventByGuid","eventObj","eventFields","getTime","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","dragObj","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","uiStateValues","start","end","endTime","groupIndex","viewElement","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","initializeValues","splitEvents","splitEvent","query","group","resources","concat","appWrap","appEle","EVENT_ACTION_CLASS","_i","_a","quickPopup","quickPopupHide","target","DISABLE_DATES","eventArgs","getPageCoordinates","Y","pageY","X","abs","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","allowGroupEdit","rowAutoHeight","virtualScrollModule","byGroupID","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","floor","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","isGroupAdaptive","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","updateAllDayEvents","byDate","undefined","getUpdatedEvent","dynamicWrappers","dynamicWrappers_1","wrapper","targetCellTime_1","eventObj_1","startTimeDiff","index_1","updateMultipleData","dayIndex","getDayIndex","updateEventHeight","parentNode","updateTimePosition","eventData","startReferenceDate","endReferenceDate","i","timeDifference","endTimeDiff","differInDays","day","DAY_WRAPPER_CLASS","datesCount","indexGroup","dynamicIndex","getIndexOfDate","events_1","isAllDayAppointment","eventSettings","spannedEventPlacement","filterQuery","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","renderSpannedEvents","appWidth","timeDiff","allDayDifference","appointmentElement","createAppointmentElement","isSpanned","CLONE_ELEMENT_CLASS","appointmentWrap","getRenderedDates","_b","slots","map","filter","res","endDate","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","calculateIntervalTime","eventSrt","targetDate","eventsData","dataIndex","events_2","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","currentIndex","trCollection","translateY","getTranslateY","rowHeight","scrollY","isNaN","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    function DragAndDrop() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.widthUptoCursorPoint = 0;\n        _this.heightUptoCursorPoint = 0;\n        _this.cursorPointIndex = 0;\n        _this.isHeaderRows = false;\n        _this.isTimelineDayProcess = false;\n        _this.widthPerMinute = 0;\n        _this.heightPerMinute = 0;\n        _this.minDiff = 0;\n        _this.isStepDragging = false;\n        _this.isMorePopupOpened = false;\n        _this.isAllDayDrag = false;\n        _this.isMultiSelect = false;\n        _this.multiData = [];\n        _this.updatedData = [];\n        _this.swagData = [];\n        _this.startTime = 0;\n        _this.isAllDayTarget = false;\n        _this.targetTd = null;\n        _this.isCursorAhead = false;\n        return _this;\n    }\n    DragAndDrop.prototype.wireDragEvent = function (element) {\n        new Draggable(element, {\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTapHold: this.parent.isAdaptive,\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: this.dragArea,\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n    };\n    DragAndDrop.prototype.setDragArea = function () {\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        this.dragArea = this.parent.eventDragArea && dragElement ? dragElement :\n            this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n    };\n    DragAndDrop.prototype.dragHelper = function (e) {\n        var _this = this;\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        this.actionObj.action = 'drag';\n        var elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach(function (ele) {\n            var cloneElement = _this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n                _this.actionObj.clone = cloneElement;\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n            }\n            _this.actionObj.cloneElement.push(cloneElement);\n            _this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    };\n    DragAndDrop.prototype.dragPosition = function (e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        var leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        var cloneRight;\n        if (this.isStepDragging) {\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n        }\n        else {\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n            this.isCursorAhead = true;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        var topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            var top_1 = parseInt(e.top, 10);\n            top_1 = top_1 < 0 ? 0 : top_1;\n            topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n        }\n        return { left: leftValue, top: topValue };\n    };\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    };\n    DragAndDrop.prototype.dragStart = function (e) {\n        var _this = this;\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (!isNullOrUndefined(eventObj)) {\n            this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        }\n        var dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\n                var dragObj = _this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                _this.actionObj.action = '';\n                _this.removeCloneElementClasses();\n                _this.removeCloneElement();\n                return;\n            }\n            _this.actionClass('addClass');\n            _this.parent.uiStateValues.action = true;\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            _this.actionObj.interval = dragEventArgs.interval;\n            _this.actionObj.navigation = dragEventArgs.navigation;\n            _this.actionObj.scroll = dragEventArgs.scroll;\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.widthUptoCursorPoint = 0;\n            _this.heightUptoCursorPoint = 0;\n            _this.cursorPointIndex = -1;\n            _this.isHeaderRows = false;\n            _this.isTimelineDayProcess = false;\n            _this.minDiff = 0;\n            _this.isMorePopupOpened = false;\n            _this.daysVariation = -1;\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n                    _this.isMorePopupOpened = true;\n                }\n                _this.actionObj.pageX = e.event.pageX;\n                var rows = _this.parent.activeViewOptions.headerRows;\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                _this.isStepDragging = !_this.isTimelineDayProcess && (_this.actionObj.slotInterval !== _this.actionObj.interval);\n                if (_this.isTimelineDayProcess) {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n                }\n                else {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n                }\n            }\n            if (_this.parent.currentView === 'TimelineYear') {\n                _this.yearEvent = new YearEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Month') {\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n                _this.updateOriginalElement(_this.actionObj.clone);\n                _this.monthEvent = new MonthEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n                _this.verticalEvent = new VerticalEvent(_this.parent);\n                _this.verticalEvent.initializeValues();\n                var splitEvents = _this.splitEvent(_this.actionObj.event);\n                splitEvents.forEach(function (event) {\n                    var query = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(event[_this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (_this.parent.activeViewOptions.group.resources.length > 0) {\n                        query = query.concat('[data-group-index = \"' + _this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = _this.parent.element.querySelector(query);\n                    if (appWrap) {\n                        var appEle = appWrap.querySelector('[data-id=\"' + _this.actionObj.clone.getAttribute('data-id') + '\"]');\n                        if (appEle) {\n                            addClass([appEle], cls.EVENT_ACTION_CLASS);\n                        }\n                    }\n                });\n            }\n        });\n    };\n    DragAndDrop.prototype.getSelectedData = function () {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n                var element = _a[_i];\n                var eventGuid = element.getAttribute('data-guid');\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    };\n    DragAndDrop.prototype.drag = function (e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(cls.DISABLE_DATES)) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventArgs = this.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n            this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\n            this.actionObj.event[this.parent.eventFields.isAllDay];\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            var date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                var currentDate = util.resetTime(date);\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            var targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        var dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(events.drag, dragArgs);\n    };\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        var startDate = eventObj[this.parent.eventFields.startTime];\n        var startTime = this.parent.activeView.renderDates[0];\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\n        }\n    };\n    DragAndDrop.prototype.dragStop = function (e) {\n        var _this = this;\n        this.isCursorAhead = false;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        this.actionObj.action = null;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        var target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        var dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit\n                && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n                _this.parent.crudModule.crudObj.isCrudAction = true;\n                _this.parent.crudModule.crudObj.sourceEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n                _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n            }\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    };\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n        var _this = this;\n        if (this.actionObj.navigation.enable) {\n            var currentDate_1 = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(function () {\n                    if (currentDate_1) {\n                        var crtDate = _this.parent.getCurrentTime();\n                        var end = crtDate.getSeconds();\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate_1 = _this.parent.getCurrentTime();\n                            _this.viewNavigation(e);\n                            _this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    };\n    DragAndDrop.prototype.navigationWrapper = function () {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    var elementHeight = this.getAllDayEventHeight();\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event_2[0].offsetHeight < elementHeight) {\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n                            var e = event_1[_i];\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            var outWrapper = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n            }\n            if (!isNullOrUndefined(outWrapper)) {\n                var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!tarWrapper_1) {\n                    tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outWrapper.appendChild(tarWrapper_1);\n                }\n                this.actionObj.cloneElement.forEach(function (ele) {\n                    tarWrapper_1.appendChild(ele);\n                });\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.viewNavigation = function (e) {\n        var navigationType;\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    };\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n            return;\n        }\n        var dragStart = this.parent.getDateFromElement(td);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        var eventContainer = td;\n        var eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            var rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    };\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\n        var _this = this;\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventStart = eventObj[this.parent.eventFields.startTime];\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\n        var eventDuration = eventEnd.getTime() - eventStart.getTime();\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\n        }\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        var tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n        }\n        else {\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[rowIndex];\n        }\n        var index;\n        if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        var td = tr.children[colIndex];\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var dragStart;\n        var dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart.getTime());\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n            }\n            this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n        }\n        this.actionObj.start = new Date(+dragStart);\n        this.actionObj.end = new Date(+dragEnd);\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n        for (var _i = 0, dynamicWrappers_1 = dynamicWrappers; _i < dynamicWrappers_1.length; _i++) {\n            var wrapper = dynamicWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach(function (data) {\n                    _this.swagData.push(extend({}, data, null, true));\n                    if (data[_this.parent.eventFields.isAllDay]) {\n                        data[_this.parent.eventFields.startTime] =\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n                        data[_this.parent.eventFields.endTime] = endTime;\n                        data[_this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime_1;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n            }\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n                this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n                var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n                if (dayIndex >= 0) {\n                    var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n                    this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n                }\n                else {\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n                        remove(this.actionObj.cloneElement[index_1]);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    };\n    DragAndDrop.prototype.splitEvent = function (event) {\n        var eventFields = this.parent.eventFields;\n        var eventData = [];\n        var startTime = event[eventFields.startTime];\n        var endTime = event[eventFields.endTime];\n        if (util.resetTime(new Date(startTime.getTime())) < util.resetTime(new Date(endTime.getTime()))) {\n            var startReferenceDate = util.resetTime(new Date(startTime.getTime()));\n            var endReferenceDate = new Date(startReferenceDate.getTime());\n            for (var i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n                endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                var eventObj = extend({}, event, null, true);\n                eventObj[eventFields.startTime] = new Date(startReferenceDate);\n                eventObj[eventFields.endTime] = new Date(endReferenceDate);\n                startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                eventData.push(eventObj);\n            }\n            var index = eventData.length - 1;\n            eventData[0][eventFields.startTime] = startTime;\n            eventData[index][eventFields.endTime] = endTime;\n        }\n        else {\n            eventData.push(event);\n        }\n        return eventData;\n    };\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    };\n    DragAndDrop.prototype.getDayIndex = function (event) {\n        var eventObj = extend({}, event, null, true);\n        var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n        var query = '';\n        var wrapper = cls.DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = cls.WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    };\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        var datesCount = 0;\n        if (!this.parent.uiStateValues.isGroupAdaptive) {\n            for (var i = 0; i < this.actionObj.groupIndex; i++) {\n                datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n            }\n        }\n        var indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n        var target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            var dynamicIndex = -1;\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], util.resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            var splitEvents = this.splitEvent(event);\n            var events_1 = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ||\n                this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n            for (var i = 0; i < events_1.length; i++) {\n                if (i > 0) {\n                    var filterQuery = \".e-day-wrapper[data-date=\\\"\" + util.resetTime(events_1[i][this.parent.eventFields.startTime]).getTime() + \"\\\"]\";\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n                    }\n                    var appWrap = this.parent.element.querySelector(filterQuery);\n                    if (appWrap) {\n                        dayIndex = dayIndex + 1;\n                        dynamicIndex = appWrap.cellIndex;\n                    }\n                    else {\n                        dayIndex = -1;\n                    }\n                }\n                if (dayIndex >= 0) {\n                    var record = this.verticalEvent.isSpannedEvent(events_1[i], dayIndex, indexGroup);\n                    var eStart = record[this.verticalEvent.fields.startTime];\n                    var eEnd = record[this.verticalEvent.fields.endTime];\n                    var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                        this.actionObj.element.offsetHeight;\n                    var topValue = this.parent.activeViewOptions.timeScale.enable ?\n                        this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n                    if (isNullOrUndefined(index)) {\n                        if (i === 0) {\n                            this.actionObj.clone.style.top = formatUnit(topValue);\n                            this.actionObj.clone.style.height = formatUnit(appHeight);\n                        }\n                        else {\n                            this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                        }\n                    }\n                    else {\n                        var appWidth = this.actionObj.cellWidth;\n                        if (event[this.parent.eventFields.isAllDay]) {\n                            topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n                            appHeight = this.getAllDayEventHeight();\n                            var timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                                event[this.parent.eventFields.startTime].getTime();\n                            var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                            if (allDayDifference >= 0) {\n                                appWidth = (allDayDifference * this.actionObj.cellWidth);\n                            }\n                        }\n                        if (this.actionObj.cloneElement[index]) {\n                            if (i === 0) {\n                                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n                            }\n                            else {\n                                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    DragAndDrop.prototype.renderSpannedEvents = function (record, index, top, height) {\n        var startTime = record[this.parent.eventFields.startTime].getTime();\n        var endTime = record[this.parent.eventFields.endTime].getTime();\n        if (startTime !== endTime) {\n            var appointmentElement = this.verticalEvent.\n                createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n            addClass([appointmentElement], [cls.CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n            setStyleAttribute(appointmentElement, {\n                'width': '100%',\n                'height': height + 'px',\n                'top': top + 'px',\n                'border': '0px'\n            });\n            var appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n            appointmentWrap[index].appendChild(appointmentElement);\n        }\n    };\n    DragAndDrop.prototype.getRenderedDates = function () {\n        var _this = this;\n        var _a, _b;\n        var renderDates = this.parent.activeView.renderDates;\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            var resources = this.parent.resourceBase.lastResourceLevel.\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\n            renderDates = resources[0].renderDates;\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\n        }\n        return renderDates;\n    };\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n        this.parent.eventBase.slots = [];\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        var renderDates = this.getRenderedDates();\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.swapDragging = function (e) {\n        var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            var eventHeight = this.getAllDayEventHeight();\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n                    var element = allDayElement_1[_i];\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    };\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            this.removeCloneElement();\n        }\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            var tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            var currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                var dragStart = new Date(timeString.getTime());\n                var dragEnd = new Date(dragStart.getTime());\n                var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() -\n                    (util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime]))).getTime();\n                dragStart = new Date(dragStart.getTime() + startTimeDiff);\n                dragEnd = new Date(dragStart.getTime() + eventDuration);\n                this.actionObj.start = new Date(dragStart.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n        for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n            var wrapper = eventWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n            var startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (var index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[index]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    };\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        var rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        var colIndex = this.getColumnIndex(offsetLeft);\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n            this.isCursorAhead = true;\n        }\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        var tr = this.parent.getContentTable().querySelector('tr');\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\n            this.parent.getDateFromElement(tr.children[index]);\n        if (this.isStepDragging) {\n            var widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                if (this.isCursorAhead || cursorDrag) {\n                    eventStart.setMilliseconds(-(eventDuration));\n                }\n                else {\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n                }\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            if (this.isCursorAhead || cursorDrag) {\n                eventStart.setMinutes(eventStart.getMinutes() +\n                    (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n                eventStart.setMilliseconds(-(eventDuration));\n            }\n            else {\n                eventStart.setMinutes(eventStart.getMinutes() -\n                    (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n            }\n        }\n        eventStart = this.calculateIntervalTime(eventStart);\n        if (this.isTimelineDayProcess) {\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        if (this.parent.eventDragArea) {\n            var targetDate = this.parent.getDateFromElement(e.target);\n            if (!isNullOrUndefined(targetDate)) {\n                if (!this.parent.activeViewOptions.timeScale.enable || (this.parent.currentView === 'TimelineMonth')) {\n                    var eventSrt = eventObj[this.parent.eventFields.startTime];\n                    eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n                }\n                else {\n                    eventStart = targetDate;\n                }\n            }\n        }\n        var eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var i = 0; i < this.multiData.length; i++) {\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            var events_2 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n            var eventData = events_2[0].data;\n            var startTime = this.timelineEventModule.getStartTime(events_2[0], eventData);\n            var endTime = this.timelineEventModule.getEndTime(events_2[0], eventData);\n            // eslint-disable-next-line max-len\n            var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n            // eslint-disable-next-line max-len\n            var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n            day = day < 0 ? 0 : day;\n            var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n            if (this.parent.enableRtl) {\n                cloneElement.style.right = formatUnit(left);\n            }\n            else {\n                cloneElement.style.left = formatUnit(left);\n            }\n            if (!this.isMorePopupOpened) {\n                cloneElement.style.width = formatUnit(width);\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    };\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\n            }\n        }\n        return offsetLeft;\n    };\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n        var pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            var targetLeft = tr.children[index].offsetLeft;\n            var pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    };\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n        var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    };\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n        var index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    };\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n        var td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            var targetDate = this.parent.getDateFromElement(td);\n            if (this.isHeaderRows) {\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\n            }\n            else {\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    };\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        var rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y +\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\n            dragArea.getBoundingClientRect().top) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        var td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n        if (this.parent.rowAutoHeight) {\n            var cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    };\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n        if (cloneElement === void 0) { cloneElement = null; }\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    };\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n        var eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    };\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        var eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    };\n    DragAndDrop.prototype.isAllowDrop = function (e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\n        var isAllowDrop = false;\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n            var selector = dropSelectors_1[_i];\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    DragAndDrop.prototype.getModuleName = function () {\n        return 'dragAndDrop';\n    };\n    return DragAndDrop;\n}(ActionBase));\nexport { DragAndDrop };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}