{"ast":null,"code":"import * as CONSTANT from './../base/constant';\nimport { NodeSelection } from '../../selection/selection';\nimport { NodeCutter } from './nodecutter';\nimport { InsertHtml } from './inserthtml';\nimport { createElement, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Link internal component\n *\n * @hidden\n\n */\n\nvar LinkCommand =\n/** @class */\nfunction () {\n  /**\n   * Constructor for creating the Formats plugin\n   *\n   * @param {EditorManager} parent - specifies the editor manager\n   * @hidden\n    */\n  function LinkCommand(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  LinkCommand.prototype.addEventListener = function () {\n    this.parent.observer.on(CONSTANT.LINK, this.linkCommand, this);\n  };\n\n  LinkCommand.prototype.linkCommand = function (e) {\n    switch (e.value.toString().toLocaleLowerCase()) {\n      case 'createlink':\n      case 'editlink':\n        this.createLink(e);\n        break;\n\n      case 'openlink':\n        this.openLink(e);\n        break;\n\n      case 'removelink':\n        this.removeLink(e);\n        break;\n    }\n  };\n\n  LinkCommand.prototype.createLink = function (e) {\n    var closestAnchor = !isNOU(e.item.selectParent) && e.item.selectParent.length > 0 && closest(e.item.selectParent[0], 'a');\n    closestAnchor = !isNOU(closestAnchor) ? closestAnchor : !isNOU(e.item.selectParent) && e.item.selectParent.length > 0 ? e.item.selectParent[0] : null;\n\n    if (!isNOU(closestAnchor) && closestAnchor.tagName === 'A') {\n      var anchorEle = closestAnchor;\n      var linkText = '';\n\n      if (!isNOU(e.item.url)) {\n        anchorEle.setAttribute('href', e.item.url);\n      }\n\n      if (!isNOU(e.item.title)) {\n        anchorEle.setAttribute('title', e.item.title);\n      }\n\n      if (!isNOU(e.item.text) && e.item.text !== '') {\n        linkText = anchorEle.innerText;\n        anchorEle.innerText = e.item.text;\n      }\n\n      if (!isNOU(e.item.target)) {\n        anchorEle.setAttribute('target', e.item.target);\n      } else {\n        anchorEle.removeAttribute('target');\n      }\n\n      if (linkText === e.item.text) {\n        e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle, anchorEle, 1, 1);\n        e.item.selection.restore();\n      } else {\n        var startIndex = e.item.action === 'Paste' ? anchorEle.childNodes[0].textContent.length : 0;\n        e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle.childNodes[0], anchorEle.childNodes[0], startIndex, anchorEle.childNodes[0].textContent.length);\n      }\n    } else {\n      var domSelection = new NodeSelection();\n      var range = domSelection.getRange(this.parent.currentDocument);\n\n      if (range.endContainer.nodeName === '#text' && range.startContainer.textContent.length === range.endOffset + 1 && range.endContainer.textContent.charAt(range.endOffset) === ' ' && range.endContainer.nextSibling.nodeName === 'A') {\n        domSelection.setSelectionText(this.parent.currentDocument, range.startContainer, range.endContainer, range.startOffset, range.endOffset + 1);\n        range = domSelection.getRange(this.parent.currentDocument);\n      }\n\n      var text = isNOU(e.item.text) ? true : e.item.text.replace(/ /g, '').localeCompare(range.toString().replace(/\\n/g, ' ').replace(/ /g, '')) < 0;\n\n      if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32 || e.event.keyCode === 13) || e.item.action === 'Paste' || range.collapsed || text) {\n        var anchor = this.createAchorNode(e);\n        anchor.innerText = e.item.text === '' ? e.item.url : e.item.text;\n        e.item.selection.restore();\n        InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n\n        if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32 || e.event.keyCode === 13)) {\n          var startContainer = e.item.selection.range.startContainer;\n          startContainer.textContent = this.removeText(startContainer.textContent, e.item.text);\n        } else {\n          var startIndex = e.item.action === 'Paste' ? anchor.childNodes[0].textContent.length : 0;\n          e.item.selection.setSelectionText(this.parent.currentDocument, anchor.childNodes[0], anchor.childNodes[0], startIndex, anchor.childNodes[0].textContent.length);\n        }\n      } else {\n        this.createLinkNode(e);\n      }\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: 'Links',\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  LinkCommand.prototype.createLinkNode = function (e) {\n    var domSelection = new NodeSelection();\n    var nodeCutter = new NodeCutter();\n    var range = domSelection.getRange(this.parent.currentDocument);\n    var nodes = this.getSelectionNodes(domSelection.getNodeCollection(range));\n    var save = domSelection.save(range, this.parent.currentDocument);\n    var txtArray = [];\n    var inlineNodes = [];\n    var currentNode;\n    var removeNodes = [];\n    var anchorNodes = [];\n    var finalinlineNodes = [];\n    var cloneNode;\n\n    for (var index = 0; index < nodes.length; index++) {\n      nodes[index] = nodeCutter.GetSpliceNode(range, nodes[index]);\n      txtArray[index] = nodes[index];\n    }\n\n    for (var i = 0; i < txtArray.length; i++) {\n      var check = true;\n      currentNode = txtArray[i];\n\n      while (check === true) {\n        if (currentNode.parentNode.nodeName === 'A') {\n          var anchorEle = currentNode.parentNode;\n          currentNode.parentNode.parentNode.insertBefore(anchorEle.firstChild, anchorEle);\n          currentNode.parentNode.removeChild(anchorEle);\n        }\n\n        if (this.isBlockNode(currentNode.parentNode) || txtArray.length === 0 || i === 0 || i === txtArray.length - 1 || range.startContainer.nodeType === 3) {\n          inlineNodes[i] = currentNode;\n          check = false;\n        } else {\n          currentNode = currentNode.parentNode;\n        }\n      }\n    }\n\n    for (var i = 0, j_1 = 0; i < inlineNodes.length; i++) {\n      if (i === 0) {\n        finalinlineNodes[j_1] = inlineNodes[i];\n      }\n\n      if (inlineNodes.length > 1 && i < inlineNodes.length - 1) {\n        if (inlineNodes[i].parentElement === inlineNodes[i + 1].parentElement && inlineNodes[i] === inlineNodes[i + 1]) {\n          continue;\n        } else {\n          finalinlineNodes[j_1 + 1] = inlineNodes[i + 1];\n          j_1++;\n        }\n      }\n    }\n\n    var j = 0;\n    anchorNodes[j] = this.createAchorNode(e);\n\n    for (var i = 0; i < finalinlineNodes.length; i++) {\n      if (i === 0) {\n        cloneNode = finalinlineNodes[i].cloneNode(true);\n        anchorNodes[i].appendChild(cloneNode);\n      }\n\n      if (i < finalinlineNodes.length - 1) {\n        if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n          var cln = finalinlineNodes[i + 1].cloneNode(true);\n          anchorNodes[j].appendChild(cln);\n        } else {\n          j = j + 1;\n          anchorNodes[j] = this.createAchorNode(e);\n          cloneNode = finalinlineNodes[i + 1].cloneNode(true);\n          anchorNodes[j].appendChild(cloneNode);\n        }\n      }\n    }\n\n    this.parent.nodeSelection.setRange(document, save.range);\n\n    for (var i = 0, j_2 = 0, k = 0; i <= finalinlineNodes.length; i++) {\n      if (i === 0) {\n        finalinlineNodes[i].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i].nextSibling);\n\n        if (this.parent.domNode.blockNodes().length === 1) {\n          this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument, anchorNodes[j_2]);\n        }\n\n        removeNodes[k] = finalinlineNodes[i];\n        k++;\n      }\n\n      if (i < finalinlineNodes.length - 1) {\n        if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n          removeNodes[k] = finalinlineNodes[i + 1];\n          k++;\n        } else {\n          j_2 = j_2 + 1;\n          finalinlineNodes[i + 1].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i + 1]);\n          removeNodes[k] = finalinlineNodes[i + 1];\n          k++;\n        }\n      }\n    }\n\n    for (var i = 0; i < removeNodes.length; i++) {\n      if (removeNodes[i].parentNode) {\n        removeNodes[i].parentNode.removeChild(removeNodes[i]);\n      }\n    }\n  };\n\n  LinkCommand.prototype.createAchorNode = function (e) {\n    var anchorEle = createElement('a', {\n      className: 'e-rte-anchor',\n      attrs: {\n        href: e.item.url,\n        title: isNOU(e.item.title) || e.item.title === '' ? e.item.url : e.item.title\n      }\n    });\n\n    if (!isNOU(e.item.target)) {\n      anchorEle.setAttribute('target', e.item.target);\n    }\n\n    return anchorEle;\n  };\n\n  LinkCommand.prototype.getSelectionNodes = function (nodeCollection) {\n    nodeCollection = nodeCollection.reverse();\n\n    for (var index = 0; index < nodeCollection.length; index++) {\n      if (nodeCollection[index].nodeType !== 3 || nodeCollection[index].textContent.trim() === '') {\n        if (nodeCollection[index].nodeName !== 'IMG') {\n          nodeCollection.splice(index, 1);\n          index--;\n        }\n      }\n    }\n\n    return nodeCollection.reverse();\n  };\n\n  LinkCommand.prototype.isBlockNode = function (element) {\n    return !!element && element.nodeType === Node.ELEMENT_NODE && CONSTANT.BLOCK_TAGS.indexOf(element.tagName.toLowerCase()) >= 0;\n  };\n\n  LinkCommand.prototype.removeText = function (text, val) {\n    var arr = text.split(' ');\n\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i] === val) {\n        arr.splice(i, 1);\n        i--;\n      }\n    }\n\n    return arr.join(' ') + ' ';\n  };\n\n  LinkCommand.prototype.openLink = function (e) {\n    document.defaultView.open(e.item.url, e.item.target);\n    this.callBack(e);\n  };\n\n  LinkCommand.prototype.removeLink = function (e) {\n    var blockNodes = this.parent.domNode.blockNodes();\n\n    if (blockNodes.length < 2) {\n      this.parent.domNode.setMarker(e.item.selection);\n      var closestAnchor = closest(e.item.selectParent[0], 'a');\n      var selectParent = closestAnchor ? closestAnchor : e.item.selectParent[0];\n      var parent_1 = selectParent.parentNode;\n      var child = [];\n\n      for (; selectParent.firstChild; null) {\n        child.push(parent_1.insertBefore(selectParent.firstChild, selectParent));\n      }\n\n      parent_1.removeChild(selectParent);\n\n      if (child && child.length === 1) {\n        e.item.selection.startContainer = e.item.selection.getNodeArray(child[child.length - 1], true);\n        e.item.selection.endContainer = e.item.selection.startContainer;\n      }\n\n      e.item.selection = this.parent.domNode.saveMarker(e.item.selection);\n    } else {\n      for (var i = 0; i < blockNodes.length; i++) {\n        var linkNode = blockNodes[i].querySelectorAll('a');\n\n        for (var j = 0; j < linkNode.length; j++) {\n          if (document.getSelection().containsNode(linkNode[j], true)) {\n            linkNode[j].outerHTML = linkNode[j].innerHTML;\n          }\n        }\n      }\n    }\n\n    e.item.selection.restore();\n    this.callBack(e);\n  };\n\n  LinkCommand.prototype.callBack = function (e) {\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  return LinkCommand;\n}();\n\nexport { LinkCommand };","map":{"version":3,"names":["CONSTANT","NodeSelection","NodeCutter","InsertHtml","createElement","isNullOrUndefined","isNOU","closest","LinkCommand","parent","addEventListener","prototype","observer","on","LINK","linkCommand","e","value","toString","toLocaleLowerCase","createLink","openLink","removeLink","closestAnchor","item","selectParent","length","tagName","anchorEle","linkText","url","setAttribute","title","text","innerText","target","removeAttribute","selection","setSelectionText","currentDocument","restore","startIndex","action","childNodes","textContent","domSelection","range","getRange","endContainer","nodeName","startContainer","endOffset","charAt","nextSibling","startOffset","replace","localeCompare","event","type","keyCode","collapsed","anchor","createAchorNode","Insert","editableElement","removeText","createLinkNode","callBack","requestType","editorMode","nodeSelection","elements","getSelectedNodes","nodeCutter","nodes","getSelectionNodes","getNodeCollection","save","txtArray","inlineNodes","currentNode","removeNodes","anchorNodes","finalinlineNodes","cloneNode","index","GetSpliceNode","i","check","parentNode","insertBefore","firstChild","removeChild","isBlockNode","nodeType","j_1","parentElement","j","appendChild","cln","setRange","document","j_2","k","domNode","blockNodes","setSelectionNode","className","attrs","href","nodeCollection","reverse","trim","splice","element","Node","ELEMENT_NODE","BLOCK_TAGS","indexOf","toLowerCase","val","arr","split","join","defaultView","open","setMarker","parent_1","child","push","getNodeArray","saveMarker","linkNode","querySelectorAll","getSelection","containsNode","outerHTML","innerHTML","subCommand"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/link.js"],"sourcesContent":["import * as CONSTANT from './../base/constant';\nimport { NodeSelection } from '../../selection/selection';\nimport { NodeCutter } from './nodecutter';\nimport { InsertHtml } from './inserthtml';\nimport { createElement, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Link internal component\n *\n * @hidden\n\n */\nvar LinkCommand = /** @class */ (function () {\n    /**\n     * Constructor for creating the Formats plugin\n     *\n     * @param {EditorManager} parent - specifies the editor manager\n     * @hidden\n\n     */\n    function LinkCommand(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    LinkCommand.prototype.addEventListener = function () {\n        this.parent.observer.on(CONSTANT.LINK, this.linkCommand, this);\n    };\n    LinkCommand.prototype.linkCommand = function (e) {\n        switch (e.value.toString().toLocaleLowerCase()) {\n            case 'createlink':\n            case 'editlink':\n                this.createLink(e);\n                break;\n            case 'openlink':\n                this.openLink(e);\n                break;\n            case 'removelink':\n                this.removeLink(e);\n                break;\n        }\n    };\n    LinkCommand.prototype.createLink = function (e) {\n        var closestAnchor = (!isNOU(e.item.selectParent) && e.item.selectParent.length > 0) &&\n            closest(e.item.selectParent[0], 'a');\n        closestAnchor = !isNOU(closestAnchor) ? closestAnchor :\n            (!isNOU(e.item.selectParent) && e.item.selectParent.length > 0) ? (e.item.selectParent[0]) : null;\n        if (!isNOU(closestAnchor) && closestAnchor.tagName === 'A') {\n            var anchorEle = closestAnchor;\n            var linkText = '';\n            if (!isNOU(e.item.url)) {\n                anchorEle.setAttribute('href', e.item.url);\n            }\n            if (!isNOU(e.item.title)) {\n                anchorEle.setAttribute('title', e.item.title);\n            }\n            if (!isNOU(e.item.text) && e.item.text !== '') {\n                linkText = anchorEle.innerText;\n                anchorEle.innerText = e.item.text;\n            }\n            if (!isNOU(e.item.target)) {\n                anchorEle.setAttribute('target', e.item.target);\n            }\n            else {\n                anchorEle.removeAttribute('target');\n            }\n            if (linkText === e.item.text) {\n                e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle, anchorEle, 1, 1);\n                e.item.selection.restore();\n            }\n            else {\n                var startIndex = e.item.action === 'Paste' ? anchorEle.childNodes[0].textContent.length : 0;\n                e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle.childNodes[0], anchorEle.childNodes[0], startIndex, anchorEle.childNodes[0].textContent.length);\n            }\n        }\n        else {\n            var domSelection = new NodeSelection();\n            var range = domSelection.getRange(this.parent.currentDocument);\n            if (range.endContainer.nodeName === '#text' && range.startContainer.textContent.length === (range.endOffset + 1) &&\n                range.endContainer.textContent.charAt(range.endOffset) === ' ' && range.endContainer.nextSibling.nodeName === 'A') {\n                domSelection.setSelectionText(this.parent.currentDocument, range.startContainer, range.endContainer, range.startOffset, range.endOffset + 1);\n                range = domSelection.getRange(this.parent.currentDocument);\n            }\n            var text = isNOU(e.item.text) ? true : e.item.text.replace(/ /g, '').localeCompare(range.toString()\n                .replace(/\\n/g, ' ').replace(/ /g, '')) < 0;\n            if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32\n                || e.event.keyCode === 13) || e.item.action === 'Paste' || range.collapsed || text) {\n                var anchor = this.createAchorNode(e);\n                anchor.innerText = e.item.text === '' ? e.item.url : e.item.text;\n                e.item.selection.restore();\n                InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n                if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32\n                    || e.event.keyCode === 13)) {\n                    var startContainer = e.item.selection.range.startContainer;\n                    startContainer.textContent = this.removeText(startContainer.textContent, e.item.text);\n                }\n                else {\n                    var startIndex = e.item.action === 'Paste' ? anchor.childNodes[0].textContent.length : 0;\n                    e.item.selection.setSelectionText(this.parent.currentDocument, anchor.childNodes[0], anchor.childNodes[0], startIndex, anchor.childNodes[0].textContent.length);\n                }\n            }\n            else {\n                this.createLinkNode(e);\n            }\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: 'Links',\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    LinkCommand.prototype.createLinkNode = function (e) {\n        var domSelection = new NodeSelection();\n        var nodeCutter = new NodeCutter();\n        var range = domSelection.getRange(this.parent.currentDocument);\n        var nodes = this.getSelectionNodes(domSelection.getNodeCollection(range));\n        var save = domSelection.save(range, this.parent.currentDocument);\n        var txtArray = [];\n        var inlineNodes = [];\n        var currentNode;\n        var removeNodes = [];\n        var anchorNodes = [];\n        var finalinlineNodes = [];\n        var cloneNode;\n        for (var index = 0; index < nodes.length; index++) {\n            nodes[index] = nodeCutter.GetSpliceNode(range, nodes[index]);\n            txtArray[index] = nodes[index];\n        }\n        for (var i = 0; i < txtArray.length; i++) {\n            var check = true;\n            currentNode = txtArray[i];\n            while (check === true) {\n                if (currentNode.parentNode.nodeName === 'A') {\n                    var anchorEle = currentNode.parentNode;\n                    currentNode.parentNode.parentNode.insertBefore(anchorEle.firstChild, anchorEle);\n                    currentNode.parentNode.removeChild(anchorEle);\n                }\n                if (this.isBlockNode(currentNode.parentNode) || txtArray.length === 0 || i === 0 || i === txtArray.length - 1\n                    || range.startContainer.nodeType === 3) {\n                    inlineNodes[i] = currentNode;\n                    check = false;\n                }\n                else {\n                    currentNode = currentNode.parentNode;\n                }\n            }\n        }\n        for (var i = 0, j_1 = 0; i < inlineNodes.length; i++) {\n            if (i === 0) {\n                finalinlineNodes[j_1] = inlineNodes[i];\n            }\n            if (inlineNodes.length > 1 && i < inlineNodes.length - 1) {\n                if ((inlineNodes[i].parentElement === inlineNodes[i + 1].parentElement) && (inlineNodes[i] === inlineNodes[i + 1])) {\n                    continue;\n                }\n                else {\n                    finalinlineNodes[j_1 + 1] = inlineNodes[i + 1];\n                    j_1++;\n                }\n            }\n        }\n        var j = 0;\n        anchorNodes[j] = this.createAchorNode(e);\n        for (var i = 0; i < finalinlineNodes.length; i++) {\n            if (i === 0) {\n                cloneNode = finalinlineNodes[i].cloneNode(true);\n                anchorNodes[i].appendChild(cloneNode);\n            }\n            if (i < finalinlineNodes.length - 1) {\n                if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n                    var cln = finalinlineNodes[i + 1].cloneNode(true);\n                    anchorNodes[j].appendChild(cln);\n                }\n                else {\n                    j = j + 1;\n                    anchorNodes[j] = this.createAchorNode(e);\n                    cloneNode = finalinlineNodes[i + 1].cloneNode(true);\n                    anchorNodes[j].appendChild(cloneNode);\n                }\n            }\n        }\n        this.parent.nodeSelection.setRange(document, save.range);\n        for (var i = 0, j_2 = 0, k = 0; i <= finalinlineNodes.length; i++) {\n            if (i === 0) {\n                finalinlineNodes[i].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i].nextSibling);\n                if (this.parent.domNode.blockNodes().length === 1) {\n                    this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument, anchorNodes[j_2]);\n                }\n                removeNodes[k] = finalinlineNodes[i];\n                k++;\n            }\n            if (i < finalinlineNodes.length - 1) {\n                if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n                    removeNodes[k] = finalinlineNodes[i + 1];\n                    k++;\n                }\n                else {\n                    j_2 = j_2 + 1;\n                    finalinlineNodes[i + 1].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i + 1]);\n                    removeNodes[k] = finalinlineNodes[i + 1];\n                    k++;\n                }\n            }\n        }\n        for (var i = 0; i < removeNodes.length; i++) {\n            if (removeNodes[i].parentNode) {\n                removeNodes[i].parentNode.removeChild(removeNodes[i]);\n            }\n        }\n    };\n    LinkCommand.prototype.createAchorNode = function (e) {\n        var anchorEle = createElement('a', {\n            className: 'e-rte-anchor',\n            attrs: {\n                href: e.item.url,\n                title: isNOU(e.item.title) || e.item.title === '' ? e.item.url : e.item.title\n            }\n        });\n        if (!isNOU(e.item.target)) {\n            anchorEle.setAttribute('target', e.item.target);\n        }\n        return anchorEle;\n    };\n    LinkCommand.prototype.getSelectionNodes = function (nodeCollection) {\n        nodeCollection = nodeCollection.reverse();\n        for (var index = 0; index < nodeCollection.length; index++) {\n            if (nodeCollection[index].nodeType !== 3 || nodeCollection[index].textContent.trim() === '') {\n                if (nodeCollection[index].nodeName !== 'IMG') {\n                    nodeCollection.splice(index, 1);\n                    index--;\n                }\n            }\n        }\n        return nodeCollection.reverse();\n    };\n    LinkCommand.prototype.isBlockNode = function (element) {\n        return (!!element && (element.nodeType === Node.ELEMENT_NODE && CONSTANT.BLOCK_TAGS.indexOf(element.tagName.toLowerCase()) >= 0));\n    };\n    LinkCommand.prototype.removeText = function (text, val) {\n        var arr = text.split(' ');\n        for (var i = 0; i < arr.length; i++) {\n            if (arr[i] === val) {\n                arr.splice(i, 1);\n                i--;\n            }\n        }\n        return arr.join(' ') + ' ';\n    };\n    LinkCommand.prototype.openLink = function (e) {\n        document.defaultView.open(e.item.url, e.item.target);\n        this.callBack(e);\n    };\n    LinkCommand.prototype.removeLink = function (e) {\n        var blockNodes = this.parent.domNode.blockNodes();\n        if (blockNodes.length < 2) {\n            this.parent.domNode.setMarker(e.item.selection);\n            var closestAnchor = closest(e.item.selectParent[0], 'a');\n            var selectParent = closestAnchor ? closestAnchor : e.item.selectParent[0];\n            var parent_1 = selectParent.parentNode;\n            var child = [];\n            for (; selectParent.firstChild; null) {\n                child.push(parent_1.insertBefore(selectParent.firstChild, selectParent));\n            }\n            parent_1.removeChild(selectParent);\n            if (child && child.length === 1) {\n                e.item.selection.startContainer = e.item.selection.getNodeArray(child[child.length - 1], true);\n                e.item.selection.endContainer = e.item.selection.startContainer;\n            }\n            e.item.selection = this.parent.domNode.saveMarker(e.item.selection);\n        }\n        else {\n            for (var i = 0; i < blockNodes.length; i++) {\n                var linkNode = blockNodes[i].querySelectorAll('a');\n                for (var j = 0; j < linkNode.length; j++) {\n                    if (document.getSelection().containsNode(linkNode[j], true)) {\n                        linkNode[j].outerHTML = linkNode[j].innerHTML;\n                    }\n                }\n            }\n        }\n        e.item.selection.restore();\n        this.callBack(e);\n    };\n    LinkCommand.prototype.callBack = function (e) {\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    return LinkCommand;\n}());\nexport { LinkCommand };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}