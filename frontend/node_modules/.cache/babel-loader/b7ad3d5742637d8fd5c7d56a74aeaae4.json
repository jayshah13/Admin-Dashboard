{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\n\nvar VirtualContentRenderer =\n/** @class */\nfunction (_super) {\n  __extends(VirtualContentRenderer, _super);\n\n  function VirtualContentRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.prevHeight = 0;\n    /** @hidden */\n\n    _this.startIndex = 0;\n    _this.preStartIndex = 0;\n    _this.preventEvent = false;\n    _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n    /** @hidden */\n\n    _this.offsets = {};\n    _this.tmpOffsets = {};\n    /** @hidden */\n\n    _this.virtualEle = new VirtualElementHandler();\n    _this.offsetKeys = [];\n    _this.isFocused = false;\n    _this.isSelection = false;\n    _this.isBottom = false;\n    _this.rndrCount = 0;\n    _this.empty = undefined;\n    _this.isCancel = false;\n    _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save'];\n    _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n    /** @hidden */\n\n    _this.virtualData = {};\n    _this.emptyRowData = {};\n    _this.vfColIndex = [];\n    _this.frzIdx = 1;\n    _this.isContextMenuOpen = false;\n    _this.isSelectionScroll = false;\n    _this.validationCheck = false;\n    _this.locator = locator;\n\n    _this.eventListener('on');\n\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n\n    _this.vgenerator = _this.generator;\n    return _this;\n  }\n\n  VirtualContentRenderer.prototype.renderTable = function () {\n    this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n\n    _super.prototype.renderTable.call(this);\n\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n    this.virtualEle.renderWrapper(this.parent.height);\n    this.virtualEle.renderPlaceHolder();\n    this.virtualEle.wrapper.style.position = 'absolute';\n    var debounceEvent = this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline;\n    var opt = {\n      container: this.content,\n      pageHeight: this.getBlockHeight() * 2,\n      debounceEvent: debounceEvent,\n      axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n    };\n    this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n  };\n\n  VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n    this.getTable().appendChild(tbody);\n    this.virtualEle.adjustTable(0, 0);\n  };\n\n  VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n    var blockIndex = args.virtualInfo.blockIndexes;\n    var colsIndex = args.virtualInfo.columnIndexes;\n    var page = args.virtualInfo.page;\n    args.virtualInfo.blockIndexes = [1, 2];\n    args.virtualInfo.page = 1;\n\n    if (!args.renderMovableContent) {\n      args.virtualInfo.columnIndexes = [];\n    }\n\n    var recordslength = this.parent.getCurrentViewRecords().length;\n    var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n    var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n    args.virtualInfo.blockIndexes = blockIndex;\n    args.virtualInfo.columnIndexes = colsIndex;\n    args.virtualInfo.page = page;\n    return virtualRows.splice(0, this.parent.frozenRows);\n  };\n\n  VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n    this.scrollAfterEdit();\n\n    if (this.parent.enablePersistence) {\n      this.parent.scrollPosition = scrollArgs.offset;\n    }\n\n    if (this.preventEvent || this.parent.isDestroyed) {\n      this.preventEvent = false;\n      return;\n    }\n\n    if (isNullOrUndefined(document.activeElement)) {\n      this.isFocused = false;\n    } else {\n      this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n    }\n\n    var info = scrollArgs.sentinel;\n    var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n\n    if (isGroupAdaptive(this.parent)) {\n      if (viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString()) {\n        return;\n      } else {\n        viewInfo.event = 'refresh-virtual-block';\n\n        if (!isNullOrUndefined(viewInfo.offsets)) {\n          viewInfo.offsets.top = this.content.scrollTop;\n        }\n\n        this.parent.pageSettings.currentPage = viewInfo.page;\n        this.parent.notify(viewInfo.event, {\n          requestType: 'virtualscroll',\n          virtualInfo: viewInfo,\n          focusElement: scrollArgs.focusElement\n        });\n        return;\n      }\n    }\n\n    if (this.prevInfo && (info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString() || info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString())) {\n      if (Browser.isIE) {\n        this.parent.hideSpinner();\n      }\n\n      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n\n      if (info.axis === 'Y') {\n        this.restoreEdit();\n      }\n\n      return;\n    }\n\n    this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n    this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n    this.requestType = 'virtualscroll';\n    this.parent.notify(viewInfo.event, {\n      requestType: 'virtualscroll',\n      virtualInfo: viewInfo,\n      focusElement: scrollArgs.focusElement\n    });\n  };\n\n  VirtualContentRenderer.prototype.block = function (blk) {\n    return this.vgenerator.isBlockAvailable(blk);\n  };\n\n  VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n    var isBlockAdded = false;\n    var tempBlocks = [];\n    var infoType = {\n      direction: direction,\n      sentinelInfo: info,\n      offsets: e,\n      startIndex: this.preStartIndex,\n      endIndex: this.preEndIndex\n    };\n    infoType.page = this.getPageFromTop(e.top, infoType);\n    infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n    infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n    var blocks = this.ensureBlocks(infoType);\n\n    if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n      // To avoid dupilcate row index problem in key focus support\n      var newBlock = blocks[blocks.length - 1];\n\n      if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n        isBlockAdded = true;\n      }\n    }\n\n    infoType.blockIndexes = blocks;\n    infoType.loadNext = !blocks.filter(function (val) {\n      return tempBlocks.indexOf(val) === -1;\n    }).every(this.block.bind(this));\n    infoType.event = infoType.loadNext || infoType.loadSelf ? modelChanged : refreshVirtualBlock;\n    infoType.nextInfo = infoType.loadNext ? {\n      page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1))\n    } : {};\n\n    if (isBlockAdded) {\n      infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n    }\n\n    if (this.activeKey === 'downArrow') {\n      var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n\n      if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n        infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n      }\n    }\n\n    infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n\n    if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n      infoType.event = refreshVirtualBlock;\n    }\n\n    return infoType;\n  };\n\n  VirtualContentRenderer.prototype.setKeyboardNavIndex = function () {\n    this.blazorDataLoad = true;\n\n    if (this.activeKey === 'downArrow' || this.activeKey === 'upArrow') {\n      this.blzRowIndex = this.activeKey === 'downArrow' ? this.rowIndex + 1 : this.rowIndex - 1;\n      document.activeElement.blur();\n    }\n  };\n\n  VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n    var _this = this;\n\n    var index = info.blockIndexes[info.block];\n    var mIdx;\n    var old = index;\n    var max = Math.max;\n    var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n      // To avoid frozen content white space issue\n      if (info.sentinelInfo.axis === 'X' || info.sentinelInfo.axis === 'Y' && info.page === this.prevInfo.page) {\n        indexes = this.prevInfo.blockIndexes;\n      }\n    }\n\n    indexes = indexes.filter(function (val, ind) {\n      return indexes.indexOf(val) === ind;\n    });\n\n    if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n      return indexes;\n    }\n\n    if (info.loadSelf || info.direction === 'down' && this.isEndBlock(old)) {\n      indexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n\n    indexes.some(function (val, ind) {\n      var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n\n      if (result) {\n        mIdx = ind;\n      }\n\n      return result;\n    });\n\n    if (mIdx !== undefined) {\n      indexes = indexes.slice(0, mIdx + 1);\n\n      if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n        indexes = [indexes[0] - 1, indexes[0]];\n      }\n    }\n\n    return indexes;\n  }; // tslint:disable-next-line:max-func-body-length\n\n\n  VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n    var _this = this; // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n\n\n    var isFrozen = this.parent.isFrozenGrid();\n    var frzCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n    var colVFtable = this.parent.enableColumnVirtualization && isFrozen;\n    this.checkFirstBlockColIndexes(e);\n    var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page && this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n    this.prevInfo = this.prevInfo || e.virtualInfo;\n    var cBlock = info.columnIndexes[0] - 1;\n\n    if (colVFtable && info.columnIndexes[0] === frzCols) {\n      cBlock = info.columnIndexes[0] - frzCols - 1;\n    }\n\n    var cOffset = this.getColumnOffset(cBlock);\n    var width;\n    var blocks = info.blockIndexes;\n\n    if (this.parent.groupSettings.columns.length) {\n      this.refreshOffsets();\n    }\n\n    if (this.parent.height === '100%') {\n      this.parent.element.style.height = '100%';\n    }\n\n    var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height : this.parent.element.getBoundingClientRect().height;\n\n    if (!this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    })) {\n      var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n      this.virtualEle.adjustTable(colVFtable ? 0 : cOffset, translate);\n\n      if (colVFtable) {\n        this.virtualEle.adjustMovableTable(cOffset, 0);\n      }\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.adjustTable(colVFtable ? 0 : cOffset, 0);\n\n      if (colVFtable) {\n        this.header.virtualEle.adjustMovableTable(cOffset, 0);\n      }\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      var cIndex = info.columnIndexes;\n      width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n\n      if (colVFtable) {\n        this.header.virtualEle.setMovableWrapperWidth(width);\n      } else {\n        this.header.virtualEle.setWrapperWidth(width);\n      }\n    }\n\n    if (colVFtable) {\n      this.virtualEle.setMovableWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n    } else {\n      this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n    }\n\n    if (!isNullOrUndefined(target.parentNode)) {\n      remove(target);\n    }\n\n    var tbody;\n\n    if (isFrozen) {\n      if (e.renderFrozenRightContent) {\n        tbody = this.parent.getContent().querySelector('.e-frozen-right-content').querySelector(literals.tbody);\n      } else if (!e.renderMovableContent) {\n        tbody = this.parent.getFrozenVirtualContent().querySelector(literals.tbody);\n      } else if (e.renderMovableContent) {\n        tbody = this.parent.getMovableVirtualContent().querySelector(literals.tbody);\n      }\n    } else {\n      tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n    }\n\n    if (tbody) {\n      remove(tbody);\n      target = null;\n    }\n\n    var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n\n    if (!isReact) {\n      target = this.parent.createElement(literals.tbody);\n      target.appendChild(newChild);\n    } else {\n      target = newChild;\n    }\n\n    if (this.parent.frozenRows && e.requestType === 'virtualscroll' && this.parent.pageSettings.currentPage === 1) {\n      for (var i = 0; i < this.parent.frozenRows; i++) {\n        target.children[0].remove();\n      }\n    }\n\n    if (isFrozen) {\n      if (e.renderFrozenRightContent) {\n        this.parent.getContent().querySelector('.e-frozen-right-content').querySelector('.' + literals.table).appendChild(target);\n        this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n      } else if (!e.renderMovableContent) {\n        this.parent.getFrozenVirtualContent().querySelector('.' + literals.table).appendChild(target);\n      } else if (e.renderMovableContent) {\n        this.parent.getMovableVirtualContent().querySelector('.' + literals.table).appendChild(target);\n\n        if (this.parent.getFrozenMode() !== literals.leftRight) {\n          this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n        }\n      }\n\n      if (this.vfColIndex.length) {\n        e.virtualInfo.columnIndexes = info.columnIndexes = extend([], this.vfColIndex);\n        this.vfColIndex = e.renderMovableContent ? [] : this.vfColIndex;\n      }\n    } else {\n      this.getTable().appendChild(target);\n      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n    }\n\n    if (this.parent.groupSettings.columns.length) {\n      if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n        var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n        this.preventEvent = true;\n        var sTop = this.content.scrollTop;\n        this.content.scrollTop = sTop + blk;\n      }\n\n      this.setVirtualHeight();\n      this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n    }\n\n    this.prevInfo = info;\n\n    if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n      this.content.focus();\n    }\n\n    var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n\n    if (this.isBottom) {\n      this.isBottom = false;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n    }\n\n    if (this.parent.pageSettings.currentPage === lastPage && blocks.length === 1) {\n      this.isBottom = true;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 2];\n    }\n\n    if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n      this.parent.notify(events.autoCol, {});\n    }\n\n    this.focusCell(e);\n    this.restoreEdit(e);\n    this.restoreAdd(e);\n    this.ensureSelectedRowPosition();\n    this.validationScrollLeft(e, isFrozen);\n\n    if (!this.initialRowTop) {\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n    }\n\n    var tableName = e.tableName;\n    var isLoaded = this.parent.getFrozenMode() === 'Left-Right' ? tableName === 'frozen-right' : tableName === 'movable';\n\n    if (!isFrozen || isLoaded) {\n      this.vgenerator.startIndex = null;\n      this.vgenerator.currentInfo = {};\n      this.vgenerator.includePrevPage = null;\n    }\n  };\n\n  VirtualContentRenderer.prototype.validationScrollLeft = function (e, isFrozen) {\n    var left = this.parent.getFrozenColumns();\n    var table = this.parent.getFrozenMode();\n    var trigger = !isFrozen || e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n\n    if (this.validationCheck && trigger) {\n      if (this.validationCol) {\n        var offset = this.vgenerator.cOffsets[this.validationCol.index - this.parent.getVisibleFrozenColumns() - 1];\n        this.validationCol = null;\n\n        if (this.parent.isFrozenGrid()) {\n          this.movableContent.scrollLeft = offset;\n        } else {\n          this.content.scrollLeft = offset;\n        }\n      } else {\n        this.validationCheck = false;\n        this.parent.editModule.editFormValidate();\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n    if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n      this.isSelectionScroll = false;\n      var row = this.parent.getRowByIndex(this.selectRowIndex);\n\n      if (row && !this.isRowInView(row)) {\n        this.rowSelected({\n          rowIndex: this.selectRowIndex,\n          row: row\n        }, true);\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.checkFirstBlockColIndexes = function (e) {\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid() && e.virtualInfo.columnIndexes[0] === 0) {\n      var indexes = [];\n      var frozenCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n\n      if (!e.renderMovableContent && e.virtualInfo.columnIndexes.length > frozenCols) {\n        this.vfColIndex = e.virtualInfo.columnIndexes;\n\n        for (var i = 0; i < frozenCols; i++) {\n          indexes.push(i);\n        }\n\n        e.virtualInfo.columnIndexes = indexes;\n      } else if (e.renderMovableContent) {\n        if (!this.vfColIndex.length) {\n          this.vfColIndex = extend([], e.virtualInfo.columnIndexes);\n        }\n\n        e.virtualInfo.columnIndexes = extend([], this.vfColIndex);\n        e.virtualInfo.columnIndexes.splice(0, frozenCols);\n      }\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  VirtualContentRenderer.prototype.focusCell = function (e) {\n    if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      return;\n    }\n\n    var row = this.parent.getRowByIndex(this.rowIndex); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n    var cell = row.cells[this.cellIndex];\n    cell.focus({\n      preventScroll: true\n    });\n    this.parent.selectRow(parseInt(row.getAttribute(literals.ariaRowIndex), 10));\n    this.activeKey = this.empty;\n  };\n\n  VirtualContentRenderer.prototype.restoreEdit = function (e) {\n    if (this.isNormaledit) {\n      var left = this.parent.getFrozenColumns();\n      var isFrozen = e && this.parent.isFrozenGrid();\n      var table = this.parent.getFrozenMode();\n      var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n\n      if ((!isFrozen || isFrozen && trigger) && this.parent.editSettings.allowEditing && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n        var row = this.getRowByIndex(this.editedRowIndex);\n        var content = this.content;\n        var keys = Object.keys(this.virtualData);\n        var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n\n        if (isFrozen && isXaxis) {\n          row = this.parent.getMovableRowByIndex(this.editedRowIndex);\n          content = this.movableContent;\n        }\n\n        if (keys.length && row && !content.querySelector('.' + literals.editedRow)) {\n          var top_1 = row.getBoundingClientRect().top;\n\n          if (isXaxis || top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight()) {\n            this.parent.isEdit = false;\n            this.parent.editModule.startEdit(row);\n          }\n        }\n\n        if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n          var rowData = extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n          this.virtualData = this.getVirtualEditedData(rowData);\n        }\n      }\n\n      this.restoreAdd(e);\n    }\n  };\n\n  VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n    var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n    var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj && this.parent.editModule.formObj.isDestroyed;\n\n    if (!isFormDestroyed) {\n      for (var i = 0; i < editForms.length; i++) {\n        rowData = this.parent.editModule.getCurrentEditedData(editForms[i], rowData);\n      }\n    }\n\n    return rowData;\n  };\n\n  VirtualContentRenderer.prototype.restoreAdd = function (e) {\n    var left = this.parent.getFrozenColumns();\n    var isFrozen = e && this.parent.isFrozenGrid();\n    var table = this.parent.getFrozenMode();\n    var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n    var startAdd = isXaxis && isFrozen ? !(this.parent.getMovableVirtualHeader().querySelector('.' + literals.addedRow) || this.parent.getMovableVirtualContent().querySelector('.' + literals.addedRow)) : !this.parent.element.querySelector('.' + literals.addedRow);\n    var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n\n    if ((!isFrozen || isFrozen && trigger) && this.isNormaledit && this.isAdd && startAdd) {\n      var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n      var isBottom = this.parent.editSettings.newRowPosition === 'Bottom' && this.parent.pageSettings.currentPage === this.maxPage;\n\n      if (isTop || isBottom) {\n        this.parent.isEdit = false;\n        this.parent.addRecord();\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.onDataReady = function (e) {\n    if (!isNullOrUndefined(e.count)) {\n      this.count = e.count;\n      this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n    }\n\n    this.vgenerator.checkAndResetCache(e.requestType);\n\n    if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined].some(function (value) {\n      return e.requestType === value;\n    })) {\n      this.refreshOffsets();\n    }\n\n    this.setVirtualHeight();\n    this.resetScrollPosition(e.requestType);\n  };\n  /**\n   * @param {number} height - specifies the height\n   * @returns {void}\n   * @hidden\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n    var width = this.parent.enableColumnVirtualization ? this.getColumnOffset(this.parent.columns.length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n\n    if (this.parent.isFrozenGrid()) {\n      var virtualHeightTemp = this.parent.pageSettings.currentPage === 1 && Object.keys(this.offsets).length <= 2 ? this.offsets[1] : this.offsets[this.getTotalBlocks() - 2];\n      var scrollableElementHeight = this.content.clientHeight;\n      virtualHeightTemp = virtualHeightTemp > scrollableElementHeight ? virtualHeightTemp : 0; // To overcome the white space issue in last page (instead of position absolute)\n\n      this.virtualEle.setVirtualHeight(virtualHeightTemp, width);\n    } else {\n      var virtualHeight = this.offsets[isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks()];\n      this.virtualEle.setVirtualHeight(virtualHeight, width);\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.setVirtualHeight(1, width);\n\n      if (this.parent.isFrozenGrid()) {\n        this.virtualEle.setMovableVirtualHeight(1, width);\n        this.header.virtualEle.setMovableVirtualHeight(1, width);\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n    var _this = this;\n\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    var page = 0;\n    this.offsetKeys.some(function (offset) {\n      var iOffset = Number(offset);\n      var border = sTop <= _this.offsets[offset] || iOffset === total && sTop > _this.offsets[offset];\n\n      if (border) {\n        if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2] && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n          iOffset = iOffset + 1;\n        }\n\n        info.block = iOffset % 2 === 0 ? 1 : 0;\n        page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n      }\n\n      return border;\n    });\n    return page;\n  };\n\n  VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n    if (info === undefined) {\n      info = {\n        page: this.getPageFromTop(sTop, {})\n      };\n      info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n\n    var block = (info.blockIndexes[0] || 1) - 1;\n    var translate = this.getOffset(block);\n    var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n\n    if (isOnenter) {\n      info = this.prevInfo;\n    }\n\n    var result = translate > sTop ? this.getOffset(block - 1) : endTranslate < sTop + cHeight ? this.getOffset(block + 1) : translate;\n    var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] - this.tmpOffsets[info.blockIndexes[0]];\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n\n    if (result + blockHeight > this.offsets[totalBlocks]) {\n      result -= result + blockHeight - this.offsets[totalBlocks];\n    }\n\n    return result;\n  };\n\n  VirtualContentRenderer.prototype.getOffset = function (block) {\n    return Math.min(this.offsets[block] | 0, this.offsets[this.maxBlock] | 0);\n  };\n\n  VirtualContentRenderer.prototype.onEntered = function () {\n    var _this = this;\n\n    return function (element, current, direction, e, isWheel, check) {\n      if (Browser.isIE && !isWheel && check && !_this.preventEvent) {\n        _this.parent.showSpinner();\n      }\n\n      var colVFtable = _this.parent.enableColumnVirtualization && _this.parent.isFrozenGrid();\n\n      var xAxis = current.axis === 'X';\n      var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n\n      var height = _this.content.getBoundingClientRect().height;\n\n      var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n\n      if (xAxis && !colVFtable) {\n        var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n\n        var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n        x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n      }\n\n      var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n\n      _this.virtualEle.adjustTable(colVFtable ? 0 : x, Math.min(y, _this.offsets[_this.maxBlock]));\n\n      if (colVFtable) {\n        _this.virtualEle.adjustMovableTable(x, 0);\n      }\n\n      if (_this.parent.enableColumnVirtualization) {\n        _this.header.virtualEle.adjustTable(colVFtable ? 0 : x, 0);\n\n        if (colVFtable) {\n          _this.header.virtualEle.adjustMovableTable(x, 0);\n        }\n      }\n    };\n  };\n\n  VirtualContentRenderer.prototype.dataBound = function () {\n    this.parent.notify(events.refreshVirtualFrozenHeight, {});\n\n    if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      this.parent.selectRow(this.selectedRowIndex);\n    } else {\n      this.activeKey = this.empty;\n    }\n  };\n\n  VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n    if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n      var transform = getTransformValues(this.content.firstElementChild);\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      var rowTop = args.row.getBoundingClientRect().top - gridTop;\n      var height = this.content.getBoundingClientRect().height;\n      var isBottom = height < rowTop;\n      var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n      var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n      this.virtualEle.adjustTable(transform.width, translateY);\n      var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n\n      if (lastRowTop < height) {\n        translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n        this.virtualEle.adjustTable(transform.width, translateY - this.parent.getRowHeight() / 2);\n      }\n    }\n\n    this.isSelection = false;\n  };\n\n  VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    var startIdx = this.maxPage * this.parent.pageSettings.pageSize - visibleRowCount;\n    return index >= startIdx;\n  };\n\n  VirtualContentRenderer.prototype.refreshMaxPage = function () {\n    if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n      this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n    }\n  };\n\n  VirtualContentRenderer.prototype.setVirtualPageQuery = function (args) {\n    var row = this.parent.getContent().querySelector('.e-row');\n\n    if (row && this.parent.isManualRefresh && this.currentInfo.blockIndexes && this.currentInfo.blockIndexes.length === 3) {\n      this.vgenerator.startIndex = parseInt(row.getAttribute('aria-rowindex'), 10);\n      this.vgenerator.currentInfo = extend({}, this.currentInfo);\n      this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();\n      var includePrevPage = this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0;\n\n      if (includePrevPage) {\n        this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize();\n        this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1);\n      } else {\n        this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1);\n      }\n\n      var skip = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();\n      var take = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();\n      args.query.skip(skip);\n      args.query.take(take);\n      args.skipPage = true;\n    }\n  };\n\n  VirtualContentRenderer.prototype.eventListener = function (action) {\n    var _this = this;\n\n    this.parent[action](dataReady, this.onDataReady, this);\n    this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n    this.parent[action](refreshVirtualBlock, this.refreshContentRows, this);\n    this.parent[action](events.selectVirtualRow, this.selectVirtualRow, this);\n    this.parent[action](events.virtaulCellFocus, this.virtualCellFocus, this);\n    this.parent[action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n    this.parent[action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n    this.parent[action](events.virtualScrollEdit, this.restoreEdit, this);\n    this.parent[action](events.virtualScrollEditSuccess, this.editSuccess, this);\n    this.parent[action](events.refreshVirtualCache, this.refreshCache, this);\n    this.parent[action](events.editReset, this.resetIsedit, this);\n    this.parent[action](events.getVirtualData, this.getVirtualData, this);\n    this.parent[action](events.virtualScrollEditCancel, this.editCancel, this);\n    this.parent[action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n    this.parent[action](events.setVirtualPageQuery, this.setVirtualPageQuery, this);\n    this.parent[action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n    this.parent[action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n    this.parent[action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n    this.parent[action](events.scrollToEdit, this.scrollToEdit, this);\n    var event = this.actions;\n\n    for (var i = 0; i < event.length; i++) {\n      this.parent[action](event[i] + \"-begin\", this.onActionBegin, this);\n    }\n\n    var fn = function () {\n      _this.observer.observe(function (scrollArgs) {\n        return _this.scrollListener(scrollArgs);\n      }, _this.onEntered());\n\n      var gObj = _this.parent;\n\n      if (gObj.enablePersistence && gObj.scrollPosition) {\n        _this.content.scrollTop = gObj.scrollPosition.top;\n        var scrollValues = {\n          direction: 'down',\n          sentinel: _this.observer.sentinelInfo.down,\n          offset: gObj.scrollPosition,\n          focusElement: gObj.element\n        };\n\n        _this.scrollListener(scrollValues);\n\n        if (gObj.enableColumnVirtualization) {\n          _this.content.scrollLeft = gObj.scrollPosition.left;\n        }\n      }\n\n      _this.parent.off(contentReady, fn);\n    };\n\n    this.parent.on(contentReady, fn, this);\n  };\n\n  VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n    var isFrozen = this.parent.isFrozenGrid();\n    var allowScroll = true;\n    this.validationCheck = true;\n\n    if (this.isAdd && this.content.scrollTop > 0) {\n      allowScroll = false;\n      var keys = Object.keys(this.offsets);\n      this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n    }\n\n    var row = this.parent.getRowByIndex(this.editedRowIndex);\n\n    if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n      if (!row || !this.isRowInView(row)) {\n        var rowIndex = this.parent.getRowHeight();\n        var scrollTop = this.editedRowIndex * rowIndex;\n\n        if (!isNullOrUndefined(scrollTop)) {\n          allowScroll = false;\n          this.content.scrollTop = scrollTop;\n        }\n      }\n    }\n\n    if (col && allowScroll) {\n      var offset = this.vgenerator.cOffsets[col.index - this.parent.getVisibleFrozenColumns() - 1];\n\n      if (!this.parent.enableColumnVirtualization) {\n        var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n        offset = isFrozen ? header.parentElement.offsetLeft - this.parent.getFrozenVirtualHeader().offsetWidth : header.parentElement.offsetLeft;\n      }\n\n      if (isFrozen) {\n        this.parent.getMovableVirtualContent().scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n      } else {\n        this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n      }\n    }\n\n    if (col && !allowScroll) {\n      this.validationCol = col;\n    }\n  };\n\n  VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n    rowObj.cells = this.vgenerator.generateCells(rowObj.foreignKeyData);\n  };\n\n  VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n    this.isCancel = e.isCancel;\n  };\n  /**\n   * @param {Object} data - specifies the data\n   * @param {Object} data.virtualData -specifies the data\n   * @param {boolean} data.isAdd - specifies isAdd\n   * @param {boolean} data.isCancel - specifies boolean in cancel\n   * @param {boolean} data.isScroll - specifies boolean for scroll\n   * @returns {void}\n   * @hidden\n   */\n\n\n  VirtualContentRenderer.prototype.getVirtualData = function (data) {\n    if (this.isNormaledit) {\n      var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n      var keys = Object.keys(this.virtualData);\n      data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n\n      if (error) {\n        return;\n      }\n\n      this.virtualData = keys.length ? this.virtualData : data.virtualData;\n      this.getVirtualEditedData(this.virtualData);\n      data.virtualData = this.virtualData;\n      data.isAdd = this.isAdd;\n      data.isCancel = this.isCancel;\n    }\n  };\n\n  VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n    this.isContextMenuOpen = args.isOpen;\n  };\n\n  VirtualContentRenderer.prototype.editCancel = function (args) {\n    var dataIndex = getEditedDataIndex(this.parent, args.data);\n\n    if (!isNullOrUndefined(dataIndex)) {\n      args.data = this.parent.getCurrentViewRecords()[dataIndex];\n    }\n  };\n\n  VirtualContentRenderer.prototype.editSuccess = function (args) {\n    if (this.isNormaledit) {\n      if (!this.isAdd && args.data) {\n        this.updateCurrentViewData(args.data);\n      }\n\n      this.isAdd = false;\n    }\n  };\n\n  VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n    var dataIndex = getEditedDataIndex(this.parent, data);\n\n    if (!isNullOrUndefined(dataIndex)) {\n      this.parent.getCurrentViewRecords()[dataIndex] = data;\n    }\n  };\n\n  VirtualContentRenderer.prototype.actionBegin = function (args) {\n    if (args.requestType !== 'virtualscroll') {\n      this.requestType = args.requestType;\n    }\n\n    if (!args.cancel) {\n      this.parent.notify(events.refreshVirtualFrozenRows, args);\n    }\n  };\n\n  VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n    // To decide the action (select or scroll), when using arrow keys for cell focus\n    var ele = document.activeElement;\n\n    if (ele.classList.contains(literals.rowCell) && e && (e.action === 'upArrow' || e.action === 'downArrow')) {\n      var rowIndex = parseInt(ele.parentElement.getAttribute(literals.ariaRowIndex), 10);\n\n      if (e && (e.action === 'downArrow' || e.action === 'upArrow')) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n\n        if (e.action === 'downArrow') {\n          rowIndex += 1;\n        } else {\n          rowIndex -= 1;\n        }\n\n        this.rowIndex = rowIndex;\n        this.cellIndex = parseInt(ele.getAttribute(literals.ariaColIndex), 10);\n        var row = this.parent.getRowByIndex(rowIndex);\n        var page = this.parent.pageSettings.currentPage;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var emptyRow = false;\n\n        if (isNullOrUndefined(row)) {\n          emptyRow = true;\n\n          if (e.action === 'downArrow' && page === this.maxPage - 1 || e.action === 'upArrow' && page === 1) {\n            emptyRow = false;\n          }\n        }\n\n        if (emptyRow || ensureLastRow(row, this.parent) && e.action === 'downArrow' || ensureFirstRow(row, this.parent.getRowHeight() * 2) && e.action === 'upArrow') {\n          this.activeKey = e.action;\n          scrollEle.scrollTop = e.action === 'downArrow' ? (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n        } else {\n          this.activeKey = this.empty;\n        }\n\n        this.parent.selectRow(rowIndex);\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.editActionBegin = function (e) {\n    this.editedRowIndex = e.index;\n    var rowData = extend({}, this.getRowObjectByIndex(e.index));\n    var keys = Object.keys(this.virtualData);\n    e.data = keys.length ? this.virtualData : rowData;\n    e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n  };\n\n  VirtualContentRenderer.prototype.refreshCache = function (args) {\n    var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n    var index = this.editedRowIndex - (block - 1) * this.getBlockSize();\n    this.vgenerator.cache[block][index].data = args.data;\n\n    if (this.vgenerator.movableCache[block]) {\n      this.vgenerator.movableCache[block][index].data = args.data;\n    }\n\n    if (this.vgenerator.frozenRightCache[block]) {\n      this.vgenerator.frozenRightCache[block][index].data = args.data;\n    }\n  };\n\n  VirtualContentRenderer.prototype.actionComplete = function (args) {\n    var editRequestTypes = ['delete', 'save', 'cancel'];\n    var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n\n    if (editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    })) {\n      this.refreshOffsets();\n\n      if (this.parent.isFrozenGrid()) {\n        this.vgenerator.refreshColOffsets();\n        this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight();\n      } else {\n        this.refreshVirtualElement();\n      }\n    }\n\n    if (this.isNormaledit && (dataActionRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }) || editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }))) {\n      this.isCancel = true;\n      this.isAdd = false;\n      this.editedRowIndex = this.empty;\n      this.virtualData = {};\n\n      if (this.parent.editModule) {\n        this.parent.editModule.editModule.previousData = undefined;\n      }\n    }\n\n    if (this.parent.enableColumnVirtualization && args.requestType === 'filterafteropen' && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n      this.parent.resetFilterDlgPosition(args.columnName);\n    }\n  };\n\n  VirtualContentRenderer.prototype.resetIsedit = function () {\n    if (this.parent.enableVirtualization && this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length || this.parent.editSettings.allowAdding && this.isAdd) {\n        this.parent.isEdit = true;\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n    if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n      if (this.parent.element.querySelector('.e-gridform')) {\n        var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n        var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n\n        if (editForm || addForm) {\n          var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex)) : extend({}, this.emptyRowData);\n          var keys = Object.keys(this.virtualData);\n          this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n        }\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n    var _this = this;\n\n    this.parent.columnModel.filter(function (e) {\n      _this.emptyRowData[e.field] = _this.empty;\n    });\n  };\n\n  VirtualContentRenderer.prototype.addActionBegin = function (args) {\n    if (this.isNormaledit) {\n      if (!Object.keys(this.emptyRowData).length) {\n        this.createEmptyRowdata();\n      }\n\n      this.isAdd = true;\n      var page = this.parent.pageSettings.currentPage;\n\n      if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n        this.isAdd = true;\n        this.onActionBegin();\n        args.startEdit = false;\n        this.content.scrollTop = 0;\n      }\n\n      if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n        this.isAdd = true;\n        this.parent.setProperties({\n          pageSettings: {\n            currentPage: this.maxPage - 1\n          }\n        }, true);\n        args.startEdit = false;\n        this.content.scrollTop = this.offsets[this.offsetKeys.length];\n      }\n    }\n  };\n  /**\n   * @param {number} index - specifies the index\n   * @returns {Object} returns the object\n   * @hidden\n   */\n\n\n  VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n    var data = this.getRowCollection(index, false, true);\n    return data;\n  };\n\n  VirtualContentRenderer.prototype.getBlockSize = function () {\n    return this.parent.pageSettings.pageSize >> 1;\n  };\n\n  VirtualContentRenderer.prototype.getBlockHeight = function () {\n    return this.getBlockSize() * this.parent.getRowHeight();\n  };\n\n  VirtualContentRenderer.prototype.isEndBlock = function (index) {\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    return index >= totalBlocks || index === totalBlocks - 1;\n  };\n\n  VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n    var rows = this.parent.vcRows;\n    return Math.floor(rows.length / this.getBlockSize() < 1 ? 1 : rows.length / this.getBlockSize());\n  };\n\n  VirtualContentRenderer.prototype.getTotalBlocks = function () {\n    return Math.ceil(this.count / this.getBlockSize());\n  };\n\n  VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n    return this.vgenerator.cOffsets[block] | 0;\n  };\n\n  VirtualContentRenderer.prototype.getModelGenerator = function () {\n    return new VirtualRowModelGenerator(this.parent);\n  };\n\n  VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n    if (this.actions.some(function (value) {\n      return value === action;\n    })) {\n      this.preventEvent = this.content.scrollTop !== 0;\n      this.content.scrollTop = 0;\n    }\n\n    if (action !== 'virtualscroll') {\n      this.isAdd = false;\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  VirtualContentRenderer.prototype.onActionBegin = function (e) {\n    //Update property silently..\n    this.parent.setProperties({\n      pageSettings: {\n        currentPage: 1\n      }\n    }, true);\n  };\n\n  VirtualContentRenderer.prototype.getRows = function () {\n    return this.vgenerator.getRows();\n  };\n\n  VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n    var row;\n\n    if (isGroupAdaptive(this.parent)) {\n      row = this.parent.getDataRows()[index];\n    } else if (this.prevInfo) {\n      row = this.getRowCollection(index, false);\n    }\n\n    return row;\n  };\n\n  VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, true);\n  };\n\n  VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, false, false, true);\n  };\n\n  VirtualContentRenderer.prototype.getRowCollection = function (index, isMovable, isRowObject, isFrozenRight) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    var rowCollection = isMovable ? this.parent.getMovableDataRows() : this.parent.getDataRows();\n    rowCollection = isFrozenRight ? this.parent.getFrozenRightDataRows() : rowCollection;\n    var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n\n    if (isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n      startIdx = parseInt(this.parent.getRows()[0].getAttribute(literals.ariaRowIndex), 10);\n      collection = collection.filter(function (m) {\n        return isNullOrUndefined(m.items);\n      });\n    }\n\n    var selectedRow = collection[index - startIdx];\n\n    if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n      if (!isRowObject) {\n        selectedRow = index <= this.parent.frozenRows ? rowCollection[index] : rowCollection[index - startIdx + this.parent.frozenRows];\n      } else {\n        selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[index].data : selectedRow;\n      }\n    }\n\n    return selectedRow;\n  };\n\n  VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    return startIdx + index;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  VirtualContentRenderer.prototype.refreshOffsets = function () {\n    var gObj = this.parent;\n    var row = 0;\n    var bSize = this.getBlockSize();\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    this.prevHeight = this.offsets[total];\n    this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n    this.offsets = {}; //Row offset update\n    // eslint-disable-next-line prefer-spread\n\n    var blocks = Array.apply(null, Array(total)).map(function () {\n      return ++row;\n    });\n\n    for (var i = 0; i < blocks.length; i++) {\n      var tmp = (this.vgenerator.cache[blocks[i]] || []).length;\n      var rem = !isGroupAdaptive(this.parent) ? this.count % bSize : gObj.vcRows.length % bSize;\n      var size = !isGroupAdaptive(this.parent) && blocks[i] in this.vgenerator.cache ? tmp * this.parent.getRowHeight() : rem && blocks[i] === total ? rem * this.parent.getRowHeight() : this.getBlockHeight(); // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n      // tmp * getRowHeight() : this.getBlockHeight();\n\n      this.offsets[blocks[i]] = (this.offsets[blocks[i] - 1] | 0) + size;\n      this.tmpOffsets[blocks[i]] = this.offsets[blocks[i] - 1] | 0;\n    }\n\n    this.offsetKeys = Object.keys(this.offsets);\n\n    if (isGroupAdaptive(this.parent)) {\n      this.parent.vGroupOffsets = this.offsets;\n    } //Column offset update\n\n\n    if (this.parent.enableColumnVirtualization) {\n      this.vgenerator.refreshColOffsets();\n    }\n  };\n\n  VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n    this.vgenerator.refreshColOffsets();\n    this.setVirtualHeight();\n  };\n\n  VirtualContentRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var frozenCols = this.parent.getFrozenColumns();\n    var fcntColGrp;\n    var mcntColGrp;\n\n    if (frozenCols) {\n      fcntColGrp = [].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll('col'));\n      mcntColGrp = [].slice.call(this.parent.getMovableVirtualContent().querySelectorAll('col'));\n    }\n\n    var rows = [];\n    rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n\n      return r.isDataRow;\n    });\n    var isRefresh = true;\n\n    if (!gObj.groupSettings.columns.length && testRow) {\n      isRefresh = false;\n    }\n\n    var tr = gObj.getDataRows();\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      var idx = gObj.getNormalizedColumnIndex(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n      var colGrp = void 0;\n\n      if (fcntColGrp && mcntColGrp) {\n        if (idx >= frozenCols) {\n          colGrp = mcntColGrp;\n          tr = this.parent.getMovableRows();\n          idx = idx - frozenCols;\n        } else {\n          colGrp = fcntColGrp;\n        }\n      } else {\n        colGrp = this.getColGroup().children;\n      }\n\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(colGrp[idx], {\n          'display': displayVal\n        });\n      }\n\n      if (!isRefresh) {\n        var width = void 0;\n\n        if (column.width) {\n          if (column.visible) {\n            width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n          } else {\n            width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n          }\n        }\n\n        if (width > gObj.width) {\n          this.setDisplayNone(tr, idx, displayVal, rows);\n\n          if (this.parent.enableColumnVirtualization) {\n            this.virtualEle.setWrapperWidth(width + '');\n          }\n\n          this.refreshVirtualElement();\n        } else {\n          isRefresh = true;\n        }\n      }\n\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n\n      this.parent.invokedFromMedia = false;\n    }\n\n    if (isRefresh || frozenCols) {\n      this.refreshContentRows({\n        requestType: 'refresh'\n      });\n    } else {\n      this.parent.notify(events.partialRefresh, {\n        rows: rows,\n        args: {\n          isFrozen: false,\n          rows: rows\n        }\n      });\n    }\n  };\n\n  VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n    var _this = this;\n\n    args.isAvailable = args.selectedIndex < this.count;\n\n    if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    }) && !this.parent.selectionModule.isInteracted) {\n      var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n      var rowHeight = this.parent.getRowHeight();\n\n      if (!selectedRow || !this.isRowInView(selectedRow)) {\n        this.isSelection = true;\n        this.selectedRowIndex = args.selectedIndex;\n        var scrollTop = (args.selectedIndex + 1) * rowHeight;\n\n        if (!isNullOrUndefined(scrollTop)) {\n          var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n          this.selectRowIndex = args.selectedIndex;\n          this.content.scrollTop = scrollTop;\n          this.isSelectionScroll = this.observer.check(direction);\n        }\n      }\n    }\n\n    if (this.parent.isFrozenGrid() && this.requestType) {\n      if (this.parent.getTablesCount() === this.frzIdx) {\n        this.requestType = this.empty;\n        this.frzIdx = 1;\n      } else {\n        this.frzIdx++;\n      }\n    } else {\n      this.requestType = this.empty;\n    }\n  };\n\n  VirtualContentRenderer.prototype.isRowInView = function (row) {\n    var top = row.getBoundingClientRect().top;\n    var bottom = row.getBoundingClientRect().bottom;\n    return top >= this.content.getBoundingClientRect().top && bottom <= this.content.getBoundingClientRect().bottom;\n  };\n\n  return VirtualContentRenderer;\n}(ContentRender);\n\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\n\nvar VirtualHeaderRenderer =\n/** @class */\nfunction (_super) {\n  __extends(VirtualHeaderRenderer, _super);\n\n  function VirtualHeaderRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.virtualEle = new VirtualElementHandler();\n    _this.isMovable = false;\n    _this.gen = new VirtualRowModelGenerator(_this.parent);\n\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n\n    _this.parent.on(refreshVirtualBlock, function (e) {\n      return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null;\n    }, _this);\n\n    return _this;\n  }\n\n  VirtualHeaderRenderer.prototype.renderTable = function () {\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n\n    _super.prototype.renderTable.call(this);\n\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n    this.virtualEle.content.style.position = 'relative';\n    this.virtualEle.renderWrapper();\n    this.virtualEle.renderPlaceHolder('absolute');\n  };\n\n  VirtualHeaderRenderer.prototype.appendContent = function (table) {\n    if (!this.isMovable) {\n      this.virtualEle.wrapper.appendChild(table);\n    } else {\n      this.virtualEle.movableWrapper.appendChild(table);\n      this.isMovable = false;\n    }\n  };\n\n  VirtualHeaderRenderer.prototype.refreshUI = function () {\n    this.isMovable = this.parent.isFrozenGrid();\n    this.setFrozenTable(this.parent.getMovableVirtualContent());\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n\n    _super.prototype.refreshUI.call(this);\n\n    this.setFrozenTable(this.parent.getFrozenVirtualContent());\n  };\n\n  VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var displayVal;\n    var idx;\n    var needFullRefresh;\n    var frozenCols = this.parent.getFrozenColumns();\n    var fhdrColGrp;\n    var mhdrColGrp;\n\n    if (frozenCols) {\n      fhdrColGrp = [].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll('col'));\n      mhdrColGrp = [].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll('col'));\n    }\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n      var colGrp = void 0;\n\n      if (fhdrColGrp && mhdrColGrp) {\n        if (idx >= frozenCols) {\n          colGrp = mhdrColGrp;\n          idx = idx - frozenCols;\n        } else {\n          colGrp = fhdrColGrp;\n        }\n      } else {\n        colGrp = this.getColGroup().children;\n      }\n\n      setStyleAttribute(colGrp[idx], {\n        'display': displayVal\n      });\n\n      if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n        var tablewidth = void 0;\n\n        if (column.visible) {\n          tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n        } else {\n          tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n        }\n\n        if (tablewidth > gObj.width) {\n          this.setDisplayNone(column, displayVal);\n          this.virtualEle.setWrapperWidth(tablewidth + '');\n          this.gen.refreshColOffsets();\n        } else {\n          needFullRefresh = true;\n        }\n      } else {\n        needFullRefresh = true;\n      }\n\n      if (needFullRefresh && !frozenCols) {\n        this.refreshUI();\n      }\n    }\n\n    if (frozenCols) {\n      this.parent.notify(events.columnPositionChanged, {});\n    }\n  };\n\n  VirtualHeaderRenderer.prototype.setFrozenTable = function (content) {\n    if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization && this.parent.contentModule.isXaxis()) {\n      this.parent.contentModule.setTable(content.querySelector('.' + literals.table));\n    }\n  };\n\n  VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n    var frozenCols = this.parent.isFrozenGrid();\n    var table = this.getTable();\n\n    if (frozenCols && col.getFreezeTableName() === 'movable') {\n      table = this.parent.getMovableVirtualHeader().querySelector('.' + literals.table);\n    }\n\n    for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n      var ele = _a[_i];\n\n      if (ele.querySelector('[e-mappinguid]') && ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n        setStyleAttribute(ele, {\n          'display': displayVal\n        });\n\n        if (displayVal === '') {\n          removeClass([ele], 'e-hide');\n        }\n\n        break;\n      }\n    }\n  };\n\n  return VirtualHeaderRenderer;\n}(HeaderRender);\n\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\n\nvar VirtualElementHandler =\n/** @class */\nfunction () {\n  function VirtualElementHandler() {}\n\n  VirtualElementHandler.prototype.renderWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height)\n    });\n    this.wrapper.appendChild(this.table);\n    this.content.appendChild(this.wrapper);\n  };\n\n  VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n    if (position === void 0) {\n      position = 'relative';\n    }\n\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack',\n      styles: \"position:\" + position\n    });\n    this.content.appendChild(this.placeholder);\n  };\n\n  VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height) + \"; display: flex\"\n    });\n    this.content.appendChild(this.wrapper);\n  };\n\n  VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.content.appendChild(this.placeholder);\n  };\n\n  VirtualElementHandler.prototype.renderMovableWrapper = function (height) {\n    this.movableWrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height)\n    });\n    this.movableContent.appendChild(this.movableWrapper);\n  };\n\n  VirtualElementHandler.prototype.renderMovablePlaceHolder = function () {\n    this.movablePlaceholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.movableContent.appendChild(this.movablePlaceholder);\n  };\n\n  VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n    this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n\n  VirtualElementHandler.prototype.adjustMovableTable = function (xValue, yValue) {\n    this.movableWrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n\n  VirtualElementHandler.prototype.setMovableWrapperWidth = function (width, full) {\n    this.movableWrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n\n  VirtualElementHandler.prototype.setMovableVirtualHeight = function (height, width) {\n    this.movablePlaceholder.style.height = height + \"px\";\n    this.movablePlaceholder.style.width = width;\n  };\n\n  VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n    this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n\n  VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n    this.placeholder.style.height = height + \"px\";\n    this.placeholder.style.width = width;\n  };\n\n  VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n    wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n\n  return VirtualElementHandler;\n}();\n\nexport { VirtualElementHandler };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","remove","createElement","closest","formatUnit","Browser","extend","isNullOrUndefined","removeClass","DataManager","dataReady","modelChanged","refreshVirtualBlock","contentReady","events","RenderType","ContentRender","HeaderRender","InterSectionObserver","VirtualRowModelGenerator","isGroupAdaptive","ensureLastRow","ensureFirstRow","getEditedDataIndex","getTransformValues","setStyleAttribute","literals","VirtualContentRenderer","_super","parent","locator","_this","call","prevHeight","startIndex","preStartIndex","preventEvent","actions","offsets","tmpOffsets","virtualEle","VirtualElementHandler","offsetKeys","isFocused","isSelection","isBottom","rndrCount","empty","undefined","isCancel","requestTypes","isNormaledit","editSettings","mode","virtualData","emptyRowData","vfColIndex","frzIdx","isContextMenuOpen","isSelectionScroll","validationCheck","eventListener","on","columnVisibilityChanged","setVisible","vgenerator","generator","renderTable","header","getService","getRenderer","Header","table","getTable","content","getPanel","querySelector","renderWrapper","height","renderPlaceHolder","wrapper","style","position","debounceEvent","dataSource","offline","opt","container","pageHeight","getBlockHeight","axes","enableColumnVirtualization","observer","renderEmpty","tbody","appendChild","adjustTable","getReorderedFrozenRows","args","blockIndex","virtualInfo","blockIndexes","colsIndex","columnIndexes","page","renderMovableContent","recordslength","getCurrentViewRecords","length","firstRecords","renderModule","data","dataManager","json","slice","virtualRows","generateRows","splice","frozenRows","scrollListener","scrollArgs","scrollAfterEdit","enablePersistence","scrollPosition","offset","isDestroyed","document","activeElement","info","sentinel","viewInfo","currentInfo","getInfoFromView","direction","prevInfo","toString","event","top","scrollTop","pageSettings","currentPage","notify","requestType","focusElement","axis","isIE","hideSpinner","restoreEdit","setColumnIndexesInView","loadNext","loadSelf","nextInfo","block","blk","isBlockAvailable","e","isBlockAdded","tempBlocks","infoType","sentinelInfo","endIndex","preEndIndex","getPageFromTop","getBlockIndexes","blocks","ensureBlocks","activeKey","newBlock","indexOf","filter","val","every","bind","Math","max","firstBlock","ceil","rowIndex","getBlockSize","getColumnIndexes","getColumnIndexesInView","setKeyboardNavIndex","blazorDataLoad","blzRowIndex","blur","index","mIdx","old","indexes","isFrozenGrid","ind","isEndBlock","some","result","getGroupedTotalBlocks","getTotalBlocks","appendContent","target","newChild","isFrozen","frzCols","getFrozenColumns","getFrozenLeftColumnsCount","colVFtable","checkFirstBlockColIndexes","cBlock","cOffset","getColumnOffset","width","groupSettings","columns","refreshOffsets","element","vHeight","getBoundingClientRect","value","translate","getTranslateY","adjustMovableTable","cIndex","setMovableWrapperWidth","setWrapperWidth","name","parentNode","renderFrozenRightContent","getContent","getFrozenVirtualContent","getMovableVirtualContent","isReact","rowTemplate","i","children","getFrozenMode","leftRight","sTop","setVirtualHeight","setPageHeight","getOffset","focus","lastPage","firstElementChild","autoCol","focusCell","restoreAdd","ensureSelectedRowPosition","validationScrollLeft","initialRowTop","gridTop","getRowByIndex","tableName","isLoaded","includePrevPage","left","trigger","validationCol","cOffsets","getVisibleFrozenColumns","movableContent","scrollLeft","editModule","editFormValidate","selectRowIndex","row","isRowInView","rowSelected","frozenCols","push","cell","cells","cellIndex","preventScroll","selectRow","parseInt","getAttribute","ariaRowIndex","allowEditing","editedRowIndex","keys","isXaxis","getMovableRowByIndex","editedRow","top_1","offsetHeight","getRowHeight","isEdit","startEdit","rowData","getRowObjectByIndex","getVirtualEditedData","editForms","getElementsByClassName","isFormDestroyed","formObj","getCurrentEditedData","startAdd","getMovableVirtualHeader","addedRow","isAdd","isTop","newRowPosition","maxPage","addRecord","onDataReady","count","pageSize","checkAndResetCache","resetScrollPosition","virtualHeightTemp","scrollableElementHeight","clientHeight","virtualHeight","setMovableVirtualHeight","total","iOffset","Number","border","min","getPage","cHeight","isOnenter","endTranslate","blockHeight","totalBlocks","maxBlock","onEntered","current","isWheel","check","showSpinner","xAxis","x","idx","maxLeft","y","dataBound","refreshVirtualFrozenHeight","selectedRowIndex","isLastBlockRow","transform","rowTop","remainHeight","translateY","lastRowTop","lastElementChild","scrollEle","visibleRowCount","floor","startIdx","refreshMaxPage","vcRows","setVirtualPageQuery","isManualRefresh","unshift","skip","take","query","skipPage","action","addEventListener","actionBegin","actionComplete","refreshContentRows","selectVirtualRow","virtaulCellFocus","virtualCellFocus","virtualScrollEditActionBegin","editActionBegin","virtualScrollAddActionBegin","addActionBegin","virtualScrollEdit","virtualScrollEditSuccess","editSuccess","refreshVirtualCache","refreshCache","editReset","resetIsedit","getVirtualData","virtualScrollEditCancel","editCancel","refreshVirtualMaxPage","selectRowOnContextOpen","resetVirtualFocus","refreshVirtualEditFormCells","refreshCells","scrollToEdit","onActionBegin","fn","observe","gObj","scrollValues","down","off","col","allowScroll","getHeaderContent","uid","parentElement","offsetLeft","getFrozenVirtualHeader","offsetWidth","enableRtl","abs","rowObj","generateCells","foreignKeyData","error","isScroll","isOpen","dataIndex","updateCurrentViewData","cancel","refreshVirtualFrozenRows","ele","classList","contains","rowCell","ariaColIndex","emptyRow","cache","movableCache","frozenRightCache","editRequestTypes","dataActionRequestTypes","refreshColOffsets","contentModule","virtualRenderer","refreshVirtualElement","previousData","resetFilterDlgPosition","columnName","enableVirtualization","allowAdding","editForm","addForm","createEmptyRowdata","columnModel","field","setProperties","getRowCollection","rows","getModelGenerator","getRows","getDataRows","getMovableVirtualRowByIndex","getFrozenRightVirtualRowByIndex","isMovable","isRowObject","isFrozenRight","prev","rowCollection","getMovableDataRows","getFrozenRightDataRows","collection","allowGrouping","m","items","selectedRow","getRowsObject","getVirtualRowIndex","bSize","apply","map","tmp","rem","size","vGroupOffsets","fcntColGrp","mcntColGrp","querySelectorAll","testRow","r","isDataRow","isRefresh","tr","c","clen","column","getNormalizedColumnIndex","displayVal","visible","colGrp","getMovableRows","getColGroup","setDisplayNone","invokedFromMedia","hideAtMedia","updateMediaColumns","partialRefresh","isAvailable","selectedIndex","selectionModule","isInteracted","rowHeight","getTablesCount","bottom","VirtualHeaderRenderer","gen","refreshUI","headerContent","movableWrapper","setFrozenTable","needFullRefresh","fhdrColGrp","mhdrColGrp","tablewidth","columnPositionChanged","setTable","getFreezeTableName","_i","_a","className","styles","placeholder","renderFrozenWrapper","renderFrozenPlaceHolder","renderMovableWrapper","renderMovablePlaceHolder","movablePlaceholder","xValue","yValue","full","setFreezeWrapperWidth"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Admin Dashboard/Frontend/node_modules/@syncfusion/ej2-grids/src/grid/renderer/virtual-content-renderer.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\nvar VirtualContentRenderer = /** @class */ (function (_super) {\n    __extends(VirtualContentRenderer, _super);\n    function VirtualContentRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.prevHeight = 0;\n        /** @hidden */\n        _this.startIndex = 0;\n        _this.preStartIndex = 0;\n        _this.preventEvent = false;\n        _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n        /** @hidden */\n        _this.offsets = {};\n        _this.tmpOffsets = {};\n        /** @hidden */\n        _this.virtualEle = new VirtualElementHandler();\n        _this.offsetKeys = [];\n        _this.isFocused = false;\n        _this.isSelection = false;\n        _this.isBottom = false;\n        _this.rndrCount = 0;\n        _this.empty = undefined;\n        _this.isCancel = false;\n        _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save'];\n        _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n        /** @hidden */\n        _this.virtualData = {};\n        _this.emptyRowData = {};\n        _this.vfColIndex = [];\n        _this.frzIdx = 1;\n        _this.isContextMenuOpen = false;\n        _this.isSelectionScroll = false;\n        _this.validationCheck = false;\n        _this.locator = locator;\n        _this.eventListener('on');\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.vgenerator = _this.generator;\n        return _this;\n    }\n    VirtualContentRenderer.prototype.renderTable = function () {\n        this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n        this.virtualEle.renderWrapper(this.parent.height);\n        this.virtualEle.renderPlaceHolder();\n        this.virtualEle.wrapper.style.position = 'absolute';\n        var debounceEvent = (this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline);\n        var opt = {\n            container: this.content, pageHeight: this.getBlockHeight() * 2, debounceEvent: debounceEvent,\n            axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n        };\n        this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n    };\n    VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n        this.getTable().appendChild(tbody);\n        this.virtualEle.adjustTable(0, 0);\n    };\n    VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n        var blockIndex = args.virtualInfo.blockIndexes;\n        var colsIndex = args.virtualInfo.columnIndexes;\n        var page = args.virtualInfo.page;\n        args.virtualInfo.blockIndexes = [1, 2];\n        args.virtualInfo.page = 1;\n        if (!args.renderMovableContent) {\n            args.virtualInfo.columnIndexes = [];\n        }\n        var recordslength = this.parent.getCurrentViewRecords().length;\n        var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n        var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n        args.virtualInfo.blockIndexes = blockIndex;\n        args.virtualInfo.columnIndexes = colsIndex;\n        args.virtualInfo.page = page;\n        return virtualRows.splice(0, this.parent.frozenRows);\n    };\n    VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n        this.scrollAfterEdit();\n        if (this.parent.enablePersistence) {\n            this.parent.scrollPosition = scrollArgs.offset;\n        }\n        if (this.preventEvent || this.parent.isDestroyed) {\n            this.preventEvent = false;\n            return;\n        }\n        if (isNullOrUndefined(document.activeElement)) {\n            this.isFocused = false;\n        }\n        else {\n            this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n        }\n        var info = scrollArgs.sentinel;\n        var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n        if (isGroupAdaptive(this.parent)) {\n            if (viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString()) {\n                return;\n            }\n            else {\n                viewInfo.event = 'refresh-virtual-block';\n                if (!isNullOrUndefined(viewInfo.offsets)) {\n                    viewInfo.offsets.top = this.content.scrollTop;\n                }\n                this.parent.pageSettings.currentPage = viewInfo.page;\n                this.parent.notify(viewInfo.event, { requestType: 'virtualscroll', virtualInfo: viewInfo, focusElement: scrollArgs.focusElement });\n                return;\n            }\n        }\n        if (this.prevInfo && ((info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString())\n            || (info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString()))) {\n            if (Browser.isIE) {\n                this.parent.hideSpinner();\n            }\n            this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n            if (info.axis === 'Y') {\n                this.restoreEdit();\n            }\n            return;\n        }\n        this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n        this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n        this.requestType = 'virtualscroll';\n        this.parent.notify(viewInfo.event, {\n            requestType: 'virtualscroll', virtualInfo: viewInfo,\n            focusElement: scrollArgs.focusElement\n        });\n    };\n    VirtualContentRenderer.prototype.block = function (blk) {\n        return this.vgenerator.isBlockAvailable(blk);\n    };\n    VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n        var isBlockAdded = false;\n        var tempBlocks = [];\n        var infoType = { direction: direction, sentinelInfo: info, offsets: e,\n            startIndex: this.preStartIndex, endIndex: this.preEndIndex };\n        infoType.page = this.getPageFromTop(e.top, infoType);\n        infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n        infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n        var blocks = this.ensureBlocks(infoType);\n        if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n            // To avoid dupilcate row index problem in key focus support\n            var newBlock = blocks[blocks.length - 1];\n            if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n                isBlockAdded = true;\n            }\n        }\n        infoType.blockIndexes = blocks;\n        infoType.loadNext = !blocks.filter(function (val) { return tempBlocks.indexOf(val) === -1; })\n            .every(this.block.bind(this));\n        infoType.event = (infoType.loadNext || infoType.loadSelf) ? modelChanged : refreshVirtualBlock;\n        infoType.nextInfo = infoType.loadNext ? { page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1)) } : {};\n        if (isBlockAdded) {\n            infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n        }\n        if (this.activeKey === 'downArrow') {\n            var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n            if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n                infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n            }\n        }\n        infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n            infoType.event = refreshVirtualBlock;\n        }\n        return infoType;\n    };\n    VirtualContentRenderer.prototype.setKeyboardNavIndex = function () {\n        this.blazorDataLoad = true;\n        if (this.activeKey === 'downArrow' || this.activeKey === 'upArrow') {\n            this.blzRowIndex = this.activeKey === 'downArrow' ? this.rowIndex + 1 : this.rowIndex - 1;\n            document.activeElement.blur();\n        }\n    };\n    VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n        var _this = this;\n        var index = info.blockIndexes[info.block];\n        var mIdx;\n        var old = index;\n        var max = Math.max;\n        var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n            // To avoid frozen content white space issue\n            if (info.sentinelInfo.axis === 'X' || (info.sentinelInfo.axis === 'Y' && (info.page === this.prevInfo.page))) {\n                indexes = this.prevInfo.blockIndexes;\n            }\n        }\n        indexes = indexes.filter(function (val, ind) { return indexes.indexOf(val) === ind; });\n        if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n            return indexes;\n        }\n        if (info.loadSelf || (info.direction === 'down' && this.isEndBlock(old))) {\n            indexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        indexes.some(function (val, ind) {\n            var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n            if (result) {\n                mIdx = ind;\n            }\n            return result;\n        });\n        if (mIdx !== undefined) {\n            indexes = indexes.slice(0, mIdx + 1);\n            if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n                indexes = [indexes[0] - 1, indexes[0]];\n            }\n        }\n        return indexes;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n        var _this = this;\n        // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n        var isFrozen = this.parent.isFrozenGrid();\n        var frzCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n        var colVFtable = this.parent.enableColumnVirtualization && isFrozen;\n        this.checkFirstBlockColIndexes(e);\n        var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page &&\n            this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n        this.prevInfo = this.prevInfo || e.virtualInfo;\n        var cBlock = (info.columnIndexes[0]) - 1;\n        if (colVFtable && info.columnIndexes[0] === frzCols) {\n            cBlock = (info.columnIndexes[0] - frzCols) - 1;\n        }\n        var cOffset = this.getColumnOffset(cBlock);\n        var width;\n        var blocks = info.blockIndexes;\n        if (this.parent.groupSettings.columns.length) {\n            this.refreshOffsets();\n        }\n        if (this.parent.height === '100%') {\n            this.parent.element.style.height = '100%';\n        }\n        var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height :\n            this.parent.element.getBoundingClientRect().height;\n        if (!this.requestTypes.some(function (value) { return value === _this.requestType; })) {\n            var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n            this.virtualEle.adjustTable(colVFtable ? 0 : cOffset, translate);\n            if (colVFtable) {\n                this.virtualEle.adjustMovableTable(cOffset, 0);\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.adjustTable(colVFtable ? 0 : cOffset, 0);\n            if (colVFtable) {\n                this.header.virtualEle.adjustMovableTable(cOffset, 0);\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            var cIndex = info.columnIndexes;\n            width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n            if (colVFtable) {\n                this.header.virtualEle.setMovableWrapperWidth(width);\n            }\n            else {\n                this.header.virtualEle.setWrapperWidth(width);\n            }\n        }\n        if (colVFtable) {\n            this.virtualEle.setMovableWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n        }\n        else {\n            this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n        }\n        if (!isNullOrUndefined(target.parentNode)) {\n            remove(target);\n        }\n        var tbody;\n        if (isFrozen) {\n            if (e.renderFrozenRightContent) {\n                tbody = this.parent.getContent().querySelector('.e-frozen-right-content').querySelector(literals.tbody);\n            }\n            else if (!e.renderMovableContent) {\n                tbody = this.parent.getFrozenVirtualContent().querySelector(literals.tbody);\n            }\n            else if (e.renderMovableContent) {\n                tbody = this.parent.getMovableVirtualContent().querySelector(literals.tbody);\n            }\n        }\n        else {\n            tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n        }\n        if (tbody) {\n            remove(tbody);\n            target = null;\n        }\n        var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n        if (!isReact) {\n            target = this.parent.createElement(literals.tbody);\n            target.appendChild(newChild);\n        }\n        else {\n            target = newChild;\n        }\n        if (this.parent.frozenRows && e.requestType === 'virtualscroll' && this.parent.pageSettings.currentPage === 1) {\n            for (var i = 0; i < this.parent.frozenRows; i++) {\n                target.children[0].remove();\n            }\n        }\n        if (isFrozen) {\n            if (e.renderFrozenRightContent) {\n                this.parent.getContent().querySelector('.e-frozen-right-content').querySelector('.' + literals.table).appendChild(target);\n                this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n            }\n            else if (!e.renderMovableContent) {\n                this.parent.getFrozenVirtualContent().querySelector('.' + literals.table).appendChild(target);\n            }\n            else if (e.renderMovableContent) {\n                this.parent.getMovableVirtualContent().querySelector('.' + literals.table).appendChild(target);\n                if (this.parent.getFrozenMode() !== literals.leftRight) {\n                    this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n                }\n            }\n            if (this.vfColIndex.length) {\n                e.virtualInfo.columnIndexes = info.columnIndexes = extend([], this.vfColIndex);\n                this.vfColIndex = e.renderMovableContent ? [] : this.vfColIndex;\n            }\n        }\n        else {\n            this.getTable().appendChild(target);\n            this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n        }\n        if (this.parent.groupSettings.columns.length) {\n            if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n                var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n                this.preventEvent = true;\n                var sTop = this.content.scrollTop;\n                this.content.scrollTop = sTop + blk;\n            }\n            this.setVirtualHeight();\n            this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n        }\n        this.prevInfo = info;\n        if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n            this.content.focus();\n        }\n        var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n        if (this.isBottom) {\n            this.isBottom = false;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n        }\n        if ((this.parent.pageSettings.currentPage === lastPage) && blocks.length === 1) {\n            this.isBottom = true;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 2];\n        }\n        if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n            this.parent.notify(events.autoCol, {});\n        }\n        this.focusCell(e);\n        this.restoreEdit(e);\n        this.restoreAdd(e);\n        this.ensureSelectedRowPosition();\n        this.validationScrollLeft(e, isFrozen);\n        if (!this.initialRowTop) {\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n        }\n        var tableName = e.tableName;\n        var isLoaded = this.parent.getFrozenMode() === 'Left-Right' ? tableName === 'frozen-right' : tableName === 'movable';\n        if (!isFrozen || isLoaded) {\n            this.vgenerator.startIndex = null;\n            this.vgenerator.currentInfo = {};\n            this.vgenerator.includePrevPage = null;\n        }\n    };\n    VirtualContentRenderer.prototype.validationScrollLeft = function (e, isFrozen) {\n        var left = this.parent.getFrozenColumns();\n        var table = this.parent.getFrozenMode();\n        var trigger = !isFrozen || e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent\n            : e.renderFrozenRightContent);\n        if (this.validationCheck && trigger) {\n            if (this.validationCol) {\n                var offset = this.vgenerator.cOffsets[(this.validationCol.index - this.parent.getVisibleFrozenColumns()) - 1];\n                this.validationCol = null;\n                if (this.parent.isFrozenGrid()) {\n                    this.movableContent.scrollLeft = offset;\n                }\n                else {\n                    this.content.scrollLeft = offset;\n                }\n            }\n            else {\n                this.validationCheck = false;\n                this.parent.editModule.editFormValidate();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n        if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n            this.isSelectionScroll = false;\n            var row = this.parent.getRowByIndex(this.selectRowIndex);\n            if (row && !this.isRowInView(row)) {\n                this.rowSelected({ rowIndex: this.selectRowIndex, row: row }, true);\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.checkFirstBlockColIndexes = function (e) {\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid() && e.virtualInfo.columnIndexes[0] === 0) {\n            var indexes = [];\n            var frozenCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n            if (!e.renderMovableContent && e.virtualInfo.columnIndexes.length > frozenCols) {\n                this.vfColIndex = e.virtualInfo.columnIndexes;\n                for (var i = 0; i < frozenCols; i++) {\n                    indexes.push(i);\n                }\n                e.virtualInfo.columnIndexes = indexes;\n            }\n            else if (e.renderMovableContent) {\n                if (!this.vfColIndex.length) {\n                    this.vfColIndex = extend([], e.virtualInfo.columnIndexes);\n                }\n                e.virtualInfo.columnIndexes = extend([], this.vfColIndex);\n                e.virtualInfo.columnIndexes.splice(0, frozenCols);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.focusCell = function (e) {\n        if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            return;\n        }\n        var row = this.parent.getRowByIndex(this.rowIndex);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var cell = row.cells[this.cellIndex];\n        cell.focus({ preventScroll: true });\n        this.parent.selectRow(parseInt(row.getAttribute(literals.ariaRowIndex), 10));\n        this.activeKey = this.empty;\n    };\n    VirtualContentRenderer.prototype.restoreEdit = function (e) {\n        if (this.isNormaledit) {\n            var left = this.parent.getFrozenColumns();\n            var isFrozen = e && this.parent.isFrozenGrid();\n            var table = this.parent.getFrozenMode();\n            var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent\n                : e.renderFrozenRightContent);\n            if ((!isFrozen || (isFrozen && trigger)) && this.parent.editSettings.allowEditing\n                && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n                var row = this.getRowByIndex(this.editedRowIndex);\n                var content = this.content;\n                var keys = Object.keys(this.virtualData);\n                var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n                if (isFrozen && isXaxis) {\n                    row = this.parent.getMovableRowByIndex(this.editedRowIndex);\n                    content = this.movableContent;\n                }\n                if (keys.length && row && !content.querySelector('.' + literals.editedRow)) {\n                    var top_1 = row.getBoundingClientRect().top;\n                    if (isXaxis || (top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight())) {\n                        this.parent.isEdit = false;\n                        this.parent.editModule.startEdit(row);\n                    }\n                }\n                if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n                    var rowData = extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n                    this.virtualData = this.getVirtualEditedData(rowData);\n                }\n            }\n            this.restoreAdd(e);\n        }\n    };\n    VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n        var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n        var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj\n            && this.parent.editModule.formObj.isDestroyed;\n        if (!isFormDestroyed) {\n            for (var i = 0; i < editForms.length; i++) {\n                rowData = this.parent.editModule.getCurrentEditedData(editForms[i], rowData);\n            }\n        }\n        return rowData;\n    };\n    VirtualContentRenderer.prototype.restoreAdd = function (e) {\n        var left = this.parent.getFrozenColumns();\n        var isFrozen = e && this.parent.isFrozenGrid();\n        var table = this.parent.getFrozenMode();\n        var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n        var startAdd = isXaxis && isFrozen ? !(this.parent.getMovableVirtualHeader().querySelector('.' + literals.addedRow)\n            || this.parent.getMovableVirtualContent().querySelector('.' + literals.addedRow)) : !this.parent.element.querySelector('.' + literals.addedRow);\n        var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n        if ((!isFrozen || (isFrozen && trigger)) && this.isNormaledit && this.isAdd && startAdd) {\n            var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n            var isBottom = this.parent.editSettings.newRowPosition === 'Bottom'\n                && this.parent.pageSettings.currentPage === this.maxPage;\n            if (isTop || isBottom) {\n                this.parent.isEdit = false;\n                this.parent.addRecord();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.onDataReady = function (e) {\n        if (!isNullOrUndefined(e.count)) {\n            this.count = e.count;\n            this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n        }\n        this.vgenerator.checkAndResetCache(e.requestType);\n        if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined]\n            .some(function (value) { return e.requestType === value; })) {\n            this.refreshOffsets();\n        }\n        this.setVirtualHeight();\n        this.resetScrollPosition(e.requestType);\n    };\n    /**\n     * @param {number} height - specifies the height\n     * @returns {void}\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n        var width = this.parent.enableColumnVirtualization ?\n            this.getColumnOffset(this.parent.columns.length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n        if (this.parent.isFrozenGrid()) {\n            var virtualHeightTemp = (this.parent.pageSettings.currentPage === 1 && Object.keys(this.offsets).length <= 2) ?\n                this.offsets[1] : this.offsets[this.getTotalBlocks() - 2];\n            var scrollableElementHeight = this.content.clientHeight;\n            virtualHeightTemp = virtualHeightTemp > scrollableElementHeight ? virtualHeightTemp : 0;\n            // To overcome the white space issue in last page (instead of position absolute)\n            this.virtualEle.setVirtualHeight(virtualHeightTemp, width);\n        }\n        else {\n            var virtualHeight = (this.offsets[isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() :\n                this.getTotalBlocks()]);\n            this.virtualEle.setVirtualHeight(virtualHeight, width);\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.setVirtualHeight(1, width);\n            if (this.parent.isFrozenGrid()) {\n                this.virtualEle.setMovableVirtualHeight(1, width);\n                this.header.virtualEle.setMovableVirtualHeight(1, width);\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n        var _this = this;\n        var total = (isGroupAdaptive(this.parent)) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        var page = 0;\n        this.offsetKeys.some(function (offset) {\n            var iOffset = Number(offset);\n            var border = sTop <= _this.offsets[offset] || (iOffset === total && sTop > _this.offsets[offset]);\n            if (border) {\n                if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2]\n                    && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n                    iOffset = iOffset + 1;\n                }\n                info.block = iOffset % 2 === 0 ? 1 : 0;\n                page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n            }\n            return border;\n        });\n        return page;\n    };\n    VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n        if (info === undefined) {\n            info = { page: this.getPageFromTop(sTop, {}) };\n            info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        var block = (info.blockIndexes[0] || 1) - 1;\n        var translate = this.getOffset(block);\n        var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n        if (isOnenter) {\n            info = this.prevInfo;\n        }\n        var result = translate > sTop ?\n            this.getOffset(block - 1) : endTranslate < (sTop + cHeight) ? this.getOffset(block + 1) : translate;\n        var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] -\n            this.tmpOffsets[info.blockIndexes[0]];\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        if (result + blockHeight > this.offsets[totalBlocks]) {\n            result -= (result + blockHeight) - this.offsets[totalBlocks];\n        }\n        return result;\n    };\n    VirtualContentRenderer.prototype.getOffset = function (block) {\n        return Math.min(this.offsets[block] | 0, this.offsets[this.maxBlock] | 0);\n    };\n    VirtualContentRenderer.prototype.onEntered = function () {\n        var _this = this;\n        return function (element, current, direction, e, isWheel, check) {\n            if (Browser.isIE && !isWheel && check && !_this.preventEvent) {\n                _this.parent.showSpinner();\n            }\n            var colVFtable = _this.parent.enableColumnVirtualization && _this.parent.isFrozenGrid();\n            var xAxis = current.axis === 'X';\n            var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n            var height = _this.content.getBoundingClientRect().height;\n            var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n            if (xAxis && !colVFtable) {\n                var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n                var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n                x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n            }\n            var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n            _this.virtualEle.adjustTable(colVFtable ? 0 : x, Math.min(y, _this.offsets[_this.maxBlock]));\n            if (colVFtable) {\n                _this.virtualEle.adjustMovableTable(x, 0);\n            }\n            if (_this.parent.enableColumnVirtualization) {\n                _this.header.virtualEle.adjustTable(colVFtable ? 0 : x, 0);\n                if (colVFtable) {\n                    _this.header.virtualEle.adjustMovableTable(x, 0);\n                }\n            }\n        };\n    };\n    VirtualContentRenderer.prototype.dataBound = function () {\n        this.parent.notify(events.refreshVirtualFrozenHeight, {});\n        if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            this.parent.selectRow(this.selectedRowIndex);\n        }\n        else {\n            this.activeKey = this.empty;\n        }\n    };\n    VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n        if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n            var transform = getTransformValues(this.content.firstElementChild);\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            var rowTop = args.row.getBoundingClientRect().top - gridTop;\n            var height = this.content.getBoundingClientRect().height;\n            var isBottom = height < rowTop;\n            var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n            var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n            this.virtualEle.adjustTable(transform.width, translateY);\n            var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n            if (lastRowTop < height) {\n                translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n                this.virtualEle.adjustTable(transform.width, translateY - (this.parent.getRowHeight() / 2));\n            }\n        }\n        this.isSelection = false;\n    };\n    VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var startIdx = (this.maxPage * this.parent.pageSettings.pageSize) - visibleRowCount;\n        return index >= startIdx;\n    };\n    VirtualContentRenderer.prototype.refreshMaxPage = function () {\n        if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n            this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n        }\n    };\n    VirtualContentRenderer.prototype.setVirtualPageQuery = function (args) {\n        var row = this.parent.getContent().querySelector('.e-row');\n        if (row && this.parent.isManualRefresh && this.currentInfo.blockIndexes && this.currentInfo.blockIndexes.length === 3) {\n            this.vgenerator.startIndex = parseInt(row.getAttribute('aria-rowindex'), 10);\n            this.vgenerator.currentInfo = extend({}, this.currentInfo);\n            this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();\n            var includePrevPage = this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0;\n            if (includePrevPage) {\n                this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize();\n                this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1);\n            }\n            else {\n                this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1);\n            }\n            var skip = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();\n            var take = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();\n            args.query.skip(skip);\n            args.query.take(take);\n            args.skipPage = true;\n        }\n    };\n    VirtualContentRenderer.prototype.eventListener = function (action) {\n        var _this = this;\n        this.parent[action](dataReady, this.onDataReady, this);\n        this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n        this.parent[action](refreshVirtualBlock, this.refreshContentRows, this);\n        this.parent[action](events.selectVirtualRow, this.selectVirtualRow, this);\n        this.parent[action](events.virtaulCellFocus, this.virtualCellFocus, this);\n        this.parent[action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n        this.parent[action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n        this.parent[action](events.virtualScrollEdit, this.restoreEdit, this);\n        this.parent[action](events.virtualScrollEditSuccess, this.editSuccess, this);\n        this.parent[action](events.refreshVirtualCache, this.refreshCache, this);\n        this.parent[action](events.editReset, this.resetIsedit, this);\n        this.parent[action](events.getVirtualData, this.getVirtualData, this);\n        this.parent[action](events.virtualScrollEditCancel, this.editCancel, this);\n        this.parent[action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n        this.parent[action](events.setVirtualPageQuery, this.setVirtualPageQuery, this);\n        this.parent[action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n        this.parent[action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n        this.parent[action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n        this.parent[action](events.scrollToEdit, this.scrollToEdit, this);\n        var event = this.actions;\n        for (var i = 0; i < event.length; i++) {\n            this.parent[action](event[i] + \"-begin\", this.onActionBegin, this);\n        }\n        var fn = function () {\n            _this.observer.observe(function (scrollArgs) { return _this.scrollListener(scrollArgs); }, _this.onEntered());\n            var gObj = _this.parent;\n            if (gObj.enablePersistence && gObj.scrollPosition) {\n                _this.content.scrollTop = gObj.scrollPosition.top;\n                var scrollValues = { direction: 'down', sentinel: _this.observer.sentinelInfo.down,\n                    offset: gObj.scrollPosition, focusElement: gObj.element };\n                _this.scrollListener(scrollValues);\n                if (gObj.enableColumnVirtualization) {\n                    _this.content.scrollLeft = gObj.scrollPosition.left;\n                }\n            }\n            _this.parent.off(contentReady, fn);\n        };\n        this.parent.on(contentReady, fn, this);\n    };\n    VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n        var isFrozen = this.parent.isFrozenGrid();\n        var allowScroll = true;\n        this.validationCheck = true;\n        if (this.isAdd && this.content.scrollTop > 0) {\n            allowScroll = false;\n            var keys = Object.keys(this.offsets);\n            this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n        }\n        var row = this.parent.getRowByIndex(this.editedRowIndex);\n        if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n            if (!row || !this.isRowInView(row)) {\n                var rowIndex = this.parent.getRowHeight();\n                var scrollTop = this.editedRowIndex * rowIndex;\n                if (!isNullOrUndefined(scrollTop)) {\n                    allowScroll = false;\n                    this.content.scrollTop = scrollTop;\n                }\n            }\n        }\n        if (col && allowScroll) {\n            var offset = this.vgenerator.cOffsets[(col.index - this.parent.getVisibleFrozenColumns()) - 1];\n            if (!this.parent.enableColumnVirtualization) {\n                var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n                offset = isFrozen ? header.parentElement.offsetLeft\n                    - this.parent.getFrozenVirtualHeader().offsetWidth\n                    : header.parentElement.offsetLeft;\n            }\n            if (isFrozen) {\n                this.parent.getMovableVirtualContent().scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n            }\n            else {\n                this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n            }\n        }\n        if (col && !allowScroll) {\n            this.validationCol = col;\n        }\n    };\n    VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n        rowObj.cells = this.vgenerator.generateCells(rowObj.foreignKeyData);\n    };\n    VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n        this.isCancel = e.isCancel;\n    };\n    /**\n     * @param {Object} data - specifies the data\n     * @param {Object} data.virtualData -specifies the data\n     * @param {boolean} data.isAdd - specifies isAdd\n     * @param {boolean} data.isCancel - specifies boolean in cancel\n     * @param {boolean} data.isScroll - specifies boolean for scroll\n     * @returns {void}\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getVirtualData = function (data) {\n        if (this.isNormaledit) {\n            var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n            var keys = Object.keys(this.virtualData);\n            data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n            if (error) {\n                return;\n            }\n            this.virtualData = keys.length ? this.virtualData : data.virtualData;\n            this.getVirtualEditedData(this.virtualData);\n            data.virtualData = this.virtualData;\n            data.isAdd = this.isAdd;\n            data.isCancel = this.isCancel;\n        }\n    };\n    VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n        this.isContextMenuOpen = args.isOpen;\n    };\n    VirtualContentRenderer.prototype.editCancel = function (args) {\n        var dataIndex = getEditedDataIndex(this.parent, args.data);\n        if (!isNullOrUndefined(dataIndex)) {\n            args.data = this.parent.getCurrentViewRecords()[dataIndex];\n        }\n    };\n    VirtualContentRenderer.prototype.editSuccess = function (args) {\n        if (this.isNormaledit) {\n            if (!this.isAdd && args.data) {\n                this.updateCurrentViewData(args.data);\n            }\n            this.isAdd = false;\n        }\n    };\n    VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n        var dataIndex = getEditedDataIndex(this.parent, data);\n        if (!isNullOrUndefined(dataIndex)) {\n            this.parent.getCurrentViewRecords()[dataIndex] = data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionBegin = function (args) {\n        if (args.requestType !== 'virtualscroll') {\n            this.requestType = args.requestType;\n        }\n        if (!args.cancel) {\n            this.parent.notify(events.refreshVirtualFrozenRows, args);\n        }\n    };\n    VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n        // To decide the action (select or scroll), when using arrow keys for cell focus\n        var ele = document.activeElement;\n        if (ele.classList.contains(literals.rowCell)\n            && e && (e.action === 'upArrow' || e.action === 'downArrow')) {\n            var rowIndex = parseInt(ele.parentElement.getAttribute(literals.ariaRowIndex), 10);\n            if (e && (e.action === 'downArrow' || e.action === 'upArrow')) {\n                var scrollEle = this.parent.getContent().firstElementChild;\n                if (e.action === 'downArrow') {\n                    rowIndex += 1;\n                }\n                else {\n                    rowIndex -= 1;\n                }\n                this.rowIndex = rowIndex;\n                this.cellIndex = parseInt(ele.getAttribute(literals.ariaColIndex), 10);\n                var row = this.parent.getRowByIndex(rowIndex);\n                var page = this.parent.pageSettings.currentPage;\n                var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n                var emptyRow = false;\n                if (isNullOrUndefined(row)) {\n                    emptyRow = true;\n                    if ((e.action === 'downArrow' && page === this.maxPage - 1) || (e.action === 'upArrow' && page === 1)) {\n                        emptyRow = false;\n                    }\n                }\n                if (emptyRow || (ensureLastRow(row, this.parent) && e.action === 'downArrow')\n                    || (ensureFirstRow(row, this.parent.getRowHeight() * 2) && e.action === 'upArrow')) {\n                    this.activeKey = e.action;\n                    scrollEle.scrollTop = e.action === 'downArrow' ?\n                        (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n                }\n                else {\n                    this.activeKey = this.empty;\n                }\n                this.parent.selectRow(rowIndex);\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.editActionBegin = function (e) {\n        this.editedRowIndex = e.index;\n        var rowData = extend({}, this.getRowObjectByIndex(e.index));\n        var keys = Object.keys(this.virtualData);\n        e.data = keys.length ? this.virtualData : rowData;\n        e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n    };\n    VirtualContentRenderer.prototype.refreshCache = function (args) {\n        var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n        var index = this.editedRowIndex - ((block - 1) * this.getBlockSize());\n        this.vgenerator.cache[block][index].data = args.data;\n        if (this.vgenerator.movableCache[block]) {\n            this.vgenerator.movableCache[block][index].data = args.data;\n        }\n        if (this.vgenerator.frozenRightCache[block]) {\n            this.vgenerator.frozenRightCache[block][index].data = args.data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionComplete = function (args) {\n        var editRequestTypes = ['delete', 'save', 'cancel'];\n        var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n        if (editRequestTypes.some(function (value) { return value === args.requestType; })) {\n            this.refreshOffsets();\n            if (this.parent.isFrozenGrid()) {\n                this.vgenerator.refreshColOffsets();\n                this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight();\n            }\n            else {\n                this.refreshVirtualElement();\n            }\n        }\n        if (this.isNormaledit && (dataActionRequestTypes.some(function (value) { return value === args.requestType; })\n            || editRequestTypes.some(function (value) { return value === args.requestType; }))) {\n            this.isCancel = true;\n            this.isAdd = false;\n            this.editedRowIndex = this.empty;\n            this.virtualData = {};\n            if (this.parent.editModule) {\n                this.parent.editModule.editModule.previousData = undefined;\n            }\n        }\n        if (this.parent.enableColumnVirtualization && args.requestType === 'filterafteropen'\n            && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n            this.parent.resetFilterDlgPosition(args.columnName);\n        }\n    };\n    VirtualContentRenderer.prototype.resetIsedit = function () {\n        if (this.parent.enableVirtualization && this.isNormaledit) {\n            if ((this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length)\n                || (this.parent.editSettings.allowAdding && this.isAdd)) {\n                this.parent.isEdit = true;\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n        if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n            if (this.parent.element.querySelector('.e-gridform')) {\n                var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n                var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n                if (editForm || addForm) {\n                    var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex))\n                        : extend({}, this.emptyRowData);\n                    var keys = Object.keys(this.virtualData);\n                    this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n                }\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n        var _this = this;\n        this.parent.columnModel.filter(function (e) {\n            _this.emptyRowData[e.field] = _this.empty;\n        });\n    };\n    VirtualContentRenderer.prototype.addActionBegin = function (args) {\n        if (this.isNormaledit) {\n            if (!Object.keys(this.emptyRowData).length) {\n                this.createEmptyRowdata();\n            }\n            this.isAdd = true;\n            var page = this.parent.pageSettings.currentPage;\n            if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n                this.isAdd = true;\n                this.onActionBegin();\n                args.startEdit = false;\n                this.content.scrollTop = 0;\n            }\n            if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n                this.isAdd = true;\n                this.parent.setProperties({ pageSettings: { currentPage: this.maxPage - 1 } }, true);\n                args.startEdit = false;\n                this.content.scrollTop = this.offsets[this.offsetKeys.length];\n            }\n        }\n    };\n    /**\n     * @param {number} index - specifies the index\n     * @returns {Object} returns the object\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n        var data = this.getRowCollection(index, false, true);\n        return data;\n    };\n    VirtualContentRenderer.prototype.getBlockSize = function () {\n        return this.parent.pageSettings.pageSize >> 1;\n    };\n    VirtualContentRenderer.prototype.getBlockHeight = function () {\n        return this.getBlockSize() * this.parent.getRowHeight();\n    };\n    VirtualContentRenderer.prototype.isEndBlock = function (index) {\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        return index >= totalBlocks || index === totalBlocks - 1;\n    };\n    VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n        var rows = this.parent.vcRows;\n        return Math.floor((rows.length / this.getBlockSize()) < 1 ? 1 : rows.length / this.getBlockSize());\n    };\n    VirtualContentRenderer.prototype.getTotalBlocks = function () {\n        return Math.ceil(this.count / this.getBlockSize());\n    };\n    VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n        return this.vgenerator.cOffsets[block] | 0;\n    };\n    VirtualContentRenderer.prototype.getModelGenerator = function () {\n        return new VirtualRowModelGenerator(this.parent);\n    };\n    VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n        if (this.actions.some(function (value) { return value === action; })) {\n            this.preventEvent = this.content.scrollTop !== 0;\n            this.content.scrollTop = 0;\n        }\n        if (action !== 'virtualscroll') {\n            this.isAdd = false;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.onActionBegin = function (e) {\n        //Update property silently..\n        this.parent.setProperties({ pageSettings: { currentPage: 1 } }, true);\n    };\n    VirtualContentRenderer.prototype.getRows = function () {\n        return this.vgenerator.getRows();\n    };\n    VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n        var row;\n        if (isGroupAdaptive(this.parent)) {\n            row = this.parent.getDataRows()[index];\n        }\n        else if (this.prevInfo) {\n            row = this.getRowCollection(index, false);\n        }\n        return row;\n    };\n    VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, true);\n    };\n    VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, false, false, true);\n    };\n    VirtualContentRenderer.prototype.getRowCollection = function (index, isMovable, isRowObject, isFrozenRight) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        var rowCollection = isMovable ? this.parent.getMovableDataRows() : this.parent.getDataRows();\n        rowCollection = isFrozenRight ? this.parent.getFrozenRightDataRows() : rowCollection;\n        var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n        if (isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n            startIdx = parseInt(this.parent.getRows()[0].getAttribute(literals.ariaRowIndex), 10);\n            collection = collection.filter(function (m) { return isNullOrUndefined(m.items); });\n        }\n        var selectedRow = collection[index - startIdx];\n        if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n            if (!isRowObject) {\n                selectedRow = index <= this.parent.frozenRows ? rowCollection[index]\n                    : rowCollection[(index - startIdx) + this.parent.frozenRows];\n            }\n            else {\n                selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[index].data : selectedRow;\n            }\n        }\n        return selectedRow;\n    };\n    VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        return startIdx + index;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    VirtualContentRenderer.prototype.refreshOffsets = function () {\n        var gObj = this.parent;\n        var row = 0;\n        var bSize = this.getBlockSize();\n        var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        this.prevHeight = this.offsets[total];\n        this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n        this.offsets = {};\n        //Row offset update\n        // eslint-disable-next-line prefer-spread\n        var blocks = Array.apply(null, Array(total)).map(function () { return ++row; });\n        for (var i = 0; i < blocks.length; i++) {\n            var tmp = (this.vgenerator.cache[blocks[i]] || []).length;\n            var rem = !isGroupAdaptive(this.parent) ? this.count % bSize : (gObj.vcRows.length % bSize);\n            var size = !isGroupAdaptive(this.parent) && blocks[i] in this.vgenerator.cache ?\n                tmp * this.parent.getRowHeight() : rem && blocks[i] === total ? rem * this.parent.getRowHeight() :\n                this.getBlockHeight();\n            // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n            // tmp * getRowHeight() : this.getBlockHeight();\n            this.offsets[blocks[i]] = (this.offsets[blocks[i] - 1] | 0) + size;\n            this.tmpOffsets[blocks[i]] = this.offsets[blocks[i] - 1] | 0;\n        }\n        this.offsetKeys = Object.keys(this.offsets);\n        if (isGroupAdaptive(this.parent)) {\n            this.parent.vGroupOffsets = this.offsets;\n        }\n        //Column offset update\n        if (this.parent.enableColumnVirtualization) {\n            this.vgenerator.refreshColOffsets();\n        }\n    };\n    VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n        this.vgenerator.refreshColOffsets();\n        this.setVirtualHeight();\n    };\n    VirtualContentRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var frozenCols = this.parent.getFrozenColumns();\n        var fcntColGrp;\n        var mcntColGrp;\n        if (frozenCols) {\n            fcntColGrp = [].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll('col'));\n            mcntColGrp = [].slice.call(this.parent.getMovableVirtualContent().querySelectorAll('col'));\n        }\n        var rows = [];\n        rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var isRefresh = true;\n        if (!gObj.groupSettings.columns.length && testRow) {\n            isRefresh = false;\n        }\n        var tr = gObj.getDataRows();\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            var idx = gObj.getNormalizedColumnIndex(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            var colGrp = void 0;\n            if (fcntColGrp && mcntColGrp) {\n                if (idx >= frozenCols) {\n                    colGrp = mcntColGrp;\n                    tr = this.parent.getMovableRows();\n                    idx = idx - frozenCols;\n                }\n                else {\n                    colGrp = fcntColGrp;\n                }\n            }\n            else {\n                colGrp = this.getColGroup().children;\n            }\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(colGrp[idx], { 'display': displayVal });\n            }\n            if (!isRefresh) {\n                var width = void 0;\n                if (column.width) {\n                    if (column.visible) {\n                        width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                    }\n                    else {\n                        width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                    }\n                }\n                if (width > gObj.width) {\n                    this.setDisplayNone(tr, idx, displayVal, rows);\n                    if (this.parent.enableColumnVirtualization) {\n                        this.virtualEle.setWrapperWidth(width + '');\n                    }\n                    this.refreshVirtualElement();\n                }\n                else {\n                    isRefresh = true;\n                }\n            }\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n        if (isRefresh || frozenCols) {\n            this.refreshContentRows({ requestType: 'refresh' });\n        }\n        else {\n            this.parent.notify(events.partialRefresh, { rows: rows, args: { isFrozen: false, rows: rows } });\n        }\n    };\n    VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n        var _this = this;\n        args.isAvailable = args.selectedIndex < this.count;\n        if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow'\n            && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) { return value === _this.requestType; })\n            && !this.parent.selectionModule.isInteracted) {\n            var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n            var rowHeight = this.parent.getRowHeight();\n            if (!selectedRow || !this.isRowInView(selectedRow)) {\n                this.isSelection = true;\n                this.selectedRowIndex = args.selectedIndex;\n                var scrollTop = (args.selectedIndex + 1) * rowHeight;\n                if (!isNullOrUndefined(scrollTop)) {\n                    var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n                    this.selectRowIndex = args.selectedIndex;\n                    this.content.scrollTop = scrollTop;\n                    this.isSelectionScroll = this.observer.check(direction);\n                }\n            }\n        }\n        if (this.parent.isFrozenGrid() && this.requestType) {\n            if (this.parent.getTablesCount() === this.frzIdx) {\n                this.requestType = this.empty;\n                this.frzIdx = 1;\n            }\n            else {\n                this.frzIdx++;\n            }\n        }\n        else {\n            this.requestType = this.empty;\n        }\n    };\n    VirtualContentRenderer.prototype.isRowInView = function (row) {\n        var top = row.getBoundingClientRect().top;\n        var bottom = row.getBoundingClientRect().bottom;\n        return (top >= this.content.getBoundingClientRect().top && bottom <= this.content.getBoundingClientRect().bottom);\n    };\n    return VirtualContentRenderer;\n}(ContentRender));\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\nvar VirtualHeaderRenderer = /** @class */ (function (_super) {\n    __extends(VirtualHeaderRenderer, _super);\n    function VirtualHeaderRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.virtualEle = new VirtualElementHandler();\n        _this.isMovable = false;\n        _this.gen = new VirtualRowModelGenerator(_this.parent);\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.parent.on(refreshVirtualBlock, function (e) { return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null; }, _this);\n        return _this;\n    }\n    VirtualHeaderRenderer.prototype.renderTable = function () {\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n        this.virtualEle.content.style.position = 'relative';\n        this.virtualEle.renderWrapper();\n        this.virtualEle.renderPlaceHolder('absolute');\n    };\n    VirtualHeaderRenderer.prototype.appendContent = function (table) {\n        if (!this.isMovable) {\n            this.virtualEle.wrapper.appendChild(table);\n        }\n        else {\n            this.virtualEle.movableWrapper.appendChild(table);\n            this.isMovable = false;\n        }\n    };\n    VirtualHeaderRenderer.prototype.refreshUI = function () {\n        this.isMovable = this.parent.isFrozenGrid();\n        this.setFrozenTable(this.parent.getMovableVirtualContent());\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.refreshUI.call(this);\n        this.setFrozenTable(this.parent.getFrozenVirtualContent());\n    };\n    VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var displayVal;\n        var idx;\n        var needFullRefresh;\n        var frozenCols = this.parent.getFrozenColumns();\n        var fhdrColGrp;\n        var mhdrColGrp;\n        if (frozenCols) {\n            fhdrColGrp = [].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll('col'));\n            mhdrColGrp = [].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll('col'));\n        }\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            var colGrp = void 0;\n            if (fhdrColGrp && mhdrColGrp) {\n                if (idx >= frozenCols) {\n                    colGrp = mhdrColGrp;\n                    idx = idx - frozenCols;\n                }\n                else {\n                    colGrp = fhdrColGrp;\n                }\n            }\n            else {\n                colGrp = this.getColGroup().children;\n            }\n            setStyleAttribute(colGrp[idx], { 'display': displayVal });\n            if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n                var tablewidth = void 0;\n                if (column.visible) {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                }\n                else {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                }\n                if (tablewidth > gObj.width) {\n                    this.setDisplayNone(column, displayVal);\n                    this.virtualEle.setWrapperWidth(tablewidth + '');\n                    this.gen.refreshColOffsets();\n                }\n                else {\n                    needFullRefresh = true;\n                }\n            }\n            else {\n                needFullRefresh = true;\n            }\n            if (needFullRefresh && !frozenCols) {\n                this.refreshUI();\n            }\n        }\n        if (frozenCols) {\n            this.parent.notify(events.columnPositionChanged, {});\n        }\n    };\n    VirtualHeaderRenderer.prototype.setFrozenTable = function (content) {\n        if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization\n            && this.parent.contentModule.isXaxis()) {\n            this.parent.contentModule\n                .setTable(content.querySelector('.' + literals.table));\n        }\n    };\n    VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n        var frozenCols = this.parent.isFrozenGrid();\n        var table = this.getTable();\n        if (frozenCols && col.getFreezeTableName() === 'movable') {\n            table = this.parent.getMovableVirtualHeader().querySelector('.' + literals.table);\n        }\n        for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n            var ele = _a[_i];\n            if (ele.querySelector('[e-mappinguid]') &&\n                ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n                setStyleAttribute(ele, { 'display': displayVal });\n                if (displayVal === '') {\n                    removeClass([ele], 'e-hide');\n                }\n                break;\n            }\n        }\n    };\n    return VirtualHeaderRenderer;\n}(HeaderRender));\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\nvar VirtualElementHandler = /** @class */ (function () {\n    function VirtualElementHandler() {\n    }\n    VirtualElementHandler.prototype.renderWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) });\n        this.wrapper.appendChild(this.table);\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n        if (position === void 0) { position = 'relative'; }\n        this.placeholder = createElement('div', { className: 'e-virtualtrack', styles: \"position:\" + position });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) + \"; display: flex\" });\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n        this.placeholder = createElement('div', { className: 'e-virtualtrack' });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderMovableWrapper = function (height) {\n        this.movableWrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) });\n        this.movableContent.appendChild(this.movableWrapper);\n    };\n    VirtualElementHandler.prototype.renderMovablePlaceHolder = function () {\n        this.movablePlaceholder = createElement('div', { className: 'e-virtualtrack' });\n        this.movableContent.appendChild(this.movablePlaceholder);\n    };\n    VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n        this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.adjustMovableTable = function (xValue, yValue) {\n        this.movableWrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.setMovableWrapperWidth = function (width, full) {\n        this.movableWrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setMovableVirtualHeight = function (height, width) {\n        this.movablePlaceholder.style.height = height + \"px\";\n        this.movablePlaceholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n        this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n        this.placeholder.style.height = height + \"px\";\n        this.placeholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n        wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    return VirtualElementHandler;\n}());\nexport { VirtualElementHandler };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}