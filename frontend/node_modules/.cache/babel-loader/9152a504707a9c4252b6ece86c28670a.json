{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/* eslint-disable max-len */\nimport { extend, isNullOrUndefined, createElement, EventHandler, addClass, append, removeClass, remove, closest, classList } from '@syncfusion/ej2-base';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { TreeView } from '@syncfusion/ej2-navigations';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Data } from '../actions/data';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\n\nvar ResourceBase =\n/** @class */\nfunction () {\n  function ResourceBase(parent) {\n    this.resourceCollection = [];\n    this.leftPixel = 25;\n    this.parent = parent;\n  }\n\n  ResourceBase.prototype.renderResourceHeaderIndent = function (tr) {\n    var resColTd = createElement('td', {\n      className: cls.RESOURCE_LEFT_TD_CLASS\n    });\n    var resColDiv = createElement('div', {\n      className: cls.RESOURCE_TEXT_CLASS\n    });\n\n    if (this.parent.activeViewOptions.headerIndentTemplate) {\n      var data = {\n        className: [resColTd.className],\n        type: 'emptyCells'\n      };\n      this.parent.renderHeaderIndentTemplate(data, resColTd);\n    } else {\n      resColTd.appendChild(resColDiv);\n    }\n\n    var args = {\n      elementType: 'emptyCells',\n      element: resColTd\n    };\n    this.parent.trigger(events.renderCell, args);\n    tr.appendChild(resColTd);\n  };\n\n  ResourceBase.prototype.hideResourceRows = function (tBody) {\n    if (this.resourceCollection.length <= 1 || this.parent.virtualScrollModule) {\n      return;\n    }\n\n    var trCount = this.lastResourceLevel.length;\n\n    for (var i = 0; i < trCount; i++) {\n      var resData = this.lastResourceLevel[i].resourceData;\n      var res = this.lastResourceLevel[i].resource;\n\n      if (resData.ClassName === cls.RESOURCE_PARENT_CLASS && !resData[res.expandedField] && !isNullOrUndefined(resData[res.expandedField])) {\n        var trCollection = [].slice.call(tBody.children);\n        var slicedCollection = trCollection.slice(i + 1, i + (parseInt(resData.Count, 10) + 1));\n        addClass(slicedCollection, cls.HIDDEN_CLASS);\n      }\n    }\n  };\n\n  ResourceBase.prototype.createResourceColumn = function () {\n    var resColl = this.resourceCollection;\n    var resDiv = createElement('div', {\n      className: cls.RESOURCE_COLUMN_WRAP_CLASS\n    });\n    var tbl = this.parent.activeView.createTableLayout(cls.RESOURCE_COLUMN_TABLE_CLASS);\n\n    if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      addClass([tbl], cls.AUTO_HEIGHT);\n    }\n\n    var tBody = tbl.querySelector('tbody');\n    var resData = this.generateTreeData(true);\n    this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n    this.renderedResources = this.lastResourceLevel;\n\n    if (this.parent.virtualScrollModule) {\n      var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n      this.setExpandedResources();\n      resData = this.expandedResources.slice(0, resourceCount);\n      this.renderedResources = resData;\n    }\n\n    append(this.getContentRows(resData), tBody);\n    this.hideResourceRows(tBody);\n    tbl.appendChild(tBody);\n    resDiv.appendChild(tbl);\n    return resDiv;\n  };\n\n  ResourceBase.prototype.setRenderedResources = function () {\n    var resColl = this.resourceCollection; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n    var temp = this.generateTreeData(true);\n    this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n    this.renderedResources = this.lastResourceLevel;\n  };\n\n  ResourceBase.prototype.setExpandedResources = function () {\n    var resources = [];\n\n    for (var i = 0; i < this.lastResourceLevel.length; i++) {\n      var resource = this.lastResourceLevel[i].resourceData;\n      var count = resource.Count;\n      resources.push(this.lastResourceLevel[i]);\n      var isExpanded = resource[this.lastResourceLevel[i].resource.expandedField];\n\n      if (!isNullOrUndefined(isExpanded) && !isExpanded && count > 0) {\n        i = i + count;\n      }\n    }\n\n    this.expandedResources = resources;\n  };\n\n  ResourceBase.prototype.getContentRows = function (resData, isVirtualScroll) {\n    var resRows = [];\n    var left;\n    var rIndex;\n    var resColl = this.resourceCollection;\n    var tr = createElement('tr');\n    var td = createElement('td', {\n      attrs: {\n        tabindex: isVirtualScroll ? '-1' : '0'\n      }\n    });\n\n    for (var i = 0; i < resData.length; i++) {\n      var ntd = td.cloneNode();\n      rIndex = util.findIndexInData(resColl, 'name', resData[i].resource.name);\n\n      if (rIndex === resColl.length - 1) {\n        extend(resData[i].resourceData, {\n          ClassName: cls.RESOURCE_CHILD_CLASS\n        });\n        this.renderedResources[i].className = [cls.RESOURCE_CHILD_CLASS];\n      } else {\n        extend(resData[i].resourceData, {\n          ClassName: cls.RESOURCE_PARENT_CLASS\n        });\n        this.renderedResources[i].className = [cls.RESOURCE_PARENT_CLASS];\n      }\n\n      left = rIndex * this.leftPixel + 'px';\n\n      if (resData[i].resourceData.ClassName === cls.RESOURCE_PARENT_CLASS && !isNullOrUndefined(resData[i].resourceData.Count) && resData[i].resourceData.Count > 0) {\n        var iconClass = void 0;\n\n        if (resData[i].resourceData[resColl[rIndex].expandedField] || isNullOrUndefined(resData[i].resourceData[resColl[rIndex].expandedField])) {\n          iconClass = cls.RESOURCE_COLLAPSE_CLASS;\n        } else {\n          iconClass = cls.RESOURCE_EXPAND_CLASS;\n        }\n\n        var iconDiv = createElement('div');\n        addClass([iconDiv], [cls.RESOURCE_TREE_ICON_CLASS, iconClass]);\n        this.setMargin(iconDiv, left);\n        ntd.appendChild(iconDiv);\n\n        if (this.resourceCollection.length > 1) {\n          EventHandler.add(iconDiv, 'click', this.onTreeIconClick, this);\n        }\n      }\n\n      this.parent.activeView.setResourceHeaderContent(ntd, resData[i], cls.RESOURCE_TEXT_CLASS);\n      ntd.setAttribute('data-group-index', resData[i].groupIndex.toString());\n      ntd.setAttribute('aria-label', resData[i].resourceData[resData[i].resource.textField] + ' resource');\n\n      if (!this.parent.activeViewOptions.resourceHeaderTemplate) {\n        this.setMargin(ntd.querySelector('.' + cls.RESOURCE_TEXT_CLASS), left);\n      }\n\n      var classCollection = [cls.RESOURCE_CELLS_CLASS, resData[i].resourceData.ClassName];\n      addClass([ntd], classCollection);\n      var args = {\n        elementType: 'resourceHeader',\n        element: ntd,\n        groupIndex: resData[i].groupIndex\n      };\n      this.parent.trigger(events.renderCell, args);\n      var ntr = tr.cloneNode();\n      ntr.appendChild(ntd);\n      resRows.push(ntr);\n    }\n\n    return resRows;\n  };\n\n  ResourceBase.prototype.setMargin = function (element, value) {\n    if (!this.parent.enableRtl) {\n      element.style.marginLeft = value;\n    } else {\n      element.style.marginRight = value;\n    }\n  };\n\n  ResourceBase.prototype.countCalculation = function (parentCollection, wholeCollection) {\n    var collection;\n\n    for (var y = 0; y < parentCollection.length; y++) {\n      var data = parentCollection[parentCollection.length - (y + 1)].dataSource;\n\n      for (var x = 0; x < data.length; x++) {\n        var totalCount = 0;\n\n        if (this.parent.activeViewOptions.group.byGroupID) {\n          var query = new Query().where(wholeCollection[wholeCollection.length - 1].groupIDField, 'equal', data[x][parentCollection[parentCollection.length - (y + 1)].idField]);\n          collection = new DataManager(wholeCollection[wholeCollection.length - 1].dataSource).executeLocal(query);\n        } else {\n          collection = wholeCollection[wholeCollection.length - 1].dataSource;\n        }\n\n        for (var z = 0; z < collection.length; z++) {\n          totalCount = totalCount + parseInt(collection[z].Count, 10);\n        }\n\n        totalCount = totalCount + parseInt(data[x].Count, 10);\n        extend(data[x], {\n          Count: totalCount\n        });\n      }\n\n      wholeCollection = wholeCollection.slice(0, -1);\n    }\n  };\n\n  ResourceBase.prototype.onTreeIconClick = function (e) {\n    var _this = this;\n\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.close();\n    }\n\n    var target = e.target;\n    var hide;\n    var trElement = closest(target, '.' + cls.RESOURCE_PARENT_CLASS).parentElement;\n    var index = parseInt(trElement.children[0].getAttribute('data-group-index'), 10);\n    var args = {\n      cancel: false,\n      event: e,\n      groupIndex: index,\n      requestType: !target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpand' : 'resourceCollapse'\n    };\n    this.parent.trigger(events.actionBegin, args, function (actionArgs) {\n      if (!actionArgs.cancel) {\n        if (target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS)) {\n          classList(target, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n          hide = true;\n        } else {\n          classList(target, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n          hide = false;\n        }\n\n        var eventElements = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n\n        for (var _i = 0, eventElements_1 = eventElements; _i < eventElements_1.length; _i++) {\n          var element = eventElements_1[_i];\n          remove(element);\n        }\n\n        if (_this.parent.virtualScrollModule) {\n          _this.updateVirtualContent(index, hide, e, target);\n        } else {\n          _this.updateContent(index, hide);\n        }\n\n        var data = {\n          cssProperties: _this.parent.getCssProperties(),\n          module: 'scroll'\n        };\n\n        _this.parent.notify(events.scrollUiUpdate, data);\n\n        args = {\n          cancel: false,\n          event: e,\n          groupIndex: index,\n          requestType: target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpanded' : 'resourceCollapsed'\n        };\n\n        _this.parent.refreshEvents(false);\n\n        _this.parent.trigger(events.actionComplete, args);\n      }\n    });\n  };\n\n  ResourceBase.prototype.updateContent = function (index, hide) {\n    var rowCollection = [];\n    var workCellCollection = [];\n    var headerRowCollection = [];\n    var pNode;\n    var clickedRes = this.lastResourceLevel[index].resourceData;\n    var resRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'tr'));\n    var contentRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'tbody tr'));\n    var eventRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' .' + cls.APPOINTMENT_CONTAINER_CLASS));\n\n    for (var j = 0; j < clickedRes.Count; j++) {\n      rowCollection.push(resRows[index + j + 1]);\n      workCellCollection.push(contentRows[index + j + 1]);\n      headerRowCollection.push(eventRows[index + j + 1]);\n    }\n\n    var clonedCollection = this.lastResourceLevel;\n\n    for (var i = 0; i < rowCollection.length; i++) {\n      var expanded = true;\n      pNode = rowCollection[i].children[0].classList.contains(cls.RESOURCE_PARENT_CLASS);\n      clonedCollection[index].resourceData[clonedCollection[index].resource.expandedField] = !hide;\n\n      if (hide) {\n        if (pNode) {\n          var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n\n          if (trElem) {\n            classList(trElem, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n          }\n        }\n\n        if (!rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n          addClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n        }\n      } else {\n        if (pNode) {\n          var rowIndex = rowCollection[i].rowIndex;\n\n          if (!clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField] && !isNullOrUndefined(clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField])) {\n            rowCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 10));\n            workCellCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 10));\n            headerRowCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 10));\n            expanded = false;\n          }\n\n          if (expanded) {\n            var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n\n            if (trElem) {\n              classList(trElem, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n            }\n          }\n        }\n\n        if (rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n          removeClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n        }\n      }\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  ResourceBase.prototype.updateVirtualContent = function (index, expand, e, target) {\n    this.lastResourceLevel[index].resourceData[this.lastResourceLevel[index].resource.expandedField] = !expand;\n    this.setExpandedResources();\n    var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n    var startIndex = this.expandedResources.indexOf(this.renderedResources[0]);\n    this.renderedResources = this.expandedResources.slice(startIndex, startIndex + resourceCount);\n\n    if (this.renderedResources.length < resourceCount) {\n      var sIndex = this.expandedResources.length - resourceCount;\n      sIndex = sIndex > 0 ? sIndex : 0;\n      this.renderedResources = this.expandedResources.slice(sIndex, this.expandedResources.length);\n    }\n\n    var virtualTrack = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n    this.parent.virtualScrollModule.updateVirtualTrackHeight(virtualTrack);\n    var resTable = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'table');\n    var contentTable = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'table');\n    var eventTable = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n    this.parent.virtualScrollModule.updateContent(resTable, contentTable, eventTable, this.renderedResources);\n    var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n\n    if (!isNullOrUndefined(timeIndicator)) {\n      timeIndicator.style.height = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight + 'px';\n    }\n  };\n\n  ResourceBase.prototype.renderResourceHeader = function () {\n    var resourceWrapper = createElement('div', {\n      className: cls.RESOURCE_TOOLBAR_CONTAINER\n    });\n    resourceWrapper.innerHTML = '<div class=\"' + cls.RESOURCE_HEADER_TOOLBAR + '\"><div class=\"' + cls.RESOURCE_MENU + '\">' + '<div class=\"e-icons ' + cls.RESOURCE_MENU_ICON + '\"></div></div><div class=\"' + cls.RESOURCE_LEVEL_TITLE + '\"></div></div>';\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      var target = this.parent.activeView.getPanel().querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      target.insertBefore(resourceWrapper, target.querySelector('.' + cls.WRAPPER_CONTAINER_CLASS));\n    } else {\n      this.parent.element.insertBefore(resourceWrapper, this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS));\n    }\n\n    this.renderResourceHeaderText();\n    EventHandler.add(resourceWrapper.querySelector('.' + cls.RESOURCE_MENU_ICON), 'click', this.menuClick, this);\n  };\n\n  ResourceBase.prototype.renderResourceTree = function () {\n    this.popupOverlay = createElement('div', {\n      className: cls.RESOURCE_TREE_POPUP_OVERLAY\n    });\n    var treeWrapper = createElement('div', {\n      className: cls.RESOURCE_TREE_POPUP + ' e-popup-close'\n    });\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      var target = this.parent.activeView.getPanel().querySelector('.' + cls.WRAPPER_CONTAINER_CLASS);\n      target.insertBefore(treeWrapper, target.children[0]);\n      target.appendChild(this.popupOverlay);\n    } else {\n      this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(treeWrapper);\n      this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(this.popupOverlay);\n    }\n\n    var resourceTree = createElement('div', {\n      className: cls.RESOURCE_TREE\n    });\n    treeWrapper.appendChild(resourceTree);\n    this.treeViewObj = new TreeView({\n      cssClass: this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      fields: {\n        dataSource: [].slice.call(this.generateTreeData()),\n        id: 'resourceId',\n        text: 'resourceName',\n        child: 'resourceChild'\n      },\n      nodeTemplate: this.parent.resourceHeaderTemplate,\n      nodeClicked: this.resourceClick.bind(this)\n    });\n    this.treeViewObj.appendTo(resourceTree);\n    this.treeViewObj.expandAll();\n    this.treePopup = new Popup(treeWrapper, {\n      targetType: 'relative',\n      actionOnScroll: 'none',\n      content: this.treeViewObj.element,\n      relateTo: this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS),\n      enableRtl: this.parent.enableRtl,\n      hideAnimation: {\n        name: 'SlideLeftOut',\n        duration: 500\n      },\n      showAnimation: {\n        name: 'SlideLeftIn',\n        duration: 500\n      },\n      viewPortElement: this.parent.element.querySelector('.' + (this.parent.currentView === 'MonthAgenda' ? cls.WRAPPER_CONTAINER_CLASS : cls.TABLE_CONTAINER_CLASS))\n    });\n    this.parent.on(events.documentClick, this.documentClick, this);\n  };\n\n  ResourceBase.prototype.generateTreeData = function (isTimeLine) {\n    var _this = this;\n\n    var treeCollection = [];\n    var resTreeColl = [];\n    var groupIndex = 0;\n\n    var _loop_1 = function (i, len) {\n      var treeHandler = function (treeLevel, index, levelId) {\n        var resource = _this.resourceCollection[index];\n        var treeArgs;\n        var resObj;\n\n        if (!isTimeLine) {\n          treeArgs = {\n            resourceId: levelId,\n            resourceName: treeLevel.resourceData[resource.textField],\n            resource: treeLevel.resource,\n            resourceData: treeLevel.resourceData\n          };\n        } else {\n          resObj = {\n            type: 'resourceHeader',\n            resource: treeLevel.resource,\n            resourceData: treeLevel.resourceData,\n            groupIndex: groupIndex,\n            groupOrder: treeLevel.groupOrder\n          };\n          resTreeColl.push(resObj);\n          groupIndex++;\n        }\n\n        if (treeLevel.child.length > 0 && !isTimeLine) {\n          treeArgs.resourceChild = [];\n        }\n\n        var count = 1;\n\n        for (var _i = 0, _a = treeLevel.child; _i < _a.length; _i++) {\n          var tree = _a[_i];\n\n          if (!isTimeLine) {\n            treeArgs.resourceChild.push(treeHandler(tree, index + 1, levelId + '-' + count));\n          } else {\n            treeHandler(tree, index + 1, levelId + '-' + count);\n          }\n\n          count += 1;\n        }\n\n        if (isTimeLine) {\n          extend(resObj.resourceData, {\n            Count: count - 1\n          });\n        }\n\n        return treeArgs;\n      };\n\n      if (!isTimeLine) {\n        treeCollection.push(treeHandler(this_1.resourceTreeLevel[i], 0, (i + 1).toString()));\n      } else {\n        treeHandler(this_1.resourceTreeLevel[i], 0, (i + 1).toString());\n      }\n    };\n\n    var this_1 = this;\n\n    for (var i = 0, len = this.resourceTreeLevel.length; i < len; i++) {\n      _loop_1(i, len);\n    }\n\n    if (isTimeLine) {\n      this.lastResourceLevel = resTreeColl;\n      return resTreeColl;\n    } else {\n      return treeCollection;\n    }\n  };\n\n  ResourceBase.prototype.renderResourceHeaderText = function () {\n    var resource = this.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n    var headerCollection = [];\n\n    var _loop_2 = function (i, len) {\n      var resourceLevel = this_2.resourceCollection[i];\n      var resourceText = resourceLevel.dataSource.filter(function (resData) {\n        return resData[resourceLevel.idField] === resource.groupOrder[i];\n      });\n      var resourceName = createElement('div', {\n        className: cls.RESOURCE_NAME,\n        innerHTML: resourceText[0][resourceLevel.textField]\n      });\n      headerCollection.push(resourceName);\n      var levelIcon = createElement('div', {\n        className: 'e-icons e-icon-next'\n      });\n      headerCollection.push(levelIcon);\n    };\n\n    var this_2 = this;\n\n    for (var i = 0, len = resource.groupOrder.length; i < len; i++) {\n      _loop_2(i, len);\n    }\n\n    headerCollection.pop();\n    var target = this.parent.currentView === 'MonthAgenda' ? this.parent.activeView.getPanel() : this.parent.element;\n    var headerWrapper = target.querySelector('.' + cls.RESOURCE_LEVEL_TITLE);\n    util.removeChildren(headerWrapper);\n\n    for (var _i = 0, headerCollection_1 = headerCollection; _i < headerCollection_1.length; _i++) {\n      var header = headerCollection_1[_i];\n      headerWrapper.appendChild(header);\n    }\n\n    if (this.lastResourceLevel.length === 1) {\n      addClass([this.parent.element.querySelector('.' + cls.RESOURCE_MENU)], cls.DISABLE_CLASS);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  ResourceBase.prototype.menuClick = function (event) {\n    if (this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP).classList.contains(cls.POPUP_OPEN)) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n    } else {\n      var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n      removeClass(treeNodes, 'e-active');\n      addClass([treeNodes[this.parent.uiStateValues.groupIndex]], 'e-active');\n      this.treePopup.show();\n      addClass([this.popupOverlay], cls.ENABLE_CLASS);\n    }\n  };\n\n  ResourceBase.prototype.selectResourceByIndex = function (groupIndex) {\n    if (this.lastResourceLevel && groupIndex > -1 && groupIndex < this.lastResourceLevel.length) {\n      this.triggerEvents(groupIndex);\n    }\n  };\n\n  ResourceBase.prototype.resourceClick = function (event) {\n    if (!event.node.classList.contains('e-has-child')) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n      var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n      var groupIndex = treeNodes.indexOf(event.node);\n      this.triggerEvents(groupIndex, event);\n      event.event.preventDefault();\n    }\n  };\n\n  ResourceBase.prototype.triggerEvents = function (groupIndex, event) {\n    var _this = this;\n\n    var args = {\n      cancel: false,\n      event: event ? event.event : null,\n      groupIndex: groupIndex,\n      requestType: 'resourceChange'\n    };\n    this.parent.trigger(events.actionBegin, args, function (actionArgs) {\n      if (!actionArgs.cancel) {\n        _this.parent.uiStateValues.groupIndex = actionArgs.groupIndex;\n\n        _this.parent.renderModule.render(_this.parent.currentView);\n\n        args = {\n          cancel: false,\n          event: event ? event.event : null,\n          groupIndex: _this.parent.uiStateValues.groupIndex,\n          requestType: 'resourceChanged'\n        };\n\n        _this.parent.trigger(events.actionComplete, args);\n      }\n    });\n  };\n\n  ResourceBase.prototype.documentClick = function (args) {\n    if (closest(args.event.target, '.' + cls.RESOURCE_TREE_POPUP)) {\n      return;\n    }\n\n    var treeWrapper = this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP);\n\n    if (treeWrapper && treeWrapper.classList.contains(cls.POPUP_OPEN)) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n    }\n  };\n\n  ResourceBase.prototype.bindResourcesData = function (isSetModel) {\n    var _this = this;\n\n    this.parent.showSpinner();\n    var promises = [];\n\n    for (var _i = 0, _a = this.parent.resources; _i < _a.length; _i++) {\n      var resource = _a[_i];\n      var dataModule = new Data(resource.dataSource, resource.query);\n      promises.push(dataModule.getData(dataModule.generateQuery()));\n    }\n\n    Promise.all(promises).then(function (e) {\n      return _this.dataManagerSuccess(e, isSetModel);\n    }).catch(function (e) {\n      return _this.parent.crudModule.dataManagerFailure(e);\n    });\n  };\n\n  ResourceBase.prototype.dataManagerSuccess = function (e, isSetModel) {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.resourceCollection = [];\n\n    for (var i = 0, length_1 = e.length; i < length_1; i++) {\n      var resource = this.parent.resources[i];\n      var resourceObj = this.getResourceModel(resource, e[i].result);\n      this.parent.resourceCollection.push(resourceObj);\n    }\n\n    this.refreshLayout(isSetModel);\n  };\n\n  ResourceBase.prototype.getResourceModel = function (resource, resourceData) {\n    var resourceObj = {\n      field: resource.field,\n      title: resource.title,\n      name: resource.name,\n      allowMultiple: resource.allowMultiple,\n      dataSource: resourceData || resource.dataSource,\n      idField: resource.idField,\n      textField: resource.textField,\n      groupIDField: resource.groupIDField,\n      colorField: resource.colorField,\n      startHourField: resource.startHourField,\n      endHourField: resource.endHourField,\n      workDaysField: resource.workDaysField,\n      expandedField: resource.expandedField,\n      cssClassField: resource.cssClassField\n    };\n    return resourceObj;\n  };\n\n  ResourceBase.prototype.refreshLayout = function (isSetModel) {\n    if (isNullOrUndefined(this.parent.uiStateValues.groupIndex) || !this.parent.enablePersistence) {\n      this.parent.uiStateValues.groupIndex = 0;\n    }\n\n    this.parent.renderElements(isSetModel);\n  };\n\n  ResourceBase.prototype.setResourceCollection = function () {\n    var requiredResources = [];\n    this.resourceCollection = [];\n    this.colorIndex = null;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      for (var _i = 0, _a = this.parent.activeViewOptions.group.resources; _i < _a.length; _i++) {\n        var resource = _a[_i];\n        var index_1 = util.findIndexInData(this.parent.resourceCollection, 'name', resource);\n\n        if (index_1 >= 0) {\n          requiredResources.push(this.parent.resourceCollection[index_1]);\n        }\n      }\n    } else if (this.parent.resourceCollection.length > 0) {\n      requiredResources = this.parent.resourceCollection;\n    }\n\n    var index = 0;\n\n    for (var _b = 0, requiredResources_1 = requiredResources; _b < requiredResources_1.length; _b++) {\n      var resource = requiredResources_1[_b];\n      var resources = this.getResourceModel(resource);\n\n      if (resource.name === this.parent.eventSettings.resourceColorField) {\n        this.colorIndex = index;\n      }\n\n      index++;\n      this.resourceCollection.push(resources);\n    }\n\n    if (isNullOrUndefined(this.colorIndex)) {\n      this.colorIndex = this.resourceCollection.length - 1;\n    }\n  };\n\n  ResourceBase.prototype.generateResourceLevels = function (innerDates, isTimeLine) {\n    var _this = this;\n\n    var resources = this.resourceCollection;\n    var resTreeGroup = [];\n    var lastColumnDates = [];\n\n    var group = function (resources, index, prevResource, prevResourceData, prevOrder) {\n      var resTree = [];\n      var resource = resources[0];\n\n      if (resource) {\n        var data = void 0;\n\n        if (prevResourceData && _this.parent.activeViewOptions.group.byGroupID) {\n          var id_1 = prevResourceData[prevResource.idField];\n          data = resource.dataSource.filter(function (e) {\n            return e[resource.groupIDField] === id_1;\n          });\n        } else {\n          data = resource.dataSource;\n        }\n\n        for (var i = 0; i < data.length; i++) {\n          var groupOrder = [];\n\n          if (prevOrder && prevOrder.length > 0) {\n            groupOrder = groupOrder.concat(prevOrder);\n          }\n\n          groupOrder.push(data[i][resource.idField]);\n          var items = group(resources.slice(1), index + 1, resource, data[i], groupOrder); // Here validate child item empty top level resource only\n\n          if (index === 0 && items.length === 0 && _this.resourceCollection.length > 1) {\n            continue;\n          }\n\n          var dateCol = [];\n          var renderDates = _this.parent.activeView.renderDates;\n          var resWorkDays = void 0;\n\n          if (!_this.parent.activeViewOptions.group.byDate && index + 1 === _this.resourceCollection.length) {\n            var workDays = data[i][resource.workDaysField];\n            var resStartHour = data[i][resource.startHourField];\n            var resEndHour = data[i][resource.endHourField];\n\n            if (workDays && workDays.length > 0) {\n              renderDates = _this.parent.activeView.getRenderDates(workDays);\n              resWorkDays = workDays;\n              dateCol = _this.parent.activeView.getDateSlots(renderDates, workDays);\n            } else {\n              resWorkDays = _this.parent.activeViewOptions.workDays;\n              dateCol = innerDates;\n            }\n\n            var dateSlots = _this.generateCustomHours(dateCol, resStartHour, resEndHour, groupOrder);\n\n            lastColumnDates = lastColumnDates.concat(dateSlots);\n          }\n\n          var resCssClass = data[i][resource.cssClassField];\n          var slotData = {\n            type: 'resourceHeader',\n            className: ['e-resource-cells'],\n            resourceLevelIndex: index,\n            groupOrder: groupOrder,\n            resource: resource,\n            resourceData: data[i],\n            colSpan: _this.parent.activeViewOptions.group.byDate ? 1 : dateCol.length,\n            renderDates: renderDates,\n            workDays: resWorkDays,\n            cssClass: resCssClass,\n            child: items\n          };\n          resTree.push(slotData);\n        }\n\n        if (!resTreeGroup[index]) {\n          resTreeGroup[index] = [];\n        }\n\n        if (resTree.length > 0) {\n          resTreeGroup[index].push(resTree);\n        }\n\n        return resTree;\n      }\n\n      return [];\n    };\n\n    this.resourceTreeLevel = group(resources, 0);\n    return isTimeLine ? [] : this.generateHeaderLevels(resTreeGroup, lastColumnDates, innerDates);\n  };\n\n  ResourceBase.prototype.generateCustomHours = function (renderDates, startHour, endHour, groupOrder) {\n    var dateSlots = extend([], renderDates, null, true);\n\n    for (var _i = 0, dateSlots_1 = dateSlots; _i < dateSlots_1.length; _i++) {\n      var dateSlot = dateSlots_1[_i];\n\n      if (startHour) {\n        dateSlot.startHour = this.parent.getStartEndTime(startHour);\n      }\n\n      if (endHour) {\n        dateSlot.endHour = this.parent.getStartEndTime(endHour);\n      }\n\n      if (groupOrder) {\n        dateSlot.groupOrder = groupOrder;\n      }\n    }\n\n    return dateSlots;\n  };\n\n  ResourceBase.prototype.generateHeaderLevels = function (resTreeGroup, lastColumnDates, headerDates) {\n    var headerLevels = [];\n\n    for (var i = resTreeGroup.length - 1; i >= 0; i--) {\n      var temp = 0;\n\n      for (var _i = 0, _a = resTreeGroup[i]; _i < _a.length; _i++) {\n        var currentLevelChilds = _a[_i];\n\n        for (var _b = 0, currentLevelChilds_1 = currentLevelChilds; _b < currentLevelChilds_1.length; _b++) {\n          var currentLevelChild = currentLevelChilds_1[_b];\n\n          if (resTreeGroup[i + 1] && resTreeGroup[i + 1].length > 0) {\n            var nextLevelChilds = resTreeGroup[i + 1][temp];\n\n            if (!nextLevelChilds) {\n              continue;\n            }\n\n            var colSpan = 0;\n\n            for (var _c = 0, nextLevelChilds_1 = nextLevelChilds; _c < nextLevelChilds_1.length; _c++) {\n              var nextLevelChild = nextLevelChilds_1[_c];\n\n              if (!this.parent.activeViewOptions.group.byGroupID || this.parent.activeViewOptions.group.byGroupID && nextLevelChild.resourceData[nextLevelChild.resource.groupIDField] === currentLevelChild.resourceData[currentLevelChild.resource.idField]) {\n                colSpan += nextLevelChild.colSpan;\n              }\n            }\n\n            currentLevelChild.colSpan = colSpan;\n          }\n\n          currentLevelChild.groupIndex = temp;\n          temp++;\n          headerLevels[currentLevelChild.resourceLevelIndex] = headerLevels[currentLevelChild.resourceLevelIndex] || [];\n          headerLevels[currentLevelChild.resourceLevelIndex].push(currentLevelChild);\n        }\n      }\n    }\n\n    this.lastResourceLevel = headerLevels.slice(-1)[0] || [];\n\n    if (!this.parent.activeViewOptions.group.byDate) {\n      var index = 0;\n\n      for (var _d = 0, _e = this.lastResourceLevel; _d < _e.length; _d++) {\n        var lastLevelResource = _e[_d];\n\n        for (var i = 0; i < lastLevelResource.colSpan; i++) {\n          lastColumnDates[index].groupIndex = lastLevelResource.groupIndex;\n          index++;\n        }\n      }\n\n      headerLevels.push(lastColumnDates);\n      return headerLevels;\n    }\n\n    var dateHeaderLevels = [];\n    var levels = extend([], headerLevels, null, true);\n    var dateColSpan = 0;\n\n    for (var _f = 0, _g = levels[0]; _f < _g.length; _f++) {\n      var firstRowTd = _g[_f];\n      dateColSpan += firstRowTd.colSpan;\n    }\n\n    var datesColumn = [];\n\n    for (var _h = 0, headerDates_1 = headerDates; _h < headerDates_1.length; _h++) {\n      var headerDate = headerDates_1[_h];\n      headerDate.colSpan = dateColSpan;\n      datesColumn.push(headerDate);\n      var resGroup = extend([], levels, null, true);\n\n      for (var k = 0, length_2 = resGroup.length; k < length_2; k++) {\n        if (k === resGroup.length - 1) {\n          for (var _j = 0, _k = resGroup[k]; _j < _k.length; _j++) {\n            var resTd = _k[_j];\n            resTd.date = headerDate.date;\n            resTd.workDays = headerDate.workDays;\n            resTd.startHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.startHourField]) || headerDate.startHour;\n            resTd.endHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.endHourField]) || headerDate.endHour;\n          }\n        }\n\n        if (!dateHeaderLevels[k]) {\n          dateHeaderLevels[k] = [];\n        }\n\n        dateHeaderLevels[k] = dateHeaderLevels[k].concat(resGroup[k]);\n      }\n    }\n\n    dateHeaderLevels.unshift(datesColumn);\n    return dateHeaderLevels;\n  };\n\n  ResourceBase.prototype.setResourceValues = function (eventObj, groupIndex) {\n    var _this = this;\n\n    var setValues = function (index, field, value) {\n      if (_this.resourceCollection[index].allowMultiple && _this.parent.activeViewOptions.group.allowGroupEdit) {\n        eventObj[field] = [value];\n      } else {\n        eventObj[field] = value;\n      }\n    };\n\n    if (groupIndex === void 0) {\n      groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : this.parent.activeCellsData.groupIndex;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(groupIndex)) {\n      var groupOrder = this.lastResourceLevel[groupIndex].groupOrder;\n\n      for (var index = 0; index < this.resourceCollection.length; index++) {\n        setValues(index, this.resourceCollection[index].field, groupOrder[index]);\n      }\n    } else if (this.parent.resourceCollection.length > 0) {\n      for (var index = 0; index < this.resourceCollection.length; index++) {\n        var data = this.resourceCollection[index].dataSource[0];\n\n        if (data) {\n          setValues(index, this.resourceCollection[index].field, data[this.resourceCollection[index].idField]);\n        }\n      }\n    }\n  };\n\n  ResourceBase.prototype.getResourceColor = function (eventObj, groupOrder) {\n    var colorFieldIndex = !isNullOrUndefined(groupOrder) && this.colorIndex > groupOrder.length - 1 ? groupOrder.length - 1 : this.colorIndex;\n    var resource = this.resourceCollection[colorFieldIndex];\n\n    if (isNullOrUndefined(groupOrder) && this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n      return undefined;\n    }\n\n    var id = isNullOrUndefined(groupOrder) ? eventObj[resource.field] : groupOrder[colorFieldIndex];\n    var data = this.filterData(resource.dataSource, resource.idField, id);\n\n    if (data.length > 0) {\n      return data[0][resource.colorField];\n    }\n\n    return undefined;\n  };\n\n  ResourceBase.prototype.getCssClass = function (eventObj) {\n    var resource = this.resourceCollection.slice(-1)[0];\n\n    if (this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n      return undefined;\n    }\n\n    var data = this.filterData(resource.dataSource, resource.idField, eventObj[resource.field]);\n\n    if (data.length > 0) {\n      return data[0][resource.cssClassField];\n    }\n\n    return undefined;\n  };\n\n  ResourceBase.prototype.getResourceRenderDates = function () {\n    // eslint-disable-next-line prefer-spread\n    var resourceDates = [].concat.apply([], this.lastResourceLevel.map(function (e) {\n      return e.renderDates;\n    }));\n\n    var removeDuplicateDates = function (dateColl) {\n      return dateColl.filter(function (date, index, dates) {\n        return dates.map(function (dateObj) {\n          return dateObj.getTime();\n        }).indexOf(date.getTime()) === index;\n      });\n    };\n\n    var renderDates = removeDuplicateDates(resourceDates);\n    renderDates.sort(function (a, b) {\n      return a.getTime() - b.getTime();\n    });\n    return renderDates;\n  };\n\n  ResourceBase.prototype.filterData = function (dataSource, field, value) {\n    return dataSource.filter(function (data) {\n      return data[field] === value;\n    });\n  };\n\n  ResourceBase.prototype.getResourceData = function (eventObj, index, groupEditIndex) {\n    if (this.parent.activeViewOptions.group.allowGroupEdit) {\n      var resourceObj = {};\n\n      for (var _i = 0, groupEditIndex_1 = groupEditIndex; _i < groupEditIndex_1.length; _i++) {\n        var groupIndex = groupEditIndex_1[_i];\n        var resourceLevel = this.lastResourceLevel[groupIndex].groupOrder;\n\n        for (var level = 0, length_3 = resourceLevel.length; level < length_3; level++) {\n          var fieldName = this.resourceCollection[level].field;\n\n          if (isNullOrUndefined(resourceObj[fieldName])) {\n            resourceObj[fieldName] = [];\n          }\n\n          resourceObj[fieldName].push(resourceLevel[level]);\n        }\n      }\n\n      eventObj = extend(eventObj, resourceObj);\n    } else {\n      for (var level = 0, length_4 = this.resourceCollection.length; level < length_4; level++) {\n        if (this.lastResourceLevel[index]) {\n          eventObj[this.resourceCollection[level].field] = this.lastResourceLevel[index].groupOrder[level];\n        }\n      }\n    }\n  };\n\n  ResourceBase.prototype.addResource = function (resources, name, index) {\n    var resourceCollection = resources instanceof Array ? resources : [resources];\n\n    var _loop_3 = function (resource) {\n      if (resource.name === name) {\n        resourceCollection.forEach(function (addObj, i) {\n          return new DataManager({\n            json: resource.dataSource\n          }).insert(addObj, null, null, index + i);\n        });\n        return \"break\";\n      }\n    };\n\n    for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n      var resource = _a[_i];\n\n      var state_1 = _loop_3(resource);\n\n      if (state_1 === \"break\") break;\n    }\n\n    this.refreshLayout(true);\n  };\n\n  ResourceBase.prototype.removeResource = function (resourceId, name) {\n    var resourceCollection = resourceId instanceof Array ? resourceId : [resourceId];\n\n    var _loop_4 = function (resource) {\n      if (resource.name === name) {\n        resourceCollection.forEach(function (removeObj) {\n          return new DataManager({\n            json: resource.dataSource\n          }).remove(resource.idField, removeObj);\n        });\n        return \"break\";\n      }\n    };\n\n    for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n      var resource = _a[_i];\n\n      var state_2 = _loop_4(resource);\n\n      if (state_2 === \"break\") break;\n    }\n\n    this.refreshLayout(true);\n  };\n\n  ResourceBase.prototype.getIndexFromResourceId = function (id, name, resourceData, event, parentField) {\n    name = name || this.parent.resourceCollection.slice(-1)[0].name;\n\n    if (isNullOrUndefined(resourceData)) {\n      resourceData = this.resourceCollection.filter(function (e) {\n        return e.name === name;\n      })[0];\n\n      if (isNullOrUndefined(resourceData)) {\n        return null;\n      }\n    }\n\n    var resource = resourceData.dataSource.filter(function (e) {\n      if (event && e[resourceData.idField] === id) {\n        if (e[resourceData.groupIDField] === event[parentField]) {\n          return e[resourceData.idField] === id;\n        }\n\n        return null;\n      } else {\n        return e[resourceData.idField] === id;\n      }\n    })[0];\n    return this.lastResourceLevel.map(function (e) {\n      return e.resourceData;\n    }).indexOf(resource);\n  };\n\n  ResourceBase.prototype.resourceExpand = function (id, name, hide) {\n    var resource = this.parent.resourceCollection.filter(function (e) {\n      if (e.name === name) {\n        return e;\n      }\n\n      return null;\n    })[0];\n    var index = 0;\n    var resourceData = resource.dataSource.filter(function (e) {\n      return e[resource.idField] === id;\n    })[0];\n\n    if (!this.parent.activeViewOptions.group.byGroupID) {\n      index = this.getIndexFromResourceId(id, name, resource);\n    } else {\n      index = this.lastResourceLevel.map(function (e) {\n        return e.resourceData;\n      }).indexOf(resourceData);\n    }\n\n    var target = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + (\"[data-group-index=\\\"\" + index + \"\\\"]\") + ' ' + '.' + cls.RESOURCE_TREE_ICON_CLASS);\n\n    if (target) {\n      if (target.classList.contains(cls.RESOURCE_EXPAND_CLASS) && !hide) {\n        target.click();\n      } else if (target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) && hide) {\n        target.click();\n      }\n    }\n  };\n\n  ResourceBase.prototype.resourceScroll = function (id, name) {\n    if (this.parent.isAdaptive || ['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n      return;\n    }\n\n    var levelName = name || this.parent.resourceCollection.slice(-1)[0].name;\n    var levelIndex = this.parent.resourceCollection.length - 1;\n    var resource = this.parent.resourceCollection.filter(function (e, index) {\n      if (e.name === levelName) {\n        levelIndex = index;\n        return e;\n      }\n\n      return null;\n    })[0];\n    var scrollElement = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var index = 0;\n\n    if (this.parent.activeView.isTimelineView()) {\n      if (!this.parent.activeViewOptions.group.byGroupID) {\n        index = this.getIndexFromResourceId(id, levelName, resource);\n      } else {\n        var resourceData = resource.dataSource.filter(function (e) {\n          return e[resource.idField] === id;\n        })[0];\n        index = this.lastResourceLevel.map(function (e) {\n          return e.resourceData;\n        }).indexOf(resourceData);\n      }\n\n      if (this.parent.virtualScrollModule) {\n        var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n        var averageRowHeight = Math.round(virtual.offsetHeight / this.expandedResources.length);\n\n        if (this.parent.rowAutoHeight) {\n          scrollElement.scrollTop = 0;\n          this.parent.virtualScrollModule.virtualScrolling();\n        }\n\n        scrollElement.scrollTop = index * averageRowHeight - (this.parent.virtualScrollModule.bufferCount - 1) * averageRowHeight;\n        this.parent.virtualScrollModule.virtualScrolling();\n\n        if (this.parent.rowAutoHeight) {\n          var td = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n\n          if (td && !td.parentElement.classList.contains(cls.HIDDEN_CLASS)) {\n            scrollElement.scrollTop = scrollElement.scrollTop < td.offsetTop ? td.offsetTop : scrollElement.scrollTop + td.offsetTop;\n          }\n        } else {\n          scrollElement.scrollTop = index * averageRowHeight;\n        }\n      } else {\n        var td = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n\n        if (td && !td.parentElement.classList.contains(cls.HIDDEN_CLASS)) {\n          scrollElement.scrollTop = td.offsetTop;\n        }\n      }\n    } else {\n      if (!this.parent.activeViewOptions.group.byGroupID) {\n        index = this.getIndexFromResourceId(id, levelName, resource);\n      } else {\n        if (levelName === this.parent.resourceCollection.slice(-1)[0].name) {\n          index = this.lastResourceLevel.map(function (e) {\n            return e.resourceData[resource.idField];\n          }).indexOf(id);\n        } else {\n          index = resource.dataSource.map(function (e) {\n            return e[resource.idField];\n          }).indexOf(id);\n        }\n      }\n\n      var offsetTarget = this.parent.element.querySelector(\".\" + cls.HEADER_ROW_CLASS + \":nth-child(\" + (levelIndex + 1) + \")\");\n      var offset = [].slice.call(offsetTarget.children).map(function (node) {\n        return node.offsetLeft;\n      });\n      scrollElement.scrollLeft = offset[index];\n    }\n  };\n\n  ResourceBase.prototype.destroy = function () {\n    this.parent.off(events.documentClick, this.documentClick);\n\n    if (this.treeViewObj) {\n      this.treeViewObj.destroy();\n      this.treeViewObj = null;\n    }\n\n    if (this.treePopup) {\n      this.treePopup.destroy();\n      this.treePopup = null;\n      remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP));\n      remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP_OVERLAY));\n    }\n\n    var resToolBarEle = this.parent.element.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER);\n\n    if (resToolBarEle) {\n      remove(resToolBarEle);\n    }\n  };\n\n  return ResourceBase;\n}();\n\nexport { ResourceBase };","map":{"version":3,"names":["extend","isNullOrUndefined","createElement","EventHandler","addClass","append","removeClass","remove","closest","classList","DataManager","Query","TreeView","Popup","Data","cls","events","util","ResourceBase","parent","resourceCollection","leftPixel","prototype","renderResourceHeaderIndent","tr","resColTd","className","RESOURCE_LEFT_TD_CLASS","resColDiv","RESOURCE_TEXT_CLASS","activeViewOptions","headerIndentTemplate","data","type","renderHeaderIndentTemplate","appendChild","args","elementType","element","trigger","renderCell","hideResourceRows","tBody","length","virtualScrollModule","trCount","lastResourceLevel","i","resData","resourceData","res","resource","ClassName","RESOURCE_PARENT_CLASS","expandedField","trCollection","slice","call","children","slicedCollection","parseInt","Count","HIDDEN_CLASS","createResourceColumn","resColl","resDiv","RESOURCE_COLUMN_WRAP_CLASS","tbl","activeView","createTableLayout","RESOURCE_COLUMN_TABLE_CLASS","uiStateValues","isGroupAdaptive","rowAutoHeight","isTimelineView","group","resources","AUTO_HEIGHT","querySelector","generateTreeData","countCalculation","renderedResources","resourceCount","getRenderedCount","setExpandedResources","expandedResources","getContentRows","setRenderedResources","temp","count","push","isExpanded","isVirtualScroll","resRows","left","rIndex","td","attrs","tabindex","ntd","cloneNode","findIndexInData","name","RESOURCE_CHILD_CLASS","iconClass","RESOURCE_COLLAPSE_CLASS","RESOURCE_EXPAND_CLASS","iconDiv","RESOURCE_TREE_ICON_CLASS","setMargin","add","onTreeIconClick","setResourceHeaderContent","setAttribute","groupIndex","toString","textField","resourceHeaderTemplate","classCollection","RESOURCE_CELLS_CLASS","ntr","value","enableRtl","style","marginLeft","marginRight","parentCollection","wholeCollection","collection","y","dataSource","x","totalCount","byGroupID","query","where","groupIDField","idField","executeLocal","z","e","_this","eventTooltip","close","target","hide","trElement","parentElement","index","getAttribute","cancel","event","requestType","contains","actionBegin","actionArgs","eventElements","querySelectorAll","APPOINTMENT_CLASS","_i","eventElements_1","updateVirtualContent","updateContent","cssProperties","getCssProperties","module","notify","scrollUiUpdate","refreshEvents","actionComplete","rowCollection","workCellCollection","headerRowCollection","pNode","clickedRes","contentRows","CONTENT_WRAP_CLASS","eventRows","APPOINTMENT_CONTAINER_CLASS","j","clonedCollection","expanded","trElem","rowIndex","splice","expand","startIndex","indexOf","sIndex","virtualTrack","VIRTUAL_TRACK_CLASS","updateVirtualTrackHeight","resTable","contentTable","eventTable","EVENT_TABLE_CLASS","timeIndicator","CURRENT_TIMELINE_CLASS","height","CONTENT_TABLE_CLASS","offsetHeight","renderResourceHeader","resourceWrapper","RESOURCE_TOOLBAR_CONTAINER","innerHTML","RESOURCE_HEADER_TOOLBAR","RESOURCE_MENU","RESOURCE_MENU_ICON","RESOURCE_LEVEL_TITLE","currentView","getPanel","insertBefore","WRAPPER_CONTAINER_CLASS","TABLE_CONTAINER_CLASS","renderResourceHeaderText","menuClick","renderResourceTree","popupOverlay","RESOURCE_TREE_POPUP_OVERLAY","treeWrapper","RESOURCE_TREE_POPUP","resourceTree","RESOURCE_TREE","treeViewObj","cssClass","fields","id","text","child","nodeTemplate","nodeClicked","resourceClick","bind","appendTo","expandAll","treePopup","targetType","actionOnScroll","content","relateTo","hideAnimation","duration","showAnimation","viewPortElement","on","documentClick","isTimeLine","treeCollection","resTreeColl","_loop_1","len","treeHandler","treeLevel","levelId","treeArgs","resObj","resourceId","resourceName","groupOrder","resourceChild","_a","tree","this_1","resourceTreeLevel","headerCollection","_loop_2","resourceLevel","this_2","resourceText","filter","RESOURCE_NAME","levelIcon","pop","headerWrapper","removeChildren","headerCollection_1","header","DISABLE_CLASS","POPUP_OPEN","ENABLE_CLASS","treeNodes","show","selectResourceByIndex","triggerEvents","node","preventDefault","renderModule","render","bindResourcesData","isSetModel","showSpinner","promises","dataModule","getData","generateQuery","Promise","all","then","dataManagerSuccess","catch","crudModule","dataManagerFailure","isDestroyed","length_1","resourceObj","getResourceModel","result","refreshLayout","field","title","allowMultiple","colorField","startHourField","endHourField","workDaysField","cssClassField","enablePersistence","renderElements","setResourceCollection","requiredResources","colorIndex","index_1","_b","requiredResources_1","eventSettings","resourceColorField","generateResourceLevels","innerDates","resTreeGroup","lastColumnDates","prevResource","prevResourceData","prevOrder","resTree","id_1","concat","items","dateCol","renderDates","resWorkDays","byDate","workDays","resStartHour","resEndHour","getRenderDates","getDateSlots","dateSlots","generateCustomHours","resCssClass","slotData","resourceLevelIndex","colSpan","generateHeaderLevels","startHour","endHour","dateSlots_1","dateSlot","getStartEndTime","headerDates","headerLevels","currentLevelChilds","currentLevelChilds_1","currentLevelChild","nextLevelChilds","_c","nextLevelChilds_1","nextLevelChild","_d","_e","lastLevelResource","dateHeaderLevels","levels","dateColSpan","_f","_g","firstRowTd","datesColumn","_h","headerDates_1","headerDate","resGroup","k","length_2","_j","_k","resTd","date","unshift","setResourceValues","eventObj","setValues","allowGroupEdit","activeCellsData","getResourceColor","colorFieldIndex","undefined","filterData","getCssClass","getResourceRenderDates","resourceDates","apply","map","removeDuplicateDates","dateColl","dates","dateObj","getTime","sort","a","b","getResourceData","groupEditIndex","groupEditIndex_1","level","length_3","fieldName","length_4","addResource","Array","_loop_3","forEach","addObj","json","insert","state_1","removeResource","_loop_4","removeObj","state_2","getIndexFromResourceId","parentField","resourceExpand","click","resourceScroll","isAdaptive","levelName","levelIndex","scrollElement","virtual","averageRowHeight","Math","round","scrollTop","virtualScrolling","bufferCount","WORK_CELLS_CLASS","offsetTop","offsetTarget","HEADER_ROW_CLASS","offset","offsetLeft","scrollLeft","destroy","off","resToolBarEle"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-schedule/src/schedule/base/resource.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-len */\nimport { extend, isNullOrUndefined, createElement, EventHandler, addClass, append, removeClass, remove, closest, classList } from '@syncfusion/ej2-base';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { TreeView } from '@syncfusion/ej2-navigations';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Data } from '../actions/data';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar ResourceBase = /** @class */ (function () {\n    function ResourceBase(parent) {\n        this.resourceCollection = [];\n        this.leftPixel = 25;\n        this.parent = parent;\n    }\n    ResourceBase.prototype.renderResourceHeaderIndent = function (tr) {\n        var resColTd = createElement('td', { className: cls.RESOURCE_LEFT_TD_CLASS });\n        var resColDiv = createElement('div', { className: cls.RESOURCE_TEXT_CLASS });\n        if (this.parent.activeViewOptions.headerIndentTemplate) {\n            var data = { className: [resColTd.className], type: 'emptyCells' };\n            this.parent.renderHeaderIndentTemplate(data, resColTd);\n        }\n        else {\n            resColTd.appendChild(resColDiv);\n        }\n        var args = { elementType: 'emptyCells', element: resColTd };\n        this.parent.trigger(events.renderCell, args);\n        tr.appendChild(resColTd);\n    };\n    ResourceBase.prototype.hideResourceRows = function (tBody) {\n        if (this.resourceCollection.length <= 1 || this.parent.virtualScrollModule) {\n            return;\n        }\n        var trCount = this.lastResourceLevel.length;\n        for (var i = 0; i < trCount; i++) {\n            var resData = this.lastResourceLevel[i].resourceData;\n            var res = this.lastResourceLevel[i].resource;\n            if (resData.ClassName === cls.RESOURCE_PARENT_CLASS && !resData[res.expandedField] &&\n                !isNullOrUndefined(resData[res.expandedField])) {\n                var trCollection = [].slice.call(tBody.children);\n                var slicedCollection = trCollection.slice(i + 1, i + (parseInt(resData.Count, 10) + 1));\n                addClass(slicedCollection, cls.HIDDEN_CLASS);\n            }\n        }\n    };\n    ResourceBase.prototype.createResourceColumn = function () {\n        var resColl = this.resourceCollection;\n        var resDiv = createElement('div', { className: cls.RESOURCE_COLUMN_WRAP_CLASS });\n        var tbl = this.parent.activeView.createTableLayout(cls.RESOURCE_COLUMN_TABLE_CLASS);\n        if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            addClass([tbl], cls.AUTO_HEIGHT);\n        }\n        var tBody = tbl.querySelector('tbody');\n        var resData = this.generateTreeData(true);\n        this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n        this.renderedResources = this.lastResourceLevel;\n        if (this.parent.virtualScrollModule) {\n            var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n            this.setExpandedResources();\n            resData = this.expandedResources.slice(0, resourceCount);\n            this.renderedResources = resData;\n        }\n        append(this.getContentRows(resData), tBody);\n        this.hideResourceRows(tBody);\n        tbl.appendChild(tBody);\n        resDiv.appendChild(tbl);\n        return resDiv;\n    };\n    ResourceBase.prototype.setRenderedResources = function () {\n        var resColl = this.resourceCollection;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var temp = this.generateTreeData(true);\n        this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n        this.renderedResources = this.lastResourceLevel;\n    };\n    ResourceBase.prototype.setExpandedResources = function () {\n        var resources = [];\n        for (var i = 0; i < this.lastResourceLevel.length; i++) {\n            var resource = this.lastResourceLevel[i].resourceData;\n            var count = resource.Count;\n            resources.push(this.lastResourceLevel[i]);\n            var isExpanded = resource[this.lastResourceLevel[i].resource.expandedField];\n            if (!isNullOrUndefined(isExpanded) && !isExpanded && count > 0) {\n                i = i + count;\n            }\n        }\n        this.expandedResources = resources;\n    };\n    ResourceBase.prototype.getContentRows = function (resData, isVirtualScroll) {\n        var resRows = [];\n        var left;\n        var rIndex;\n        var resColl = this.resourceCollection;\n        var tr = createElement('tr');\n        var td = createElement('td', { attrs: { tabindex: isVirtualScroll ? '-1' : '0' } });\n        for (var i = 0; i < resData.length; i++) {\n            var ntd = td.cloneNode();\n            rIndex = util.findIndexInData(resColl, 'name', resData[i].resource.name);\n            if (rIndex === resColl.length - 1) {\n                extend(resData[i].resourceData, { ClassName: cls.RESOURCE_CHILD_CLASS });\n                this.renderedResources[i].className = [cls.RESOURCE_CHILD_CLASS];\n            }\n            else {\n                extend(resData[i].resourceData, { ClassName: cls.RESOURCE_PARENT_CLASS });\n                this.renderedResources[i].className = [cls.RESOURCE_PARENT_CLASS];\n            }\n            left = (rIndex * this.leftPixel) + 'px';\n            if (resData[i].resourceData.ClassName === cls.RESOURCE_PARENT_CLASS\n                && !isNullOrUndefined(resData[i].resourceData.Count) && (resData[i].resourceData.Count > 0)) {\n                var iconClass = void 0;\n                if (resData[i].resourceData[resColl[rIndex].expandedField] ||\n                    isNullOrUndefined(resData[i].resourceData[resColl[rIndex].expandedField])) {\n                    iconClass = cls.RESOURCE_COLLAPSE_CLASS;\n                }\n                else {\n                    iconClass = cls.RESOURCE_EXPAND_CLASS;\n                }\n                var iconDiv = createElement('div');\n                addClass([iconDiv], [cls.RESOURCE_TREE_ICON_CLASS, iconClass]);\n                this.setMargin(iconDiv, left);\n                ntd.appendChild(iconDiv);\n                if (this.resourceCollection.length > 1) {\n                    EventHandler.add(iconDiv, 'click', this.onTreeIconClick, this);\n                }\n            }\n            this.parent.activeView.setResourceHeaderContent(ntd, resData[i], cls.RESOURCE_TEXT_CLASS);\n            ntd.setAttribute('data-group-index', resData[i].groupIndex.toString());\n            ntd.setAttribute('aria-label', resData[i].resourceData[resData[i].resource.textField] + ' resource');\n            if (!this.parent.activeViewOptions.resourceHeaderTemplate) {\n                this.setMargin(ntd.querySelector('.' + cls.RESOURCE_TEXT_CLASS), left);\n            }\n            var classCollection = [cls.RESOURCE_CELLS_CLASS, resData[i].resourceData.ClassName];\n            addClass([ntd], classCollection);\n            var args = { elementType: 'resourceHeader', element: ntd, groupIndex: resData[i].groupIndex };\n            this.parent.trigger(events.renderCell, args);\n            var ntr = tr.cloneNode();\n            ntr.appendChild(ntd);\n            resRows.push(ntr);\n        }\n        return resRows;\n    };\n    ResourceBase.prototype.setMargin = function (element, value) {\n        if (!this.parent.enableRtl) {\n            element.style.marginLeft = value;\n        }\n        else {\n            element.style.marginRight = value;\n        }\n    };\n    ResourceBase.prototype.countCalculation = function (parentCollection, wholeCollection) {\n        var collection;\n        for (var y = 0; y < parentCollection.length; y++) {\n            var data = parentCollection[parentCollection.length - (y + 1)].dataSource;\n            for (var x = 0; x < data.length; x++) {\n                var totalCount = 0;\n                if (this.parent.activeViewOptions.group.byGroupID) {\n                    var query = new Query().where(wholeCollection[wholeCollection.length - 1].groupIDField, 'equal', data[x][parentCollection[parentCollection.length - (y + 1)].idField]);\n                    collection = new DataManager(wholeCollection[wholeCollection.length - 1].dataSource).executeLocal(query);\n                }\n                else {\n                    collection = wholeCollection[wholeCollection.length - 1].dataSource;\n                }\n                for (var z = 0; z < collection.length; z++) {\n                    totalCount = totalCount + parseInt(collection[z].Count, 10);\n                }\n                totalCount = totalCount + parseInt(data[x].Count, 10);\n                extend(data[x], { Count: totalCount });\n            }\n            wholeCollection = wholeCollection.slice(0, -1);\n        }\n    };\n    ResourceBase.prototype.onTreeIconClick = function (e) {\n        var _this = this;\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.close();\n        }\n        var target = e.target;\n        var hide;\n        var trElement = closest(target, '.' + cls.RESOURCE_PARENT_CLASS)\n            .parentElement;\n        var index = parseInt(trElement.children[0].getAttribute('data-group-index'), 10);\n        var args = {\n            cancel: false, event: e, groupIndex: index,\n            requestType: !target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpand' : 'resourceCollapse'\n        };\n        this.parent.trigger(events.actionBegin, args, function (actionArgs) {\n            if (!actionArgs.cancel) {\n                if (target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS)) {\n                    classList(target, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n                    hide = true;\n                }\n                else {\n                    classList(target, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n                    hide = false;\n                }\n                var eventElements = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n                for (var _i = 0, eventElements_1 = eventElements; _i < eventElements_1.length; _i++) {\n                    var element = eventElements_1[_i];\n                    remove(element);\n                }\n                if (_this.parent.virtualScrollModule) {\n                    _this.updateVirtualContent(index, hide, e, target);\n                }\n                else {\n                    _this.updateContent(index, hide);\n                }\n                var data = { cssProperties: _this.parent.getCssProperties(), module: 'scroll' };\n                _this.parent.notify(events.scrollUiUpdate, data);\n                args = {\n                    cancel: false, event: e, groupIndex: index,\n                    requestType: target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpanded' : 'resourceCollapsed'\n                };\n                _this.parent.refreshEvents(false);\n                _this.parent.trigger(events.actionComplete, args);\n            }\n        });\n    };\n    ResourceBase.prototype.updateContent = function (index, hide) {\n        var rowCollection = [];\n        var workCellCollection = [];\n        var headerRowCollection = [];\n        var pNode;\n        var clickedRes = this.lastResourceLevel[index].resourceData;\n        var resRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'tr'));\n        var contentRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'tbody tr'));\n        var eventRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' .' + cls.APPOINTMENT_CONTAINER_CLASS));\n        for (var j = 0; j < clickedRes.Count; j++) {\n            rowCollection.push(resRows[index + j + 1]);\n            workCellCollection.push(contentRows[index + j + 1]);\n            headerRowCollection.push(eventRows[index + j + 1]);\n        }\n        var clonedCollection = this.lastResourceLevel;\n        for (var i = 0; i < rowCollection.length; i++) {\n            var expanded = true;\n            pNode = rowCollection[i].children[0].classList.contains(cls.RESOURCE_PARENT_CLASS);\n            clonedCollection[index].resourceData[clonedCollection[index].resource.expandedField] = !hide;\n            if (hide) {\n                if (pNode) {\n                    var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n                    if (trElem) {\n                        classList(trElem, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n                    }\n                }\n                if (!rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n                    addClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n                }\n            }\n            else {\n                if (pNode) {\n                    var rowIndex = rowCollection[i].rowIndex;\n                    if (!clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField]\n                        && !isNullOrUndefined(clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField])) {\n                        rowCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 10)));\n                        workCellCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 10)));\n                        headerRowCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 10)));\n                        expanded = false;\n                    }\n                    if (expanded) {\n                        var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n                        if (trElem) {\n                            classList(trElem, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n                        }\n                    }\n                }\n                if (rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n                    removeClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    ResourceBase.prototype.updateVirtualContent = function (index, expand, e, target) {\n        this.lastResourceLevel[index].resourceData[this.lastResourceLevel[index].resource.expandedField] = !expand;\n        this.setExpandedResources();\n        var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n        var startIndex = this.expandedResources.indexOf(this.renderedResources[0]);\n        this.renderedResources = this.expandedResources.slice(startIndex, startIndex + resourceCount);\n        if (this.renderedResources.length < resourceCount) {\n            var sIndex = this.expandedResources.length - resourceCount;\n            sIndex = (sIndex > 0) ? sIndex : 0;\n            this.renderedResources = this.expandedResources.slice(sIndex, this.expandedResources.length);\n        }\n        var virtualTrack = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n        this.parent.virtualScrollModule.updateVirtualTrackHeight(virtualTrack);\n        var resTable = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'table');\n        var contentTable = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'table');\n        var eventTable = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n        this.parent.virtualScrollModule.updateContent(resTable, contentTable, eventTable, this.renderedResources);\n        var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n        if (!isNullOrUndefined(timeIndicator)) {\n            timeIndicator.style.height =\n                this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight + 'px';\n        }\n    };\n    ResourceBase.prototype.renderResourceHeader = function () {\n        var resourceWrapper = createElement('div', { className: cls.RESOURCE_TOOLBAR_CONTAINER });\n        resourceWrapper.innerHTML = '<div class=\"' + cls.RESOURCE_HEADER_TOOLBAR + '\"><div class=\"' + cls.RESOURCE_MENU + '\">' +\n            '<div class=\"e-icons ' + cls.RESOURCE_MENU_ICON + '\"></div></div><div class=\"' + cls.RESOURCE_LEVEL_TITLE + '\"></div></div>';\n        if (this.parent.currentView === 'MonthAgenda') {\n            var target = this.parent.activeView.getPanel().querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            target.insertBefore(resourceWrapper, target.querySelector('.' + cls.WRAPPER_CONTAINER_CLASS));\n        }\n        else {\n            this.parent.element.insertBefore(resourceWrapper, this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS));\n        }\n        this.renderResourceHeaderText();\n        EventHandler.add(resourceWrapper.querySelector('.' + cls.RESOURCE_MENU_ICON), 'click', this.menuClick, this);\n    };\n    ResourceBase.prototype.renderResourceTree = function () {\n        this.popupOverlay = createElement('div', { className: cls.RESOURCE_TREE_POPUP_OVERLAY });\n        var treeWrapper = createElement('div', { className: cls.RESOURCE_TREE_POPUP + ' e-popup-close' });\n        if (this.parent.currentView === 'MonthAgenda') {\n            var target = this.parent.activeView.getPanel().querySelector('.' + cls.WRAPPER_CONTAINER_CLASS);\n            target.insertBefore(treeWrapper, target.children[0]);\n            target.appendChild(this.popupOverlay);\n        }\n        else {\n            this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(treeWrapper);\n            this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(this.popupOverlay);\n        }\n        var resourceTree = createElement('div', { className: cls.RESOURCE_TREE });\n        treeWrapper.appendChild(resourceTree);\n        this.treeViewObj = new TreeView({\n            cssClass: this.parent.cssClass,\n            enableRtl: this.parent.enableRtl,\n            fields: {\n                dataSource: [].slice.call(this.generateTreeData()),\n                id: 'resourceId',\n                text: 'resourceName',\n                child: 'resourceChild'\n            },\n            nodeTemplate: this.parent.resourceHeaderTemplate,\n            nodeClicked: this.resourceClick.bind(this)\n        });\n        this.treeViewObj.appendTo(resourceTree);\n        this.treeViewObj.expandAll();\n        this.treePopup = new Popup(treeWrapper, {\n            targetType: 'relative',\n            actionOnScroll: 'none',\n            content: this.treeViewObj.element,\n            relateTo: this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS),\n            enableRtl: this.parent.enableRtl,\n            hideAnimation: { name: 'SlideLeftOut', duration: 500 },\n            showAnimation: { name: 'SlideLeftIn', duration: 500 },\n            viewPortElement: this.parent.element.querySelector('.' + (this.parent.currentView === 'MonthAgenda' ?\n                cls.WRAPPER_CONTAINER_CLASS : cls.TABLE_CONTAINER_CLASS))\n        });\n        this.parent.on(events.documentClick, this.documentClick, this);\n    };\n    ResourceBase.prototype.generateTreeData = function (isTimeLine) {\n        var _this = this;\n        var treeCollection = [];\n        var resTreeColl = [];\n        var groupIndex = 0;\n        var _loop_1 = function (i, len) {\n            var treeHandler = function (treeLevel, index, levelId) {\n                var resource = _this.resourceCollection[index];\n                var treeArgs;\n                var resObj;\n                if (!isTimeLine) {\n                    treeArgs = {\n                        resourceId: levelId,\n                        resourceName: treeLevel.resourceData[resource.textField],\n                        resource: treeLevel.resource,\n                        resourceData: treeLevel.resourceData\n                    };\n                }\n                else {\n                    resObj = {\n                        type: 'resourceHeader', resource: treeLevel.resource,\n                        resourceData: treeLevel.resourceData, groupIndex: groupIndex,\n                        groupOrder: treeLevel.groupOrder\n                    };\n                    resTreeColl.push(resObj);\n                    groupIndex++;\n                }\n                if (treeLevel.child.length > 0 && !isTimeLine) {\n                    treeArgs.resourceChild = [];\n                }\n                var count = 1;\n                for (var _i = 0, _a = treeLevel.child; _i < _a.length; _i++) {\n                    var tree = _a[_i];\n                    if (!isTimeLine) {\n                        treeArgs.resourceChild.push(treeHandler(tree, index + 1, levelId + '-' + count));\n                    }\n                    else {\n                        treeHandler(tree, index + 1, levelId + '-' + count);\n                    }\n                    count += 1;\n                }\n                if (isTimeLine) {\n                    extend(resObj.resourceData, { Count: count - 1 });\n                }\n                return treeArgs;\n            };\n            if (!isTimeLine) {\n                treeCollection.push(treeHandler(this_1.resourceTreeLevel[i], 0, (i + 1).toString()));\n            }\n            else {\n                treeHandler(this_1.resourceTreeLevel[i], 0, (i + 1).toString());\n            }\n        };\n        var this_1 = this;\n        for (var i = 0, len = this.resourceTreeLevel.length; i < len; i++) {\n            _loop_1(i, len);\n        }\n        if (isTimeLine) {\n            this.lastResourceLevel = resTreeColl;\n            return resTreeColl;\n        }\n        else {\n            return treeCollection;\n        }\n    };\n    ResourceBase.prototype.renderResourceHeaderText = function () {\n        var resource = this.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        var headerCollection = [];\n        var _loop_2 = function (i, len) {\n            var resourceLevel = this_2.resourceCollection[i];\n            var resourceText = resourceLevel.dataSource.filter(function (resData) {\n                return resData[resourceLevel.idField] === resource.groupOrder[i];\n            });\n            var resourceName = createElement('div', {\n                className: cls.RESOURCE_NAME,\n                innerHTML: resourceText[0][resourceLevel.textField]\n            });\n            headerCollection.push(resourceName);\n            var levelIcon = createElement('div', { className: 'e-icons e-icon-next' });\n            headerCollection.push(levelIcon);\n        };\n        var this_2 = this;\n        for (var i = 0, len = resource.groupOrder.length; i < len; i++) {\n            _loop_2(i, len);\n        }\n        headerCollection.pop();\n        var target = (this.parent.currentView === 'MonthAgenda') ? this.parent.activeView.getPanel() : this.parent.element;\n        var headerWrapper = target.querySelector('.' + cls.RESOURCE_LEVEL_TITLE);\n        util.removeChildren(headerWrapper);\n        for (var _i = 0, headerCollection_1 = headerCollection; _i < headerCollection_1.length; _i++) {\n            var header = headerCollection_1[_i];\n            headerWrapper.appendChild(header);\n        }\n        if (this.lastResourceLevel.length === 1) {\n            addClass([this.parent.element.querySelector('.' + cls.RESOURCE_MENU)], cls.DISABLE_CLASS);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    ResourceBase.prototype.menuClick = function (event) {\n        if (this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP).classList.contains(cls.POPUP_OPEN)) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n        }\n        else {\n            var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n            removeClass(treeNodes, 'e-active');\n            addClass([treeNodes[this.parent.uiStateValues.groupIndex]], 'e-active');\n            this.treePopup.show();\n            addClass([this.popupOverlay], cls.ENABLE_CLASS);\n        }\n    };\n    ResourceBase.prototype.selectResourceByIndex = function (groupIndex) {\n        if (this.lastResourceLevel && groupIndex > -1 && groupIndex < this.lastResourceLevel.length) {\n            this.triggerEvents(groupIndex);\n        }\n    };\n    ResourceBase.prototype.resourceClick = function (event) {\n        if (!event.node.classList.contains('e-has-child')) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n            var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n            var groupIndex = treeNodes.indexOf(event.node);\n            this.triggerEvents(groupIndex, event);\n            event.event.preventDefault();\n        }\n    };\n    ResourceBase.prototype.triggerEvents = function (groupIndex, event) {\n        var _this = this;\n        var args = { cancel: false, event: (event) ? event.event : null, groupIndex: groupIndex, requestType: 'resourceChange' };\n        this.parent.trigger(events.actionBegin, args, function (actionArgs) {\n            if (!actionArgs.cancel) {\n                _this.parent.uiStateValues.groupIndex = actionArgs.groupIndex;\n                _this.parent.renderModule.render(_this.parent.currentView);\n                args = {\n                    cancel: false, event: (event) ? event.event : null, groupIndex: _this.parent.uiStateValues.groupIndex, requestType: 'resourceChanged'\n                };\n                _this.parent.trigger(events.actionComplete, args);\n            }\n        });\n    };\n    ResourceBase.prototype.documentClick = function (args) {\n        if (closest(args.event.target, '.' + cls.RESOURCE_TREE_POPUP)) {\n            return;\n        }\n        var treeWrapper = this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP);\n        if (treeWrapper && treeWrapper.classList.contains(cls.POPUP_OPEN)) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n        }\n    };\n    ResourceBase.prototype.bindResourcesData = function (isSetModel) {\n        var _this = this;\n        this.parent.showSpinner();\n        var promises = [];\n        for (var _i = 0, _a = this.parent.resources; _i < _a.length; _i++) {\n            var resource = _a[_i];\n            var dataModule = new Data(resource.dataSource, resource.query);\n            promises.push(dataModule.getData(dataModule.generateQuery()));\n        }\n        Promise.all(promises).then(function (e) { return _this.dataManagerSuccess(e, isSetModel); })\n            .catch(function (e) { return _this.parent.crudModule.dataManagerFailure(e); });\n    };\n    ResourceBase.prototype.dataManagerSuccess = function (e, isSetModel) {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.resourceCollection = [];\n        for (var i = 0, length_1 = e.length; i < length_1; i++) {\n            var resource = this.parent.resources[i];\n            var resourceObj = this.getResourceModel(resource, e[i].result);\n            this.parent.resourceCollection.push(resourceObj);\n        }\n        this.refreshLayout(isSetModel);\n    };\n    ResourceBase.prototype.getResourceModel = function (resource, resourceData) {\n        var resourceObj = {\n            field: resource.field,\n            title: resource.title,\n            name: resource.name,\n            allowMultiple: resource.allowMultiple,\n            dataSource: resourceData || resource.dataSource,\n            idField: resource.idField,\n            textField: resource.textField,\n            groupIDField: resource.groupIDField,\n            colorField: resource.colorField,\n            startHourField: resource.startHourField,\n            endHourField: resource.endHourField,\n            workDaysField: resource.workDaysField,\n            expandedField: resource.expandedField,\n            cssClassField: resource.cssClassField\n        };\n        return resourceObj;\n    };\n    ResourceBase.prototype.refreshLayout = function (isSetModel) {\n        if (isNullOrUndefined(this.parent.uiStateValues.groupIndex) || !(this.parent.enablePersistence)) {\n            this.parent.uiStateValues.groupIndex = 0;\n        }\n        this.parent.renderElements(isSetModel);\n    };\n    ResourceBase.prototype.setResourceCollection = function () {\n        var requiredResources = [];\n        this.resourceCollection = [];\n        this.colorIndex = null;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            for (var _i = 0, _a = this.parent.activeViewOptions.group.resources; _i < _a.length; _i++) {\n                var resource = _a[_i];\n                var index_1 = util.findIndexInData(this.parent.resourceCollection, 'name', resource);\n                if (index_1 >= 0) {\n                    requiredResources.push(this.parent.resourceCollection[index_1]);\n                }\n            }\n        }\n        else if (this.parent.resourceCollection.length > 0) {\n            requiredResources = this.parent.resourceCollection;\n        }\n        var index = 0;\n        for (var _b = 0, requiredResources_1 = requiredResources; _b < requiredResources_1.length; _b++) {\n            var resource = requiredResources_1[_b];\n            var resources = this.getResourceModel(resource);\n            if (resource.name === this.parent.eventSettings.resourceColorField) {\n                this.colorIndex = index;\n            }\n            index++;\n            this.resourceCollection.push(resources);\n        }\n        if (isNullOrUndefined(this.colorIndex)) {\n            this.colorIndex = this.resourceCollection.length - 1;\n        }\n    };\n    ResourceBase.prototype.generateResourceLevels = function (innerDates, isTimeLine) {\n        var _this = this;\n        var resources = this.resourceCollection;\n        var resTreeGroup = [];\n        var lastColumnDates = [];\n        var group = function (resources, index, prevResource, prevResourceData, prevOrder) {\n            var resTree = [];\n            var resource = resources[0];\n            if (resource) {\n                var data = void 0;\n                if (prevResourceData && _this.parent.activeViewOptions.group.byGroupID) {\n                    var id_1 = prevResourceData[prevResource.idField];\n                    data = resource.dataSource.filter(function (e) {\n                        return e[resource.groupIDField] === id_1;\n                    });\n                }\n                else {\n                    data = resource.dataSource;\n                }\n                for (var i = 0; i < data.length; i++) {\n                    var groupOrder = [];\n                    if (prevOrder && prevOrder.length > 0) {\n                        groupOrder = groupOrder.concat(prevOrder);\n                    }\n                    groupOrder.push(data[i][resource.idField]);\n                    var items = group(resources.slice(1), index + 1, resource, data[i], groupOrder);\n                    // Here validate child item empty top level resource only\n                    if (index === 0 && items.length === 0 && _this.resourceCollection.length > 1) {\n                        continue;\n                    }\n                    var dateCol = [];\n                    var renderDates = _this.parent.activeView.renderDates;\n                    var resWorkDays = void 0;\n                    if (!_this.parent.activeViewOptions.group.byDate && index + 1 === _this.resourceCollection.length) {\n                        var workDays = data[i][resource.workDaysField];\n                        var resStartHour = data[i][resource.startHourField];\n                        var resEndHour = data[i][resource.endHourField];\n                        if (workDays && workDays.length > 0) {\n                            renderDates = _this.parent.activeView.getRenderDates(workDays);\n                            resWorkDays = workDays;\n                            dateCol = _this.parent.activeView.getDateSlots(renderDates, workDays);\n                        }\n                        else {\n                            resWorkDays = _this.parent.activeViewOptions.workDays;\n                            dateCol = innerDates;\n                        }\n                        var dateSlots = _this.generateCustomHours(dateCol, resStartHour, resEndHour, groupOrder);\n                        lastColumnDates = lastColumnDates.concat(dateSlots);\n                    }\n                    var resCssClass = data[i][resource.cssClassField];\n                    var slotData = {\n                        type: 'resourceHeader', className: ['e-resource-cells'],\n                        resourceLevelIndex: index, groupOrder: groupOrder,\n                        resource: resource, resourceData: data[i],\n                        colSpan: _this.parent.activeViewOptions.group.byDate ? 1 : dateCol.length,\n                        renderDates: renderDates, workDays: resWorkDays, cssClass: resCssClass,\n                        child: items\n                    };\n                    resTree.push(slotData);\n                }\n                if (!resTreeGroup[index]) {\n                    resTreeGroup[index] = [];\n                }\n                if (resTree.length > 0) {\n                    resTreeGroup[index].push(resTree);\n                }\n                return resTree;\n            }\n            return [];\n        };\n        this.resourceTreeLevel = group(resources, 0);\n        return (isTimeLine) ? [] : this.generateHeaderLevels(resTreeGroup, lastColumnDates, innerDates);\n    };\n    ResourceBase.prototype.generateCustomHours = function (renderDates, startHour, endHour, groupOrder) {\n        var dateSlots = extend([], renderDates, null, true);\n        for (var _i = 0, dateSlots_1 = dateSlots; _i < dateSlots_1.length; _i++) {\n            var dateSlot = dateSlots_1[_i];\n            if (startHour) {\n                dateSlot.startHour = this.parent.getStartEndTime(startHour);\n            }\n            if (endHour) {\n                dateSlot.endHour = this.parent.getStartEndTime(endHour);\n            }\n            if (groupOrder) {\n                dateSlot.groupOrder = groupOrder;\n            }\n        }\n        return dateSlots;\n    };\n    ResourceBase.prototype.generateHeaderLevels = function (resTreeGroup, lastColumnDates, headerDates) {\n        var headerLevels = [];\n        for (var i = resTreeGroup.length - 1; i >= 0; i--) {\n            var temp = 0;\n            for (var _i = 0, _a = resTreeGroup[i]; _i < _a.length; _i++) {\n                var currentLevelChilds = _a[_i];\n                for (var _b = 0, currentLevelChilds_1 = currentLevelChilds; _b < currentLevelChilds_1.length; _b++) {\n                    var currentLevelChild = currentLevelChilds_1[_b];\n                    if (resTreeGroup[i + 1] && resTreeGroup[i + 1].length > 0) {\n                        var nextLevelChilds = resTreeGroup[i + 1][temp];\n                        if (!nextLevelChilds) {\n                            continue;\n                        }\n                        var colSpan = 0;\n                        for (var _c = 0, nextLevelChilds_1 = nextLevelChilds; _c < nextLevelChilds_1.length; _c++) {\n                            var nextLevelChild = nextLevelChilds_1[_c];\n                            if (!this.parent.activeViewOptions.group.byGroupID || (this.parent.activeViewOptions.group.byGroupID &&\n                                nextLevelChild.resourceData[nextLevelChild.resource.groupIDField] ===\n                                    currentLevelChild.resourceData[currentLevelChild.resource.idField])) {\n                                colSpan += nextLevelChild.colSpan;\n                            }\n                        }\n                        currentLevelChild.colSpan = colSpan;\n                    }\n                    currentLevelChild.groupIndex = temp;\n                    temp++;\n                    headerLevels[currentLevelChild.resourceLevelIndex] = headerLevels[currentLevelChild.resourceLevelIndex] || [];\n                    headerLevels[currentLevelChild.resourceLevelIndex].push(currentLevelChild);\n                }\n            }\n        }\n        this.lastResourceLevel = headerLevels.slice(-1)[0] || [];\n        if (!this.parent.activeViewOptions.group.byDate) {\n            var index = 0;\n            for (var _d = 0, _e = this.lastResourceLevel; _d < _e.length; _d++) {\n                var lastLevelResource = _e[_d];\n                for (var i = 0; i < lastLevelResource.colSpan; i++) {\n                    lastColumnDates[index].groupIndex = lastLevelResource.groupIndex;\n                    index++;\n                }\n            }\n            headerLevels.push(lastColumnDates);\n            return headerLevels;\n        }\n        var dateHeaderLevels = [];\n        var levels = extend([], headerLevels, null, true);\n        var dateColSpan = 0;\n        for (var _f = 0, _g = levels[0]; _f < _g.length; _f++) {\n            var firstRowTd = _g[_f];\n            dateColSpan += firstRowTd.colSpan;\n        }\n        var datesColumn = [];\n        for (var _h = 0, headerDates_1 = headerDates; _h < headerDates_1.length; _h++) {\n            var headerDate = headerDates_1[_h];\n            headerDate.colSpan = dateColSpan;\n            datesColumn.push(headerDate);\n            var resGroup = extend([], levels, null, true);\n            for (var k = 0, length_2 = resGroup.length; k < length_2; k++) {\n                if (k === resGroup.length - 1) {\n                    for (var _j = 0, _k = resGroup[k]; _j < _k.length; _j++) {\n                        var resTd = _k[_j];\n                        resTd.date = headerDate.date;\n                        resTd.workDays = headerDate.workDays;\n                        resTd.startHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.startHourField]) ||\n                            headerDate.startHour;\n                        resTd.endHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.endHourField]) ||\n                            headerDate.endHour;\n                    }\n                }\n                if (!dateHeaderLevels[k]) {\n                    dateHeaderLevels[k] = [];\n                }\n                dateHeaderLevels[k] = dateHeaderLevels[k].concat(resGroup[k]);\n            }\n        }\n        dateHeaderLevels.unshift(datesColumn);\n        return dateHeaderLevels;\n    };\n    ResourceBase.prototype.setResourceValues = function (eventObj, groupIndex) {\n        var _this = this;\n        var setValues = function (index, field, value) {\n            if (_this.resourceCollection[index].allowMultiple && _this.parent.activeViewOptions.group.allowGroupEdit) {\n                eventObj[field] = [value];\n            }\n            else {\n                eventObj[field] = value;\n            }\n        };\n        if (groupIndex === void 0) {\n            groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex :\n                this.parent.activeCellsData.groupIndex;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(groupIndex)) {\n            var groupOrder = this.lastResourceLevel[groupIndex].groupOrder;\n            for (var index = 0; index < this.resourceCollection.length; index++) {\n                setValues(index, this.resourceCollection[index].field, groupOrder[index]);\n            }\n        }\n        else if (this.parent.resourceCollection.length > 0) {\n            for (var index = 0; index < this.resourceCollection.length; index++) {\n                var data = this.resourceCollection[index].dataSource[0];\n                if (data) {\n                    setValues(index, this.resourceCollection[index].field, data[this.resourceCollection[index].idField]);\n                }\n            }\n        }\n    };\n    ResourceBase.prototype.getResourceColor = function (eventObj, groupOrder) {\n        var colorFieldIndex = (!isNullOrUndefined(groupOrder) &&\n            this.colorIndex > groupOrder.length - 1) ? groupOrder.length - 1 : this.colorIndex;\n        var resource = this.resourceCollection[colorFieldIndex];\n        if (isNullOrUndefined(groupOrder) && this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n            return undefined;\n        }\n        var id = isNullOrUndefined(groupOrder) ? eventObj[resource.field] : groupOrder[colorFieldIndex];\n        var data = this.filterData(resource.dataSource, resource.idField, id);\n        if (data.length > 0) {\n            return data[0][resource.colorField];\n        }\n        return undefined;\n    };\n    ResourceBase.prototype.getCssClass = function (eventObj) {\n        var resource = this.resourceCollection.slice(-1)[0];\n        if (this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n            return undefined;\n        }\n        var data = this.filterData(resource.dataSource, resource.idField, eventObj[resource.field]);\n        if (data.length > 0) {\n            return data[0][resource.cssClassField];\n        }\n        return undefined;\n    };\n    ResourceBase.prototype.getResourceRenderDates = function () {\n        // eslint-disable-next-line prefer-spread\n        var resourceDates = [].concat.apply([], this.lastResourceLevel.map(function (e) { return e.renderDates; }));\n        var removeDuplicateDates = function (dateColl) { return dateColl.filter(function (date, index, dates) {\n            return dates.map(function (dateObj) { return dateObj.getTime(); }).indexOf(date.getTime()) === index;\n        }); };\n        var renderDates = removeDuplicateDates(resourceDates);\n        renderDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n        return renderDates;\n    };\n    ResourceBase.prototype.filterData = function (dataSource, field, value) {\n        return dataSource.filter(function (data) { return data[field] === value; });\n    };\n    ResourceBase.prototype.getResourceData = function (eventObj, index, groupEditIndex) {\n        if (this.parent.activeViewOptions.group.allowGroupEdit) {\n            var resourceObj = {};\n            for (var _i = 0, groupEditIndex_1 = groupEditIndex; _i < groupEditIndex_1.length; _i++) {\n                var groupIndex = groupEditIndex_1[_i];\n                var resourceLevel = this.lastResourceLevel[groupIndex].groupOrder;\n                for (var level = 0, length_3 = resourceLevel.length; level < length_3; level++) {\n                    var fieldName = this.resourceCollection[level].field;\n                    if (isNullOrUndefined(resourceObj[fieldName])) {\n                        resourceObj[fieldName] = [];\n                    }\n                    resourceObj[fieldName].push(resourceLevel[level]);\n                }\n            }\n            eventObj = extend(eventObj, resourceObj);\n        }\n        else {\n            for (var level = 0, length_4 = this.resourceCollection.length; level < length_4; level++) {\n                if (this.lastResourceLevel[index]) {\n                    eventObj[this.resourceCollection[level].field] = this.lastResourceLevel[index].groupOrder[level];\n                }\n            }\n        }\n    };\n    ResourceBase.prototype.addResource = function (resources, name, index) {\n        var resourceCollection = (resources instanceof Array) ? resources : [resources];\n        var _loop_3 = function (resource) {\n            if (resource.name === name) {\n                resourceCollection.forEach(function (addObj, i) {\n                    return new DataManager({ json: resource.dataSource }).insert(addObj, null, null, index + i);\n                });\n                return \"break\";\n            }\n        };\n        for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n            var resource = _a[_i];\n            var state_1 = _loop_3(resource);\n            if (state_1 === \"break\")\n                break;\n        }\n        this.refreshLayout(true);\n    };\n    ResourceBase.prototype.removeResource = function (resourceId, name) {\n        var resourceCollection = (resourceId instanceof Array) ? resourceId : [resourceId];\n        var _loop_4 = function (resource) {\n            if (resource.name === name) {\n                resourceCollection.forEach(function (removeObj) {\n                    return new DataManager({ json: resource.dataSource }).remove(resource.idField, removeObj);\n                });\n                return \"break\";\n            }\n        };\n        for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n            var resource = _a[_i];\n            var state_2 = _loop_4(resource);\n            if (state_2 === \"break\")\n                break;\n        }\n        this.refreshLayout(true);\n    };\n    ResourceBase.prototype.getIndexFromResourceId = function (id, name, resourceData, event, parentField) {\n        name = name || this.parent.resourceCollection.slice(-1)[0].name;\n        if (isNullOrUndefined(resourceData)) {\n            resourceData = this.resourceCollection.filter(function (e) { return e.name === name; })[0];\n            if (isNullOrUndefined(resourceData)) {\n                return null;\n            }\n        }\n        var resource = resourceData.dataSource.filter(function (e) {\n            if (event && e[resourceData.idField] === id) {\n                if (e[resourceData.groupIDField] === event[parentField]) {\n                    return e[resourceData.idField] === id;\n                }\n                return null;\n            }\n            else {\n                return e[resourceData.idField] === id;\n            }\n        })[0];\n        return (this.lastResourceLevel.map(function (e) { return e.resourceData; }).indexOf(resource));\n    };\n    ResourceBase.prototype.resourceExpand = function (id, name, hide) {\n        var resource = this.parent.resourceCollection.filter(function (e) {\n            if (e.name === name) {\n                return e;\n            }\n            return null;\n        })[0];\n        var index = 0;\n        var resourceData = resource.dataSource.filter(function (e) { return e[resource.idField] === id; })[0];\n        if (!this.parent.activeViewOptions.group.byGroupID) {\n            index = this.getIndexFromResourceId(id, name, resource);\n        }\n        else {\n            index = this.lastResourceLevel.map(function (e) { return e.resourceData; }).indexOf(resourceData);\n        }\n        var target = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + (\"[data-group-index=\\\"\" + index + \"\\\"]\") +\n            ' ' + '.' + cls.RESOURCE_TREE_ICON_CLASS);\n        if (target) {\n            if (target.classList.contains(cls.RESOURCE_EXPAND_CLASS) && !hide) {\n                target.click();\n            }\n            else if (target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) && hide) {\n                target.click();\n            }\n        }\n    };\n    ResourceBase.prototype.resourceScroll = function (id, name) {\n        if (this.parent.isAdaptive || ['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n            return;\n        }\n        var levelName = name || this.parent.resourceCollection.slice(-1)[0].name;\n        var levelIndex = this.parent.resourceCollection.length - 1;\n        var resource = this.parent.resourceCollection.filter(function (e, index) {\n            if (e.name === levelName) {\n                levelIndex = index;\n                return e;\n            }\n            return null;\n        })[0];\n        var scrollElement = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var index = 0;\n        if (this.parent.activeView.isTimelineView()) {\n            if (!this.parent.activeViewOptions.group.byGroupID) {\n                index = this.getIndexFromResourceId(id, levelName, resource);\n            }\n            else {\n                var resourceData = resource.dataSource.filter(function (e) {\n                    return e[resource.idField] === id;\n                })[0];\n                index = this.lastResourceLevel.map(function (e) { return e.resourceData; }).indexOf(resourceData);\n            }\n            if (this.parent.virtualScrollModule) {\n                var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n                var averageRowHeight = Math.round(virtual.offsetHeight / this.expandedResources.length);\n                if (this.parent.rowAutoHeight) {\n                    scrollElement.scrollTop = 0;\n                    this.parent.virtualScrollModule.virtualScrolling();\n                }\n                scrollElement.scrollTop = (index * averageRowHeight) - (((this.parent.virtualScrollModule.bufferCount - 1) * averageRowHeight));\n                this.parent.virtualScrollModule.virtualScrolling();\n                if (this.parent.rowAutoHeight) {\n                    var td = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n                    if (td && !td.parentElement.classList.contains(cls.HIDDEN_CLASS)) {\n                        scrollElement.scrollTop =\n                            (scrollElement.scrollTop < td.offsetTop) ? td.offsetTop : scrollElement.scrollTop + td.offsetTop;\n                    }\n                }\n                else {\n                    scrollElement.scrollTop = (index * averageRowHeight);\n                }\n            }\n            else {\n                var td = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n                if (td && !td.parentElement.classList.contains(cls.HIDDEN_CLASS)) {\n                    scrollElement.scrollTop = td.offsetTop;\n                }\n            }\n        }\n        else {\n            if (!this.parent.activeViewOptions.group.byGroupID) {\n                index = this.getIndexFromResourceId(id, levelName, resource);\n            }\n            else {\n                if (levelName === this.parent.resourceCollection.slice(-1)[0].name) {\n                    index = this.lastResourceLevel.map(function (e) { return e.resourceData[resource.idField]; }).indexOf(id);\n                }\n                else {\n                    index = resource.dataSource.map(function (e) { return e[resource.idField]; }).indexOf(id);\n                }\n            }\n            var offsetTarget = this.parent.element.querySelector(\".\" + cls.HEADER_ROW_CLASS + \":nth-child(\" + (levelIndex + 1) + \")\");\n            var offset = [].slice.call(offsetTarget.children).map(function (node) { return node.offsetLeft; });\n            scrollElement.scrollLeft = offset[index];\n        }\n    };\n    ResourceBase.prototype.destroy = function () {\n        this.parent.off(events.documentClick, this.documentClick);\n        if (this.treeViewObj) {\n            this.treeViewObj.destroy();\n            this.treeViewObj = null;\n        }\n        if (this.treePopup) {\n            this.treePopup.destroy();\n            this.treePopup = null;\n            remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP));\n            remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP_OVERLAY));\n        }\n        var resToolBarEle = this.parent.element.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER);\n        if (resToolBarEle) {\n            remove(resToolBarEle);\n        }\n    };\n    return ResourceBase;\n}());\nexport { ResourceBase };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}