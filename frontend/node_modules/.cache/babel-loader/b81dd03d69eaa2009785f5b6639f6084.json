{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { append, createElement, remove, isNullOrUndefined, closest, extend } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { FormValidator, NumericTextBox, TextBox } from '@syncfusion/ej2-inputs';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * Dialog module is used to perform card actions.\n */\n\nvar KanbanDialog =\n/** @class */\nfunction () {\n  /**\n   * Constructor for dialog module\n   *\n   * @param {Kanban} parent Accepts the kanban instance\n   */\n  function KanbanDialog(parent) {\n    this.preventUpdate = false;\n    this.parent = parent;\n  }\n\n  KanbanDialog.prototype.openDialog = function (action, data) {\n    this.action = action;\n    this.parent.activeCardData.data = data;\n    this.renderDialog(data, action);\n    this.dialogObj.show();\n  };\n\n  KanbanDialog.prototype.closeDialog = function () {\n    this.dialogObj.hide();\n  };\n\n  KanbanDialog.prototype.renderDialog = function (args, action) {\n    this.element = createElement('div', {\n      id: this.parent.element.id + '_dialog_wrapper'\n    });\n    this.parent.element.appendChild(this.element);\n    var dialogModel = {\n      buttons: this.getDialogButtons(action),\n      content: this.getDialogContent(args, action),\n      cssClass: cls.DIALOG_CLASS,\n      enableRtl: this.parent.enableRtl,\n      header: this.parent.localeObj.getConstant(action === 'Add' ? 'addTitle' : action === 'Edit' ? 'editTitle' : 'deleteTitle'),\n      height: 'auto',\n      isModal: true,\n      showCloseIcon: true,\n      width: action === 'Delete' ? 400 : 350,\n      visible: false,\n      beforeOpen: this.onBeforeDialogOpen.bind(this),\n      beforeClose: this.onBeforeDialogClose.bind(this)\n    };\n    this.dialogObj = new Dialog(extend(dialogModel, action !== 'Delete' ? this.parent.dialogSettings.model || {} : {}), this.element);\n\n    if (action !== 'Delete') {\n      this.applyFormValidation();\n    }\n\n    this.dialogObj.element.querySelector('.e-dlg-closeicon-btn').title = this.parent.localeObj.getConstant('close');\n  };\n\n  KanbanDialog.prototype.getDialogContent = function (args, action) {\n    if (action === 'Delete') {\n      return this.parent.localeObj.getConstant('deleteContent');\n    } else {\n      var container = createElement('div', {\n        className: cls.FORM_WRAPPER_CLASS\n      });\n      var form = createElement('form', {\n        id: this.parent.element.id + 'EditForm',\n        className: cls.FORM_CLASS,\n        attrs: {\n          onsubmit: 'return false;'\n        }\n      });\n\n      if (this.parent.dialogSettings.template) {\n        if (args) {\n          this.destroyComponents();\n          [].slice.call(form.childNodes).forEach(function (node) {\n            return remove(node);\n          });\n        }\n\n        var templateId = this.parent.element.id + '_dialogTemplate';\n        var dialogTemplate = this.parent.templateParser(this.parent.dialogSettings.template)(args, this.parent, 'dialogTemplate', templateId, false);\n        append(dialogTemplate, form);\n        this.parent.renderTemplates();\n      } else {\n        var dialogWrapper = createElement('div', {\n          className: cls.DIALOG_CONTENT_CONTAINER\n        });\n        form.appendChild(dialogWrapper);\n        var table = createElement('table');\n        dialogWrapper.appendChild(table);\n        var dialogFields = this.getDialogFields();\n\n        for (var _i = 0, dialogFields_1 = dialogFields; _i < dialogFields_1.length; _i++) {\n          var field = dialogFields_1[_i];\n          var tr = createElement('tr');\n          table.appendChild(tr);\n          tr.appendChild(createElement('td', {\n            className: 'e-label',\n            innerHTML: field.text ? field.text : field.key\n          }));\n          var td = createElement('td');\n          tr.appendChild(td);\n          td.appendChild(this.renderComponents(field));\n        }\n      }\n\n      container.appendChild(form);\n      return container;\n    }\n  };\n\n  KanbanDialog.prototype.getDialogFields = function () {\n    var fields = this.parent.dialogSettings.fields;\n\n    if (fields.length === 0) {\n      fields = [{\n        text: 'ID',\n        key: this.parent.cardSettings.headerField,\n        type: 'TextBox'\n      }, {\n        key: this.parent.keyField,\n        type: 'DropDown'\n      }, {\n        key: this.parent.cardSettings.contentField,\n        type: 'TextArea'\n      }];\n\n      if (this.parent.sortSettings.field) {\n        fields.splice(fields.length - 1, 0, {\n          key: this.parent.sortSettings.field,\n          type: 'TextBox'\n        });\n      }\n\n      if (this.parent.swimlaneSettings.keyField) {\n        fields.splice(fields.length - 1, 0, {\n          key: this.parent.swimlaneSettings.keyField,\n          type: 'DropDown'\n        });\n      }\n    }\n\n    return fields;\n  };\n\n  KanbanDialog.prototype.getDialogButtons = function (action) {\n    var primaryButtonClass = action === 'Delete' ? 'e-dialog-yes' : action === 'Add' ? 'e-dialog-add' : 'e-dialog-edit';\n    var flatButtonClass = action === 'Delete' ? 'e-dialog-no' : 'e-dialog-cancel';\n    var dialogButtons = [{\n      buttonModel: {\n        cssClass: 'e-flat ' + primaryButtonClass,\n        isPrimary: true,\n        content: this.parent.localeObj.getConstant(action === 'Add' || action === 'Edit' ? 'save' : 'yes')\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-flat ' + flatButtonClass,\n        isPrimary: false,\n        content: this.parent.localeObj.getConstant(action === 'Add' || action === 'Edit' ? 'cancel' : 'no')\n      },\n      click: this.dialogButtonClick.bind(this)\n    }];\n\n    if (action === 'Edit') {\n      var deleteButton = {\n        buttonModel: {\n          cssClass: 'e-flat e-dialog-delete',\n          isPrimary: false,\n          content: this.parent.localeObj.getConstant('delete')\n        },\n        click: this.dialogButtonClick.bind(this)\n      };\n      dialogButtons.splice(0, 0, deleteButton);\n    }\n\n    return dialogButtons;\n  };\n\n  KanbanDialog.prototype.renderComponents = function (field) {\n    var wrapper = createElement('div', {\n      className: field.key + '_wrapper'\n    });\n    var element = createElement('input', {\n      className: cls.FIELD_CLASS,\n      attrs: {\n        'name': field.key\n      }\n    });\n    wrapper.appendChild(element);\n    var divElement;\n    var dropDownOptions;\n    var controlObj;\n    var fieldValue = this.parent.activeCardData.data ? this.parent.activeCardData.data[field.key] : null;\n\n    switch (field.type) {\n      case 'DropDown':\n        if (field.key === this.parent.keyField) {\n          var currentKeys = this.parent.layoutModule.columnKeys;\n\n          if (this.parent.actionModule.hideColumnKeys.length > 0) {\n            currentKeys = [];\n\n            for (var i = 0; i < this.parent.columns.length; i++) {\n              if (this.parent.layoutModule.isColumnVisible(this.parent.columns[i])) {\n                var isNumeric = typeof this.parent.columns[i].keyField === 'number';\n\n                if (isNumeric) {\n                  currentKeys = currentKeys.concat(this.parent.columns[i].keyField.toString());\n                } else {\n                  currentKeys = currentKeys.concat(this.parent.columns[i].keyField.split(',').map(function (e) {\n                    return e.trim();\n                  }));\n                }\n              }\n            }\n          }\n\n          dropDownOptions = {\n            dataSource: currentKeys,\n            value: fieldValue ? fieldValue.toString() : fieldValue\n          };\n        } else if (field.key === this.parent.swimlaneSettings.keyField) {\n          dropDownOptions = {\n            dataSource: [].slice.call(this.parent.layoutModule.kanbanRows),\n            fields: {\n              text: 'textField',\n              value: 'keyField'\n            },\n            value: fieldValue\n          };\n        }\n\n        controlObj = new DropDownList(dropDownOptions);\n        break;\n\n      case 'Numeric':\n        controlObj = new NumericTextBox({\n          value: fieldValue\n        });\n        break;\n\n      case 'TextBox':\n        controlObj = new TextBox({\n          value: fieldValue\n        });\n\n        if (fieldValue && this.parent.cardSettings.headerField === field.key) {\n          controlObj.enabled = false;\n        }\n\n        break;\n\n      case 'TextArea':\n        remove(element);\n        divElement = createElement('div');\n        element = createElement('textarea', {\n          className: cls.FIELD_CLASS,\n          attrs: {\n            'name': field.key,\n            'rows': '3'\n          },\n          innerHTML: fieldValue\n        });\n        wrapper.appendChild(divElement).appendChild(element);\n        break;\n\n      default:\n        break;\n    }\n\n    if (controlObj) {\n      controlObj.appendTo(element);\n    }\n\n    return wrapper;\n  };\n\n  KanbanDialog.prototype.onBeforeDialogOpen = function (args) {\n    var _this = this;\n\n    var eventProp = {\n      data: this.parent.activeCardData.data,\n      cancel: false,\n      element: this.element,\n      target: this.parent.activeCardData.element,\n      requestType: this.action\n    };\n    this.storeElement = document.activeElement;\n\n    if (parseInt(args.maxHeight, 10) <= 250) {\n      args.maxHeight = '250px';\n    }\n\n    this.parent.trigger(events.dialogOpen, eventProp, function (openArgs) {\n      args.cancel = openArgs.cancel;\n\n      if (openArgs.cancel) {\n        _this.destroy();\n      }\n    });\n  };\n\n  KanbanDialog.prototype.onBeforeDialogClose = function (args) {\n    var _this = this;\n\n    var formInputs = this.getFormElements();\n    var cardObj = {};\n\n    if (args.isInteracted) {\n      /* close icon preventing data update */\n      this.preventUpdate = true;\n    }\n\n    if (!this.preventUpdate) {\n      for (var _i = 0, formInputs_1 = formInputs; _i < formInputs_1.length; _i++) {\n        var input = formInputs_1[_i];\n        var columnName = input.name || this.getColumnName(input);\n\n        if (!isNullOrUndefined(columnName) && columnName !== '') {\n          var value = this.getValueFromElement(input);\n\n          if (columnName === this.parent.cardSettings.headerField) {\n            value = this.getIDType() === 'string' ? value : parseInt(value, 10);\n          }\n\n          cardObj[columnName] = value;\n        }\n      }\n    }\n\n    this.preventUpdate = false;\n    cardObj = extend(this.parent.activeCardData.data, cardObj);\n    var eventProp = {\n      data: cardObj,\n      cancel: false,\n      element: this.element,\n      requestType: this.action\n    };\n    this.parent.trigger(events.dialogClose, eventProp, function (closeArgs) {\n      args.cancel = closeArgs.cancel;\n\n      if (!closeArgs.cancel) {\n        _this.cardData = eventProp.data;\n\n        _this.destroy();\n\n        _this.parent.actionModule.SingleCardSelection(_this.cardData);\n      }\n    });\n  };\n\n  KanbanDialog.prototype.getIDType = function () {\n    if (this.parent.kanbanData.length !== 0) {\n      return typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField];\n    }\n\n    return 'string';\n  };\n\n  KanbanDialog.prototype.applyFormValidation = function () {\n    var _this = this;\n\n    var form = this.element.querySelector('.' + cls.FORM_CLASS);\n    var rules = {};\n\n    for (var _i = 0, _a = this.parent.dialogSettings.fields; _i < _a.length; _i++) {\n      var field = _a[_i];\n      rules[field.key] = field.validationRules && Object.keys(field.validationRules).length > 0 ? field.validationRules : null;\n    }\n\n    this.formObj = new FormValidator(form, {\n      rules: rules,\n      customPlacement: function (inputElement, error) {\n        var id = error.getAttribute('for');\n\n        var elem = _this.element.querySelector('#' + id + '_Error');\n\n        if (!elem) {\n          _this.createTooltip(inputElement, error, id, '');\n        }\n      },\n      validationComplete: function (args) {\n        var elem = _this.element.querySelector('#' + args.inputName + '_Error');\n\n        if (elem) {\n          elem.style.display = args.status === 'failure' ? '' : 'none';\n        }\n      }\n    });\n  };\n\n  KanbanDialog.prototype.createTooltip = function (element, error, name, display) {\n    var dlgContent;\n    var client;\n    var inputClient = element.parentElement.getBoundingClientRect();\n\n    if (this.element.classList.contains(cls.DIALOG_CLASS)) {\n      dlgContent = this.element;\n      client = this.element.getBoundingClientRect();\n    } else {\n      dlgContent = this.element.querySelector('.e-kanban-dialog .e-dlg-content');\n      client = dlgContent.getBoundingClientRect();\n    }\n\n    var div = createElement('div', {\n      className: 'e-tooltip-wrap e-popup ' + cls.ERROR_VALIDATION_CLASS,\n      id: name + '_Error',\n      styles: 'display:' + display + ';top:' + (inputClient.bottom - client.top + dlgContent.scrollTop + 9) + 'px;left:' + (inputClient.left - client.left + dlgContent.scrollLeft + inputClient.width / 2) + 'px;'\n    });\n    var content = createElement('div', {\n      className: 'e-tip-content'\n    });\n    content.appendChild(error);\n    var arrow = createElement('div', {\n      className: 'e-arrow-tip e-tip-top'\n    });\n    arrow.appendChild(createElement('div', {\n      className: 'e-arrow-tip-outer e-tip-top'\n    }));\n    arrow.appendChild(createElement('div', {\n      className: 'e-arrow-tip-inner e-tip-top'\n    }));\n    div.appendChild(content);\n    div.appendChild(arrow);\n    dlgContent.appendChild(div);\n    div.style.left = parseInt(div.style.left, 10) - div.offsetWidth / 2 + 'px';\n  };\n\n  KanbanDialog.prototype.destroyToolTip = function () {\n    if (this.element) {\n      this.element.querySelectorAll('.' + cls.ERROR_VALIDATION_CLASS).forEach(function (node) {\n        return remove(node);\n      });\n    }\n\n    if (this.formObj && this.formObj.element) {\n      this.formObj.reset();\n    }\n  };\n\n  KanbanDialog.prototype.dialogButtonClick = function (event) {\n    var target = event.target.cloneNode(true);\n    var id = this.formObj.element.id;\n\n    if (document.getElementById(id) && this.formObj.validate() && (target.classList.contains('e-dialog-edit') || target.classList.contains('e-dialog-add'))) {\n      this.dialogObj.hide();\n\n      if (target.classList.contains('e-dialog-edit')) {\n        var activeCard = this.parent.activeCardData;\n        var updateIndex = void 0;\n\n        if (activeCard.data[this.parent.keyField] === this.cardData[this.parent.keyField] && activeCard.element) {\n          updateIndex = [].slice.call(activeCard.element.parentElement.children).indexOf(activeCard.element);\n        }\n\n        this.parent.crudModule.updateCard(this.cardData, updateIndex);\n      }\n\n      if (target.classList.contains('e-dialog-add')) {\n        this.parent.crudModule.addCard(this.cardData);\n      }\n\n      this.parent.actionModule.SingleCardSelection(this.cardData);\n      this.cardData = null;\n    }\n\n    if (!target.classList.contains('e-dialog-edit') && !target.classList.contains('e-dialog-add')) {\n      if (target.classList.contains('e-dialog-cancel')) {\n        this.preventUpdate = true;\n      }\n\n      this.dialogObj.hide();\n\n      if (target.classList.contains('e-dialog-yes')) {\n        this.parent.crudModule.deleteCard(this.parent.activeCardData.data);\n      } else if (target.classList.contains('e-dialog-no')) {\n        this.openDialog('Edit', this.parent.activeCardData.data);\n      } else if (target.classList.contains('e-dialog-delete')) {\n        this.openDialog('Delete', this.parent.activeCardData.data);\n      }\n    }\n  };\n\n  KanbanDialog.prototype.getFormElements = function () {\n    var elements = [].slice.call(this.element.querySelectorAll('.' + cls.FIELD_CLASS));\n    var validElements = [];\n\n    for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n      var element = elements_1[_i];\n\n      if (element.classList.contains('e-control')) {\n        validElements.push(element);\n      } else if (element.querySelector('.e-control')) {\n        validElements.push(element.querySelector('.e-control'));\n      } else {\n        validElements.push(element);\n      }\n    }\n\n    return validElements;\n  };\n\n  KanbanDialog.prototype.getColumnName = function (element) {\n    var attrName = element.getAttribute('data-name') || '';\n\n    if (attrName === '') {\n      var isDropDowns = false;\n      var fieldSelector = '';\n\n      if (element.classList.contains('e-dropdownlist') || element.classList.contains('e-multiselect')) {\n        fieldSelector = element.classList.contains('e-dropdownlist') ? 'e-ddl' : 'e-multiselect';\n        isDropDowns = true;\n      } else if (element.classList.contains('e-numerictextbox')) {\n        fieldSelector = 'e-numeric';\n      }\n\n      var classSelector = isDropDowns ? \".\" + fieldSelector + \":not(.e-control)\" : \".\" + fieldSelector;\n      var control = closest(element, classSelector) || element.querySelector(\".\" + fieldSelector);\n\n      if (control) {\n        var attrEle = control.querySelector('[name]');\n\n        if (attrEle) {\n          attrName = attrEle.name;\n        }\n      }\n    }\n\n    return attrName;\n  };\n\n  KanbanDialog.prototype.getValueFromElement = function (element) {\n    var value;\n\n    if (element.classList.contains('e-dropdownlist')) {\n      value = element.ej2_instances[0].value;\n    } else if (element.classList.contains('e-multiselect')) {\n      value = element.ej2_instances[0].value;\n    } else if (element.classList.contains('e-checkbox')) {\n      value = element.ej2_instances[0].checked;\n    } else {\n      if (element.type === 'checkbox') {\n        value = element.checked;\n      } else {\n        value = element.value;\n      }\n    }\n\n    return value;\n  };\n\n  KanbanDialog.prototype.destroyComponents = function () {\n    var formelement = this.getFormElements();\n\n    for (var _i = 0, formelement_1 = formelement; _i < formelement_1.length; _i++) {\n      var element = formelement_1[_i];\n      var instance = element.ej2_instances;\n\n      if (instance && instance.length > 0) {\n        instance.forEach(function (node) {\n          return node.destroy();\n        });\n      }\n    }\n  };\n\n  KanbanDialog.prototype.destroy = function () {\n    this.destroyToolTip();\n    this.destroyComponents();\n\n    if (this.dialogObj) {\n      this.dialogObj.destroy();\n      this.storeElement.focus();\n      this.dialogObj = null;\n      remove(this.element);\n      this.element = null;\n    }\n  };\n\n  return KanbanDialog;\n}();\n\nexport { KanbanDialog };","map":{"version":3,"names":["append","createElement","remove","isNullOrUndefined","closest","extend","DropDownList","FormValidator","NumericTextBox","TextBox","Dialog","events","cls","KanbanDialog","parent","preventUpdate","prototype","openDialog","action","data","activeCardData","renderDialog","dialogObj","show","closeDialog","hide","args","element","id","appendChild","dialogModel","buttons","getDialogButtons","content","getDialogContent","cssClass","DIALOG_CLASS","enableRtl","header","localeObj","getConstant","height","isModal","showCloseIcon","width","visible","beforeOpen","onBeforeDialogOpen","bind","beforeClose","onBeforeDialogClose","dialogSettings","model","applyFormValidation","querySelector","title","container","className","FORM_WRAPPER_CLASS","form","FORM_CLASS","attrs","onsubmit","template","destroyComponents","slice","call","childNodes","forEach","node","templateId","dialogTemplate","templateParser","renderTemplates","dialogWrapper","DIALOG_CONTENT_CONTAINER","table","dialogFields","getDialogFields","_i","dialogFields_1","length","field","tr","innerHTML","text","key","td","renderComponents","fields","cardSettings","headerField","type","keyField","contentField","sortSettings","splice","swimlaneSettings","primaryButtonClass","flatButtonClass","dialogButtons","buttonModel","isPrimary","click","dialogButtonClick","deleteButton","wrapper","FIELD_CLASS","divElement","dropDownOptions","controlObj","fieldValue","currentKeys","layoutModule","columnKeys","actionModule","hideColumnKeys","i","columns","isColumnVisible","isNumeric","concat","toString","split","map","e","trim","dataSource","value","kanbanRows","enabled","appendTo","_this","eventProp","cancel","target","requestType","storeElement","document","activeElement","parseInt","maxHeight","trigger","dialogOpen","openArgs","destroy","formInputs","getFormElements","cardObj","isInteracted","formInputs_1","input","columnName","name","getColumnName","getValueFromElement","getIDType","dialogClose","closeArgs","cardData","SingleCardSelection","kanbanData","rules","_a","validationRules","Object","keys","formObj","customPlacement","inputElement","error","getAttribute","elem","createTooltip","validationComplete","inputName","style","display","status","dlgContent","client","inputClient","parentElement","getBoundingClientRect","classList","contains","div","ERROR_VALIDATION_CLASS","styles","bottom","top","scrollTop","left","scrollLeft","arrow","offsetWidth","destroyToolTip","querySelectorAll","reset","event","cloneNode","getElementById","validate","activeCard","updateIndex","children","indexOf","crudModule","updateCard","addCard","deleteCard","elements","validElements","elements_1","push","attrName","isDropDowns","fieldSelector","classSelector","control","attrEle","ej2_instances","checked","formelement","formelement_1","instance","focus"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Admin-Dashboard/frontend/node_modules/@syncfusion/ej2-kanban/src/kanban/actions/dialog.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { append, createElement, remove, isNullOrUndefined, closest, extend } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { FormValidator, NumericTextBox, TextBox } from '@syncfusion/ej2-inputs';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * Dialog module is used to perform card actions.\n */\nvar KanbanDialog = /** @class */ (function () {\n    /**\n     * Constructor for dialog module\n     *\n     * @param {Kanban} parent Accepts the kanban instance\n     */\n    function KanbanDialog(parent) {\n        this.preventUpdate = false;\n        this.parent = parent;\n    }\n    KanbanDialog.prototype.openDialog = function (action, data) {\n        this.action = action;\n        this.parent.activeCardData.data = data;\n        this.renderDialog(data, action);\n        this.dialogObj.show();\n    };\n    KanbanDialog.prototype.closeDialog = function () {\n        this.dialogObj.hide();\n    };\n    KanbanDialog.prototype.renderDialog = function (args, action) {\n        this.element = createElement('div', { id: this.parent.element.id + '_dialog_wrapper' });\n        this.parent.element.appendChild(this.element);\n        var dialogModel = {\n            buttons: this.getDialogButtons(action),\n            content: this.getDialogContent(args, action),\n            cssClass: cls.DIALOG_CLASS,\n            enableRtl: this.parent.enableRtl,\n            header: this.parent.localeObj.getConstant(action === 'Add' ? 'addTitle' : action === 'Edit' ? 'editTitle' : 'deleteTitle'),\n            height: 'auto',\n            isModal: true,\n            showCloseIcon: true,\n            width: (action === 'Delete') ? 400 : 350,\n            visible: false,\n            beforeOpen: this.onBeforeDialogOpen.bind(this),\n            beforeClose: this.onBeforeDialogClose.bind(this)\n        };\n        this.dialogObj = new Dialog(extend(dialogModel, action !== 'Delete' ? (this.parent.dialogSettings.model || {}) : {}), this.element);\n        if (action !== 'Delete') {\n            this.applyFormValidation();\n        }\n        this.dialogObj.element.querySelector('.e-dlg-closeicon-btn').title = this.parent.localeObj.getConstant('close');\n    };\n    KanbanDialog.prototype.getDialogContent = function (args, action) {\n        if (action === 'Delete') {\n            return this.parent.localeObj.getConstant('deleteContent');\n        }\n        else {\n            var container = createElement('div', { className: cls.FORM_WRAPPER_CLASS });\n            var form = createElement('form', {\n                id: this.parent.element.id + 'EditForm',\n                className: cls.FORM_CLASS, attrs: { onsubmit: 'return false;' }\n            });\n            if (this.parent.dialogSettings.template) {\n                if (args) {\n                    this.destroyComponents();\n                    [].slice.call(form.childNodes).forEach(function (node) { return remove(node); });\n                }\n                var templateId = this.parent.element.id + '_dialogTemplate';\n                var dialogTemplate = this.parent.templateParser(this.parent.dialogSettings.template)(args, this.parent, 'dialogTemplate', templateId, false);\n                append(dialogTemplate, form);\n                this.parent.renderTemplates();\n            }\n            else {\n                var dialogWrapper = createElement('div', { className: cls.DIALOG_CONTENT_CONTAINER });\n                form.appendChild(dialogWrapper);\n                var table = createElement('table');\n                dialogWrapper.appendChild(table);\n                var dialogFields = this.getDialogFields();\n                for (var _i = 0, dialogFields_1 = dialogFields; _i < dialogFields_1.length; _i++) {\n                    var field = dialogFields_1[_i];\n                    var tr = createElement('tr');\n                    table.appendChild(tr);\n                    tr.appendChild(createElement('td', { className: 'e-label', innerHTML: field.text ? field.text : field.key }));\n                    var td = createElement('td');\n                    tr.appendChild(td);\n                    td.appendChild(this.renderComponents(field));\n                }\n            }\n            container.appendChild(form);\n            return container;\n        }\n    };\n    KanbanDialog.prototype.getDialogFields = function () {\n        var fields = this.parent.dialogSettings.fields;\n        if (fields.length === 0) {\n            fields = [\n                { text: 'ID', key: this.parent.cardSettings.headerField, type: 'TextBox' },\n                { key: this.parent.keyField, type: 'DropDown' },\n                { key: this.parent.cardSettings.contentField, type: 'TextArea' }\n            ];\n            if (this.parent.sortSettings.field) {\n                fields.splice(fields.length - 1, 0, { key: this.parent.sortSettings.field, type: 'TextBox' });\n            }\n            if (this.parent.swimlaneSettings.keyField) {\n                fields.splice(fields.length - 1, 0, { key: this.parent.swimlaneSettings.keyField, type: 'DropDown' });\n            }\n        }\n        return fields;\n    };\n    KanbanDialog.prototype.getDialogButtons = function (action) {\n        var primaryButtonClass = action === 'Delete' ? 'e-dialog-yes' : action === 'Add' ? 'e-dialog-add' : 'e-dialog-edit';\n        var flatButtonClass = action === 'Delete' ? 'e-dialog-no' : 'e-dialog-cancel';\n        var dialogButtons = [\n            {\n                buttonModel: {\n                    cssClass: 'e-flat ' + primaryButtonClass, isPrimary: true,\n                    content: this.parent.localeObj.getConstant(action === 'Add' || action === 'Edit' ? 'save' : 'yes')\n                },\n                click: this.dialogButtonClick.bind(this)\n            }, {\n                buttonModel: {\n                    cssClass: 'e-flat ' + flatButtonClass, isPrimary: false,\n                    content: this.parent.localeObj.getConstant(action === 'Add' || action === 'Edit' ? 'cancel' : 'no')\n                },\n                click: this.dialogButtonClick.bind(this)\n            }\n        ];\n        if (action === 'Edit') {\n            var deleteButton = {\n                buttonModel: { cssClass: 'e-flat e-dialog-delete', isPrimary: false, content: this.parent.localeObj.getConstant('delete') },\n                click: this.dialogButtonClick.bind(this)\n            };\n            dialogButtons.splice(0, 0, deleteButton);\n        }\n        return dialogButtons;\n    };\n    KanbanDialog.prototype.renderComponents = function (field) {\n        var wrapper = createElement('div', { className: field.key + '_wrapper' });\n        var element = createElement('input', { className: cls.FIELD_CLASS, attrs: { 'name': field.key } });\n        wrapper.appendChild(element);\n        var divElement;\n        var dropDownOptions;\n        var controlObj;\n        var fieldValue = this.parent.activeCardData.data ?\n            this.parent.activeCardData.data[field.key] : null;\n        switch (field.type) {\n            case 'DropDown':\n                if (field.key === this.parent.keyField) {\n                    var currentKeys = this.parent.layoutModule.columnKeys;\n                    if (this.parent.actionModule.hideColumnKeys.length > 0) {\n                        currentKeys = [];\n                        for (var i = 0; i < this.parent.columns.length; i++) {\n                            if (this.parent.layoutModule.isColumnVisible(this.parent.columns[i])) {\n                                var isNumeric = typeof this.parent.columns[i].keyField === 'number';\n                                if (isNumeric) {\n                                    currentKeys = currentKeys.concat(this.parent.columns[i].keyField.toString());\n                                }\n                                else {\n                                    currentKeys = currentKeys.concat(this.parent.columns[i].keyField.split(',').map(function (e) { return e.trim(); }));\n                                }\n                            }\n                        }\n                    }\n                    dropDownOptions = { dataSource: currentKeys, value: fieldValue ? fieldValue.toString() : fieldValue };\n                }\n                else if (field.key === this.parent.swimlaneSettings.keyField) {\n                    dropDownOptions = {\n                        dataSource: [].slice.call(this.parent.layoutModule.kanbanRows),\n                        fields: { text: 'textField', value: 'keyField' }, value: fieldValue\n                    };\n                }\n                controlObj = new DropDownList(dropDownOptions);\n                break;\n            case 'Numeric':\n                controlObj = new NumericTextBox({ value: fieldValue });\n                break;\n            case 'TextBox':\n                controlObj = new TextBox({ value: fieldValue });\n                if (fieldValue && this.parent.cardSettings.headerField === field.key) {\n                    controlObj.enabled = false;\n                }\n                break;\n            case 'TextArea':\n                remove(element);\n                divElement = createElement('div');\n                element = createElement('textarea', {\n                    className: cls.FIELD_CLASS, attrs: { 'name': field.key, 'rows': '3' },\n                    innerHTML: fieldValue\n                });\n                wrapper.appendChild(divElement).appendChild(element);\n                break;\n            default:\n                break;\n        }\n        if (controlObj) {\n            controlObj.appendTo(element);\n        }\n        return wrapper;\n    };\n    KanbanDialog.prototype.onBeforeDialogOpen = function (args) {\n        var _this = this;\n        var eventProp = {\n            data: this.parent.activeCardData.data,\n            cancel: false, element: this.element,\n            target: this.parent.activeCardData.element,\n            requestType: this.action\n        };\n        this.storeElement = document.activeElement;\n        if (parseInt(args.maxHeight, 10) <= 250) {\n            args.maxHeight = '250px';\n        }\n        this.parent.trigger(events.dialogOpen, eventProp, function (openArgs) {\n            args.cancel = openArgs.cancel;\n            if (openArgs.cancel) {\n                _this.destroy();\n            }\n        });\n    };\n    KanbanDialog.prototype.onBeforeDialogClose = function (args) {\n        var _this = this;\n        var formInputs = this.getFormElements();\n        var cardObj = {};\n        if (args.isInteracted) {\n            /* close icon preventing data update */\n            this.preventUpdate = true;\n        }\n        if (!this.preventUpdate) {\n            for (var _i = 0, formInputs_1 = formInputs; _i < formInputs_1.length; _i++) {\n                var input = formInputs_1[_i];\n                var columnName = input.name || this.getColumnName(input);\n                if (!isNullOrUndefined(columnName) && columnName !== '') {\n                    var value = this.getValueFromElement(input);\n                    if (columnName === this.parent.cardSettings.headerField) {\n                        value = this.getIDType() === 'string' ? value : parseInt(value, 10);\n                    }\n                    cardObj[columnName] = value;\n                }\n            }\n        }\n        this.preventUpdate = false;\n        cardObj = extend(this.parent.activeCardData.data, cardObj);\n        var eventProp = { data: cardObj, cancel: false, element: this.element, requestType: this.action };\n        this.parent.trigger(events.dialogClose, eventProp, function (closeArgs) {\n            args.cancel = closeArgs.cancel;\n            if (!closeArgs.cancel) {\n                _this.cardData = eventProp.data;\n                _this.destroy();\n                _this.parent.actionModule.SingleCardSelection(_this.cardData);\n            }\n        });\n    };\n    KanbanDialog.prototype.getIDType = function () {\n        if (this.parent.kanbanData.length !== 0) {\n            return typeof (this.parent.kanbanData[0][this.parent.cardSettings.headerField]);\n        }\n        return 'string';\n    };\n    KanbanDialog.prototype.applyFormValidation = function () {\n        var _this = this;\n        var form = this.element.querySelector('.' + cls.FORM_CLASS);\n        var rules = {};\n        for (var _i = 0, _a = this.parent.dialogSettings.fields; _i < _a.length; _i++) {\n            var field = _a[_i];\n            rules[field.key] = (field.validationRules && Object.keys(field.validationRules).length > 0) ? field.validationRules : null;\n        }\n        this.formObj = new FormValidator(form, {\n            rules: rules,\n            customPlacement: function (inputElement, error) {\n                var id = error.getAttribute('for');\n                var elem = _this.element.querySelector('#' + id + '_Error');\n                if (!elem) {\n                    _this.createTooltip(inputElement, error, id, '');\n                }\n            },\n            validationComplete: function (args) {\n                var elem = _this.element.querySelector('#' + args.inputName + '_Error');\n                if (elem) {\n                    elem.style.display = (args.status === 'failure') ? '' : 'none';\n                }\n            }\n        });\n    };\n    KanbanDialog.prototype.createTooltip = function (element, error, name, display) {\n        var dlgContent;\n        var client;\n        var inputClient = element.parentElement.getBoundingClientRect();\n        if (this.element.classList.contains(cls.DIALOG_CLASS)) {\n            dlgContent = this.element;\n            client = this.element.getBoundingClientRect();\n        }\n        else {\n            dlgContent = this.element.querySelector('.e-kanban-dialog .e-dlg-content');\n            client = dlgContent.getBoundingClientRect();\n        }\n        var div = createElement('div', {\n            className: 'e-tooltip-wrap e-popup ' + cls.ERROR_VALIDATION_CLASS,\n            id: name + '_Error',\n            styles: 'display:' + display + ';top:' +\n                (inputClient.bottom - client.top + dlgContent.scrollTop + 9) + 'px;left:' +\n                (inputClient.left - client.left + dlgContent.scrollLeft + inputClient.width / 2) + 'px;'\n        });\n        var content = createElement('div', { className: 'e-tip-content' });\n        content.appendChild(error);\n        var arrow = createElement('div', { className: 'e-arrow-tip e-tip-top' });\n        arrow.appendChild(createElement('div', { className: 'e-arrow-tip-outer e-tip-top' }));\n        arrow.appendChild(createElement('div', { className: 'e-arrow-tip-inner e-tip-top' }));\n        div.appendChild(content);\n        div.appendChild(arrow);\n        dlgContent.appendChild(div);\n        div.style.left = (parseInt(div.style.left, 10) - div.offsetWidth / 2) + 'px';\n    };\n    KanbanDialog.prototype.destroyToolTip = function () {\n        if (this.element) {\n            this.element.querySelectorAll('.' + cls.ERROR_VALIDATION_CLASS).forEach(function (node) { return remove(node); });\n        }\n        if (this.formObj && this.formObj.element) {\n            this.formObj.reset();\n        }\n    };\n    KanbanDialog.prototype.dialogButtonClick = function (event) {\n        var target = event.target.cloneNode(true);\n        var id = this.formObj.element.id;\n        if (document.getElementById(id) && this.formObj.validate() &&\n            (target.classList.contains('e-dialog-edit') || target.classList.contains('e-dialog-add'))) {\n            this.dialogObj.hide();\n            if (target.classList.contains('e-dialog-edit')) {\n                var activeCard = this.parent.activeCardData;\n                var updateIndex = void 0;\n                if (activeCard.data[this.parent.keyField] === this.cardData[this.parent.keyField]\n                    && activeCard.element) {\n                    updateIndex = [].slice.call(activeCard.element.parentElement.children).indexOf(activeCard.element);\n                }\n                this.parent.crudModule.updateCard(this.cardData, updateIndex);\n            }\n            if (target.classList.contains('e-dialog-add')) {\n                this.parent.crudModule.addCard(this.cardData);\n            }\n            this.parent.actionModule.SingleCardSelection(this.cardData);\n            this.cardData = null;\n        }\n        if (!target.classList.contains('e-dialog-edit') && !target.classList.contains('e-dialog-add')) {\n            if (target.classList.contains('e-dialog-cancel')) {\n                this.preventUpdate = true;\n            }\n            this.dialogObj.hide();\n            if (target.classList.contains('e-dialog-yes')) {\n                this.parent.crudModule.deleteCard(this.parent.activeCardData.data);\n            }\n            else if (target.classList.contains('e-dialog-no')) {\n                this.openDialog('Edit', this.parent.activeCardData.data);\n            }\n            else if (target.classList.contains('e-dialog-delete')) {\n                this.openDialog('Delete', this.parent.activeCardData.data);\n            }\n        }\n    };\n    KanbanDialog.prototype.getFormElements = function () {\n        var elements = [].slice.call(this.element.querySelectorAll('.' + cls.FIELD_CLASS));\n        var validElements = [];\n        for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n            var element = elements_1[_i];\n            if (element.classList.contains('e-control')) {\n                validElements.push(element);\n            }\n            else if (element.querySelector('.e-control')) {\n                validElements.push(element.querySelector('.e-control'));\n            }\n            else {\n                validElements.push(element);\n            }\n        }\n        return validElements;\n    };\n    KanbanDialog.prototype.getColumnName = function (element) {\n        var attrName = element.getAttribute('data-name') || '';\n        if (attrName === '') {\n            var isDropDowns = false;\n            var fieldSelector = '';\n            if (element.classList.contains('e-dropdownlist') || element.classList.contains('e-multiselect')) {\n                fieldSelector = element.classList.contains('e-dropdownlist') ? 'e-ddl' : 'e-multiselect';\n                isDropDowns = true;\n            }\n            else if (element.classList.contains('e-numerictextbox')) {\n                fieldSelector = 'e-numeric';\n            }\n            var classSelector = isDropDowns ? \".\" + fieldSelector + \":not(.e-control)\" : \".\" + fieldSelector;\n            var control = closest(element, classSelector) || element.querySelector(\".\" + fieldSelector);\n            if (control) {\n                var attrEle = control.querySelector('[name]');\n                if (attrEle) {\n                    attrName = attrEle.name;\n                }\n            }\n        }\n        return attrName;\n    };\n    KanbanDialog.prototype.getValueFromElement = function (element) {\n        var value;\n        if (element.classList.contains('e-dropdownlist')) {\n            value = element.ej2_instances[0].value;\n        }\n        else if (element.classList.contains('e-multiselect')) {\n            value = element.ej2_instances[0].value;\n        }\n        else if (element.classList.contains('e-checkbox')) {\n            value = element.ej2_instances[0].checked;\n        }\n        else {\n            if (element.type === 'checkbox') {\n                value = element.checked;\n            }\n            else {\n                value = element.value;\n            }\n        }\n        return value;\n    };\n    KanbanDialog.prototype.destroyComponents = function () {\n        var formelement = this.getFormElements();\n        for (var _i = 0, formelement_1 = formelement; _i < formelement_1.length; _i++) {\n            var element = formelement_1[_i];\n            var instance = element.ej2_instances;\n            if (instance && instance.length > 0) {\n                instance.forEach(function (node) { return node.destroy(); });\n            }\n        }\n    };\n    KanbanDialog.prototype.destroy = function () {\n        this.destroyToolTip();\n        this.destroyComponents();\n        if (this.dialogObj) {\n            this.dialogObj.destroy();\n            this.storeElement.focus();\n            this.dialogObj = null;\n            remove(this.element);\n            this.element = null;\n        }\n    };\n    return KanbanDialog;\n}());\nexport { KanbanDialog };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}