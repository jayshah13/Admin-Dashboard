{"ast":null,"code":"import { NodeSelection } from './../../selection/index';\nimport { NodeCutter } from './nodecutter';\nimport * as CONSTANT from './../base/constant';\nimport { detach, Browser, isNullOrUndefined as isNOU, createElement, closest } from '@syncfusion/ej2-base';\nimport { InsertMethods } from './insert-methods';\nimport { updateTextNode } from './../../common/util';\n/**\n * Insert a HTML Node or Text\n *\n * @hidden\n\n */\n\nvar InsertHtml =\n/** @class */\nfunction () {\n  function InsertHtml() {}\n\n  InsertHtml.Insert = function (docElement, insertNode, editNode, isExternal) {\n    var node;\n\n    if (typeof insertNode === 'string') {\n      var divNode = document.createElement('div');\n      divNode.innerHTML = insertNode;\n      node = isExternal ? divNode : divNode.firstChild;\n    } else {\n      if (isExternal && !(!isNOU(insertNode) && !isNOU(insertNode.classList) && insertNode.classList.contains('pasteContent'))) {\n        var divNode = document.createElement('div');\n        divNode.appendChild(insertNode);\n        node = divNode;\n      } else {\n        node = insertNode;\n      }\n    }\n\n    var nodeSelection = new NodeSelection();\n    var nodeCutter = new NodeCutter();\n    var range = nodeSelection.getRange(docElement);\n\n    if (range.startContainer === editNode && range.startContainer === range.endContainer && range.startOffset === 0 && range.startOffset === range.endOffset && editNode.textContent.length === 0 && editNode.children[0].tagName === 'P') {\n      nodeSelection.setSelectionText(docElement, range.startContainer.children[0], range.startContainer.children[0], 0, 0);\n      range = nodeSelection.getRange(docElement);\n    }\n\n    var isCursor = range.startOffset === range.endOffset && range.startOffset === 0 && range.startContainer === range.endContainer;\n    var isCollapsed = range.collapsed;\n    var nodes = this.getNodeCollection(range, nodeSelection, node);\n    var closestParentNode = node.nodeName.toLowerCase() === 'table' ? this.closestEle(nodes[0].parentNode, editNode) : nodes[0];\n\n    if (isExternal || !isNOU(node) && !isNOU(node.classList) && node.classList.contains('pasteContent')) {\n      this.pasteInsertHTML(nodes, node, range, nodeSelection, nodeCutter, docElement, isCollapsed, closestParentNode, editNode);\n      return;\n    }\n\n    if (editNode !== range.startContainer && (!isCollapsed && !(closestParentNode.nodeType === Node.ELEMENT_NODE && CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) !== -1) || node.nodeName.toLowerCase() === 'table' && closestParentNode && CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) === -1)) {\n      var preNode = nodeCutter.GetSpliceNode(range, closestParentNode);\n      var sibNode = preNode.previousSibling;\n      var parentNode = preNode.parentNode;\n\n      if (nodes.length === 1 || node.nodeName.toLowerCase() === 'table' && preNode.childElementCount === 0) {\n        nodeSelection.setSelectionContents(docElement, preNode);\n        range = nodeSelection.getRange(docElement);\n      } else {\n        var lasNode = nodeCutter.GetSpliceNode(range, nodes[nodes.length - 1].parentElement);\n        lasNode = isNOU(lasNode) ? preNode : lasNode;\n        nodeSelection.setSelectionText(docElement, preNode, lasNode, 0, lasNode.nodeType === 3 ? lasNode.textContent.length : lasNode.childNodes.length);\n        range = nodeSelection.getRange(docElement);\n      }\n\n      range.extractContents();\n\n      if (insertNode.tagName === 'TABLE') {\n        this.removeEmptyElements(editNode);\n      }\n\n      for (var index = 0; index < nodes.length; index++) {\n        if (nodes[index].nodeType !== 3 && nodes[index].parentNode != null) {\n          if (nodes[index].nodeName === 'IMG') {\n            continue;\n          }\n\n          nodes[index].parentNode.removeChild(nodes[index]);\n        }\n      }\n\n      if (sibNode) {\n        InsertMethods.AppendBefore(node, sibNode, true);\n      } else {\n        var previousNode = null;\n\n        while (parentNode !== editNode && parentNode.firstChild && parentNode.textContent.trim() === '') {\n          var parentNode1 = parentNode.parentNode;\n          previousNode = parentNode;\n          parentNode = parentNode1;\n        }\n\n        if (previousNode !== null) {\n          parentNode = previousNode;\n        }\n\n        if (parentNode.firstChild && (parentNode !== editNode || node.nodeName === 'TABLE' && isCursor && parentNode === range.startContainer && parentNode === range.endContainer)) {\n          if (parentNode.textContent.trim() === '' && parentNode !== editNode) {\n            InsertMethods.AppendBefore(node, parentNode, false);\n            detach(parentNode);\n          } else {\n            InsertMethods.AppendBefore(node, parentNode.firstChild, false);\n          }\n        } else {\n          parentNode.appendChild(node);\n        }\n      }\n\n      if (node.nodeName === 'IMG') {\n        this.imageFocus(node, nodeSelection, docElement);\n      } else if (node.nodeType !== 3) {\n        nodeSelection.setSelectionText(docElement, node, node, 0, node.childNodes.length);\n      } else {\n        nodeSelection.setSelectionText(docElement, node, node, 0, node.textContent.length);\n      }\n    } else {\n      range.deleteContents();\n\n      if (isCursor && range.startContainer.textContent === '' && range.startContainer.nodeName !== 'BR') {\n        range.startContainer.innerHTML = '';\n      }\n\n      if (Browser.isIE) {\n        var frag = docElement.createDocumentFragment();\n        frag.appendChild(node);\n        range.insertNode(frag);\n      } else if (range.startContainer.nodeType === 1 && range.startContainer.nodeName.toLowerCase() === 'hr' && range.endContainer.nodeName.toLowerCase() === 'hr') {\n        var paraElem = range.startContainer.nextElementSibling;\n\n        if (paraElem) {\n          if (paraElem.querySelector('br')) {\n            detach(paraElem.querySelector('br'));\n          }\n\n          paraElem.appendChild(node);\n        }\n      } else {\n        if (range.startContainer.nodeName === 'BR') {\n          range.startContainer.parentElement.insertBefore(node, range.startContainer);\n        } else {\n          range.insertNode(node);\n        }\n      }\n\n      if (node.nodeType !== 3 && node.childNodes.length > 0) {\n        nodeSelection.setSelectionText(docElement, node, node, 1, 1);\n      } else if (node.nodeName === 'IMG') {\n        this.imageFocus(node, nodeSelection, docElement);\n      } else if (node.nodeType !== 3) {\n        nodeSelection.setSelectionContents(docElement, node);\n      } else {\n        nodeSelection.setSelectionText(docElement, node, node, node.textContent.length, node.textContent.length);\n      }\n    }\n  };\n\n  InsertHtml.pasteInsertHTML = function (nodes, node, range, nodeSelection, nodeCutter, docElement, isCollapsed, closestParentNode, editNode) {\n    var isCursor = range.startOffset === range.endOffset && range.startContainer === range.endContainer;\n\n    if (isCursor && range.startContainer === editNode && editNode.textContent === '') {\n      var currentBlockNode = this.getImmediateBlockNode(nodes[nodes.length - 1], editNode);\n      nodeSelection.setSelectionText(docElement, currentBlockNode, currentBlockNode, 0, 0);\n      range = nodeSelection.getRange(docElement);\n    }\n\n    var lasNode;\n    var sibNode;\n    var isSingleNode;\n    var preNode;\n\n    if (editNode !== range.startContainer && (!isCollapsed && !(closestParentNode.nodeType === Node.ELEMENT_NODE && CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) !== -1) || node.nodeName.toLowerCase() === 'table' && closestParentNode && CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) === -1)) {\n      preNode = nodeCutter.GetSpliceNode(range, closestParentNode);\n      sibNode = isNOU(preNode.previousSibling) ? preNode.parentNode.previousSibling : preNode.previousSibling;\n\n      if (nodes.length === 1) {\n        nodeSelection.setSelectionContents(docElement, preNode);\n        range = nodeSelection.getRange(docElement);\n        isSingleNode = true;\n      } else {\n        lasNode = nodeCutter.GetSpliceNode(range, nodes[nodes.length - 1].parentElement);\n        lasNode = isNOU(lasNode) ? preNode : lasNode;\n        nodeSelection.setSelectionText(docElement, preNode, lasNode, 0, lasNode.nodeType === 3 ? lasNode.textContent.length : lasNode.childNodes.length);\n        range = nodeSelection.getRange(docElement);\n        isSingleNode = false;\n      }\n    }\n\n    var containsBlockNode = false;\n    this.removingComments(node);\n    var allChildNodes = node.childNodes;\n\n    for (var i = 0; i < allChildNodes.length; i++) {\n      if (CONSTANT.BLOCK_TAGS.indexOf(allChildNodes[i].nodeName.toLocaleLowerCase()) >= 0) {\n        containsBlockNode = true;\n        break;\n      }\n    }\n\n    var lastSelectionNode;\n    var fragment = document.createDocumentFragment();\n\n    if (!containsBlockNode) {\n      if (!isCursor) {\n        while (node.firstChild) {\n          lastSelectionNode = node.firstChild;\n          fragment.appendChild(node.firstChild);\n        }\n\n        if (isSingleNode) {\n          preNode.parentNode.replaceChild(fragment, preNode);\n        } else {\n          range.deleteContents();\n          detach(lasNode); // eslint-disable-next-line\n\n          !isNOU(sibNode) ? sibNode.parentNode.appendChild(fragment) : editNode.appendChild(fragment);\n        }\n      } else {\n        var tempSpan = createElement('span', {\n          className: 'tempSpan'\n        });\n        var nearestAnchor = closest(range.startContainer.parentElement, 'a');\n\n        if (range.startContainer.nodeType === 3 && nearestAnchor) {\n          var immediateBlockNode = this.getImmediateBlockNode(range.startContainer, editNode);\n\n          if (immediateBlockNode.querySelectorAll('br').length > 0) {\n            detach(immediateBlockNode.querySelector('br'));\n          }\n\n          var rangeElement = closest(nearestAnchor, 'span');\n          rangeElement.appendChild(tempSpan);\n        } else {\n          range.insertNode(tempSpan);\n        }\n\n        while (node.firstChild) {\n          lastSelectionNode = node.firstChild;\n          fragment.appendChild(node.firstChild);\n        }\n\n        tempSpan.parentNode.replaceChild(fragment, tempSpan);\n      }\n    } else {\n      this.insertTempNode(range, node, nodes, nodeCutter, editNode);\n      var isFirstTextNode = true;\n      var isPreviousInlineElem = void 0;\n      var paraElm = void 0;\n      var previousParent = void 0;\n      range.deleteContents();\n\n      while (node.firstChild) {\n        if (node.firstChild.nodeName === '#text' && node.firstChild.textContent.trim() === '') {\n          detach(node.firstChild);\n          continue;\n        }\n\n        if (node.firstChild.nodeName === '#text' && isFirstTextNode || this.inlineNode.indexOf(node.firstChild.nodeName.toLocaleLowerCase()) >= 0 && isFirstTextNode) {\n          lastSelectionNode = node.firstChild;\n\n          if (isNOU(node.previousElementSibling)) {\n            var firstParaElm = createElement('p');\n            node.parentElement.insertBefore(firstParaElm, node);\n          }\n\n          node.previousElementSibling.appendChild(node.firstChild);\n        } else {\n          lastSelectionNode = node.firstChild;\n\n          if (node.firstChild.nodeName === '#text' || this.inlineNode.indexOf(node.firstChild.nodeName.toLocaleLowerCase()) >= 0) {\n            if (!isPreviousInlineElem) {\n              paraElm = createElement('p');\n              paraElm.appendChild(node.firstChild);\n              fragment.appendChild(paraElm);\n            } else {\n              previousParent.appendChild(node.firstChild);\n              fragment.appendChild(previousParent);\n            }\n\n            previousParent = paraElm;\n            isPreviousInlineElem = true;\n          } else {\n            fragment.appendChild(node.firstChild);\n            isPreviousInlineElem = false;\n          }\n\n          isFirstTextNode = false;\n        }\n      }\n\n      node.parentNode.replaceChild(fragment, node);\n    }\n\n    if (lastSelectionNode.nodeName === '#text') {\n      this.placeCursorEnd(lastSelectionNode, node, nodeSelection, docElement, editNode);\n    } else {\n      this.cursorPos(lastSelectionNode, node, nodeSelection, docElement, editNode);\n    }\n  };\n\n  InsertHtml.placeCursorEnd = function (lastSelectionNode, node, nodeSelection, docElement, editNode) {\n    lastSelectionNode = lastSelectionNode.nodeName === 'BR' ? isNOU(lastSelectionNode.previousSibling) ? lastSelectionNode.parentNode : lastSelectionNode.previousSibling : lastSelectionNode;\n\n    while (!isNOU(lastSelectionNode) && lastSelectionNode.nodeName !== '#text' && lastSelectionNode.nodeName !== 'IMG' && lastSelectionNode.nodeName !== 'BR' && lastSelectionNode.nodeName !== 'HR') {\n      lastSelectionNode = lastSelectionNode.lastChild;\n    }\n\n    lastSelectionNode = isNOU(lastSelectionNode) ? node : lastSelectionNode;\n\n    if (lastSelectionNode.nodeName === 'IMG') {\n      this.imageFocus(lastSelectionNode, nodeSelection, docElement);\n    } else {\n      nodeSelection.setSelectionText(docElement, lastSelectionNode, lastSelectionNode, lastSelectionNode.textContent.length, lastSelectionNode.textContent.length);\n    }\n\n    this.removeEmptyElements(editNode);\n  };\n\n  InsertHtml.getNodeCollection = function (range, nodeSelection, node) {\n    var nodes = [];\n\n    if (range.startOffset === range.endOffset && range.startContainer === range.endContainer && range.startContainer.nodeName != 'BR' && (range.startContainer.nodeName === 'TD' || range.startContainer.nodeType !== 3 && node.classList && node.classList.contains('pasteContent'))) {\n      nodes.push(range.startContainer.childNodes[range.endOffset]);\n    } else {\n      nodes = nodeSelection.getInsertNodeCollection(range);\n    }\n\n    return nodes;\n  };\n\n  InsertHtml.insertTempNode = function (range, node, nodes, nodeCutter, editNode) {\n    if (range.startContainer === editNode && !isNOU(range.startContainer.childNodes[range.endOffset - 1]) && range.startContainer.childNodes[range.endOffset - 1].nodeName === 'TABLE') {\n      if (isNOU(range.startContainer.childNodes[range.endOffset - 1].nextSibling)) {\n        range.startContainer.appendChild(node);\n      } else {\n        range.startContainer.insertBefore(node, range.startContainer.childNodes[range.endOffset - 1].nextSibling);\n      }\n    } else if (range.startContainer === editNode && !isNOU(range.startContainer.childNodes[range.endOffset]) && range.startContainer.childNodes[range.endOffset].nodeName === 'TABLE') {\n      range.startContainer.insertBefore(node, range.startContainer.childNodes[range.endOffset]);\n    } else if (range.startContainer === range.endContainer && range.startContainer.nodeType !== 3 && node.firstChild.nodeName === 'HR') {\n      if (range.startContainer.classList.contains('e-content') || range.startContainer.nodeName === 'BODY') {\n        range.startContainer.appendChild(node);\n      } else {\n        range.startContainer.parentNode.insertBefore(node, range.startContainer);\n      }\n    } else {\n      var blockNode = this.getImmediateBlockNode(nodes[nodes.length - 1], editNode);\n\n      if ((isNOU(blockNode) || isNOU(blockNode.parentElement)) && range.endContainer.nodeType !== 3) {\n        blockNode = range.endContainer;\n        range.setEnd(blockNode, range.endContainer.textContent.length);\n      }\n\n      if (blockNode.nodeName === 'BODY' && range.startContainer === range.endContainer && range.startContainer.nodeType === 1) {\n        blockNode = range.startContainer;\n      }\n\n      if (blockNode.closest('LI') && node && node.firstElementChild && (node.firstElementChild.tagName === 'OL' || node.firstElementChild.tagName === 'UL')) {\n        var liNode = void 0;\n\n        while (node.firstElementChild.lastElementChild && node.firstElementChild.lastElementChild.tagName === 'LI') {\n          liNode = node.firstElementChild.lastElementChild;\n          liNode.style.removeProperty('margin-left');\n          liNode.style.removeProperty('margin-top');\n          liNode.style.removeProperty('margin-bottom');\n          node.firstElementChild.insertAdjacentElement('afterend', liNode);\n        }\n      }\n\n      if (blockNode.nodeName === 'TD' || blockNode.nodeName === 'TH') {\n        var tempSpan = createElement('span', {\n          className: 'tempSpan'\n        });\n        range.insertNode(tempSpan);\n        tempSpan.parentNode.replaceChild(node, tempSpan);\n      } else {\n        var currentNode = nodes[nodes.length - 1];\n        var splitedElm = void 0;\n\n        if ((currentNode.nodeName === 'BR' || currentNode.nodeName === 'HR') && !isNOU(currentNode.parentElement) && currentNode.parentElement.textContent.trim().length === 0) {\n          splitedElm = currentNode;\n        } else {\n          splitedElm = nodeCutter.GetSpliceNode(range, blockNode);\n        }\n\n        splitedElm.parentNode.replaceChild(node, splitedElm);\n      }\n    }\n  };\n\n  InsertHtml.cursorPos = function (lastSelectionNode, node, nodeSelection, docElement, editNode) {\n    lastSelectionNode.classList.add('lastNode');\n    editNode.innerHTML = updateTextNode(editNode.innerHTML);\n    lastSelectionNode = editNode.querySelector('.lastNode');\n\n    if (!isNOU(lastSelectionNode)) {\n      this.placeCursorEnd(lastSelectionNode, node, nodeSelection, docElement, editNode);\n      lastSelectionNode.classList.remove('lastNode');\n\n      if (lastSelectionNode.classList.length === 0) {\n        lastSelectionNode.removeAttribute('class');\n      }\n    }\n  };\n\n  InsertHtml.imageFocus = function (node, nodeSelection, docElement) {\n    var focusNode = document.createTextNode(' ');\n    node.parentNode.insertBefore(focusNode, node.nextSibling);\n    nodeSelection.setSelectionText(docElement, node.nextSibling, node.nextSibling, 0, 0);\n  }; // eslint-disable-next-line\n\n\n  InsertHtml.getImmediateBlockNode = function (node, editNode) {\n    do {\n      node = node.parentNode;\n    } while (node && CONSTANT.BLOCK_TAGS.indexOf(node.nodeName.toLocaleLowerCase()) < 0);\n\n    return node;\n  };\n\n  InsertHtml.removingComments = function (elm) {\n    var innerElement = elm.innerHTML;\n    innerElement = innerElement.replace(/<!--[\\s\\S]*?-->/g, '');\n    elm.innerHTML = innerElement;\n  };\n\n  InsertHtml.findDetachEmptyElem = function (element) {\n    var removableElement;\n\n    if (!isNOU(element.parentElement)) {\n      if (element.parentElement.textContent.trim() === '' && element.parentElement.contentEditable !== 'true') {\n        removableElement = this.findDetachEmptyElem(element.parentElement);\n      } else {\n        removableElement = element;\n      }\n    } else {\n      removableElement = null;\n    }\n\n    return removableElement;\n  };\n\n  InsertHtml.removeEmptyElements = function (element) {\n    var emptyElements = element.querySelectorAll(':empty');\n\n    for (var i = 0; i < emptyElements.length; i++) {\n      if (emptyElements[i].tagName !== 'IMG' && emptyElements[i].tagName !== 'BR' && emptyElements[i].tagName !== 'IFRAME' && emptyElements[i].tagName !== 'TD' && emptyElements[i].tagName !== 'SOURCE' && emptyElements[i].tagName !== 'HR') {\n        var detachableElement = this.findDetachEmptyElem(emptyElements[i]);\n\n        if (!isNOU(detachableElement)) {\n          detach(detachableElement);\n        }\n      }\n    }\n  };\n\n  InsertHtml.closestEle = function (element, editNode) {\n    var el = element;\n\n    while (el && el.nodeType === 1) {\n      if (el.parentNode === editNode || !isNOU(el.parentNode.tagName) && CONSTANT.IGNORE_BLOCK_TAGS.indexOf(el.parentNode.tagName.toLocaleLowerCase()) !== -1) {\n        return el;\n      }\n\n      el = el.parentNode;\n    }\n\n    return null;\n  };\n  /**\n   * Insert method\n   *\n   * @hidden\n    */\n\n\n  InsertHtml.inlineNode = ['a', 'abbr', 'acronym', 'audio', 'b', 'bdi', 'bdo', 'big', 'br', 'button', 'canvas', 'cite', 'code', 'data', 'datalist', 'del', 'dfn', 'em', 'embed', 'font', 'i', 'iframe', 'img', 'input', 'ins', 'kbd', 'label', 'map', 'mark', 'meter', 'noscript', 'object', 'output', 'picture', 'progress', 'q', 'ruby', 's', 'samp', 'script', 'select', 'slot', 'small', 'span', 'strong', 'sub', 'sup', 'svg', 'template', 'textarea', 'time', 'u', 'tt', 'var', 'video', 'wbr'];\n  return InsertHtml;\n}();\n\nexport { InsertHtml };","map":{"version":3,"names":["NodeSelection","NodeCutter","CONSTANT","detach","Browser","isNullOrUndefined","isNOU","createElement","closest","InsertMethods","updateTextNode","InsertHtml","Insert","docElement","insertNode","editNode","isExternal","node","divNode","document","innerHTML","firstChild","classList","contains","appendChild","nodeSelection","nodeCutter","range","getRange","startContainer","endContainer","startOffset","endOffset","textContent","length","children","tagName","setSelectionText","isCursor","isCollapsed","collapsed","nodes","getNodeCollection","closestParentNode","nodeName","toLowerCase","closestEle","parentNode","pasteInsertHTML","nodeType","Node","ELEMENT_NODE","TABLE_BLOCK_TAGS","indexOf","toLocaleLowerCase","preNode","GetSpliceNode","sibNode","previousSibling","childElementCount","setSelectionContents","lasNode","parentElement","childNodes","extractContents","removeEmptyElements","index","removeChild","AppendBefore","previousNode","trim","parentNode1","imageFocus","deleteContents","isIE","frag","createDocumentFragment","paraElem","nextElementSibling","querySelector","insertBefore","currentBlockNode","getImmediateBlockNode","isSingleNode","containsBlockNode","removingComments","allChildNodes","i","BLOCK_TAGS","lastSelectionNode","fragment","replaceChild","tempSpan","className","nearestAnchor","immediateBlockNode","querySelectorAll","rangeElement","insertTempNode","isFirstTextNode","isPreviousInlineElem","paraElm","previousParent","inlineNode","previousElementSibling","firstParaElm","placeCursorEnd","cursorPos","lastChild","push","getInsertNodeCollection","nextSibling","blockNode","setEnd","firstElementChild","liNode","lastElementChild","style","removeProperty","insertAdjacentElement","currentNode","splitedElm","add","remove","removeAttribute","focusNode","createTextNode","elm","innerElement","replace","findDetachEmptyElem","element","removableElement","contentEditable","emptyElements","detachableElement","el","IGNORE_BLOCK_TAGS"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/inserthtml.js"],"sourcesContent":["import { NodeSelection } from './../../selection/index';\nimport { NodeCutter } from './nodecutter';\nimport * as CONSTANT from './../base/constant';\nimport { detach, Browser, isNullOrUndefined as isNOU, createElement, closest } from '@syncfusion/ej2-base';\nimport { InsertMethods } from './insert-methods';\nimport { updateTextNode } from './../../common/util';\n/**\n * Insert a HTML Node or Text\n *\n * @hidden\n\n */\nvar InsertHtml = /** @class */ (function () {\n    function InsertHtml() {\n    }\n    InsertHtml.Insert = function (docElement, insertNode, editNode, isExternal) {\n        var node;\n        if (typeof insertNode === 'string') {\n            var divNode = document.createElement('div');\n            divNode.innerHTML = insertNode;\n            node = isExternal ? divNode : divNode.firstChild;\n        }\n        else {\n            if (isExternal && !(!isNOU(insertNode) && !isNOU(insertNode.classList) &&\n                insertNode.classList.contains('pasteContent'))) {\n                var divNode = document.createElement('div');\n                divNode.appendChild(insertNode);\n                node = divNode;\n            }\n            else {\n                node = insertNode;\n            }\n        }\n        var nodeSelection = new NodeSelection();\n        var nodeCutter = new NodeCutter();\n        var range = nodeSelection.getRange(docElement);\n        if (range.startContainer === editNode && range.startContainer === range.endContainer && range.startOffset === 0 &&\n            range.startOffset === range.endOffset && editNode.textContent.length === 0 && editNode.children[0].tagName === 'P') {\n            nodeSelection.setSelectionText(docElement, range.startContainer.children[0], range.startContainer.children[0], 0, 0);\n            range = nodeSelection.getRange(docElement);\n        }\n        var isCursor = range.startOffset === range.endOffset && range.startOffset === 0 &&\n            range.startContainer === range.endContainer;\n        var isCollapsed = range.collapsed;\n        var nodes = this.getNodeCollection(range, nodeSelection, node);\n        var closestParentNode = (node.nodeName.toLowerCase() === 'table') ? this.closestEle(nodes[0].parentNode, editNode) : nodes[0];\n        if (isExternal || (!isNOU(node) && !isNOU(node.classList) &&\n            node.classList.contains('pasteContent'))) {\n            this.pasteInsertHTML(nodes, node, range, nodeSelection, nodeCutter, docElement, isCollapsed, closestParentNode, editNode);\n            return;\n        }\n        if (editNode !== range.startContainer && ((!isCollapsed && !(closestParentNode.nodeType === Node.ELEMENT_NODE &&\n            CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) !== -1))\n            || (node.nodeName.toLowerCase() === 'table' && closestParentNode &&\n                CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) === -1))) {\n            var preNode = nodeCutter.GetSpliceNode(range, closestParentNode);\n            var sibNode = preNode.previousSibling;\n            var parentNode = preNode.parentNode;\n            if (nodes.length === 1 || (node.nodeName.toLowerCase() === 'table' && preNode.childElementCount === 0)) {\n                nodeSelection.setSelectionContents(docElement, preNode);\n                range = nodeSelection.getRange(docElement);\n            }\n            else {\n                var lasNode = nodeCutter.GetSpliceNode(range, nodes[nodes.length - 1].parentElement);\n                lasNode = isNOU(lasNode) ? preNode : lasNode;\n                nodeSelection.setSelectionText(docElement, preNode, lasNode, 0, (lasNode.nodeType === 3) ?\n                    lasNode.textContent.length : lasNode.childNodes.length);\n                range = nodeSelection.getRange(docElement);\n            }\n            range.extractContents();\n            if (insertNode.tagName === 'TABLE') {\n                this.removeEmptyElements(editNode);\n            }\n            for (var index = 0; index < nodes.length; index++) {\n                if (nodes[index].nodeType !== 3 && nodes[index].parentNode != null) {\n                    if (nodes[index].nodeName === 'IMG') {\n                        continue;\n                    }\n                    nodes[index].parentNode.removeChild(nodes[index]);\n                }\n            }\n            if (sibNode) {\n                InsertMethods.AppendBefore(node, sibNode, true);\n            }\n            else {\n                var previousNode = null;\n                while (parentNode !== editNode && parentNode.firstChild &&\n                    (parentNode.textContent.trim() === '')) {\n                    var parentNode1 = parentNode.parentNode;\n                    previousNode = parentNode;\n                    parentNode = parentNode1;\n                }\n                if (previousNode !== null) {\n                    parentNode = previousNode;\n                }\n                if (parentNode.firstChild && (parentNode !== editNode ||\n                    (node.nodeName === 'TABLE' && isCursor && parentNode === range.startContainer &&\n                        parentNode === range.endContainer))) {\n                    if (parentNode.textContent.trim() === '' && parentNode !== editNode) {\n                        InsertMethods.AppendBefore(node, parentNode, false);\n                        detach(parentNode);\n                    }\n                    else {\n                        InsertMethods.AppendBefore(node, parentNode.firstChild, false);\n                    }\n                }\n                else {\n                    parentNode.appendChild(node);\n                }\n            }\n            if (node.nodeName === 'IMG') {\n                this.imageFocus(node, nodeSelection, docElement);\n            }\n            else if (node.nodeType !== 3) {\n                nodeSelection.setSelectionText(docElement, node, node, 0, node.childNodes.length);\n            }\n            else {\n                nodeSelection.setSelectionText(docElement, node, node, 0, node.textContent.length);\n            }\n        }\n        else {\n            range.deleteContents();\n            if (isCursor && range.startContainer.textContent === '' && range.startContainer.nodeName !== 'BR') {\n                range.startContainer.innerHTML = '';\n            }\n            if (Browser.isIE) {\n                var frag = docElement.createDocumentFragment();\n                frag.appendChild(node);\n                range.insertNode(frag);\n            }\n            else if (range.startContainer.nodeType === 1 && range.startContainer.nodeName.toLowerCase() === 'hr'\n                && range.endContainer.nodeName.toLowerCase() === 'hr') {\n                var paraElem = range.startContainer.nextElementSibling;\n                if (paraElem) {\n                    if (paraElem.querySelector('br')) {\n                        detach(paraElem.querySelector('br'));\n                    }\n                    paraElem.appendChild(node);\n                }\n            }\n            else {\n                if (range.startContainer.nodeName === 'BR') {\n                    range.startContainer.parentElement.insertBefore(node, range.startContainer);\n                }\n                else {\n                    range.insertNode(node);\n                }\n            }\n            if (node.nodeType !== 3 && node.childNodes.length > 0) {\n                nodeSelection.setSelectionText(docElement, node, node, 1, 1);\n            }\n            else if (node.nodeName === 'IMG') {\n                this.imageFocus(node, nodeSelection, docElement);\n            }\n            else if (node.nodeType !== 3) {\n                nodeSelection.setSelectionContents(docElement, node);\n            }\n            else {\n                nodeSelection.setSelectionText(docElement, node, node, node.textContent.length, node.textContent.length);\n            }\n        }\n    };\n    InsertHtml.pasteInsertHTML = function (nodes, node, range, nodeSelection, nodeCutter, docElement, isCollapsed, closestParentNode, editNode) {\n        var isCursor = range.startOffset === range.endOffset &&\n            range.startContainer === range.endContainer;\n        if (isCursor && range.startContainer === editNode && editNode.textContent === '') {\n            var currentBlockNode = this.getImmediateBlockNode(nodes[nodes.length - 1], editNode);\n            nodeSelection.setSelectionText(docElement, currentBlockNode, currentBlockNode, 0, 0);\n            range = nodeSelection.getRange(docElement);\n        }\n        var lasNode;\n        var sibNode;\n        var isSingleNode;\n        var preNode;\n        if (editNode !== range.startContainer && ((!isCollapsed && !(closestParentNode.nodeType === Node.ELEMENT_NODE &&\n            CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) !== -1))\n            || (node.nodeName.toLowerCase() === 'table' && closestParentNode &&\n                CONSTANT.TABLE_BLOCK_TAGS.indexOf(closestParentNode.tagName.toLocaleLowerCase()) === -1))) {\n            preNode = nodeCutter.GetSpliceNode(range, closestParentNode);\n            sibNode = isNOU(preNode.previousSibling) ? preNode.parentNode.previousSibling : preNode.previousSibling;\n            if (nodes.length === 1) {\n                nodeSelection.setSelectionContents(docElement, preNode);\n                range = nodeSelection.getRange(docElement);\n                isSingleNode = true;\n            }\n            else {\n                lasNode = nodeCutter.GetSpliceNode(range, nodes[nodes.length - 1].parentElement);\n                lasNode = isNOU(lasNode) ? preNode : lasNode;\n                nodeSelection.setSelectionText(docElement, preNode, lasNode, 0, (lasNode.nodeType === 3) ?\n                    lasNode.textContent.length : lasNode.childNodes.length);\n                range = nodeSelection.getRange(docElement);\n                isSingleNode = false;\n            }\n        }\n        var containsBlockNode = false;\n        this.removingComments(node);\n        var allChildNodes = node.childNodes;\n        for (var i = 0; i < allChildNodes.length; i++) {\n            if (CONSTANT.BLOCK_TAGS.indexOf(allChildNodes[i].nodeName.toLocaleLowerCase()) >= 0) {\n                containsBlockNode = true;\n                break;\n            }\n        }\n        var lastSelectionNode;\n        var fragment = document.createDocumentFragment();\n        if (!containsBlockNode) {\n            if (!isCursor) {\n                while (node.firstChild) {\n                    lastSelectionNode = node.firstChild;\n                    fragment.appendChild(node.firstChild);\n                }\n                if (isSingleNode) {\n                    preNode.parentNode.replaceChild(fragment, preNode);\n                }\n                else {\n                    range.deleteContents();\n                    detach(lasNode);\n                    // eslint-disable-next-line\n                    !isNOU(sibNode) ? sibNode.parentNode.appendChild(fragment) : editNode.appendChild(fragment);\n                }\n            }\n            else {\n                var tempSpan = createElement('span', { className: 'tempSpan' });\n                var nearestAnchor = closest(range.startContainer.parentElement, 'a');\n                if (range.startContainer.nodeType === 3 && nearestAnchor) {\n                    var immediateBlockNode = this.getImmediateBlockNode(range.startContainer, editNode);\n                    if (immediateBlockNode.querySelectorAll('br').length > 0) {\n                        detach(immediateBlockNode.querySelector('br'));\n                    }\n                    var rangeElement = closest(nearestAnchor, 'span');\n                    rangeElement.appendChild(tempSpan);\n                }\n                else {\n                    range.insertNode(tempSpan);\n                }\n                while (node.firstChild) {\n                    lastSelectionNode = node.firstChild;\n                    fragment.appendChild(node.firstChild);\n                }\n                tempSpan.parentNode.replaceChild(fragment, tempSpan);\n            }\n        }\n        else {\n            this.insertTempNode(range, node, nodes, nodeCutter, editNode);\n            var isFirstTextNode = true;\n            var isPreviousInlineElem = void 0;\n            var paraElm = void 0;\n            var previousParent = void 0;\n            range.deleteContents();\n            while (node.firstChild) {\n                if (node.firstChild.nodeName === '#text' && node.firstChild.textContent.trim() === '') {\n                    detach(node.firstChild);\n                    continue;\n                }\n                if (node.firstChild.nodeName === '#text' && isFirstTextNode ||\n                    (this.inlineNode.indexOf(node.firstChild.nodeName.toLocaleLowerCase()) >= 0 && isFirstTextNode)) {\n                    lastSelectionNode = node.firstChild;\n                    if (isNOU(node.previousElementSibling)) {\n                        var firstParaElm = createElement('p');\n                        node.parentElement.insertBefore(firstParaElm, node);\n                    }\n                    node.previousElementSibling.appendChild(node.firstChild);\n                }\n                else {\n                    lastSelectionNode = node.firstChild;\n                    if (node.firstChild.nodeName === '#text' ||\n                        (this.inlineNode.indexOf(node.firstChild.nodeName.toLocaleLowerCase()) >= 0)) {\n                        if (!isPreviousInlineElem) {\n                            paraElm = createElement('p');\n                            paraElm.appendChild(node.firstChild);\n                            fragment.appendChild(paraElm);\n                        }\n                        else {\n                            previousParent.appendChild(node.firstChild);\n                            fragment.appendChild(previousParent);\n                        }\n                        previousParent = paraElm;\n                        isPreviousInlineElem = true;\n                    }\n                    else {\n                        fragment.appendChild(node.firstChild);\n                        isPreviousInlineElem = false;\n                    }\n                    isFirstTextNode = false;\n                }\n            }\n            node.parentNode.replaceChild(fragment, node);\n        }\n        if (lastSelectionNode.nodeName === '#text') {\n            this.placeCursorEnd(lastSelectionNode, node, nodeSelection, docElement, editNode);\n        }\n        else {\n            this.cursorPos(lastSelectionNode, node, nodeSelection, docElement, editNode);\n        }\n    };\n    InsertHtml.placeCursorEnd = function (lastSelectionNode, node, nodeSelection, docElement, editNode) {\n        lastSelectionNode = lastSelectionNode.nodeName === 'BR' ? (isNOU(lastSelectionNode.previousSibling) ? lastSelectionNode.parentNode\n            : lastSelectionNode.previousSibling) : lastSelectionNode;\n        while (!isNOU(lastSelectionNode) && lastSelectionNode.nodeName !== '#text' && lastSelectionNode.nodeName !== 'IMG' &&\n            lastSelectionNode.nodeName !== 'BR' && lastSelectionNode.nodeName !== 'HR') {\n            lastSelectionNode = lastSelectionNode.lastChild;\n        }\n        lastSelectionNode = isNOU(lastSelectionNode) ? node : lastSelectionNode;\n        if (lastSelectionNode.nodeName === 'IMG') {\n            this.imageFocus(lastSelectionNode, nodeSelection, docElement);\n        }\n        else {\n            nodeSelection.setSelectionText(docElement, lastSelectionNode, lastSelectionNode, lastSelectionNode.textContent.length, lastSelectionNode.textContent.length);\n        }\n        this.removeEmptyElements(editNode);\n    };\n    InsertHtml.getNodeCollection = function (range, nodeSelection, node) {\n        var nodes = [];\n        if (range.startOffset === range.endOffset && range.startContainer === range.endContainer &&\n            range.startContainer.nodeName != 'BR' &&\n            (range.startContainer.nodeName === 'TD' || (range.startContainer.nodeType !== 3 &&\n                node.classList && node.classList.contains('pasteContent')))) {\n            nodes.push(range.startContainer.childNodes[range.endOffset]);\n        }\n        else {\n            nodes = nodeSelection.getInsertNodeCollection(range);\n        }\n        return nodes;\n    };\n    InsertHtml.insertTempNode = function (range, node, nodes, nodeCutter, editNode) {\n        if (range.startContainer === editNode && !isNOU(range.startContainer.childNodes[range.endOffset - 1]) &&\n            range.startContainer.childNodes[range.endOffset - 1].nodeName === 'TABLE') {\n            if (isNOU(range.startContainer.childNodes[range.endOffset - 1].nextSibling)) {\n                range.startContainer.appendChild(node);\n            }\n            else {\n                range.startContainer.insertBefore(node, range.startContainer.childNodes[range.endOffset - 1].nextSibling);\n            }\n        }\n        else if (range.startContainer === editNode && !isNOU(range.startContainer.childNodes[range.endOffset]) &&\n            range.startContainer.childNodes[range.endOffset].nodeName === 'TABLE') {\n            range.startContainer.insertBefore(node, range.startContainer.childNodes[range.endOffset]);\n        }\n        else if (range.startContainer === range.endContainer && range.startContainer.nodeType !== 3\n            && node.firstChild.nodeName === 'HR') {\n            if (range.startContainer.classList.contains('e-content') || range.startContainer.nodeName === 'BODY') {\n                range.startContainer.appendChild(node);\n            }\n            else {\n                range.startContainer.parentNode.insertBefore(node, range.startContainer);\n            }\n        }\n        else {\n            var blockNode = this.getImmediateBlockNode(nodes[nodes.length - 1], editNode);\n            if ((isNOU(blockNode) || isNOU(blockNode.parentElement)) && range.endContainer.nodeType !== 3) {\n                blockNode = range.endContainer;\n                range.setEnd(blockNode, range.endContainer.textContent.length);\n            }\n            if (blockNode.nodeName === 'BODY' && range.startContainer === range.endContainer && range.startContainer.nodeType === 1) {\n                blockNode = range.startContainer;\n            }\n            if (blockNode.closest('LI') && node && node.firstElementChild &&\n                ((node).firstElementChild.tagName === 'OL' || node.firstElementChild.tagName === 'UL')) {\n                var liNode = void 0;\n                while (node.firstElementChild.lastElementChild && node.firstElementChild.lastElementChild.tagName === 'LI') {\n                    liNode = node.firstElementChild.lastElementChild;\n                    liNode.style.removeProperty('margin-left');\n                    liNode.style.removeProperty('margin-top');\n                    liNode.style.removeProperty('margin-bottom');\n                    node.firstElementChild.insertAdjacentElement('afterend', liNode);\n                }\n            }\n            if (blockNode.nodeName === 'TD' || blockNode.nodeName === 'TH') {\n                var tempSpan = createElement('span', { className: 'tempSpan' });\n                range.insertNode(tempSpan);\n                tempSpan.parentNode.replaceChild(node, tempSpan);\n            }\n            else {\n                var currentNode = nodes[nodes.length - 1];\n                var splitedElm = void 0;\n                if ((currentNode.nodeName === 'BR' || currentNode.nodeName === 'HR') && !isNOU(currentNode.parentElement) &&\n                    currentNode.parentElement.textContent.trim().length === 0) {\n                    splitedElm = currentNode;\n                }\n                else {\n                    splitedElm = nodeCutter.GetSpliceNode(range, blockNode);\n                }\n                splitedElm.parentNode.replaceChild(node, splitedElm);\n            }\n        }\n    };\n    InsertHtml.cursorPos = function (lastSelectionNode, node, nodeSelection, docElement, editNode) {\n        lastSelectionNode.classList.add('lastNode');\n        editNode.innerHTML = updateTextNode(editNode.innerHTML);\n        lastSelectionNode = editNode.querySelector('.lastNode');\n        if (!isNOU(lastSelectionNode)) {\n            this.placeCursorEnd(lastSelectionNode, node, nodeSelection, docElement, editNode);\n            lastSelectionNode.classList.remove('lastNode');\n            if (lastSelectionNode.classList.length === 0) {\n                lastSelectionNode.removeAttribute('class');\n            }\n        }\n    };\n    InsertHtml.imageFocus = function (node, nodeSelection, docElement) {\n        var focusNode = document.createTextNode(' ');\n        node.parentNode.insertBefore(focusNode, node.nextSibling);\n        nodeSelection.setSelectionText(docElement, node.nextSibling, node.nextSibling, 0, 0);\n    };\n    // eslint-disable-next-line\n    InsertHtml.getImmediateBlockNode = function (node, editNode) {\n        do {\n            node = node.parentNode;\n        } while (node && CONSTANT.BLOCK_TAGS.indexOf(node.nodeName.toLocaleLowerCase()) < 0);\n        return node;\n    };\n    InsertHtml.removingComments = function (elm) {\n        var innerElement = elm.innerHTML;\n        innerElement = innerElement.replace(/<!--[\\s\\S]*?-->/g, '');\n        elm.innerHTML = innerElement;\n    };\n    InsertHtml.findDetachEmptyElem = function (element) {\n        var removableElement;\n        if (!isNOU(element.parentElement)) {\n            if (element.parentElement.textContent.trim() === '' && element.parentElement.contentEditable !== 'true') {\n                removableElement = this.findDetachEmptyElem(element.parentElement);\n            }\n            else {\n                removableElement = element;\n            }\n        }\n        else {\n            removableElement = null;\n        }\n        return removableElement;\n    };\n    InsertHtml.removeEmptyElements = function (element) {\n        var emptyElements = element.querySelectorAll(':empty');\n        for (var i = 0; i < emptyElements.length; i++) {\n            if (emptyElements[i].tagName !== 'IMG' && emptyElements[i].tagName !== 'BR' &&\n                emptyElements[i].tagName !== 'IFRAME' && emptyElements[i].tagName !== 'TD' &&\n                emptyElements[i].tagName !== 'SOURCE' && emptyElements[i].tagName !== 'HR') {\n                var detachableElement = this.findDetachEmptyElem(emptyElements[i]);\n                if (!isNOU(detachableElement)) {\n                    detach(detachableElement);\n                }\n            }\n        }\n    };\n    InsertHtml.closestEle = function (element, editNode) {\n        var el = element;\n        while (el && el.nodeType === 1) {\n            if (el.parentNode === editNode ||\n                (!isNOU(el.parentNode.tagName) &&\n                    CONSTANT.IGNORE_BLOCK_TAGS.indexOf(el.parentNode.tagName.toLocaleLowerCase()) !== -1)) {\n                return el;\n            }\n            el = el.parentNode;\n        }\n        return null;\n    };\n    /**\n     * Insert method\n     *\n     * @hidden\n\n     */\n    InsertHtml.inlineNode = ['a', 'abbr', 'acronym', 'audio', 'b', 'bdi', 'bdo', 'big', 'br', 'button',\n        'canvas', 'cite', 'code', 'data', 'datalist', 'del', 'dfn', 'em', 'embed', 'font', 'i', 'iframe', 'img', 'input',\n        'ins', 'kbd', 'label', 'map', 'mark', 'meter', 'noscript', 'object', 'output', 'picture', 'progress',\n        'q', 'ruby', 's', 'samp', 'script', 'select', 'slot', 'small', 'span', 'strong', 'sub', 'sup', 'svg',\n        'template', 'textarea', 'time', 'u', 'tt', 'var', 'video', 'wbr'];\n    return InsertHtml;\n}());\nexport { InsertHtml };\n"],"mappings":"AAAA,SAASA,aAAT,QAA8B,yBAA9B;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAO,KAAKC,QAAZ,MAA0B,oBAA1B;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,iBAAiB,IAAIC,KAA/C,EAAsDC,aAAtD,EAAqEC,OAArE,QAAoF,sBAApF;AACA,SAASC,aAAT,QAA8B,kBAA9B;AACA,SAASC,cAAT,QAA+B,qBAA/B;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,UAAU;AAAG;AAAe,YAAY;EACxC,SAASA,UAAT,GAAsB,CACrB;;EACDA,UAAU,CAACC,MAAX,GAAoB,UAAUC,UAAV,EAAsBC,UAAtB,EAAkCC,QAAlC,EAA4CC,UAA5C,EAAwD;IACxE,IAAIC,IAAJ;;IACA,IAAI,OAAOH,UAAP,KAAsB,QAA1B,EAAoC;MAChC,IAAII,OAAO,GAAGC,QAAQ,CAACZ,aAAT,CAAuB,KAAvB,CAAd;MACAW,OAAO,CAACE,SAAR,GAAoBN,UAApB;MACAG,IAAI,GAAGD,UAAU,GAAGE,OAAH,GAAaA,OAAO,CAACG,UAAtC;IACH,CAJD,MAKK;MACD,IAAIL,UAAU,IAAI,EAAE,CAACV,KAAK,CAACQ,UAAD,CAAN,IAAsB,CAACR,KAAK,CAACQ,UAAU,CAACQ,SAAZ,CAA5B,IAChBR,UAAU,CAACQ,SAAX,CAAqBC,QAArB,CAA8B,cAA9B,CADc,CAAlB,EACoD;QAChD,IAAIL,OAAO,GAAGC,QAAQ,CAACZ,aAAT,CAAuB,KAAvB,CAAd;QACAW,OAAO,CAACM,WAAR,CAAoBV,UAApB;QACAG,IAAI,GAAGC,OAAP;MACH,CALD,MAMK;QACDD,IAAI,GAAGH,UAAP;MACH;IACJ;;IACD,IAAIW,aAAa,GAAG,IAAIzB,aAAJ,EAApB;IACA,IAAI0B,UAAU,GAAG,IAAIzB,UAAJ,EAAjB;IACA,IAAI0B,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAZ;;IACA,IAAIc,KAAK,CAACE,cAAN,KAAyBd,QAAzB,IAAqCY,KAAK,CAACE,cAAN,KAAyBF,KAAK,CAACG,YAApE,IAAoFH,KAAK,CAACI,WAAN,KAAsB,CAA1G,IACAJ,KAAK,CAACI,WAAN,KAAsBJ,KAAK,CAACK,SAD5B,IACyCjB,QAAQ,CAACkB,WAAT,CAAqBC,MAArB,KAAgC,CADzE,IAC8EnB,QAAQ,CAACoB,QAAT,CAAkB,CAAlB,EAAqBC,OAArB,KAAiC,GADnH,EACwH;MACpHX,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2Cc,KAAK,CAACE,cAAN,CAAqBM,QAArB,CAA8B,CAA9B,CAA3C,EAA6ER,KAAK,CAACE,cAAN,CAAqBM,QAArB,CAA8B,CAA9B,CAA7E,EAA+G,CAA/G,EAAkH,CAAlH;MACAR,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAR;IACH;;IACD,IAAIyB,QAAQ,GAAGX,KAAK,CAACI,WAAN,KAAsBJ,KAAK,CAACK,SAA5B,IAAyCL,KAAK,CAACI,WAAN,KAAsB,CAA/D,IACXJ,KAAK,CAACE,cAAN,KAAyBF,KAAK,CAACG,YADnC;IAEA,IAAIS,WAAW,GAAGZ,KAAK,CAACa,SAAxB;IACA,IAAIC,KAAK,GAAG,KAAKC,iBAAL,CAAuBf,KAAvB,EAA8BF,aAA9B,EAA6CR,IAA7C,CAAZ;IACA,IAAI0B,iBAAiB,GAAI1B,IAAI,CAAC2B,QAAL,CAAcC,WAAd,OAAgC,OAAjC,GAA4C,KAAKC,UAAL,CAAgBL,KAAK,CAAC,CAAD,CAAL,CAASM,UAAzB,EAAqChC,QAArC,CAA5C,GAA6F0B,KAAK,CAAC,CAAD,CAA1H;;IACA,IAAIzB,UAAU,IAAK,CAACV,KAAK,CAACW,IAAD,CAAN,IAAgB,CAACX,KAAK,CAACW,IAAI,CAACK,SAAN,CAAtB,IACfL,IAAI,CAACK,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CADJ,EAC8C;MAC1C,KAAKyB,eAAL,CAAqBP,KAArB,EAA4BxB,IAA5B,EAAkCU,KAAlC,EAAyCF,aAAzC,EAAwDC,UAAxD,EAAoEb,UAApE,EAAgF0B,WAAhF,EAA6FI,iBAA7F,EAAgH5B,QAAhH;MACA;IACH;;IACD,IAAIA,QAAQ,KAAKY,KAAK,CAACE,cAAnB,KAAuC,CAACU,WAAD,IAAgB,EAAEI,iBAAiB,CAACM,QAAlB,KAA+BC,IAAI,CAACC,YAApC,IACzDjD,QAAQ,CAACkD,gBAAT,CAA0BC,OAA1B,CAAkCV,iBAAiB,CAACP,OAAlB,CAA0BkB,iBAA1B,EAAlC,MAAqF,CAAC,CAD/B,CAAjB,IAElCrC,IAAI,CAAC2B,QAAL,CAAcC,WAAd,OAAgC,OAAhC,IAA2CF,iBAA3C,IACAzC,QAAQ,CAACkD,gBAAT,CAA0BC,OAA1B,CAAkCV,iBAAiB,CAACP,OAAlB,CAA0BkB,iBAA1B,EAAlC,MAAqF,CAAC,CAH1F,CAAJ,EAGmG;MAC/F,IAAIC,OAAO,GAAG7B,UAAU,CAAC8B,aAAX,CAAyB7B,KAAzB,EAAgCgB,iBAAhC,CAAd;MACA,IAAIc,OAAO,GAAGF,OAAO,CAACG,eAAtB;MACA,IAAIX,UAAU,GAAGQ,OAAO,CAACR,UAAzB;;MACA,IAAIN,KAAK,CAACP,MAAN,KAAiB,CAAjB,IAAuBjB,IAAI,CAAC2B,QAAL,CAAcC,WAAd,OAAgC,OAAhC,IAA2CU,OAAO,CAACI,iBAAR,KAA8B,CAApG,EAAwG;QACpGlC,aAAa,CAACmC,oBAAd,CAAmC/C,UAAnC,EAA+C0C,OAA/C;QACA5B,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAR;MACH,CAHD,MAIK;QACD,IAAIgD,OAAO,GAAGnC,UAAU,CAAC8B,aAAX,CAAyB7B,KAAzB,EAAgCc,KAAK,CAACA,KAAK,CAACP,MAAN,GAAe,CAAhB,CAAL,CAAwB4B,aAAxD,CAAd;QACAD,OAAO,GAAGvD,KAAK,CAACuD,OAAD,CAAL,GAAiBN,OAAjB,GAA2BM,OAArC;QACApC,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2C0C,OAA3C,EAAoDM,OAApD,EAA6D,CAA7D,EAAiEA,OAAO,CAACZ,QAAR,KAAqB,CAAtB,GAC5DY,OAAO,CAAC5B,WAAR,CAAoBC,MADwC,GAC/B2B,OAAO,CAACE,UAAR,CAAmB7B,MADpD;QAEAP,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAR;MACH;;MACDc,KAAK,CAACqC,eAAN;;MACA,IAAIlD,UAAU,CAACsB,OAAX,KAAuB,OAA3B,EAAoC;QAChC,KAAK6B,mBAAL,CAAyBlD,QAAzB;MACH;;MACD,KAAK,IAAImD,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGzB,KAAK,CAACP,MAAlC,EAA0CgC,KAAK,EAA/C,EAAmD;QAC/C,IAAIzB,KAAK,CAACyB,KAAD,CAAL,CAAajB,QAAb,KAA0B,CAA1B,IAA+BR,KAAK,CAACyB,KAAD,CAAL,CAAanB,UAAb,IAA2B,IAA9D,EAAoE;UAChE,IAAIN,KAAK,CAACyB,KAAD,CAAL,CAAatB,QAAb,KAA0B,KAA9B,EAAqC;YACjC;UACH;;UACDH,KAAK,CAACyB,KAAD,CAAL,CAAanB,UAAb,CAAwBoB,WAAxB,CAAoC1B,KAAK,CAACyB,KAAD,CAAzC;QACH;MACJ;;MACD,IAAIT,OAAJ,EAAa;QACThD,aAAa,CAAC2D,YAAd,CAA2BnD,IAA3B,EAAiCwC,OAAjC,EAA0C,IAA1C;MACH,CAFD,MAGK;QACD,IAAIY,YAAY,GAAG,IAAnB;;QACA,OAAOtB,UAAU,KAAKhC,QAAf,IAA2BgC,UAAU,CAAC1B,UAAtC,IACF0B,UAAU,CAACd,WAAX,CAAuBqC,IAAvB,OAAkC,EADvC,EAC4C;UACxC,IAAIC,WAAW,GAAGxB,UAAU,CAACA,UAA7B;UACAsB,YAAY,GAAGtB,UAAf;UACAA,UAAU,GAAGwB,WAAb;QACH;;QACD,IAAIF,YAAY,KAAK,IAArB,EAA2B;UACvBtB,UAAU,GAAGsB,YAAb;QACH;;QACD,IAAItB,UAAU,CAAC1B,UAAX,KAA0B0B,UAAU,KAAKhC,QAAf,IACzBE,IAAI,CAAC2B,QAAL,KAAkB,OAAlB,IAA6BN,QAA7B,IAAyCS,UAAU,KAAKpB,KAAK,CAACE,cAA9D,IACGkB,UAAU,KAAKpB,KAAK,CAACG,YAFzB,CAAJ,EAE6C;UACzC,IAAIiB,UAAU,CAACd,WAAX,CAAuBqC,IAAvB,OAAkC,EAAlC,IAAwCvB,UAAU,KAAKhC,QAA3D,EAAqE;YACjEN,aAAa,CAAC2D,YAAd,CAA2BnD,IAA3B,EAAiC8B,UAAjC,EAA6C,KAA7C;YACA5C,MAAM,CAAC4C,UAAD,CAAN;UACH,CAHD,MAIK;YACDtC,aAAa,CAAC2D,YAAd,CAA2BnD,IAA3B,EAAiC8B,UAAU,CAAC1B,UAA5C,EAAwD,KAAxD;UACH;QACJ,CAVD,MAWK;UACD0B,UAAU,CAACvB,WAAX,CAAuBP,IAAvB;QACH;MACJ;;MACD,IAAIA,IAAI,CAAC2B,QAAL,KAAkB,KAAtB,EAA6B;QACzB,KAAK4B,UAAL,CAAgBvD,IAAhB,EAAsBQ,aAAtB,EAAqCZ,UAArC;MACH,CAFD,MAGK,IAAII,IAAI,CAACgC,QAAL,KAAkB,CAAtB,EAAyB;QAC1BxB,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2CI,IAA3C,EAAiDA,IAAjD,EAAuD,CAAvD,EAA0DA,IAAI,CAAC8C,UAAL,CAAgB7B,MAA1E;MACH,CAFI,MAGA;QACDT,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2CI,IAA3C,EAAiDA,IAAjD,EAAuD,CAAvD,EAA0DA,IAAI,CAACgB,WAAL,CAAiBC,MAA3E;MACH;IACJ,CApED,MAqEK;MACDP,KAAK,CAAC8C,cAAN;;MACA,IAAInC,QAAQ,IAAIX,KAAK,CAACE,cAAN,CAAqBI,WAArB,KAAqC,EAAjD,IAAuDN,KAAK,CAACE,cAAN,CAAqBe,QAArB,KAAkC,IAA7F,EAAmG;QAC/FjB,KAAK,CAACE,cAAN,CAAqBT,SAArB,GAAiC,EAAjC;MACH;;MACD,IAAIhB,OAAO,CAACsE,IAAZ,EAAkB;QACd,IAAIC,IAAI,GAAG9D,UAAU,CAAC+D,sBAAX,EAAX;QACAD,IAAI,CAACnD,WAAL,CAAiBP,IAAjB;QACAU,KAAK,CAACb,UAAN,CAAiB6D,IAAjB;MACH,CAJD,MAKK,IAAIhD,KAAK,CAACE,cAAN,CAAqBoB,QAArB,KAAkC,CAAlC,IAAuCtB,KAAK,CAACE,cAAN,CAAqBe,QAArB,CAA8BC,WAA9B,OAAgD,IAAvF,IACFlB,KAAK,CAACG,YAAN,CAAmBc,QAAnB,CAA4BC,WAA5B,OAA8C,IADhD,EACsD;QACvD,IAAIgC,QAAQ,GAAGlD,KAAK,CAACE,cAAN,CAAqBiD,kBAApC;;QACA,IAAID,QAAJ,EAAc;UACV,IAAIA,QAAQ,CAACE,aAAT,CAAuB,IAAvB,CAAJ,EAAkC;YAC9B5E,MAAM,CAAC0E,QAAQ,CAACE,aAAT,CAAuB,IAAvB,CAAD,CAAN;UACH;;UACDF,QAAQ,CAACrD,WAAT,CAAqBP,IAArB;QACH;MACJ,CATI,MAUA;QACD,IAAIU,KAAK,CAACE,cAAN,CAAqBe,QAArB,KAAkC,IAAtC,EAA4C;UACxCjB,KAAK,CAACE,cAAN,CAAqBiC,aAArB,CAAmCkB,YAAnC,CAAgD/D,IAAhD,EAAsDU,KAAK,CAACE,cAA5D;QACH,CAFD,MAGK;UACDF,KAAK,CAACb,UAAN,CAAiBG,IAAjB;QACH;MACJ;;MACD,IAAIA,IAAI,CAACgC,QAAL,KAAkB,CAAlB,IAAuBhC,IAAI,CAAC8C,UAAL,CAAgB7B,MAAhB,GAAyB,CAApD,EAAuD;QACnDT,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2CI,IAA3C,EAAiDA,IAAjD,EAAuD,CAAvD,EAA0D,CAA1D;MACH,CAFD,MAGK,IAAIA,IAAI,CAAC2B,QAAL,KAAkB,KAAtB,EAA6B;QAC9B,KAAK4B,UAAL,CAAgBvD,IAAhB,EAAsBQ,aAAtB,EAAqCZ,UAArC;MACH,CAFI,MAGA,IAAII,IAAI,CAACgC,QAAL,KAAkB,CAAtB,EAAyB;QAC1BxB,aAAa,CAACmC,oBAAd,CAAmC/C,UAAnC,EAA+CI,IAA/C;MACH,CAFI,MAGA;QACDQ,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2CI,IAA3C,EAAiDA,IAAjD,EAAuDA,IAAI,CAACgB,WAAL,CAAiBC,MAAxE,EAAgFjB,IAAI,CAACgB,WAAL,CAAiBC,MAAjG;MACH;IACJ;EACJ,CAlJD;;EAmJAvB,UAAU,CAACqC,eAAX,GAA6B,UAAUP,KAAV,EAAiBxB,IAAjB,EAAuBU,KAAvB,EAA8BF,aAA9B,EAA6CC,UAA7C,EAAyDb,UAAzD,EAAqE0B,WAArE,EAAkFI,iBAAlF,EAAqG5B,QAArG,EAA+G;IACxI,IAAIuB,QAAQ,GAAGX,KAAK,CAACI,WAAN,KAAsBJ,KAAK,CAACK,SAA5B,IACXL,KAAK,CAACE,cAAN,KAAyBF,KAAK,CAACG,YADnC;;IAEA,IAAIQ,QAAQ,IAAIX,KAAK,CAACE,cAAN,KAAyBd,QAArC,IAAiDA,QAAQ,CAACkB,WAAT,KAAyB,EAA9E,EAAkF;MAC9E,IAAIgD,gBAAgB,GAAG,KAAKC,qBAAL,CAA2BzC,KAAK,CAACA,KAAK,CAACP,MAAN,GAAe,CAAhB,CAAhC,EAAoDnB,QAApD,CAAvB;MACAU,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2CoE,gBAA3C,EAA6DA,gBAA7D,EAA+E,CAA/E,EAAkF,CAAlF;MACAtD,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAR;IACH;;IACD,IAAIgD,OAAJ;IACA,IAAIJ,OAAJ;IACA,IAAI0B,YAAJ;IACA,IAAI5B,OAAJ;;IACA,IAAIxC,QAAQ,KAAKY,KAAK,CAACE,cAAnB,KAAuC,CAACU,WAAD,IAAgB,EAAEI,iBAAiB,CAACM,QAAlB,KAA+BC,IAAI,CAACC,YAApC,IACzDjD,QAAQ,CAACkD,gBAAT,CAA0BC,OAA1B,CAAkCV,iBAAiB,CAACP,OAAlB,CAA0BkB,iBAA1B,EAAlC,MAAqF,CAAC,CAD/B,CAAjB,IAElCrC,IAAI,CAAC2B,QAAL,CAAcC,WAAd,OAAgC,OAAhC,IAA2CF,iBAA3C,IACAzC,QAAQ,CAACkD,gBAAT,CAA0BC,OAA1B,CAAkCV,iBAAiB,CAACP,OAAlB,CAA0BkB,iBAA1B,EAAlC,MAAqF,CAAC,CAH1F,CAAJ,EAGmG;MAC/FC,OAAO,GAAG7B,UAAU,CAAC8B,aAAX,CAAyB7B,KAAzB,EAAgCgB,iBAAhC,CAAV;MACAc,OAAO,GAAGnD,KAAK,CAACiD,OAAO,CAACG,eAAT,CAAL,GAAiCH,OAAO,CAACR,UAAR,CAAmBW,eAApD,GAAsEH,OAAO,CAACG,eAAxF;;MACA,IAAIjB,KAAK,CAACP,MAAN,KAAiB,CAArB,EAAwB;QACpBT,aAAa,CAACmC,oBAAd,CAAmC/C,UAAnC,EAA+C0C,OAA/C;QACA5B,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAR;QACAsE,YAAY,GAAG,IAAf;MACH,CAJD,MAKK;QACDtB,OAAO,GAAGnC,UAAU,CAAC8B,aAAX,CAAyB7B,KAAzB,EAAgCc,KAAK,CAACA,KAAK,CAACP,MAAN,GAAe,CAAhB,CAAL,CAAwB4B,aAAxD,CAAV;QACAD,OAAO,GAAGvD,KAAK,CAACuD,OAAD,CAAL,GAAiBN,OAAjB,GAA2BM,OAArC;QACApC,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2C0C,OAA3C,EAAoDM,OAApD,EAA6D,CAA7D,EAAiEA,OAAO,CAACZ,QAAR,KAAqB,CAAtB,GAC5DY,OAAO,CAAC5B,WAAR,CAAoBC,MADwC,GAC/B2B,OAAO,CAACE,UAAR,CAAmB7B,MADpD;QAEAP,KAAK,GAAGF,aAAa,CAACG,QAAd,CAAuBf,UAAvB,CAAR;QACAsE,YAAY,GAAG,KAAf;MACH;IACJ;;IACD,IAAIC,iBAAiB,GAAG,KAAxB;IACA,KAAKC,gBAAL,CAAsBpE,IAAtB;IACA,IAAIqE,aAAa,GAAGrE,IAAI,CAAC8C,UAAzB;;IACA,KAAK,IAAIwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,aAAa,CAACpD,MAAlC,EAA0CqD,CAAC,EAA3C,EAA+C;MAC3C,IAAIrF,QAAQ,CAACsF,UAAT,CAAoBnC,OAApB,CAA4BiC,aAAa,CAACC,CAAD,CAAb,CAAiB3C,QAAjB,CAA0BU,iBAA1B,EAA5B,KAA8E,CAAlF,EAAqF;QACjF8B,iBAAiB,GAAG,IAApB;QACA;MACH;IACJ;;IACD,IAAIK,iBAAJ;IACA,IAAIC,QAAQ,GAAGvE,QAAQ,CAACyD,sBAAT,EAAf;;IACA,IAAI,CAACQ,iBAAL,EAAwB;MACpB,IAAI,CAAC9C,QAAL,EAAe;QACX,OAAOrB,IAAI,CAACI,UAAZ,EAAwB;UACpBoE,iBAAiB,GAAGxE,IAAI,CAACI,UAAzB;UACAqE,QAAQ,CAAClE,WAAT,CAAqBP,IAAI,CAACI,UAA1B;QACH;;QACD,IAAI8D,YAAJ,EAAkB;UACd5B,OAAO,CAACR,UAAR,CAAmB4C,YAAnB,CAAgCD,QAAhC,EAA0CnC,OAA1C;QACH,CAFD,MAGK;UACD5B,KAAK,CAAC8C,cAAN;UACAtE,MAAM,CAAC0D,OAAD,CAAN,CAFC,CAGD;;UACA,CAACvD,KAAK,CAACmD,OAAD,CAAN,GAAkBA,OAAO,CAACV,UAAR,CAAmBvB,WAAnB,CAA+BkE,QAA/B,CAAlB,GAA6D3E,QAAQ,CAACS,WAAT,CAAqBkE,QAArB,CAA7D;QACH;MACJ,CAdD,MAeK;QACD,IAAIE,QAAQ,GAAGrF,aAAa,CAAC,MAAD,EAAS;UAAEsF,SAAS,EAAE;QAAb,CAAT,CAA5B;QACA,IAAIC,aAAa,GAAGtF,OAAO,CAACmB,KAAK,CAACE,cAAN,CAAqBiC,aAAtB,EAAqC,GAArC,CAA3B;;QACA,IAAInC,KAAK,CAACE,cAAN,CAAqBoB,QAArB,KAAkC,CAAlC,IAAuC6C,aAA3C,EAA0D;UACtD,IAAIC,kBAAkB,GAAG,KAAKb,qBAAL,CAA2BvD,KAAK,CAACE,cAAjC,EAAiDd,QAAjD,CAAzB;;UACA,IAAIgF,kBAAkB,CAACC,gBAAnB,CAAoC,IAApC,EAA0C9D,MAA1C,GAAmD,CAAvD,EAA0D;YACtD/B,MAAM,CAAC4F,kBAAkB,CAAChB,aAAnB,CAAiC,IAAjC,CAAD,CAAN;UACH;;UACD,IAAIkB,YAAY,GAAGzF,OAAO,CAACsF,aAAD,EAAgB,MAAhB,CAA1B;UACAG,YAAY,CAACzE,WAAb,CAAyBoE,QAAzB;QACH,CAPD,MAQK;UACDjE,KAAK,CAACb,UAAN,CAAiB8E,QAAjB;QACH;;QACD,OAAO3E,IAAI,CAACI,UAAZ,EAAwB;UACpBoE,iBAAiB,GAAGxE,IAAI,CAACI,UAAzB;UACAqE,QAAQ,CAAClE,WAAT,CAAqBP,IAAI,CAACI,UAA1B;QACH;;QACDuE,QAAQ,CAAC7C,UAAT,CAAoB4C,YAApB,CAAiCD,QAAjC,EAA2CE,QAA3C;MACH;IACJ,CApCD,MAqCK;MACD,KAAKM,cAAL,CAAoBvE,KAApB,EAA2BV,IAA3B,EAAiCwB,KAAjC,EAAwCf,UAAxC,EAAoDX,QAApD;MACA,IAAIoF,eAAe,GAAG,IAAtB;MACA,IAAIC,oBAAoB,GAAG,KAAK,CAAhC;MACA,IAAIC,OAAO,GAAG,KAAK,CAAnB;MACA,IAAIC,cAAc,GAAG,KAAK,CAA1B;MACA3E,KAAK,CAAC8C,cAAN;;MACA,OAAOxD,IAAI,CAACI,UAAZ,EAAwB;QACpB,IAAIJ,IAAI,CAACI,UAAL,CAAgBuB,QAAhB,KAA6B,OAA7B,IAAwC3B,IAAI,CAACI,UAAL,CAAgBY,WAAhB,CAA4BqC,IAA5B,OAAuC,EAAnF,EAAuF;UACnFnE,MAAM,CAACc,IAAI,CAACI,UAAN,CAAN;UACA;QACH;;QACD,IAAIJ,IAAI,CAACI,UAAL,CAAgBuB,QAAhB,KAA6B,OAA7B,IAAwCuD,eAAxC,IACC,KAAKI,UAAL,CAAgBlD,OAAhB,CAAwBpC,IAAI,CAACI,UAAL,CAAgBuB,QAAhB,CAAyBU,iBAAzB,EAAxB,KAAyE,CAAzE,IAA8E6C,eADnF,EACqG;UACjGV,iBAAiB,GAAGxE,IAAI,CAACI,UAAzB;;UACA,IAAIf,KAAK,CAACW,IAAI,CAACuF,sBAAN,CAAT,EAAwC;YACpC,IAAIC,YAAY,GAAGlG,aAAa,CAAC,GAAD,CAAhC;YACAU,IAAI,CAAC6C,aAAL,CAAmBkB,YAAnB,CAAgCyB,YAAhC,EAA8CxF,IAA9C;UACH;;UACDA,IAAI,CAACuF,sBAAL,CAA4BhF,WAA5B,CAAwCP,IAAI,CAACI,UAA7C;QACH,CARD,MASK;UACDoE,iBAAiB,GAAGxE,IAAI,CAACI,UAAzB;;UACA,IAAIJ,IAAI,CAACI,UAAL,CAAgBuB,QAAhB,KAA6B,OAA7B,IACC,KAAK2D,UAAL,CAAgBlD,OAAhB,CAAwBpC,IAAI,CAACI,UAAL,CAAgBuB,QAAhB,CAAyBU,iBAAzB,EAAxB,KAAyE,CAD9E,EACkF;YAC9E,IAAI,CAAC8C,oBAAL,EAA2B;cACvBC,OAAO,GAAG9F,aAAa,CAAC,GAAD,CAAvB;cACA8F,OAAO,CAAC7E,WAAR,CAAoBP,IAAI,CAACI,UAAzB;cACAqE,QAAQ,CAAClE,WAAT,CAAqB6E,OAArB;YACH,CAJD,MAKK;cACDC,cAAc,CAAC9E,WAAf,CAA2BP,IAAI,CAACI,UAAhC;cACAqE,QAAQ,CAAClE,WAAT,CAAqB8E,cAArB;YACH;;YACDA,cAAc,GAAGD,OAAjB;YACAD,oBAAoB,GAAG,IAAvB;UACH,CAbD,MAcK;YACDV,QAAQ,CAAClE,WAAT,CAAqBP,IAAI,CAACI,UAA1B;YACA+E,oBAAoB,GAAG,KAAvB;UACH;;UACDD,eAAe,GAAG,KAAlB;QACH;MACJ;;MACDlF,IAAI,CAAC8B,UAAL,CAAgB4C,YAAhB,CAA6BD,QAA7B,EAAuCzE,IAAvC;IACH;;IACD,IAAIwE,iBAAiB,CAAC7C,QAAlB,KAA+B,OAAnC,EAA4C;MACxC,KAAK8D,cAAL,CAAoBjB,iBAApB,EAAuCxE,IAAvC,EAA6CQ,aAA7C,EAA4DZ,UAA5D,EAAwEE,QAAxE;IACH,CAFD,MAGK;MACD,KAAK4F,SAAL,CAAelB,iBAAf,EAAkCxE,IAAlC,EAAwCQ,aAAxC,EAAuDZ,UAAvD,EAAmEE,QAAnE;IACH;EACJ,CApID;;EAqIAJ,UAAU,CAAC+F,cAAX,GAA4B,UAAUjB,iBAAV,EAA6BxE,IAA7B,EAAmCQ,aAAnC,EAAkDZ,UAAlD,EAA8DE,QAA9D,EAAwE;IAChG0E,iBAAiB,GAAGA,iBAAiB,CAAC7C,QAAlB,KAA+B,IAA/B,GAAuCtC,KAAK,CAACmF,iBAAiB,CAAC/B,eAAnB,CAAL,GAA2C+B,iBAAiB,CAAC1C,UAA7D,GACrD0C,iBAAiB,CAAC/B,eADJ,GACuB+B,iBAD3C;;IAEA,OAAO,CAACnF,KAAK,CAACmF,iBAAD,CAAN,IAA6BA,iBAAiB,CAAC7C,QAAlB,KAA+B,OAA5D,IAAuE6C,iBAAiB,CAAC7C,QAAlB,KAA+B,KAAtG,IACH6C,iBAAiB,CAAC7C,QAAlB,KAA+B,IAD5B,IACoC6C,iBAAiB,CAAC7C,QAAlB,KAA+B,IAD1E,EACgF;MAC5E6C,iBAAiB,GAAGA,iBAAiB,CAACmB,SAAtC;IACH;;IACDnB,iBAAiB,GAAGnF,KAAK,CAACmF,iBAAD,CAAL,GAA2BxE,IAA3B,GAAkCwE,iBAAtD;;IACA,IAAIA,iBAAiB,CAAC7C,QAAlB,KAA+B,KAAnC,EAA0C;MACtC,KAAK4B,UAAL,CAAgBiB,iBAAhB,EAAmChE,aAAnC,EAAkDZ,UAAlD;IACH,CAFD,MAGK;MACDY,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2C4E,iBAA3C,EAA8DA,iBAA9D,EAAiFA,iBAAiB,CAACxD,WAAlB,CAA8BC,MAA/G,EAAuHuD,iBAAiB,CAACxD,WAAlB,CAA8BC,MAArJ;IACH;;IACD,KAAK+B,mBAAL,CAAyBlD,QAAzB;EACH,CAfD;;EAgBAJ,UAAU,CAAC+B,iBAAX,GAA+B,UAAUf,KAAV,EAAiBF,aAAjB,EAAgCR,IAAhC,EAAsC;IACjE,IAAIwB,KAAK,GAAG,EAAZ;;IACA,IAAId,KAAK,CAACI,WAAN,KAAsBJ,KAAK,CAACK,SAA5B,IAAyCL,KAAK,CAACE,cAAN,KAAyBF,KAAK,CAACG,YAAxE,IACAH,KAAK,CAACE,cAAN,CAAqBe,QAArB,IAAiC,IADjC,KAECjB,KAAK,CAACE,cAAN,CAAqBe,QAArB,KAAkC,IAAlC,IAA2CjB,KAAK,CAACE,cAAN,CAAqBoB,QAArB,KAAkC,CAAlC,IACxChC,IAAI,CAACK,SADmC,IACtBL,IAAI,CAACK,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAHtB,CAAJ,EAGqE;MACjEkB,KAAK,CAACoE,IAAN,CAAWlF,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAtC,CAAX;IACH,CALD,MAMK;MACDS,KAAK,GAAGhB,aAAa,CAACqF,uBAAd,CAAsCnF,KAAtC,CAAR;IACH;;IACD,OAAOc,KAAP;EACH,CAZD;;EAaA9B,UAAU,CAACuF,cAAX,GAA4B,UAAUvE,KAAV,EAAiBV,IAAjB,EAAuBwB,KAAvB,EAA8Bf,UAA9B,EAA0CX,QAA1C,EAAoD;IAC5E,IAAIY,KAAK,CAACE,cAAN,KAAyBd,QAAzB,IAAqC,CAACT,KAAK,CAACqB,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAN,GAAkB,CAAlD,CAAD,CAA3C,IACAL,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAN,GAAkB,CAAlD,EAAqDY,QAArD,KAAkE,OADtE,EAC+E;MAC3E,IAAItC,KAAK,CAACqB,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAN,GAAkB,CAAlD,EAAqD+E,WAAtD,CAAT,EAA6E;QACzEpF,KAAK,CAACE,cAAN,CAAqBL,WAArB,CAAiCP,IAAjC;MACH,CAFD,MAGK;QACDU,KAAK,CAACE,cAAN,CAAqBmD,YAArB,CAAkC/D,IAAlC,EAAwCU,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAN,GAAkB,CAAlD,EAAqD+E,WAA7F;MACH;IACJ,CARD,MASK,IAAIpF,KAAK,CAACE,cAAN,KAAyBd,QAAzB,IAAqC,CAACT,KAAK,CAACqB,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAtC,CAAD,CAA3C,IACLL,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAtC,EAAiDY,QAAjD,KAA8D,OAD7D,EACsE;MACvEjB,KAAK,CAACE,cAAN,CAAqBmD,YAArB,CAAkC/D,IAAlC,EAAwCU,KAAK,CAACE,cAAN,CAAqBkC,UAArB,CAAgCpC,KAAK,CAACK,SAAtC,CAAxC;IACH,CAHI,MAIA,IAAIL,KAAK,CAACE,cAAN,KAAyBF,KAAK,CAACG,YAA/B,IAA+CH,KAAK,CAACE,cAAN,CAAqBoB,QAArB,KAAkC,CAAjF,IACFhC,IAAI,CAACI,UAAL,CAAgBuB,QAAhB,KAA6B,IAD/B,EACqC;MACtC,IAAIjB,KAAK,CAACE,cAAN,CAAqBP,SAArB,CAA+BC,QAA/B,CAAwC,WAAxC,KAAwDI,KAAK,CAACE,cAAN,CAAqBe,QAArB,KAAkC,MAA9F,EAAsG;QAClGjB,KAAK,CAACE,cAAN,CAAqBL,WAArB,CAAiCP,IAAjC;MACH,CAFD,MAGK;QACDU,KAAK,CAACE,cAAN,CAAqBkB,UAArB,CAAgCiC,YAAhC,CAA6C/D,IAA7C,EAAmDU,KAAK,CAACE,cAAzD;MACH;IACJ,CARI,MASA;MACD,IAAImF,SAAS,GAAG,KAAK9B,qBAAL,CAA2BzC,KAAK,CAACA,KAAK,CAACP,MAAN,GAAe,CAAhB,CAAhC,EAAoDnB,QAApD,CAAhB;;MACA,IAAI,CAACT,KAAK,CAAC0G,SAAD,CAAL,IAAoB1G,KAAK,CAAC0G,SAAS,CAAClD,aAAX,CAA1B,KAAwDnC,KAAK,CAACG,YAAN,CAAmBmB,QAAnB,KAAgC,CAA5F,EAA+F;QAC3F+D,SAAS,GAAGrF,KAAK,CAACG,YAAlB;QACAH,KAAK,CAACsF,MAAN,CAAaD,SAAb,EAAwBrF,KAAK,CAACG,YAAN,CAAmBG,WAAnB,CAA+BC,MAAvD;MACH;;MACD,IAAI8E,SAAS,CAACpE,QAAV,KAAuB,MAAvB,IAAiCjB,KAAK,CAACE,cAAN,KAAyBF,KAAK,CAACG,YAAhE,IAAgFH,KAAK,CAACE,cAAN,CAAqBoB,QAArB,KAAkC,CAAtH,EAAyH;QACrH+D,SAAS,GAAGrF,KAAK,CAACE,cAAlB;MACH;;MACD,IAAImF,SAAS,CAACxG,OAAV,CAAkB,IAAlB,KAA2BS,IAA3B,IAAmCA,IAAI,CAACiG,iBAAxC,KACEjG,IAAD,CAAOiG,iBAAP,CAAyB9E,OAAzB,KAAqC,IAArC,IAA6CnB,IAAI,CAACiG,iBAAL,CAAuB9E,OAAvB,KAAmC,IADjF,CAAJ,EAC4F;QACxF,IAAI+E,MAAM,GAAG,KAAK,CAAlB;;QACA,OAAOlG,IAAI,CAACiG,iBAAL,CAAuBE,gBAAvB,IAA2CnG,IAAI,CAACiG,iBAAL,CAAuBE,gBAAvB,CAAwChF,OAAxC,KAAoD,IAAtG,EAA4G;UACxG+E,MAAM,GAAGlG,IAAI,CAACiG,iBAAL,CAAuBE,gBAAhC;UACAD,MAAM,CAACE,KAAP,CAAaC,cAAb,CAA4B,aAA5B;UACAH,MAAM,CAACE,KAAP,CAAaC,cAAb,CAA4B,YAA5B;UACAH,MAAM,CAACE,KAAP,CAAaC,cAAb,CAA4B,eAA5B;UACArG,IAAI,CAACiG,iBAAL,CAAuBK,qBAAvB,CAA6C,UAA7C,EAAyDJ,MAAzD;QACH;MACJ;;MACD,IAAIH,SAAS,CAACpE,QAAV,KAAuB,IAAvB,IAA+BoE,SAAS,CAACpE,QAAV,KAAuB,IAA1D,EAAgE;QAC5D,IAAIgD,QAAQ,GAAGrF,aAAa,CAAC,MAAD,EAAS;UAAEsF,SAAS,EAAE;QAAb,CAAT,CAA5B;QACAlE,KAAK,CAACb,UAAN,CAAiB8E,QAAjB;QACAA,QAAQ,CAAC7C,UAAT,CAAoB4C,YAApB,CAAiC1E,IAAjC,EAAuC2E,QAAvC;MACH,CAJD,MAKK;QACD,IAAI4B,WAAW,GAAG/E,KAAK,CAACA,KAAK,CAACP,MAAN,GAAe,CAAhB,CAAvB;QACA,IAAIuF,UAAU,GAAG,KAAK,CAAtB;;QACA,IAAI,CAACD,WAAW,CAAC5E,QAAZ,KAAyB,IAAzB,IAAiC4E,WAAW,CAAC5E,QAAZ,KAAyB,IAA3D,KAAoE,CAACtC,KAAK,CAACkH,WAAW,CAAC1D,aAAb,CAA1E,IACA0D,WAAW,CAAC1D,aAAZ,CAA0B7B,WAA1B,CAAsCqC,IAAtC,GAA6CpC,MAA7C,KAAwD,CAD5D,EAC+D;UAC3DuF,UAAU,GAAGD,WAAb;QACH,CAHD,MAIK;UACDC,UAAU,GAAG/F,UAAU,CAAC8B,aAAX,CAAyB7B,KAAzB,EAAgCqF,SAAhC,CAAb;QACH;;QACDS,UAAU,CAAC1E,UAAX,CAAsB4C,YAAtB,CAAmC1E,IAAnC,EAAyCwG,UAAzC;MACH;IACJ;EACJ,CA7DD;;EA8DA9G,UAAU,CAACgG,SAAX,GAAuB,UAAUlB,iBAAV,EAA6BxE,IAA7B,EAAmCQ,aAAnC,EAAkDZ,UAAlD,EAA8DE,QAA9D,EAAwE;IAC3F0E,iBAAiB,CAACnE,SAAlB,CAA4BoG,GAA5B,CAAgC,UAAhC;IACA3G,QAAQ,CAACK,SAAT,GAAqBV,cAAc,CAACK,QAAQ,CAACK,SAAV,CAAnC;IACAqE,iBAAiB,GAAG1E,QAAQ,CAACgE,aAAT,CAAuB,WAAvB,CAApB;;IACA,IAAI,CAACzE,KAAK,CAACmF,iBAAD,CAAV,EAA+B;MAC3B,KAAKiB,cAAL,CAAoBjB,iBAApB,EAAuCxE,IAAvC,EAA6CQ,aAA7C,EAA4DZ,UAA5D,EAAwEE,QAAxE;MACA0E,iBAAiB,CAACnE,SAAlB,CAA4BqG,MAA5B,CAAmC,UAAnC;;MACA,IAAIlC,iBAAiB,CAACnE,SAAlB,CAA4BY,MAA5B,KAAuC,CAA3C,EAA8C;QAC1CuD,iBAAiB,CAACmC,eAAlB,CAAkC,OAAlC;MACH;IACJ;EACJ,CAXD;;EAYAjH,UAAU,CAAC6D,UAAX,GAAwB,UAAUvD,IAAV,EAAgBQ,aAAhB,EAA+BZ,UAA/B,EAA2C;IAC/D,IAAIgH,SAAS,GAAG1G,QAAQ,CAAC2G,cAAT,CAAwB,GAAxB,CAAhB;IACA7G,IAAI,CAAC8B,UAAL,CAAgBiC,YAAhB,CAA6B6C,SAA7B,EAAwC5G,IAAI,CAAC8F,WAA7C;IACAtF,aAAa,CAACY,gBAAd,CAA+BxB,UAA/B,EAA2CI,IAAI,CAAC8F,WAAhD,EAA6D9F,IAAI,CAAC8F,WAAlE,EAA+E,CAA/E,EAAkF,CAAlF;EACH,CAJD,CAlYwC,CAuYxC;;;EACApG,UAAU,CAACuE,qBAAX,GAAmC,UAAUjE,IAAV,EAAgBF,QAAhB,EAA0B;IACzD,GAAG;MACCE,IAAI,GAAGA,IAAI,CAAC8B,UAAZ;IACH,CAFD,QAES9B,IAAI,IAAIf,QAAQ,CAACsF,UAAT,CAAoBnC,OAApB,CAA4BpC,IAAI,CAAC2B,QAAL,CAAcU,iBAAd,EAA5B,IAAiE,CAFlF;;IAGA,OAAOrC,IAAP;EACH,CALD;;EAMAN,UAAU,CAAC0E,gBAAX,GAA8B,UAAU0C,GAAV,EAAe;IACzC,IAAIC,YAAY,GAAGD,GAAG,CAAC3G,SAAvB;IACA4G,YAAY,GAAGA,YAAY,CAACC,OAAb,CAAqB,kBAArB,EAAyC,EAAzC,CAAf;IACAF,GAAG,CAAC3G,SAAJ,GAAgB4G,YAAhB;EACH,CAJD;;EAKArH,UAAU,CAACuH,mBAAX,GAAiC,UAAUC,OAAV,EAAmB;IAChD,IAAIC,gBAAJ;;IACA,IAAI,CAAC9H,KAAK,CAAC6H,OAAO,CAACrE,aAAT,CAAV,EAAmC;MAC/B,IAAIqE,OAAO,CAACrE,aAAR,CAAsB7B,WAAtB,CAAkCqC,IAAlC,OAA6C,EAA7C,IAAmD6D,OAAO,CAACrE,aAAR,CAAsBuE,eAAtB,KAA0C,MAAjG,EAAyG;QACrGD,gBAAgB,GAAG,KAAKF,mBAAL,CAAyBC,OAAO,CAACrE,aAAjC,CAAnB;MACH,CAFD,MAGK;QACDsE,gBAAgB,GAAGD,OAAnB;MACH;IACJ,CAPD,MAQK;MACDC,gBAAgB,GAAG,IAAnB;IACH;;IACD,OAAOA,gBAAP;EACH,CAdD;;EAeAzH,UAAU,CAACsD,mBAAX,GAAiC,UAAUkE,OAAV,EAAmB;IAChD,IAAIG,aAAa,GAAGH,OAAO,CAACnC,gBAAR,CAAyB,QAAzB,CAApB;;IACA,KAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+C,aAAa,CAACpG,MAAlC,EAA0CqD,CAAC,EAA3C,EAA+C;MAC3C,IAAI+C,aAAa,CAAC/C,CAAD,CAAb,CAAiBnD,OAAjB,KAA6B,KAA7B,IAAsCkG,aAAa,CAAC/C,CAAD,CAAb,CAAiBnD,OAAjB,KAA6B,IAAnE,IACAkG,aAAa,CAAC/C,CAAD,CAAb,CAAiBnD,OAAjB,KAA6B,QAD7B,IACyCkG,aAAa,CAAC/C,CAAD,CAAb,CAAiBnD,OAAjB,KAA6B,IADtE,IAEAkG,aAAa,CAAC/C,CAAD,CAAb,CAAiBnD,OAAjB,KAA6B,QAF7B,IAEyCkG,aAAa,CAAC/C,CAAD,CAAb,CAAiBnD,OAAjB,KAA6B,IAF1E,EAEgF;QAC5E,IAAImG,iBAAiB,GAAG,KAAKL,mBAAL,CAAyBI,aAAa,CAAC/C,CAAD,CAAtC,CAAxB;;QACA,IAAI,CAACjF,KAAK,CAACiI,iBAAD,CAAV,EAA+B;UAC3BpI,MAAM,CAACoI,iBAAD,CAAN;QACH;MACJ;IACJ;EACJ,CAZD;;EAaA5H,UAAU,CAACmC,UAAX,GAAwB,UAAUqF,OAAV,EAAmBpH,QAAnB,EAA6B;IACjD,IAAIyH,EAAE,GAAGL,OAAT;;IACA,OAAOK,EAAE,IAAIA,EAAE,CAACvF,QAAH,KAAgB,CAA7B,EAAgC;MAC5B,IAAIuF,EAAE,CAACzF,UAAH,KAAkBhC,QAAlB,IACC,CAACT,KAAK,CAACkI,EAAE,CAACzF,UAAH,CAAcX,OAAf,CAAN,IACGlC,QAAQ,CAACuI,iBAAT,CAA2BpF,OAA3B,CAAmCmF,EAAE,CAACzF,UAAH,CAAcX,OAAd,CAAsBkB,iBAAtB,EAAnC,MAAkF,CAAC,CAF3F,EAE+F;QAC3F,OAAOkF,EAAP;MACH;;MACDA,EAAE,GAAGA,EAAE,CAACzF,UAAR;IACH;;IACD,OAAO,IAAP;EACH,CAXD;EAYA;AACJ;AACA;AACA;AACA;;;EAEIpC,UAAU,CAAC4F,UAAX,GAAwB,CAAC,GAAD,EAAM,MAAN,EAAc,SAAd,EAAyB,OAAzB,EAAkC,GAAlC,EAAuC,KAAvC,EAA8C,KAA9C,EAAqD,KAArD,EAA4D,IAA5D,EAAkE,QAAlE,EACpB,QADoB,EACV,MADU,EACF,MADE,EACM,MADN,EACc,UADd,EAC0B,KAD1B,EACiC,KADjC,EACwC,IADxC,EAC8C,OAD9C,EACuD,MADvD,EAC+D,GAD/D,EACoE,QADpE,EAC8E,KAD9E,EACqF,OADrF,EAEpB,KAFoB,EAEb,KAFa,EAEN,OAFM,EAEG,KAFH,EAEU,MAFV,EAEkB,OAFlB,EAE2B,UAF3B,EAEuC,QAFvC,EAEiD,QAFjD,EAE2D,SAF3D,EAEsE,UAFtE,EAGpB,GAHoB,EAGf,MAHe,EAGP,GAHO,EAGF,MAHE,EAGM,QAHN,EAGgB,QAHhB,EAG0B,MAH1B,EAGkC,OAHlC,EAG2C,MAH3C,EAGmD,QAHnD,EAG6D,KAH7D,EAGoE,KAHpE,EAG2E,KAH3E,EAIpB,UAJoB,EAIR,UAJQ,EAII,MAJJ,EAIY,GAJZ,EAIiB,IAJjB,EAIuB,KAJvB,EAI8B,OAJ9B,EAIuC,KAJvC,CAAxB;EAKA,OAAO5F,UAAP;AACH,CAvc+B,EAAhC;;AAwcA,SAASA,UAAT"},"metadata":{},"sourceType":"module"}