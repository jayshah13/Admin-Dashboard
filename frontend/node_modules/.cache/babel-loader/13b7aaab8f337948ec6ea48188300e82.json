{"ast":null,"code":"import * as EVENTS from '../../common/constant';\nimport { createElement, isNullOrUndefined as isNOU, detach } from '@syncfusion/ej2-base';\n/**\n * PasteCleanup for MsWord content\n *\n * @hidden\n\n */\n\nvar MsWordPaste =\n/** @class */\nfunction () {\n  function MsWordPaste(parent) {\n    this.olData = ['decimal', 'lower-alpha', 'lower-roman', 'upper-alpha', 'upper-roman', 'lower-greek'];\n    this.ulData = ['disc', 'square', 'circle', 'disc', 'square', 'circle'];\n    this.ignorableNodes = ['A', 'APPLET', 'B', 'BLOCKQUOTE', 'BR', 'BUTTON', 'CENTER', 'CODE', 'COL', 'COLGROUP', 'DD', 'DEL', 'DFN', 'DIR', 'DIV', 'DL', 'DT', 'EM', 'FIELDSET', 'FONT', 'FORM', 'FRAME', 'FRAMESET', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'HR', 'I', 'IMG', 'IFRAME', 'INPUT', 'INS', 'LABEL', 'LI', 'OL', 'OPTION', 'P', 'PARAM', 'PRE', 'Q', 'S', 'SELECT', 'SPAN', 'STRIKE', 'STRONG', 'SUB', 'SUP', 'TABLE', 'TBODY', 'TD', 'TEXTAREA', 'TFOOT', 'TH', 'THEAD', 'TITLE', 'TR', 'TT', 'U', 'UL'];\n    this.blockNode = ['div', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'address', 'blockquote', 'button', 'center', 'dd', 'dir', 'dl', 'dt', 'fieldset', 'frameset', 'hr', 'iframe', 'isindex', 'li', 'map', 'menu', 'noframes', 'noscript', 'object', 'ol', 'pre', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'ul', 'header', 'article', 'nav', 'footer', 'section', 'aside', 'main', 'figure', 'figcaption'];\n    this.borderStyle = ['border-top', 'border-right', 'border-bottom', 'border-left'];\n    this.removableElements = ['o:p', 'style'];\n    this.listContents = [];\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  MsWordPaste.prototype.addEventListener = function () {\n    this.parent.observer.on(EVENTS.MS_WORD_CLEANUP_PLUGIN, this.wordCleanup, this);\n  };\n\n  MsWordPaste.prototype.wordCleanup = function (e) {\n    var wordPasteStyleConfig = !isNOU(e.allowedStylePropertiesArray) ? e.allowedStylePropertiesArray : [];\n    var listNodes = [];\n    var tempHTMLContent = e.args.clipboardData.getData('text/HTML');\n    var rtfData = e.args.clipboardData.getData('text/rtf');\n    var elm = createElement('p');\n    elm.setAttribute('id', 'MSWord-Content');\n    elm.innerHTML = tempHTMLContent;\n    var patern = /class='?Mso|style='[^ ]*\\bmso-/i;\n    var patern2 = /class=\"?Mso|style=\"[^ ]*\\bmso-/i;\n    var patern3 = /(class=\"?Mso|class='?Mso|class=\"?Xl|class='?Xl|class=Xl|style=\"[^\"]*\\bmso-|style='[^']*\\bmso-|w:WordDocument)/gi;\n    var pattern4 = /style='mso-width-source:/i;\n\n    if (patern.test(tempHTMLContent) || patern2.test(tempHTMLContent) || patern3.test(tempHTMLContent) || pattern4.test(tempHTMLContent)) {\n      this.imageConversion(elm, rtfData);\n      tempHTMLContent = tempHTMLContent.replace(/<img[^>]+>/i, '');\n      this.addListClass(elm);\n      listNodes = this.cleanUp(elm, listNodes);\n\n      if (!isNOU(listNodes[0]) && listNodes[0].parentElement.tagName !== 'UL' && listNodes[0].parentElement.tagName !== 'OL') {\n        this.listConverter(listNodes);\n      }\n\n      this.styleCorrection(elm, wordPasteStyleConfig);\n      this.removingComments(elm);\n      this.removeUnwantedElements(elm);\n      this.removeEmptyElements(elm);\n      this.breakLineAddition(elm);\n      this.removeClassName(elm);\n\n      if (pattern4.test(tempHTMLContent)) {\n        this.addTableBorderClass(elm);\n      }\n\n      e.callBack(elm.innerHTML);\n    } else {\n      e.callBack(elm.innerHTML);\n    }\n  };\n\n  MsWordPaste.prototype.addListClass = function (elm) {\n    var allNodes = elm.querySelectorAll('*');\n\n    for (var index = 0; index < allNodes.length; index++) {\n      if (!isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').replace(/ /g, '').replace('\\n', '').indexOf('mso-list:l') >= 0 && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') === -1 && allNodes[index].tagName.charAt(0) !== 'H') {\n        allNodes[index].classList.add('msolistparagraph');\n      }\n    }\n  };\n\n  MsWordPaste.prototype.addTableBorderClass = function (elm) {\n    var allTableElm = elm.querySelectorAll('table');\n    var hasTableBorder = false;\n\n    for (var i = 0; i < allTableElm.length; i++) {\n      for (var j = 0; j < this.borderStyle.length; j++) {\n        if (allTableElm[i].innerHTML.indexOf(this.borderStyle[j]) >= 0) {\n          hasTableBorder = true;\n          break;\n        }\n      }\n\n      if (hasTableBorder) {\n        allTableElm[i].classList.add('e-rte-table-border');\n        hasTableBorder = false;\n      }\n    }\n  };\n\n  MsWordPaste.prototype.imageConversion = function (elm, rtfData) {\n    this.checkVShape(elm);\n    var imgElem = elm.querySelectorAll('img');\n    var imgSrc = [];\n    var base64Src = [];\n    var imgName = []; // eslint-disable-next-line\n\n    var linkRegex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n\n    if (imgElem.length > 0) {\n      for (var i = 0; i < imgElem.length; i++) {\n        imgSrc.push(imgElem[i].getAttribute('src'));\n        imgName.push(imgElem[i].getAttribute('src').split('/')[imgElem[i].getAttribute('src').split('/').length - 1].split('.')[0]);\n      }\n\n      var hexValue = this.hexConversion(rtfData);\n\n      for (var i = 0; i < hexValue.length; i++) {\n        base64Src.push(this.convertToBase64(hexValue[i]));\n      }\n\n      for (var i = 0; i < imgElem.length; i++) {\n        if (imgSrc[i].match(linkRegex)) {\n          imgElem[i].setAttribute('src', imgSrc[i]);\n        } else {\n          imgElem[i].setAttribute('src', base64Src[i]);\n        }\n\n        imgElem[i].setAttribute('id', 'msWordImg-' + imgName[i]);\n      }\n    }\n  };\n\n  MsWordPaste.prototype.checkVShape = function (elm) {\n    var allNodes = elm.querySelectorAll('*');\n\n    for (var i = 0; i < allNodes.length; i++) {\n      switch (allNodes[i].nodeName) {\n        case 'V:SHAPETYPE':\n          detach(allNodes[i]);\n          break;\n\n        case 'V:SHAPE':\n          if (allNodes[i].firstElementChild.nodeName === 'V:IMAGEDATA') {\n            var src = allNodes[i].firstElementChild.getAttribute('src');\n            var imgElement = createElement('img');\n            imgElement.setAttribute('src', src);\n            allNodes[i].parentElement.insertBefore(imgElement, allNodes[i]);\n            detach(allNodes[i]);\n          }\n\n          break;\n      }\n    }\n  };\n\n  MsWordPaste.prototype.convertToBase64 = function (hexValue) {\n    var byteArr = this.conHexStringToBytes(hexValue.hex);\n    var base64String = this.conBytesToBase64(byteArr);\n    var base64 = hexValue.type ? 'data:' + hexValue.type + ';base64,' + base64String : null;\n    return base64;\n  };\n\n  MsWordPaste.prototype.conBytesToBase64 = function (byteArr) {\n    var base64Str = '';\n    var base64Char = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n    var byteArrLen = byteArr.length;\n\n    for (var i = 0; i < byteArrLen; i += 3) {\n      var array3 = byteArr.slice(i, i + 3);\n      var array3length = array3.length;\n      var array4 = [];\n\n      if (array3length < 3) {\n        for (var j = array3length; j < 3; j++) {\n          array3[j] = 0;\n        }\n      }\n\n      array4[0] = (array3[0] & 0xFC) >> 2;\n      array4[1] = (array3[0] & 0x03) << 4 | array3[1] >> 4;\n      array4[2] = (array3[1] & 0x0F) << 2 | (array3[2] & 0xC0) >> 6;\n      array4[3] = array3[2] & 0x3F;\n\n      for (var j = 0; j < 4; j++) {\n        if (j <= array3length) {\n          base64Str += base64Char.charAt(array4[j]);\n        } else {\n          base64Str += '=';\n        }\n      }\n    }\n\n    return base64Str;\n  };\n\n  MsWordPaste.prototype.conHexStringToBytes = function (hex) {\n    var byteArr = [];\n    var byteArrLen = hex.length / 2;\n\n    for (var i = 0; i < byteArrLen; i++) {\n      byteArr.push(parseInt(hex.substr(i * 2, 2), 16));\n    }\n\n    return byteArr;\n  };\n\n  MsWordPaste.prototype.hexConversion = function (rtfData) {\n    // eslint-disable-next-line\n    var picHead = /\\{\\\\pict[\\s\\S]+?\\\\bliptag\\-?\\d+(\\\\blipupi\\-?\\d+)?(\\{\\\\\\*\\\\blipuid\\s?[\\da-fA-F]+)?[\\s\\}]*?/;\n    var pic = new RegExp('(?:(' + picHead.source + '))([\\\\da-fA-F\\\\s]+)\\\\}', 'g');\n    var fullImg = rtfData.match(pic);\n    var imgType;\n    var result = [];\n\n    if (!isNOU(fullImg)) {\n      for (var i = 0; i < fullImg.length; i++) {\n        if (picHead.test(fullImg[i])) {\n          if (fullImg[i].indexOf('\\\\pngblip') !== -1) {\n            imgType = 'image/png';\n          } else if (fullImg[i].indexOf('\\\\jpegblip') !== -1) {\n            imgType = 'image/jpeg';\n          } else {\n            continue;\n          }\n\n          result.push({\n            hex: imgType ? fullImg[i].replace(picHead, '').replace(/[^\\da-fA-F]/g, '') : null,\n            type: imgType\n          });\n        }\n      }\n    }\n\n    return result;\n  };\n\n  MsWordPaste.prototype.removeClassName = function (elm) {\n    var elmWithClass = elm.querySelectorAll('*[class]');\n\n    for (var i = 0; i < elmWithClass.length; i++) {\n      elmWithClass[i].removeAttribute('class');\n    }\n  };\n\n  MsWordPaste.prototype.breakLineAddition = function (elm) {\n    var allElements = elm.querySelectorAll('*');\n\n    for (var i = 0; i < allElements.length; i++) {\n      if (allElements[i].children.length === 0 && allElements[i].innerHTML === '&nbsp;' && allElements[i].innerHTML === '&nbsp;' && !allElements[i].closest('li') && !allElements[i].closest('td')) {\n        var detachableElement = this.findDetachElem(allElements[i]);\n        var brElement = createElement('br');\n\n        if (!isNOU(detachableElement.parentElement)) {\n          detachableElement.parentElement.insertBefore(brElement, detachableElement);\n          detach(detachableElement);\n        }\n      }\n    }\n  };\n\n  MsWordPaste.prototype.findDetachElem = function (element) {\n    var removableElement;\n\n    if (!isNOU(element.parentElement) && element.parentElement.textContent.trim() === '' && element.parentElement.tagName !== 'TD' && isNOU(element.parentElement.querySelector('img'))) {\n      removableElement = this.findDetachElem(element.parentElement);\n    } else {\n      removableElement = element;\n    }\n\n    return removableElement;\n  };\n\n  MsWordPaste.prototype.removeUnwantedElements = function (elm) {\n    var innerElement = elm.innerHTML;\n\n    for (var i = 0; i < this.removableElements.length; i++) {\n      var regExpStartElem = new RegExp('<' + this.removableElements[i] + '>', 'g');\n      var regExpEndElem = new RegExp('</' + this.removableElements[i] + '>', 'g');\n      innerElement = innerElement.replace(regExpStartElem, '');\n      innerElement = innerElement.replace(regExpEndElem, '');\n    }\n\n    elm.innerHTML = innerElement;\n    elm.querySelectorAll(':empty');\n  };\n\n  MsWordPaste.prototype.findDetachEmptyElem = function (element) {\n    var removableElement;\n\n    if (!isNOU(element.parentElement)) {\n      if (element.parentElement.textContent.trim() === '' && element.parentElement.getAttribute('id') !== 'MSWord-Content' && isNOU(element.parentElement.querySelector('img'))) {\n        removableElement = this.findDetachEmptyElem(element.parentElement);\n      } else {\n        removableElement = element;\n      }\n    } else {\n      removableElement = null;\n    }\n\n    return removableElement;\n  };\n\n  MsWordPaste.prototype.removeEmptyElements = function (element) {\n    var emptyElements = element.querySelectorAll(':empty');\n\n    for (var i = 0; i < emptyElements.length; i++) {\n      if (!isNOU(emptyElements[i].closest('td')) && !isNOU(emptyElements[i].closest('td').querySelector('.MsoNormal'))) {\n        emptyElements[i].innerHTML = '-';\n      }\n\n      if (emptyElements[i].tagName !== 'IMG' && emptyElements[i].tagName !== 'BR' && emptyElements[i].tagName !== 'IFRAME' && emptyElements[i].tagName !== 'TD' && emptyElements[i].tagName !== 'HR') {\n        var detachableElement = this.findDetachEmptyElem(emptyElements[i]);\n\n        if (!isNOU(detachableElement)) {\n          detach(detachableElement);\n        }\n      }\n    }\n  };\n\n  MsWordPaste.prototype.styleCorrection = function (elm, wordPasteStyleConfig) {\n    var styleElement = elm.querySelectorAll('style');\n\n    if (styleElement.length > 0) {\n      var styles = styleElement[0].innerHTML.match(/[\\S ]+\\s+{[\\s\\S]+?}/gi);\n      var styleClassObject_1 = !isNOU(styles) ? this.findStyleObject(styles) : null;\n      var keys = Object.keys(styleClassObject_1);\n      var values = keys.map(function (key) {\n        return styleClassObject_1[key];\n      });\n      values = this.removeUnwantedStyle(values, wordPasteStyleConfig);\n      this.filterStyles(elm, wordPasteStyleConfig);\n      var resultElem = void 0;\n      var fromClass = false;\n\n      for (var i = 0; i < keys.length; i++) {\n        if (keys[i].split('.')[0] === '') {\n          resultElem = elm.getElementsByClassName(keys[i].split('.')[1]);\n          fromClass = true;\n        } else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') >= 0) {\n          continue;\n        } else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') < 0) {\n          resultElem = elm.getElementsByTagName(keys[i]);\n        } else {\n          resultElem = elm.querySelectorAll(keys[i]);\n        }\n\n        for (var j = 0; j < resultElem.length; j++) {\n          var styleProperty = resultElem[j].getAttribute('style');\n\n          if (!isNOU(styleProperty) && styleProperty.trim() !== '') {\n            var valueSplit = values[i].split(';');\n\n            if (!fromClass) {\n              for (var k = 0; k < valueSplit.length; k++) {\n                if (styleProperty.indexOf(valueSplit[k].split(':')[0]) >= 0) {\n                  valueSplit.splice(k, 1);\n                  k--;\n                }\n              }\n            }\n\n            values[i] = valueSplit.join(';') + ';';\n            var changedValue = styleProperty + values[i];\n            resultElem[j].setAttribute('style', changedValue);\n          } else {\n            values[i] = values[i].replace(/text-indent:-(.*?)(?=;|$)/gm, '');\n            resultElem[j].setAttribute('style', values[i]);\n          }\n        }\n\n        fromClass = false;\n      }\n    }\n  };\n\n  MsWordPaste.prototype.filterStyles = function (elm, wordPasteStyleConfig) {\n    var elmWithStyles = elm.querySelectorAll('*[style]');\n\n    for (var i = 0; i < elmWithStyles.length; i++) {\n      var elemStyleProperty = elmWithStyles[i].getAttribute('style').split(';');\n      var styleValue = '';\n\n      for (var j = 0; j < elemStyleProperty.length; j++) {\n        if (wordPasteStyleConfig.indexOf(elemStyleProperty[j].split(':')[0].trim()) >= 0) {\n          styleValue += elemStyleProperty[j] + ';';\n        }\n      }\n\n      elmWithStyles[i].setAttribute('style', styleValue);\n    }\n  };\n\n  MsWordPaste.prototype.removeUnwantedStyle = function (values, wordPasteStyleConfig) {\n    for (var i = 0; i < values.length; i++) {\n      var styleValues = values[i].split(';');\n      values[i] = '';\n\n      for (var j = 0; j < styleValues.length; j++) {\n        if (wordPasteStyleConfig.indexOf(styleValues[j].split(':')[0]) >= 0) {\n          values[i] += styleValues[j] + ';';\n        }\n      }\n    }\n\n    return values;\n  };\n\n  MsWordPaste.prototype.findStyleObject = function (styles) {\n    var styleClassObject = {};\n\n    for (var i = 0; i < styles.length; i++) {\n      var tempStyle = styles[i];\n      var classNameCollection = tempStyle.replace(/([\\S ]+\\s+){[\\s\\S]+?}/gi, '$1');\n      var stylesCollection = tempStyle.replace(/[\\S ]+\\s+{([\\s\\S]+?)}/gi, '$1');\n      classNameCollection = classNameCollection.replace(/^[\\s]|[\\s]$/gm, '');\n      stylesCollection = stylesCollection.replace(/^[\\s]|[\\s]$/gm, '');\n      classNameCollection = classNameCollection.replace(/\\n|\\r|\\n\\r/g, '');\n      stylesCollection = stylesCollection.replace(/\\n|\\r|\\n\\r/g, '');\n\n      for (var classNames = classNameCollection.split(', '), j = 0; j < classNames.length; j++) {\n        styleClassObject[classNames[j]] = stylesCollection;\n      }\n    }\n\n    return styleClassObject;\n  };\n\n  MsWordPaste.prototype.removingComments = function (elm) {\n    var innerElement = elm.innerHTML;\n    innerElement = innerElement.replace(/<!--[\\s\\S]*?-->/g, '');\n    elm.innerHTML = innerElement;\n  };\n\n  MsWordPaste.prototype.cleanUp = function (node, listNodes) {\n    // eslint-disable-next-line\n    var temp = '';\n    var tempCleaner = [];\n    var prevflagState;\n    var allNodes = node.querySelectorAll('*');\n\n    for (var index = 0; index < allNodes.length; index++) {\n      if (this.ignorableNodes.indexOf(allNodes[index].nodeName) === -1 || allNodes[index].nodeType === 3 && allNodes[index].textContent.trim() === '') {\n        tempCleaner.push(allNodes[index]);\n        continue;\n      } else if (allNodes[index].className && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && allNodes[index].childElementCount !== 1 && !isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n        if (allNodes[index].className.indexOf('MsoListParagraphCxSpFirst') >= 0 && listNodes.length > 0 && listNodes[listNodes.length - 1] !== null) {\n          listNodes.push(null);\n        }\n\n        listNodes.push(allNodes[index]);\n      }\n\n      if (prevflagState && this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1 && !(allNodes[index].className && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0)) {\n        listNodes.push(null);\n      }\n\n      if (this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1) {\n        if (allNodes[index].className && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n          prevflagState = true;\n        } else {\n          prevflagState = false;\n        }\n      }\n    }\n\n    if (listNodes.length && listNodes[listNodes.length - 1] !== null) {\n      listNodes.push(null);\n    }\n\n    return listNodes;\n  };\n\n  MsWordPaste.prototype.listConverter = function (listNodes) {\n    var level;\n    var data = [];\n    var collection = [];\n    var content = '';\n    var stNode;\n    var currentListStyle = '';\n\n    for (var i = 0; i < listNodes.length; i++) {\n      if (listNodes[i] === null) {\n        data.push({\n          content: this.makeConversion(collection),\n          node: listNodes[i - 1]\n        });\n        collection = [];\n        continue;\n      }\n\n      if (listNodes[i].getAttribute('style') && listNodes[i].getAttribute('style').indexOf('mso-outline-level') !== -1) {\n        listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('mso-outline-level', 'mso-outline'));\n      }\n\n      content = listNodes[i].getAttribute('style');\n\n      if (content && content.indexOf('level') !== -1) {\n        // eslint-disable-next-line\n        level = parseInt(content.charAt(content.indexOf('level') + 5), null);\n      } else {\n        level = 1;\n      }\n\n      this.listContents = [];\n      this.getListContent(listNodes[i]);\n      var type = void 0;\n      var listStyleType = void 0;\n\n      if (!isNOU(this.listContents[0])) {\n        type = this.listContents[0].trim().length > 1 ? 'ol' : 'ul';\n        listStyleType = this.getlistStyleType(this.listContents[0], type);\n        var tempNode = [];\n\n        for (var j = 1; j < this.listContents.length; j++) {\n          tempNode.push(this.listContents[j]);\n        }\n\n        var currentClassName = void 0;\n\n        if (!isNOU(listNodes[i].className)) {\n          currentClassName = listNodes[i].className;\n        }\n\n        if (!isNOU(listNodes[i].getAttribute('style'))) {\n          listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('text-align:start;', ''));\n\n          if (listNodes[i].style.textAlign !== '') {\n            listNodes[i].setAttribute('style', 'text-align:' + listNodes[i].style.textAlign);\n            currentListStyle = listNodes[i].getAttribute('style');\n          }\n        }\n\n        collection.push({\n          listType: type,\n          content: tempNode,\n          nestedLevel: level,\n          class: currentClassName,\n          listStyle: currentListStyle,\n          listStyleTypeName: listStyleType\n        });\n      }\n    }\n\n    stNode = listNodes.shift();\n\n    while (stNode) {\n      var elemColl = [];\n\n      for (var temp1 = 0; temp1 < data.length; temp1++) {\n        if (data[temp1].node === stNode) {\n          for (var index = 0; index < data[temp1].content.childNodes.length; index++) {\n            elemColl.push(data[temp1].content.childNodes[index]);\n          }\n\n          for (var index = 0; index < elemColl.length; index++) {\n            stNode.parentElement.insertBefore(elemColl[index], stNode);\n          }\n\n          break;\n        }\n      }\n\n      stNode.remove();\n      stNode = listNodes.shift();\n\n      if (!stNode) {\n        stNode = listNodes.shift();\n      }\n    }\n  };\n\n  MsWordPaste.prototype.getlistStyleType = function (listContent, type) {\n    var currentListClass;\n\n    if (type === 'ol') {\n      switch (listContent.split('.')[0]) {\n        case \"A\":\n          currentListClass = \"upper-alpha\";\n          break;\n\n        case \"a\":\n          currentListClass = \"lower-alpha\";\n          break;\n\n        case \"I\":\n          currentListClass = \"upper-roman\";\n          break;\n\n        case \"i\":\n          currentListClass = \"lower-roman\";\n          break;\n\n        case \"ฮฑ\":\n          currentListClass = \"lower-greek\";\n          break;\n\n        default:\n          currentListClass = \"decimal\";\n          break;\n      }\n    } else {\n      switch (listContent.split('.')[0]) {\n        case \"o\":\n          currentListClass = \"circle\";\n          break;\n\n        case \"ยง\":\n          currentListClass = \"square\";\n          break;\n\n        default:\n          currentListClass = \"disc\";\n          break;\n      }\n    }\n\n    return currentListClass;\n  };\n\n  MsWordPaste.prototype.makeConversion = function (collection) {\n    var root = createElement('div');\n    var temp;\n    var pLevel = 1;\n    var prevList;\n    var listCount = 0;\n    var elem;\n\n    for (var index = 0; index < collection.length; index++) {\n      var pElement = createElement('p');\n      pElement.innerHTML = collection[index].content.join(' ');\n\n      if (collection[index].nestedLevel === 1 && listCount === 0 && collection[index].content) {\n        root.appendChild(temp = createElement(collection[index].listType));\n        prevList = createElement('li');\n        prevList.appendChild(pElement);\n        temp.appendChild(prevList);\n        temp.setAttribute('level', collection[index].nestedLevel.toString());\n        temp.style.listStyleType = collection[index].listStyleTypeName;\n      } else if (collection[index].nestedLevel === pLevel) {\n        if (prevList.parentElement.tagName.toLowerCase() === collection[index].listType) {\n          prevList.parentElement.appendChild(prevList = createElement('li'));\n          prevList.appendChild(pElement);\n        } else {\n          temp = createElement(collection[index].listType);\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n          prevList.parentElement.parentElement.appendChild(temp);\n          prevList = createElement('li');\n          prevList.appendChild(pElement);\n          temp.appendChild(prevList);\n          temp.setAttribute('level', collection[index].nestedLevel.toString());\n        }\n      } else if (collection[index].nestedLevel > pLevel) {\n        if (!isNOU(prevList)) {\n          for (var j = 0; j < collection[index].nestedLevel - pLevel; j++) {\n            prevList.appendChild(temp = createElement(collection[index].listType));\n            prevList = createElement('li');\n\n            if (j != collection[index].nestedLevel - pLevel - 1 && collection[index].nestedLevel - pLevel > 1) {\n              prevList.style.listStyleType = \"none\";\n            }\n\n            temp.appendChild(prevList);\n          }\n\n          prevList.appendChild(pElement);\n          temp.setAttribute('level', collection[index].nestedLevel.toString());\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n        } else {\n          root.appendChild(temp = createElement(collection[index].listType));\n          prevList = createElement('li');\n          prevList.appendChild(pElement);\n          temp.appendChild(prevList);\n          temp.setAttribute('level', collection[index].nestedLevel.toString());\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n        }\n      } else if (collection[index].nestedLevel === 1) {\n        if (root.lastChild.tagName.toLowerCase() === collection[index].listType) {\n          temp = root.lastChild;\n        } else {\n          root.appendChild(temp = createElement(collection[index].listType));\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n        }\n\n        prevList = createElement('li');\n        prevList.appendChild(pElement);\n        temp.appendChild(prevList);\n        temp.setAttribute('level', collection[index].nestedLevel.toString());\n      } else {\n        elem = prevList;\n\n        while (elem.parentElement) {\n          elem = elem.parentElement;\n\n          if (elem.attributes.getNamedItem('level')) {\n            // eslint-disable-next-line\n            if (parseInt(elem.attributes.getNamedItem('level').textContent, null) === collection[index].nestedLevel) {\n              prevList = createElement('li');\n              prevList.appendChild(pElement);\n              elem.appendChild(prevList);\n              break; // eslint-disable-next-line\n            } else if (collection[index].nestedLevel > parseInt(elem.attributes.getNamedItem('level').textContent, null)) {\n              elem.appendChild(temp = createElement(collection[index].listType));\n              prevList = createElement('li');\n              prevList.appendChild(pElement);\n              temp.appendChild(prevList);\n              temp.setAttribute('level', collection[index].nestedLevel.toString());\n              temp.style.listStyleType = collection[index].listStyleTypeName;\n              break;\n            }\n          }\n\n          continue;\n        }\n      }\n\n      prevList.setAttribute('class', collection[index].class);\n      var currentStyle = prevList.getAttribute('style');\n      prevList.setAttribute('style', !isNOU(currentStyle) ? currentStyle : '');\n      pLevel = collection[index].nestedLevel;\n      listCount++;\n    }\n\n    return root;\n  };\n\n  MsWordPaste.prototype.getListContent = function (elem) {\n    var pushContent = '';\n    var firstChild = elem.firstElementChild;\n\n    if (firstChild.textContent.trim() === '' && !isNOU(firstChild.firstElementChild) && firstChild.firstElementChild.nodeName === 'IMG') {\n      pushContent = elem.innerHTML.trim();\n      this.listContents.push('');\n      this.listContents.push(pushContent);\n    } else {\n      var styleNodes = ['b', 'em'];\n\n      if (firstChild.childNodes.length > 0 && (firstChild.querySelectorAll('b').length > 0 || firstChild.querySelectorAll('em').length > 0)) {\n        for (var i = 0; i < firstChild.childNodes.length; i++) {\n          var nodeName = firstChild.childNodes[i].nodeName.toLowerCase();\n\n          if (firstChild.childNodes[i].textContent.trim().length > 1 && styleNodes.indexOf(nodeName) !== -1) {\n            pushContent = '<' + nodeName + '>' + firstChild.childNodes[i].textContent + '</' + nodeName + '>';\n            this.listContents.push(pushContent);\n          } else if (firstChild.childNodes[i].textContent.trim().length === 1) {\n            this.listContents.push(firstChild.childNodes[i].textContent.trim());\n          }\n        }\n      } else {\n        pushContent = firstChild.textContent.trim();\n        this.listContents.push(pushContent);\n      }\n    }\n\n    detach(firstChild);\n    this.listContents.push(elem.innerHTML);\n  };\n\n  return MsWordPaste;\n}();\n\nexport { MsWordPaste };","map":{"version":3,"names":["EVENTS","createElement","isNullOrUndefined","isNOU","detach","MsWordPaste","parent","olData","ulData","ignorableNodes","blockNode","borderStyle","removableElements","listContents","addEventListener","prototype","observer","on","MS_WORD_CLEANUP_PLUGIN","wordCleanup","e","wordPasteStyleConfig","allowedStylePropertiesArray","listNodes","tempHTMLContent","args","clipboardData","getData","rtfData","elm","setAttribute","innerHTML","patern","patern2","patern3","pattern4","test","imageConversion","replace","addListClass","cleanUp","parentElement","tagName","listConverter","styleCorrection","removingComments","removeUnwantedElements","removeEmptyElements","breakLineAddition","removeClassName","addTableBorderClass","callBack","allNodes","querySelectorAll","index","length","getAttribute","indexOf","className","toLowerCase","charAt","classList","add","allTableElm","hasTableBorder","i","j","checkVShape","imgElem","imgSrc","base64Src","imgName","linkRegex","RegExp","push","split","hexValue","hexConversion","convertToBase64","match","nodeName","firstElementChild","src","imgElement","insertBefore","byteArr","conHexStringToBytes","hex","base64String","conBytesToBase64","base64","type","base64Str","base64Char","byteArrLen","array3","slice","array3length","array4","parseInt","substr","picHead","pic","source","fullImg","imgType","result","elmWithClass","removeAttribute","allElements","children","closest","detachableElement","findDetachElem","brElement","element","removableElement","textContent","trim","querySelector","innerElement","regExpStartElem","regExpEndElem","findDetachEmptyElem","emptyElements","styleElement","styles","styleClassObject_1","findStyleObject","keys","Object","values","map","key","removeUnwantedStyle","filterStyles","resultElem","fromClass","getElementsByClassName","getElementsByTagName","styleProperty","valueSplit","k","splice","join","changedValue","elmWithStyles","elemStyleProperty","styleValue","styleValues","styleClassObject","tempStyle","classNameCollection","stylesCollection","classNames","node","temp","tempCleaner","prevflagState","nodeType","childElementCount","level","data","collection","content","stNode","currentListStyle","makeConversion","getListContent","listStyleType","getlistStyleType","tempNode","currentClassName","style","textAlign","listType","nestedLevel","class","listStyle","listStyleTypeName","shift","elemColl","temp1","childNodes","remove","listContent","currentListClass","root","pLevel","prevList","listCount","elem","pElement","appendChild","toString","lastChild","attributes","getNamedItem","currentStyle","pushContent","firstChild","styleNodes"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/ms-word-clean-up.js"],"sourcesContent":["import * as EVENTS from '../../common/constant';\nimport { createElement, isNullOrUndefined as isNOU, detach } from '@syncfusion/ej2-base';\n/**\n * PasteCleanup for MsWord content\n *\n * @hidden\n\n */\nvar MsWordPaste = /** @class */ (function () {\n    function MsWordPaste(parent) {\n        this.olData = [\n            'decimal',\n            'lower-alpha',\n            'lower-roman',\n            'upper-alpha',\n            'upper-roman',\n            'lower-greek'\n        ];\n        this.ulData = [\n            'disc',\n            'square',\n            'circle',\n            'disc',\n            'square',\n            'circle'\n        ];\n        this.ignorableNodes = ['A', 'APPLET', 'B', 'BLOCKQUOTE', 'BR',\n            'BUTTON', 'CENTER', 'CODE', 'COL', 'COLGROUP', 'DD', 'DEL', 'DFN', 'DIR', 'DIV',\n            'DL', 'DT', 'EM', 'FIELDSET', 'FONT', 'FORM', 'FRAME', 'FRAMESET', 'H1', 'H2',\n            'H3', 'H4', 'H5', 'H6', 'HR', 'I', 'IMG', 'IFRAME', 'INPUT', 'INS', 'LABEL',\n            'LI', 'OL', 'OPTION', 'P', 'PARAM', 'PRE', 'Q', 'S', 'SELECT', 'SPAN', 'STRIKE',\n            'STRONG', 'SUB', 'SUP', 'TABLE', 'TBODY', 'TD', 'TEXTAREA', 'TFOOT', 'TH',\n            'THEAD', 'TITLE', 'TR', 'TT', 'U', 'UL'];\n        this.blockNode = ['div', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6',\n            'address', 'blockquote', 'button', 'center', 'dd', 'dir', 'dl', 'dt', 'fieldset',\n            'frameset', 'hr', 'iframe', 'isindex', 'li', 'map', 'menu', 'noframes', 'noscript',\n            'object', 'ol', 'pre', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'ul',\n            'header', 'article', 'nav', 'footer', 'section', 'aside', 'main', 'figure', 'figcaption'];\n        this.borderStyle = ['border-top', 'border-right', 'border-bottom', 'border-left'];\n        this.removableElements = ['o:p', 'style'];\n        this.listContents = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    MsWordPaste.prototype.addEventListener = function () {\n        this.parent.observer.on(EVENTS.MS_WORD_CLEANUP_PLUGIN, this.wordCleanup, this);\n    };\n    MsWordPaste.prototype.wordCleanup = function (e) {\n        var wordPasteStyleConfig = !isNOU(e.allowedStylePropertiesArray) ? e.allowedStylePropertiesArray : [];\n        var listNodes = [];\n        var tempHTMLContent = e.args.clipboardData.getData('text/HTML');\n        var rtfData = e.args.clipboardData.getData('text/rtf');\n        var elm = createElement('p');\n        elm.setAttribute('id', 'MSWord-Content');\n        elm.innerHTML = tempHTMLContent;\n        var patern = /class='?Mso|style='[^ ]*\\bmso-/i;\n        var patern2 = /class=\"?Mso|style=\"[^ ]*\\bmso-/i;\n        var patern3 = /(class=\"?Mso|class='?Mso|class=\"?Xl|class='?Xl|class=Xl|style=\"[^\"]*\\bmso-|style='[^']*\\bmso-|w:WordDocument)/gi;\n        var pattern4 = /style='mso-width-source:/i;\n        if (patern.test(tempHTMLContent) || patern2.test(tempHTMLContent) || patern3.test(tempHTMLContent) ||\n            pattern4.test(tempHTMLContent)) {\n            this.imageConversion(elm, rtfData);\n            tempHTMLContent = tempHTMLContent.replace(/<img[^>]+>/i, '');\n            this.addListClass(elm);\n            listNodes = this.cleanUp(elm, listNodes);\n            if (!isNOU(listNodes[0]) && listNodes[0].parentElement.tagName !== 'UL' &&\n                listNodes[0].parentElement.tagName !== 'OL') {\n                this.listConverter(listNodes);\n            }\n            this.styleCorrection(elm, wordPasteStyleConfig);\n            this.removingComments(elm);\n            this.removeUnwantedElements(elm);\n            this.removeEmptyElements(elm);\n            this.breakLineAddition(elm);\n            this.removeClassName(elm);\n            if (pattern4.test(tempHTMLContent)) {\n                this.addTableBorderClass(elm);\n            }\n            e.callBack(elm.innerHTML);\n        }\n        else {\n            e.callBack(elm.innerHTML);\n        }\n    };\n    MsWordPaste.prototype.addListClass = function (elm) {\n        var allNodes = elm.querySelectorAll('*');\n        for (var index = 0; index < allNodes.length; index++) {\n            if (!isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').replace(/ /g, '').replace('\\n', '').indexOf('mso-list:l') >= 0 &&\n                allNodes[index].className.toLowerCase().indexOf('msolistparagraph') === -1 && allNodes[index].tagName.charAt(0) !== 'H') {\n                allNodes[index].classList.add('msolistparagraph');\n            }\n        }\n    };\n    MsWordPaste.prototype.addTableBorderClass = function (elm) {\n        var allTableElm = elm.querySelectorAll('table');\n        var hasTableBorder = false;\n        for (var i = 0; i < allTableElm.length; i++) {\n            for (var j = 0; j < this.borderStyle.length; j++) {\n                if (allTableElm[i].innerHTML.indexOf(this.borderStyle[j]) >= 0) {\n                    hasTableBorder = true;\n                    break;\n                }\n            }\n            if (hasTableBorder) {\n                allTableElm[i].classList.add('e-rte-table-border');\n                hasTableBorder = false;\n            }\n        }\n    };\n    MsWordPaste.prototype.imageConversion = function (elm, rtfData) {\n        this.checkVShape(elm);\n        var imgElem = elm.querySelectorAll('img');\n        var imgSrc = [];\n        var base64Src = [];\n        var imgName = [];\n        // eslint-disable-next-line\n        var linkRegex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n        if (imgElem.length > 0) {\n            for (var i = 0; i < imgElem.length; i++) {\n                imgSrc.push(imgElem[i].getAttribute('src'));\n                imgName.push(imgElem[i].getAttribute('src').split('/')[imgElem[i].getAttribute('src').split('/').length - 1].split('.')[0]);\n            }\n            var hexValue = this.hexConversion(rtfData);\n            for (var i = 0; i < hexValue.length; i++) {\n                base64Src.push(this.convertToBase64(hexValue[i]));\n            }\n            for (var i = 0; i < imgElem.length; i++) {\n                if (imgSrc[i].match(linkRegex)) {\n                    imgElem[i].setAttribute('src', imgSrc[i]);\n                }\n                else {\n                    imgElem[i].setAttribute('src', base64Src[i]);\n                }\n                imgElem[i].setAttribute('id', 'msWordImg-' + imgName[i]);\n            }\n        }\n    };\n    MsWordPaste.prototype.checkVShape = function (elm) {\n        var allNodes = elm.querySelectorAll('*');\n        for (var i = 0; i < allNodes.length; i++) {\n            switch (allNodes[i].nodeName) {\n                case 'V:SHAPETYPE':\n                    detach(allNodes[i]);\n                    break;\n                case 'V:SHAPE':\n                    if (allNodes[i].firstElementChild.nodeName === 'V:IMAGEDATA') {\n                        var src = allNodes[i].firstElementChild.getAttribute('src');\n                        var imgElement = createElement('img');\n                        imgElement.setAttribute('src', src);\n                        allNodes[i].parentElement.insertBefore(imgElement, allNodes[i]);\n                        detach(allNodes[i]);\n                    }\n                    break;\n            }\n        }\n    };\n    MsWordPaste.prototype.convertToBase64 = function (hexValue) {\n        var byteArr = this.conHexStringToBytes(hexValue.hex);\n        var base64String = this.conBytesToBase64(byteArr);\n        var base64 = hexValue.type ? 'data:' + hexValue.type + ';base64,' + base64String : null;\n        return base64;\n    };\n    MsWordPaste.prototype.conBytesToBase64 = function (byteArr) {\n        var base64Str = '';\n        var base64Char = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n        var byteArrLen = byteArr.length;\n        for (var i = 0; i < byteArrLen; i += 3) {\n            var array3 = byteArr.slice(i, i + 3);\n            var array3length = array3.length;\n            var array4 = [];\n            if (array3length < 3) {\n                for (var j = array3length; j < 3; j++) {\n                    array3[j] = 0;\n                }\n            }\n            array4[0] = (array3[0] & 0xFC) >> 2;\n            array4[1] = ((array3[0] & 0x03) << 4) | (array3[1] >> 4);\n            array4[2] = ((array3[1] & 0x0F) << 2) | ((array3[2] & 0xC0) >> 6);\n            array4[3] = array3[2] & 0x3F;\n            for (var j = 0; j < 4; j++) {\n                if (j <= array3length) {\n                    base64Str += base64Char.charAt(array4[j]);\n                }\n                else {\n                    base64Str += '=';\n                }\n            }\n        }\n        return base64Str;\n    };\n    MsWordPaste.prototype.conHexStringToBytes = function (hex) {\n        var byteArr = [];\n        var byteArrLen = hex.length / 2;\n        for (var i = 0; i < byteArrLen; i++) {\n            byteArr.push(parseInt(hex.substr(i * 2, 2), 16));\n        }\n        return byteArr;\n    };\n    MsWordPaste.prototype.hexConversion = function (rtfData) {\n        // eslint-disable-next-line\n        var picHead = /\\{\\\\pict[\\s\\S]+?\\\\bliptag\\-?\\d+(\\\\blipupi\\-?\\d+)?(\\{\\\\\\*\\\\blipuid\\s?[\\da-fA-F]+)?[\\s\\}]*?/;\n        var pic = new RegExp('(?:(' + picHead.source + '))([\\\\da-fA-F\\\\s]+)\\\\}', 'g');\n        var fullImg = rtfData.match(pic);\n        var imgType;\n        var result = [];\n        if (!isNOU(fullImg)) {\n            for (var i = 0; i < fullImg.length; i++) {\n                if (picHead.test(fullImg[i])) {\n                    if (fullImg[i].indexOf('\\\\pngblip') !== -1) {\n                        imgType = 'image/png';\n                    }\n                    else if (fullImg[i].indexOf('\\\\jpegblip') !== -1) {\n                        imgType = 'image/jpeg';\n                    }\n                    else {\n                        continue;\n                    }\n                    result.push({\n                        hex: imgType ? fullImg[i].replace(picHead, '').replace(/[^\\da-fA-F]/g, '') : null,\n                        type: imgType\n                    });\n                }\n            }\n        }\n        return result;\n    };\n    MsWordPaste.prototype.removeClassName = function (elm) {\n        var elmWithClass = elm.querySelectorAll('*[class]');\n        for (var i = 0; i < elmWithClass.length; i++) {\n            elmWithClass[i].removeAttribute('class');\n        }\n    };\n    MsWordPaste.prototype.breakLineAddition = function (elm) {\n        var allElements = elm.querySelectorAll('*');\n        for (var i = 0; i < allElements.length; i++) {\n            if (allElements[i].children.length === 0 && allElements[i].innerHTML === '&nbsp;' &&\n                (allElements[i].innerHTML === '&nbsp;' && !allElements[i].closest('li')) &&\n                !allElements[i].closest('td')) {\n                var detachableElement = this.findDetachElem(allElements[i]);\n                var brElement = createElement('br');\n                if (!isNOU(detachableElement.parentElement)) {\n                    detachableElement.parentElement.insertBefore(brElement, detachableElement);\n                    detach(detachableElement);\n                }\n            }\n        }\n    };\n    MsWordPaste.prototype.findDetachElem = function (element) {\n        var removableElement;\n        if (!isNOU(element.parentElement) &&\n            element.parentElement.textContent.trim() === '' && element.parentElement.tagName !== 'TD' &&\n            isNOU(element.parentElement.querySelector('img'))) {\n            removableElement = this.findDetachElem(element.parentElement);\n        }\n        else {\n            removableElement = element;\n        }\n        return removableElement;\n    };\n    MsWordPaste.prototype.removeUnwantedElements = function (elm) {\n        var innerElement = elm.innerHTML;\n        for (var i = 0; i < this.removableElements.length; i++) {\n            var regExpStartElem = new RegExp('<' + this.removableElements[i] + '>', 'g');\n            var regExpEndElem = new RegExp('</' + this.removableElements[i] + '>', 'g');\n            innerElement = innerElement.replace(regExpStartElem, '');\n            innerElement = innerElement.replace(regExpEndElem, '');\n        }\n        elm.innerHTML = innerElement;\n        elm.querySelectorAll(':empty');\n    };\n    MsWordPaste.prototype.findDetachEmptyElem = function (element) {\n        var removableElement;\n        if (!isNOU(element.parentElement)) {\n            if (element.parentElement.textContent.trim() === '' &&\n                element.parentElement.getAttribute('id') !== 'MSWord-Content' &&\n                isNOU(element.parentElement.querySelector('img'))) {\n                removableElement = this.findDetachEmptyElem(element.parentElement);\n            }\n            else {\n                removableElement = element;\n            }\n        }\n        else {\n            removableElement = null;\n        }\n        return removableElement;\n    };\n    MsWordPaste.prototype.removeEmptyElements = function (element) {\n        var emptyElements = element.querySelectorAll(':empty');\n        for (var i = 0; i < emptyElements.length; i++) {\n            if (!isNOU(emptyElements[i].closest('td')) &&\n                !isNOU(emptyElements[i].closest('td').querySelector('.MsoNormal'))) {\n                emptyElements[i].innerHTML = '-';\n            }\n            if (emptyElements[i].tagName !== 'IMG' && emptyElements[i].tagName !== 'BR' &&\n                emptyElements[i].tagName !== 'IFRAME' && emptyElements[i].tagName !== 'TD' &&\n                emptyElements[i].tagName !== 'HR') {\n                var detachableElement = this.findDetachEmptyElem(emptyElements[i]);\n                if (!isNOU(detachableElement)) {\n                    detach(detachableElement);\n                }\n            }\n        }\n    };\n    MsWordPaste.prototype.styleCorrection = function (elm, wordPasteStyleConfig) {\n        var styleElement = elm.querySelectorAll('style');\n        if (styleElement.length > 0) {\n            var styles = styleElement[0].innerHTML.match(/[\\S ]+\\s+{[\\s\\S]+?}/gi);\n            var styleClassObject_1 = !isNOU(styles) ? this.findStyleObject(styles) : null;\n            var keys = Object.keys(styleClassObject_1);\n            var values = keys.map(function (key) {\n                return styleClassObject_1[key];\n            });\n            values = this.removeUnwantedStyle(values, wordPasteStyleConfig);\n            this.filterStyles(elm, wordPasteStyleConfig);\n            var resultElem = void 0;\n            var fromClass = false;\n            for (var i = 0; i < keys.length; i++) {\n                if (keys[i].split('.')[0] === '') {\n                    resultElem = elm.getElementsByClassName(keys[i].split('.')[1]);\n                    fromClass = true;\n                }\n                else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') >= 0) {\n                    continue;\n                }\n                else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') < 0) {\n                    resultElem = elm.getElementsByTagName(keys[i]);\n                }\n                else {\n                    resultElem = elm.querySelectorAll(keys[i]);\n                }\n                for (var j = 0; j < resultElem.length; j++) {\n                    var styleProperty = resultElem[j].getAttribute('style');\n                    if (!isNOU(styleProperty) && styleProperty.trim() !== '') {\n                        var valueSplit = values[i].split(';');\n                        if (!fromClass) {\n                            for (var k = 0; k < valueSplit.length; k++) {\n                                if (styleProperty.indexOf(valueSplit[k].split(':')[0]) >= 0) {\n                                    valueSplit.splice(k, 1);\n                                    k--;\n                                }\n                            }\n                        }\n                        values[i] = valueSplit.join(';') + ';';\n                        var changedValue = styleProperty + values[i];\n                        resultElem[j].setAttribute('style', changedValue);\n                    }\n                    else {\n                        values[i] = values[i].replace(/text-indent:-(.*?)(?=;|$)/gm, '');\n                        resultElem[j].setAttribute('style', values[i]);\n                    }\n                }\n                fromClass = false;\n            }\n        }\n    };\n    MsWordPaste.prototype.filterStyles = function (elm, wordPasteStyleConfig) {\n        var elmWithStyles = elm.querySelectorAll('*[style]');\n        for (var i = 0; i < elmWithStyles.length; i++) {\n            var elemStyleProperty = elmWithStyles[i].getAttribute('style').split(';');\n            var styleValue = '';\n            for (var j = 0; j < elemStyleProperty.length; j++) {\n                if (wordPasteStyleConfig.indexOf(elemStyleProperty[j].split(':')[0].trim()) >= 0) {\n                    styleValue += elemStyleProperty[j] + ';';\n                }\n            }\n            elmWithStyles[i].setAttribute('style', styleValue);\n        }\n    };\n    MsWordPaste.prototype.removeUnwantedStyle = function (values, wordPasteStyleConfig) {\n        for (var i = 0; i < values.length; i++) {\n            var styleValues = values[i].split(';');\n            values[i] = '';\n            for (var j = 0; j < styleValues.length; j++) {\n                if (wordPasteStyleConfig.indexOf(styleValues[j].split(':')[0]) >= 0) {\n                    values[i] += styleValues[j] + ';';\n                }\n            }\n        }\n        return values;\n    };\n    MsWordPaste.prototype.findStyleObject = function (styles) {\n        var styleClassObject = {};\n        for (var i = 0; i < styles.length; i++) {\n            var tempStyle = styles[i];\n            var classNameCollection = tempStyle.replace(/([\\S ]+\\s+){[\\s\\S]+?}/gi, '$1');\n            var stylesCollection = tempStyle.replace(/[\\S ]+\\s+{([\\s\\S]+?)}/gi, '$1');\n            classNameCollection = classNameCollection.replace(/^[\\s]|[\\s]$/gm, '');\n            stylesCollection = stylesCollection.replace(/^[\\s]|[\\s]$/gm, '');\n            classNameCollection = classNameCollection.replace(/\\n|\\r|\\n\\r/g, '');\n            stylesCollection = stylesCollection.replace(/\\n|\\r|\\n\\r/g, '');\n            for (var classNames = classNameCollection.split(', '), j = 0; j < classNames.length; j++) {\n                styleClassObject[classNames[j]] = stylesCollection;\n            }\n        }\n        return styleClassObject;\n    };\n    MsWordPaste.prototype.removingComments = function (elm) {\n        var innerElement = elm.innerHTML;\n        innerElement = innerElement.replace(/<!--[\\s\\S]*?-->/g, '');\n        elm.innerHTML = innerElement;\n    };\n    MsWordPaste.prototype.cleanUp = function (node, listNodes) {\n        // eslint-disable-next-line\n        var temp = '';\n        var tempCleaner = [];\n        var prevflagState;\n        var allNodes = node.querySelectorAll('*');\n        for (var index = 0; index < allNodes.length; index++) {\n            if (this.ignorableNodes.indexOf(allNodes[index].nodeName) === -1 ||\n                (allNodes[index].nodeType === 3 && allNodes[index].textContent.trim() === '')) {\n                tempCleaner.push(allNodes[index]);\n                continue;\n            }\n            else if (allNodes[index].className &&\n                allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 &&\n                allNodes[index].childElementCount !== 1 && !isNOU(allNodes[index].getAttribute('style')) &&\n                allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n                if (allNodes[index].className.indexOf('MsoListParagraphCxSpFirst') >= 0 && listNodes.length > 0 &&\n                    listNodes[listNodes.length - 1] !== null) {\n                    listNodes.push(null);\n                }\n                listNodes.push(allNodes[index]);\n            }\n            if (prevflagState && (this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1) &&\n                !(allNodes[index].className &&\n                    allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) &&\n                    allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0)) {\n                listNodes.push(null);\n            }\n            if (this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1) {\n                if (allNodes[index].className &&\n                    allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) &&\n                    allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n                    prevflagState = true;\n                }\n                else {\n                    prevflagState = false;\n                }\n            }\n        }\n        if (listNodes.length && (listNodes[listNodes.length - 1] !== null)) {\n            listNodes.push(null);\n        }\n        return listNodes;\n    };\n    MsWordPaste.prototype.listConverter = function (listNodes) {\n        var level;\n        var data = [];\n        var collection = [];\n        var content = '';\n        var stNode;\n        var currentListStyle = '';\n        for (var i = 0; i < listNodes.length; i++) {\n            if (listNodes[i] === null) {\n                data.push({ content: this.makeConversion(collection), node: listNodes[i - 1] });\n                collection = [];\n                continue;\n            }\n            if (listNodes[i].getAttribute('style') && listNodes[i].getAttribute('style').indexOf('mso-outline-level') !== -1) {\n                listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('mso-outline-level', 'mso-outline'));\n            }\n            content = listNodes[i].getAttribute('style');\n            if (content && content.indexOf('level') !== -1) {\n                // eslint-disable-next-line\n                level = parseInt(content.charAt(content.indexOf('level') + 5), null);\n            }\n            else {\n                level = 1;\n            }\n            this.listContents = [];\n            this.getListContent(listNodes[i]);\n            var type = void 0;\n            var listStyleType = void 0;\n            if (!isNOU(this.listContents[0])) {\n                type = this.listContents[0].trim().length > 1 ? 'ol' : 'ul';\n                listStyleType = this.getlistStyleType(this.listContents[0], type);\n                var tempNode = [];\n                for (var j = 1; j < this.listContents.length; j++) {\n                    tempNode.push(this.listContents[j]);\n                }\n                var currentClassName = void 0;\n                if (!isNOU(listNodes[i].className)) {\n                    currentClassName = listNodes[i].className;\n                }\n                if (!isNOU(listNodes[i].getAttribute('style'))) {\n                    listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('text-align:start;', ''));\n                    if (listNodes[i].style.textAlign !== '') {\n                        listNodes[i].setAttribute('style', 'text-align:' + listNodes[i].style.textAlign);\n                        currentListStyle = listNodes[i].getAttribute('style');\n                    }\n                }\n                collection.push({ listType: type, content: tempNode, nestedLevel: level, class: currentClassName,\n                    listStyle: currentListStyle, listStyleTypeName: listStyleType });\n            }\n        }\n        stNode = listNodes.shift();\n        while (stNode) {\n            var elemColl = [];\n            for (var temp1 = 0; temp1 < data.length; temp1++) {\n                if (data[temp1].node === stNode) {\n                    for (var index = 0; index < data[temp1].content.childNodes.length; index++) {\n                        elemColl.push(data[temp1].content.childNodes[index]);\n                    }\n                    for (var index = 0; index < elemColl.length; index++) {\n                        stNode.parentElement.insertBefore(elemColl[index], stNode);\n                    }\n                    break;\n                }\n            }\n            stNode.remove();\n            stNode = listNodes.shift();\n            if (!stNode) {\n                stNode = listNodes.shift();\n            }\n        }\n    };\n    MsWordPaste.prototype.getlistStyleType = function (listContent, type) {\n        var currentListClass;\n        if (type === 'ol') {\n            switch (listContent.split('.')[0]) {\n                case \"A\":\n                    currentListClass = \"upper-alpha\";\n                    break;\n                case \"a\":\n                    currentListClass = \"lower-alpha\";\n                    break;\n                case \"I\":\n                    currentListClass = \"upper-roman\";\n                    break;\n                case \"i\":\n                    currentListClass = \"lower-roman\";\n                    break;\n                case \"ฮฑ\":\n                    currentListClass = \"lower-greek\";\n                    break;\n                default:\n                    currentListClass = \"decimal\";\n                    break;\n            }\n        }\n        else {\n            switch (listContent.split('.')[0]) {\n                case \"o\":\n                    currentListClass = \"circle\";\n                    break;\n                case \"ยง\":\n                    currentListClass = \"square\";\n                    break;\n                default:\n                    currentListClass = \"disc\";\n                    break;\n            }\n        }\n        return currentListClass;\n    };\n    MsWordPaste.prototype.makeConversion = function (collection) {\n        var root = createElement('div');\n        var temp;\n        var pLevel = 1;\n        var prevList;\n        var listCount = 0;\n        var elem;\n        for (var index = 0; index < collection.length; index++) {\n            var pElement = createElement('p');\n            pElement.innerHTML = collection[index].content.join(' ');\n            if ((collection[index].nestedLevel === 1) && listCount === 0 && collection[index].content) {\n                root.appendChild(temp = createElement(collection[index].listType));\n                prevList = createElement('li');\n                prevList.appendChild(pElement);\n                temp.appendChild(prevList);\n                temp.setAttribute('level', collection[index].nestedLevel.toString());\n                temp.style.listStyleType = collection[index].listStyleTypeName;\n            }\n            else if (collection[index].nestedLevel === pLevel) {\n                if (prevList.parentElement.tagName.toLowerCase() === collection[index].listType) {\n                    prevList.parentElement.appendChild(prevList = createElement('li'));\n                    prevList.appendChild(pElement);\n                }\n                else {\n                    temp = createElement(collection[index].listType);\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                    prevList.parentElement.parentElement.appendChild(temp);\n                    prevList = createElement('li');\n                    prevList.appendChild(pElement);\n                    temp.appendChild(prevList);\n                    temp.setAttribute('level', collection[index].nestedLevel.toString());\n                }\n            }\n            else if (collection[index].nestedLevel > pLevel) {\n                if (!isNOU(prevList)) {\n                    for (var j = 0; j < collection[index].nestedLevel - pLevel; j++) {\n                        prevList.appendChild(temp = createElement(collection[index].listType));\n                        prevList = createElement('li');\n                        if (j != collection[index].nestedLevel - pLevel - 1 && collection[index].nestedLevel - pLevel > 1) {\n                            prevList.style.listStyleType = \"none\";\n                        }\n                        temp.appendChild(prevList);\n                    }\n                    prevList.appendChild(pElement);\n                    temp.setAttribute('level', collection[index].nestedLevel.toString());\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                }\n                else {\n                    root.appendChild(temp = createElement(collection[index].listType));\n                    prevList = createElement('li');\n                    prevList.appendChild(pElement);\n                    temp.appendChild(prevList);\n                    temp.setAttribute('level', collection[index].nestedLevel.toString());\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                }\n            }\n            else if (collection[index].nestedLevel === 1) {\n                if (root.lastChild.tagName.toLowerCase() === collection[index].listType) {\n                    temp = root.lastChild;\n                }\n                else {\n                    root.appendChild(temp = createElement(collection[index].listType));\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                }\n                prevList = createElement('li');\n                prevList.appendChild(pElement);\n                temp.appendChild(prevList);\n                temp.setAttribute('level', collection[index].nestedLevel.toString());\n            }\n            else {\n                elem = prevList;\n                while (elem.parentElement) {\n                    elem = elem.parentElement;\n                    if (elem.attributes.getNamedItem('level')) {\n                        // eslint-disable-next-line\n                        if (parseInt(elem.attributes.getNamedItem('level').textContent, null) === collection[index].nestedLevel) {\n                            prevList = createElement('li');\n                            prevList.appendChild(pElement);\n                            elem.appendChild(prevList);\n                            break;\n                            // eslint-disable-next-line\n                        }\n                        else if (collection[index].nestedLevel > parseInt(elem.attributes.getNamedItem('level').textContent, null)) {\n                            elem.appendChild(temp = createElement(collection[index].listType));\n                            prevList = createElement('li');\n                            prevList.appendChild(pElement);\n                            temp.appendChild(prevList);\n                            temp.setAttribute('level', collection[index].nestedLevel.toString());\n                            temp.style.listStyleType = collection[index].listStyleTypeName;\n                            break;\n                        }\n                    }\n                    continue;\n                }\n            }\n            prevList.setAttribute('class', collection[index].class);\n            var currentStyle = prevList.getAttribute('style');\n            prevList.setAttribute('style', (!isNOU(currentStyle) ? currentStyle : ''));\n            pLevel = collection[index].nestedLevel;\n            listCount++;\n        }\n        return root;\n    };\n    MsWordPaste.prototype.getListContent = function (elem) {\n        var pushContent = '';\n        var firstChild = elem.firstElementChild;\n        if (firstChild.textContent.trim() === '' && !isNOU(firstChild.firstElementChild) &&\n            firstChild.firstElementChild.nodeName === 'IMG') {\n            pushContent = elem.innerHTML.trim();\n            this.listContents.push('');\n            this.listContents.push(pushContent);\n        }\n        else {\n            var styleNodes = ['b', 'em'];\n            if (firstChild.childNodes.length > 0 && (firstChild.querySelectorAll('b').length > 0\n                || firstChild.querySelectorAll('em').length > 0)) {\n                for (var i = 0; i < firstChild.childNodes.length; i++) {\n                    var nodeName = firstChild.childNodes[i].nodeName.toLowerCase();\n                    if (firstChild.childNodes[i].textContent.trim().length > 1 && styleNodes.indexOf(nodeName) !== -1) {\n                        pushContent = '<' + nodeName + '>' + firstChild.childNodes[i].textContent + '</' + nodeName + '>';\n                        this.listContents.push(pushContent);\n                    }\n                    else if (firstChild.childNodes[i].textContent.trim().length === 1) {\n                        this.listContents.push(firstChild.childNodes[i].textContent.trim());\n                    }\n                }\n            }\n            else {\n                pushContent = firstChild.textContent.trim();\n                this.listContents.push(pushContent);\n            }\n        }\n        detach(firstChild);\n        this.listContents.push(elem.innerHTML);\n    };\n    return MsWordPaste;\n}());\nexport { MsWordPaste };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}