{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable jsdoc/require-returns */\n\n/* eslint-disable @typescript-eslint/no-inferrable-types */\n\n/* eslint-disable jsdoc/require-param */\n\n/* eslint-disable valid-jsdoc */\n\n/**\n * AccumulationChart Selection src file\n */\n\n\nimport { Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { indexFinder, getElement } from '../../common/utils/helper';\nimport { pointByIndex } from '../model/acc-base';\nimport { Index } from '../../common/model/base';\nimport { BaseSelection } from '../../common/user-interaction/selection';\nimport { selectionComplete } from '../../common/model/constants';\n/**\n * `AccumulationSelection` module handles the selection for accumulation chart.\n */\n\nvar AccumulationSelection =\n/** @class */\nfunction (_super) {\n  __extends(AccumulationSelection, _super);\n\n  function AccumulationSelection(accumulation) {\n    var _this = _super.call(this, accumulation) || this;\n\n    _this.accumulation = accumulation;\n    _this.renderer = accumulation.renderer;\n\n    _this.addEventListener();\n\n    return _this;\n  }\n  /**\n   * Binding events for selection module.\n   */\n\n\n  AccumulationSelection.prototype.addEventListener = function () {\n    if (this.accumulation.isDestroyed) {\n      return;\n    }\n\n    var cancelEvent = Browser.isPointer ? 'pointerleave' : 'mouseleave';\n    this.accumulation.on(Browser.touchMoveEvent, this.mouseMove, this);\n    this.accumulation.on('click', this.calculateSelectedElements, this);\n  };\n  /**\n   * UnBinding events for selection module.\n   */\n\n\n  AccumulationSelection.prototype.removeEventListener = function () {\n    if (this.accumulation.isDestroyed) {\n      return;\n    }\n\n    this.accumulation.off(Browser.touchMoveEvent, this.mouseMove);\n    this.accumulation.off('click', this.calculateSelectedElements);\n  };\n  /**\n   * To initialize the private variables\n   */\n\n\n  AccumulationSelection.prototype.initPrivateVariables = function (accumulation) {\n    this.styleId = accumulation.element.id + '_ej2_chart_selection';\n    this.unselected = accumulation.element.id + '_ej2_deselected';\n    this.selectedDataIndexes = [];\n    this.rectPoints = null;\n  };\n  /**\n   * Invoke selection for rendered chart.\n   *\n   * @param {AccumulationChart} accumulation Define the chart to invoke the selection.\n   * @returns {void}\n   */\n\n\n  AccumulationSelection.prototype.invokeSelection = function (accumulation) {\n    this.initPrivateVariables(accumulation);\n    this.series = extend({}, accumulation.visibleSeries, null, true);\n    this.seriesStyles();\n    this.currentMode = accumulation.selectionMode;\n    this.selectDataIndex(this.concatIndexes(accumulation.selectedDataIndexes, this.selectedDataIndexes), accumulation);\n  };\n  /**\n   * To get series selection style by series.\n   */\n\n\n  AccumulationSelection.prototype.generateStyle = function (series) {\n    return series.selectionStyle || this.styleId + '_series_' + series.index;\n  };\n  /**\n   * To get series selection style while hovering legend\n   */\n\n\n  AccumulationSelection.prototype.generateLegendClickStyle = function (series, event) {\n    if (event.type === 'mousemove') {\n      this.styleId = this.accumulation.element.id + '_ej2_chart_highlight';\n    } else if (event.type === 'click') {\n      this.styleId = this.accumulation.element.id + '_ej2_chart_selection';\n    }\n\n    return series.selectionStyle || this.styleId + '_series_' + series.index;\n  };\n  /**\n   * To get elements by index, series\n   */\n\n\n  AccumulationSelection.prototype.findElements = function (accumulation, series, index) {\n    return [this.getElementByIndex(index)];\n  };\n  /**\n   * To get series point element by index\n   */\n\n\n  AccumulationSelection.prototype.getElementByIndex = function (index) {\n    var elementId = this.control.element.id + '_Series_' + index.series + '_Point_' + index.point;\n    return document.getElementById(elementId);\n  };\n  /**\n  * To find the selected element.\n   * @return {void}\n   * @private\n   */\n\n\n  AccumulationSelection.prototype.isAlreadySelected = function (event) {\n    if (event.type === 'mousemove') {\n      this.currentMode = this.accumulation.highlightMode;\n      this.highlightDataIndexes = [];\n      this.styleId = this.accumulation.element.id + '_ej2_chart_highlight';\n    } else if (event.type === 'click') {\n      this.currentMode = this.accumulation.selectionMode;\n      this.styleId = this.accumulation.element.id + '_ej2_chart_selection';\n    }\n\n    if (this.accumulation.highlightMode !== 'None' && this.accumulation.selectionMode === 'None') {\n      if (event.type === 'click') {\n        return false;\n      }\n    }\n\n    var targetElement = event.target;\n\n    if (this.accumulation.highlightMode !== 'None' && this.previousSelectedElement && this.previousSelectedElement[0]) {\n      var parentNodeId = targetElement.parentNode.id;\n      var isValidElement = void 0;\n\n      if (targetElement.parentNode) {\n        isValidElement = parentNodeId.indexOf('SeriesGroup') > 0 || parentNodeId.indexOf('SymbolGroup') > 0 ? true : false;\n      }\n\n      for (var i = 0; i < this.previousSelectedElement.length; i++) {\n        if (this.previousSelectedElement[i].hasAttribute('class')) {\n          if (this.previousSelectedElement[i].getAttribute('class').indexOf('highlight') > -1 && (isValidElement || event.type === 'click')) {\n            this.previousSelectedElement[i].removeAttribute('class');\n            this.addOrRemoveIndex(this.highlightDataIndexes, indexFinder(this.previousSelectedElement[i].id));\n          } else if (!isValidElement && this.previousSelectedElement[i].getAttribute('class').indexOf('highlight') > -1) {\n            this.performSelection(indexFinder(this.previousSelectedElement[i].id), this.accumulation, this.previousSelectedElement[i]);\n          }\n        }\n      }\n    }\n\n    return true;\n  };\n  /**\n   * To calculate selected elements on mouse click or touch\n   *\n   * @private\n   */\n\n\n  AccumulationSelection.prototype.calculateSelectedElements = function (accumulation, event) {\n    if (isNullOrUndefined(event.target)) {\n      return;\n    }\n\n    var targetEle = event.target;\n\n    if (accumulation.highlightMode === 'None' && accumulation.selectionMode === 'None' || targetEle.id.indexOf(accumulation.element.id + '_') === -1) {\n      return;\n    }\n\n    if (event.type === 'mousemove') {\n      if (!isNullOrUndefined(targetEle.parentNode) && targetEle.parentNode.hasAttribute('class') && (targetEle.parentNode.getAttribute('class').indexOf('highlight') > 0 || targetEle.parentNode.getAttribute('class').indexOf('selection') > 0)) {\n        return;\n      }\n    }\n\n    if (targetEle.getAttribute('id').indexOf('_connector_') > -1) {\n      return;\n    } else {\n      this.isAlreadySelected(event);\n\n      if (targetEle.id.indexOf('_Series_') > -1 || targetEle.id.indexOf('_datalabel_') > -1) {\n        this.performSelection(indexFinder(targetEle.id), accumulation, event.target);\n      }\n    }\n  };\n  /**\n   * To perform the selection process based on index and element.\n   */\n\n\n  AccumulationSelection.prototype.performSelection = function (index, accumulation, element) {\n    element = element.id.indexOf('datalabel') > -1 ? accumulation.getSeriesElement().childNodes[index.series].childNodes[index.point] : element;\n\n    switch (this.currentMode) {\n      case 'Point':\n        if (!isNaN(index.point)) {\n          this.selection(accumulation, index, [element]);\n          this.selectionComplete(accumulation, accumulation.series[0]);\n          this.blurEffect(accumulation.element.id, accumulation.visibleSeries);\n        }\n\n        break;\n    }\n  };\n  /**\n   *  Method to get the selected data index\n   *\n   * @private\n   */\n\n\n  AccumulationSelection.prototype.selectionComplete = function (accumulation, series) {\n    var pointIndex;\n    var selectedPointValues = [];\n\n    for (var i = 0; i < this.selectedDataIndexes.length; i++) {\n      pointIndex = this.selectedDataIndexes[i].point;\n\n      if (!isNaN(pointIndex)) {\n        selectedPointValues.push({\n          x: series.dataSource[pointIndex][series.xName],\n          y: series.points[pointIndex].y,\n          seriesIndex: this.selectedDataIndexes[i].series,\n          pointIndex: pointIndex\n        });\n      }\n    }\n\n    var args = {\n      name: selectionComplete,\n      selectedDataValues: selectedPointValues,\n      cancel: false\n    };\n    accumulation.trigger(selectionComplete, args);\n  };\n  /**\n   * To select the element by index. Adding or removing selection style class name.\n   */\n\n\n  AccumulationSelection.prototype.selection = function (accumulation, index, selectedElements) {\n    if (!accumulation.isMultiSelect && this.styleId.indexOf('highlight') === -1 && accumulation.selectionMode !== 'None') {\n      this.removeMultiSelectEelments(accumulation, this.selectedDataIndexes, index, accumulation.series);\n    }\n\n    var className = selectedElements[0] && (selectedElements[0].getAttribute('class') || '');\n\n    if (selectedElements[0] && className.indexOf(this.getSelectionClass(selectedElements[0].id)) > -1) {\n      this.removeStyles(selectedElements, index);\n\n      if (this.styleId.indexOf('highlight') > 0 && accumulation.highlightMode !== 'None') {\n        this.addOrRemoveIndex(this.highlightDataIndexes, index);\n      } else {\n        this.addOrRemoveIndex(this.selectedDataIndexes, index);\n      }\n\n      if (accumulation.enableBorderOnMouseMove) {\n        var borderElement = document.getElementById(selectedElements[0].id.split('_')[0] + 'PointHover_Border');\n\n        if (!isNullOrUndefined(borderElement)) {\n          this.removeSvgClass(borderElement, borderElement.getAttribute('class'));\n        }\n      }\n    } else {\n      this.previousSelectedElement = accumulation.highlightMode !== 'None' ? selectedElements : [];\n\n      if (className.indexOf('selection') < 0) {\n        this.applyStyles(selectedElements, index);\n      }\n\n      if (accumulation.enableBorderOnMouseMove) {\n        var borderElement = document.getElementById(selectedElements[0].id.split('_')[0] + 'PointHover_Border');\n\n        if (!isNullOrUndefined(borderElement)) {\n          this.removeSvgClass(borderElement, borderElement.getAttribute('class'));\n          this.addSvgClass(borderElement, selectedElements[0].getAttribute('class'));\n        }\n      }\n\n      if (this.styleId.indexOf('highlight') > 0 && accumulation.highlightMode !== 'None') {\n        this.addOrRemoveIndex(this.highlightDataIndexes, index, true);\n      } else {\n        this.addOrRemoveIndex(this.selectedDataIndexes, index, true);\n      }\n    }\n  };\n  /**\n   * To redraw the selection process on accumulation chart refresh.\n   *\n   * @private\n   */\n\n\n  AccumulationSelection.prototype.redrawSelection = function (accumulation) {\n    var selectedDataIndexes = extend([], this.selectedDataIndexes, null, true);\n    var highlightDataIndexes = extend([], this.highlightDataIndexes, null, true);\n\n    if (this.styleId.indexOf('highlight') > 0 && highlightDataIndexes.length > 0) {\n      this.removeSelectedElements(accumulation, this.highlightDataIndexes);\n      selectedDataIndexes = highlightDataIndexes;\n    } else {\n      this.removeSelectedElements(accumulation, this.selectedDataIndexes);\n    }\n\n    this.blurEffect(accumulation.element.id, accumulation.visibleSeries);\n    this.selectDataIndex(selectedDataIndexes, accumulation);\n  };\n  /**\n   * To remove the selected elements style classes by indexes.\n   */\n\n\n  AccumulationSelection.prototype.removeSelectedElements = function (accumulation, indexes) {\n    for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\n      var index = indexes_1[_i];\n      this.removeStyles([this.getElementByIndex(index)], index);\n    }\n  };\n  /**\n   * To perform the selection for legend elements.\n   *\n   * @private\n   */\n\n\n  AccumulationSelection.prototype.legendSelection = function (accumulation, series, pointIndex, event) {\n    var targetEle = event.target;\n\n    if (event.type === 'mousemove') {\n      if (event.target.id.indexOf('text') > 1) {\n        targetEle = getElement(event.target.id.replace('text', 'shape'));\n      }\n\n      if (targetEle.hasAttribute('class') && (targetEle.getAttribute('class').indexOf('highlight') > -1 || targetEle.getAttribute('class').indexOf('selection') > -1)) {\n        return;\n      }\n\n      this.currentMode = this.accumulation.highlightMode;\n    }\n\n    var isPreSelected = this.isAlreadySelected(event);\n\n    if (isPreSelected) {\n      var element = accumulation.getSeriesElement().childNodes[series].childNodes[pointIndex];\n      var seriesStyle = this.generateLegendClickStyle(accumulation.visibleSeries[series], event);\n      var seriesElements = accumulation.getSeriesElement().childNodes[series].childNodes[pointIndex];\n      this.selection(accumulation, new Index(series, pointIndex), [seriesElements]);\n      this.blurEffect(accumulation.element.id, accumulation.visibleSeries);\n    }\n  };\n  /**\n   * To select the element by selected data indexes.\n   */\n\n\n  AccumulationSelection.prototype.selectDataIndex = function (indexes, accumulation) {\n    var element;\n\n    for (var _i = 0, indexes_2 = indexes; _i < indexes_2.length; _i++) {\n      var index = indexes_2[_i];\n      element = this.getElementByIndex(index);\n\n      if (element) {\n        this.performSelection(index, accumulation, element);\n      }\n    }\n  };\n  /**\n   * To remove the selection styles for multi selection process.\n   */\n\n\n  AccumulationSelection.prototype.removeMultiSelectEelments = function (accumulation, index, currentIndex, seriesCollection) {\n    var series;\n\n    for (var i = 0; i < index.length; i++) {\n      series = seriesCollection[index[i].series];\n\n      if (!this.checkEquals(index[i], currentIndex)) {\n        this.removeStyles(this.findElements(accumulation, series, index[i]), index[i]);\n        index.splice(i, 1);\n        i--;\n      }\n    }\n  };\n  /**\n   * To apply the opacity effect for accumulation chart series elements.\n   */\n\n\n  AccumulationSelection.prototype.blurEffect = function (pieId, visibleSeries) {\n    var visibility = this.checkVisibility(this.highlightDataIndexes) || this.checkVisibility(this.selectedDataIndexes); // legend click scenario\n\n    for (var _i = 0, visibleSeries_1 = visibleSeries; _i < visibleSeries_1.length; _i++) {\n      var series = visibleSeries_1[_i];\n\n      if (series.visible) {\n        this.checkSelectionElements(document.getElementById(pieId + '_SeriesCollection'), this.generateStyle(series), visibility);\n      }\n    }\n  };\n  /**\n   * To check selection elements by style class name.\n   */\n\n\n  AccumulationSelection.prototype.checkSelectionElements = function (element, className, visibility) {\n    var children = element.childNodes[0].childNodes;\n    var legendShape;\n    var elementClass;\n    var parentClass;\n    var selectElement = element;\n\n    for (var i = 0; i < children.length; i++) {\n      elementClass = children[i].getAttribute('class') || '';\n      parentClass = children[i].parentNode.getAttribute('class') || '';\n\n      if (this.accumulation.selectionMode !== 'None' && this.accumulation.highlightMode !== 'None') {\n        className = elementClass.indexOf('selection') > 0 || elementClass.indexOf('highlight') > 0 ? elementClass : className;\n        className = parentClass.indexOf('selection') > 0 || parentClass.indexOf('highlight') > 0 ? parentClass : className;\n      }\n\n      if (elementClass.indexOf(className) === -1 && parentClass.indexOf(className) === -1 && visibility) {\n        this.addSvgClass(children[i], this.unselected);\n      } else {\n        this.removeSvgClass(children[i], this.unselected);\n      }\n\n      if (elementClass.indexOf(className) === -1 && parentClass.indexOf(className) === -1 && visibility) {\n        this.addSvgClass(children[i], this.unselected);\n      } else {\n        selectElement = children[i];\n        this.removeSvgClass(children[i], this.unselected);\n        this.removeSvgClass(children[i].parentNode, this.unselected);\n      }\n\n      if (this.control.accumulationLegendModule && this.control.legendSettings.visible) {\n        legendShape = document.getElementById(this.control.element.id + '_chart_legend_shape_' + i);\n\n        if (legendShape) {\n          if (elementClass.indexOf(className) === -1 && parentClass.indexOf(className) === -1 && visibility) {\n            this.addSvgClass(legendShape, this.unselected);\n          } else {\n            this.removeSvgClass(legendShape, this.unselected);\n          }\n        }\n      }\n    }\n  };\n  /**\n   * To apply selection style for elements.\n   */\n\n\n  AccumulationSelection.prototype.applyStyles = function (elements, index) {\n    var accumulationTooltip = this.control.accumulationTooltipModule;\n\n    for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n      var element = elements_1[_i];\n      var legendShape = void 0;\n\n      if (element) {\n        if (this.control.accumulationLegendModule && this.control.legendSettings.visible) {\n          legendShape = document.getElementById(this.control.element.id + '_chart_legend_shape_' + index.point);\n          this.removeSvgClass(legendShape, legendShape.getAttribute('class'));\n          this.addSvgClass(legendShape, this.getSelectionClass(legendShape.id));\n        }\n\n        this.removeSvgClass(element.parentNode, this.unselected);\n        this.removeSvgClass(element, this.unselected);\n        var opacity = accumulationTooltip && accumulationTooltip.previousPoints.length > 0 && accumulationTooltip.previousPoints[0].point.index !== index.point ? accumulationTooltip.svgTooltip.opacity : this.series[index.series].opacity;\n        element.setAttribute('opacity', opacity.toString());\n        this.addSvgClass(element, this.getSelectionClass(element.id));\n      }\n    }\n  };\n  /**\n   * To get selection style class name by id\n   */\n\n\n  AccumulationSelection.prototype.getSelectionClass = function (id) {\n    return this.generateStyle(this.control.series[indexFinder(id).series]);\n  };\n  /**\n   * To remove selection style for elements.\n   */\n\n\n  AccumulationSelection.prototype.removeStyles = function (elements, index) {\n    var accumulationTooltip = this.control.accumulationTooltipModule;\n    var legendShape;\n\n    for (var _i = 0, elements_2 = elements; _i < elements_2.length; _i++) {\n      var element = elements_2[_i];\n\n      if (element) {\n        if (this.control.accumulationLegendModule && this.control.legendSettings.visible) {\n          legendShape = document.getElementById(this.control.element.id + '_chart_legend_shape_' + index.point);\n          this.removeSvgClass(legendShape, this.getSelectionClass(legendShape.id));\n        }\n\n        var opacity = accumulationTooltip && accumulationTooltip.previousPoints.length > 0 && accumulationTooltip.previousPoints[0].point.index === index.point ? accumulationTooltip.svgTooltip.opacity : this.series[index.series].opacity;\n        element.setAttribute('opacity', opacity.toString());\n        this.removeSvgClass(element, this.getSelectionClass(element.id));\n      }\n    }\n  };\n  /**\n   * To apply or remove selected elements index.\n   */\n\n\n  AccumulationSelection.prototype.addOrRemoveIndex = function (indexes, index, add) {\n    for (var i = 0; i < indexes.length; i++) {\n      if (this.checkEquals(indexes[i], index)) {\n        indexes.splice(i, 1);\n        i--;\n      }\n    }\n\n    if (add) {\n      indexes.push(index);\n    }\n  };\n  /**\n   * To check two index, point and series are equal\n   */\n\n\n  AccumulationSelection.prototype.checkEquals = function (first, second) {\n    return first.point === second.point && first.series === second.series;\n  };\n  /** @private */\n\n\n  AccumulationSelection.prototype.mouseMove = function (event) {\n    var accumulation = this.accumulation;\n    var targetElement = event.target;\n\n    if (accumulation.highlightMode !== 'None') {\n      if (!isNullOrUndefined(targetElement)) {\n        if (event.target.id.indexOf('text') > 1) {\n          targetElement = getElement(event.target.id.replace('text', 'shape'));\n        }\n\n        if (targetElement.hasAttribute('class') && targetElement.getAttribute('class').indexOf('highlight') > -1) {\n          return;\n        }\n\n        this.calculateSelectedElements(accumulation, event);\n        return;\n      }\n    }\n\n    if (accumulation.selectionMode === 'None') {\n      return;\n    }\n  };\n  /**\n   * To check selected points are visibility\n   */\n\n\n  AccumulationSelection.prototype.checkPointVisibility = function (selectedDataIndexes) {\n    var visible = false;\n\n    for (var _i = 0, selectedDataIndexes_1 = selectedDataIndexes; _i < selectedDataIndexes_1.length; _i++) {\n      var data = selectedDataIndexes_1[_i];\n\n      if (pointByIndex(data.point, this.control.visibleSeries[0].points).visible) {\n        visible = true;\n        break;\n      }\n    }\n\n    return visible;\n  };\n  /**\n   * Get module name.\n   */\n\n\n  AccumulationSelection.prototype.getModuleName = function () {\n    return 'AccumulationSelection';\n  };\n  /**\n   * To destroy the selection.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  AccumulationSelection.prototype.destroy = function () {\n    // Destroy method performed here\n    this.removeEventListener();\n  };\n\n  return AccumulationSelection;\n}(BaseSelection);\n\nexport { AccumulationSelection };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Browser","extend","isNullOrUndefined","indexFinder","getElement","pointByIndex","Index","BaseSelection","selectionComplete","AccumulationSelection","_super","accumulation","_this","call","renderer","addEventListener","isDestroyed","cancelEvent","isPointer","on","touchMoveEvent","mouseMove","calculateSelectedElements","removeEventListener","off","initPrivateVariables","styleId","element","id","unselected","selectedDataIndexes","rectPoints","invokeSelection","series","visibleSeries","seriesStyles","currentMode","selectionMode","selectDataIndex","concatIndexes","generateStyle","selectionStyle","index","generateLegendClickStyle","event","type","findElements","getElementByIndex","elementId","control","point","document","getElementById","isAlreadySelected","highlightMode","highlightDataIndexes","targetElement","target","previousSelectedElement","parentNodeId","parentNode","isValidElement","indexOf","i","length","hasAttribute","getAttribute","removeAttribute","addOrRemoveIndex","performSelection","targetEle","getSeriesElement","childNodes","isNaN","selection","blurEffect","pointIndex","selectedPointValues","push","x","dataSource","xName","y","points","seriesIndex","args","name","selectedDataValues","cancel","trigger","selectedElements","isMultiSelect","removeMultiSelectEelments","className","getSelectionClass","removeStyles","enableBorderOnMouseMove","borderElement","split","removeSvgClass","applyStyles","addSvgClass","redrawSelection","removeSelectedElements","indexes","_i","indexes_1","legendSelection","replace","isPreSelected","seriesStyle","seriesElements","indexes_2","currentIndex","seriesCollection","checkEquals","splice","pieId","visibility","checkVisibility","visibleSeries_1","visible","checkSelectionElements","children","legendShape","elementClass","parentClass","selectElement","accumulationLegendModule","legendSettings","elements","accumulationTooltip","accumulationTooltipModule","elements_1","opacity","previousPoints","svgTooltip","setAttribute","toString","elements_2","add","first","second","checkPointVisibility","selectedDataIndexes_1","data","getModuleName","destroy"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-charts/src/accumulation-chart/user-interaction/selection.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable jsdoc/require-returns */\n/* eslint-disable @typescript-eslint/no-inferrable-types */\n/* eslint-disable jsdoc/require-param */\n/* eslint-disable valid-jsdoc */\n/**\n * AccumulationChart Selection src file\n */\nimport { Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { indexFinder, getElement } from '../../common/utils/helper';\nimport { pointByIndex } from '../model/acc-base';\nimport { Index } from '../../common/model/base';\nimport { BaseSelection } from '../../common/user-interaction/selection';\nimport { selectionComplete } from '../../common/model/constants';\n/**\n * `AccumulationSelection` module handles the selection for accumulation chart.\n */\nvar AccumulationSelection = /** @class */ (function (_super) {\n    __extends(AccumulationSelection, _super);\n    function AccumulationSelection(accumulation) {\n        var _this = _super.call(this, accumulation) || this;\n        _this.accumulation = accumulation;\n        _this.renderer = accumulation.renderer;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Binding events for selection module.\n     */\n    AccumulationSelection.prototype.addEventListener = function () {\n        if (this.accumulation.isDestroyed) {\n            return;\n        }\n        var cancelEvent = Browser.isPointer ? 'pointerleave' : 'mouseleave';\n        this.accumulation.on(Browser.touchMoveEvent, this.mouseMove, this);\n        this.accumulation.on('click', this.calculateSelectedElements, this);\n    };\n    /**\n     * UnBinding events for selection module.\n     */\n    AccumulationSelection.prototype.removeEventListener = function () {\n        if (this.accumulation.isDestroyed) {\n            return;\n        }\n        this.accumulation.off(Browser.touchMoveEvent, this.mouseMove);\n        this.accumulation.off('click', this.calculateSelectedElements);\n    };\n    /**\n     * To initialize the private variables\n     */\n    AccumulationSelection.prototype.initPrivateVariables = function (accumulation) {\n        this.styleId = accumulation.element.id + '_ej2_chart_selection';\n        this.unselected = accumulation.element.id + '_ej2_deselected';\n        this.selectedDataIndexes = [];\n        this.rectPoints = null;\n    };\n    /**\n     * Invoke selection for rendered chart.\n     *\n     * @param {AccumulationChart} accumulation Define the chart to invoke the selection.\n     * @returns {void}\n     */\n    AccumulationSelection.prototype.invokeSelection = function (accumulation) {\n        this.initPrivateVariables(accumulation);\n        this.series = extend({}, accumulation.visibleSeries, null, true);\n        this.seriesStyles();\n        this.currentMode = accumulation.selectionMode;\n        this.selectDataIndex(this.concatIndexes(accumulation.selectedDataIndexes, this.selectedDataIndexes), accumulation);\n    };\n    /**\n     * To get series selection style by series.\n     */\n    AccumulationSelection.prototype.generateStyle = function (series) {\n        return (series.selectionStyle || this.styleId + '_series_' + series.index);\n    };\n    /**\n     * To get series selection style while hovering legend\n     */\n    AccumulationSelection.prototype.generateLegendClickStyle = function (series, event) {\n        if (event.type === 'mousemove') {\n            this.styleId = this.accumulation.element.id + '_ej2_chart_highlight';\n        }\n        else if (event.type === 'click') {\n            this.styleId = this.accumulation.element.id + '_ej2_chart_selection';\n        }\n        return (series.selectionStyle || this.styleId + '_series_' + series.index);\n    };\n    /**\n     * To get elements by index, series\n     */\n    AccumulationSelection.prototype.findElements = function (accumulation, series, index) {\n        return [this.getElementByIndex(index)];\n    };\n    /**\n     * To get series point element by index\n     */\n    AccumulationSelection.prototype.getElementByIndex = function (index) {\n        var elementId = this.control.element.id + '_Series_' + index.series + '_Point_' + index.point;\n        return document.getElementById(elementId);\n    };\n    /**\n    * To find the selected element.\n     * @return {void}\n     * @private\n     */\n    AccumulationSelection.prototype.isAlreadySelected = function (event) {\n        if (event.type === 'mousemove') {\n            this.currentMode = this.accumulation.highlightMode;\n            this.highlightDataIndexes = [];\n            this.styleId = this.accumulation.element.id + '_ej2_chart_highlight';\n        }\n        else if (event.type === 'click') {\n            this.currentMode = this.accumulation.selectionMode;\n            this.styleId = this.accumulation.element.id + '_ej2_chart_selection';\n        }\n        if (this.accumulation.highlightMode !== 'None' && this.accumulation.selectionMode === 'None') {\n            if (event.type === 'click') {\n                return false;\n            }\n        }\n        var targetElement = event.target;\n        if ((this.accumulation.highlightMode !== 'None' && this.previousSelectedElement && this.previousSelectedElement[0])) {\n            var parentNodeId = targetElement.parentNode.id;\n            var isValidElement = void 0;\n            if (targetElement.parentNode) {\n                isValidElement = (parentNodeId.indexOf('SeriesGroup') > 0 ||\n                    parentNodeId.indexOf('SymbolGroup') > 0) ? true : false;\n            }\n            for (var i = 0; i < this.previousSelectedElement.length; i++) {\n                if (this.previousSelectedElement[i].hasAttribute('class')) {\n                    if (this.previousSelectedElement[i].getAttribute('class').indexOf('highlight') > -1 && (isValidElement || event.type === 'click')) {\n                        this.previousSelectedElement[i].removeAttribute('class');\n                        this.addOrRemoveIndex(this.highlightDataIndexes, indexFinder(this.previousSelectedElement[i].id));\n                    }\n                    else if (!isValidElement && this.previousSelectedElement[i].getAttribute('class').indexOf('highlight') > -1) {\n                        this.performSelection(indexFinder(this.previousSelectedElement[i].id), this.accumulation, this.previousSelectedElement[i]);\n                    }\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * To calculate selected elements on mouse click or touch\n     *\n     * @private\n     */\n    AccumulationSelection.prototype.calculateSelectedElements = function (accumulation, event) {\n        if (isNullOrUndefined(event.target)) {\n            return;\n        }\n        var targetEle = event.target;\n        if ((accumulation.highlightMode === 'None' && accumulation.selectionMode === 'None') ||\n            targetEle.id.indexOf(accumulation.element.id + '_') === -1) {\n            return;\n        }\n        if (event.type === 'mousemove') {\n            if (!isNullOrUndefined(targetEle.parentNode) && targetEle.parentNode.hasAttribute('class') &&\n                (targetEle.parentNode.getAttribute('class').indexOf('highlight') > 0 ||\n                    targetEle.parentNode.getAttribute('class').indexOf('selection') > 0)) {\n                return;\n            }\n        }\n        if (targetEle.getAttribute('id').indexOf('_connector_') > -1) {\n            return;\n        }\n        else {\n            this.isAlreadySelected(event);\n            if (targetEle.id.indexOf('_Series_') > -1 || targetEle.id.indexOf('_datalabel_') > -1) {\n                this.performSelection(indexFinder(targetEle.id), accumulation, event.target);\n            }\n        }\n    };\n    /**\n     * To perform the selection process based on index and element.\n     */\n    AccumulationSelection.prototype.performSelection = function (index, accumulation, element) {\n        element = element.id.indexOf('datalabel') > -1 ?\n            accumulation.getSeriesElement().childNodes[index.series].childNodes[index.point]\n            : element;\n        switch (this.currentMode) {\n            case 'Point':\n                if (!isNaN(index.point)) {\n                    this.selection(accumulation, index, [element]);\n                    this.selectionComplete(accumulation, accumulation.series[0]);\n                    this.blurEffect(accumulation.element.id, accumulation.visibleSeries);\n                }\n                break;\n        }\n    };\n    /**\n     *  Method to get the selected data index\n     *\n     * @private\n     */\n    AccumulationSelection.prototype.selectionComplete = function (accumulation, series) {\n        var pointIndex;\n        var selectedPointValues = [];\n        for (var i = 0; i < this.selectedDataIndexes.length; i++) {\n            pointIndex = this.selectedDataIndexes[i].point;\n            if (!isNaN(pointIndex)) {\n                selectedPointValues.push({\n                    x: series.dataSource[pointIndex][series.xName], y: series.points[pointIndex].y,\n                    seriesIndex: this.selectedDataIndexes[i].series, pointIndex: pointIndex\n                });\n            }\n        }\n        var args = {\n            name: selectionComplete,\n            selectedDataValues: selectedPointValues,\n            cancel: false\n        };\n        accumulation.trigger(selectionComplete, args);\n    };\n    /**\n     * To select the element by index. Adding or removing selection style class name.\n     */\n    AccumulationSelection.prototype.selection = function (accumulation, index, selectedElements) {\n        if (!accumulation.isMultiSelect && this.styleId.indexOf('highlight') === -1 &&\n            accumulation.selectionMode !== 'None') {\n            this.removeMultiSelectEelments(accumulation, this.selectedDataIndexes, index, accumulation.series);\n        }\n        var className = selectedElements[0] && (selectedElements[0].getAttribute('class') || '');\n        if (selectedElements[0] && className.indexOf(this.getSelectionClass(selectedElements[0].id)) > -1) {\n            this.removeStyles(selectedElements, index);\n            if (this.styleId.indexOf('highlight') > 0 && accumulation.highlightMode !== 'None') {\n                this.addOrRemoveIndex(this.highlightDataIndexes, index);\n            }\n            else {\n                this.addOrRemoveIndex(this.selectedDataIndexes, index);\n            }\n            if (accumulation.enableBorderOnMouseMove) {\n                var borderElement = document.getElementById(selectedElements[0].id.split('_')[0] + 'PointHover_Border');\n                if (!isNullOrUndefined(borderElement)) {\n                    this.removeSvgClass(borderElement, borderElement.getAttribute('class'));\n                }\n            }\n        }\n        else {\n            this.previousSelectedElement = accumulation.highlightMode !== 'None' ? selectedElements : [];\n            if (className.indexOf('selection') < 0) {\n                this.applyStyles(selectedElements, index);\n            }\n            if (accumulation.enableBorderOnMouseMove) {\n                var borderElement = document.getElementById(selectedElements[0].id.split('_')[0] + 'PointHover_Border');\n                if (!isNullOrUndefined(borderElement)) {\n                    this.removeSvgClass(borderElement, borderElement.getAttribute('class'));\n                    this.addSvgClass(borderElement, selectedElements[0].getAttribute('class'));\n                }\n            }\n            if (this.styleId.indexOf('highlight') > 0 && accumulation.highlightMode !== 'None') {\n                this.addOrRemoveIndex(this.highlightDataIndexes, index, true);\n            }\n            else {\n                this.addOrRemoveIndex(this.selectedDataIndexes, index, true);\n            }\n        }\n    };\n    /**\n     * To redraw the selection process on accumulation chart refresh.\n     *\n     * @private\n     */\n    AccumulationSelection.prototype.redrawSelection = function (accumulation) {\n        var selectedDataIndexes = extend([], this.selectedDataIndexes, null, true);\n        var highlightDataIndexes = extend([], this.highlightDataIndexes, null, true);\n        if (this.styleId.indexOf('highlight') > 0 && highlightDataIndexes.length > 0) {\n            this.removeSelectedElements(accumulation, this.highlightDataIndexes);\n            selectedDataIndexes = highlightDataIndexes;\n        }\n        else {\n            this.removeSelectedElements(accumulation, this.selectedDataIndexes);\n        }\n        this.blurEffect(accumulation.element.id, accumulation.visibleSeries);\n        this.selectDataIndex(selectedDataIndexes, accumulation);\n    };\n    /**\n     * To remove the selected elements style classes by indexes.\n     */\n    AccumulationSelection.prototype.removeSelectedElements = function (accumulation, indexes) {\n        for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\n            var index = indexes_1[_i];\n            this.removeStyles([this.getElementByIndex(index)], index);\n        }\n    };\n    /**\n     * To perform the selection for legend elements.\n     *\n     * @private\n     */\n    AccumulationSelection.prototype.legendSelection = function (accumulation, series, pointIndex, event) {\n        var targetEle = event.target;\n        if (event.type === 'mousemove') {\n            if (event.target.id.indexOf('text') > 1) {\n                targetEle = getElement(event.target.id.replace('text', 'shape'));\n            }\n            if (targetEle.hasAttribute('class') && (targetEle.getAttribute('class').indexOf('highlight') > -1 ||\n                targetEle.getAttribute('class').indexOf('selection') > -1)) {\n                return;\n            }\n            this.currentMode = this.accumulation.highlightMode;\n        }\n        var isPreSelected = this.isAlreadySelected(event);\n        if (isPreSelected) {\n            var element = accumulation.getSeriesElement().childNodes[series].childNodes[pointIndex];\n            var seriesStyle = this.generateLegendClickStyle(accumulation.visibleSeries[series], event);\n            var seriesElements = accumulation.getSeriesElement().childNodes[series].childNodes[pointIndex];\n            this.selection(accumulation, new Index(series, pointIndex), [seriesElements]);\n            this.blurEffect(accumulation.element.id, accumulation.visibleSeries);\n        }\n    };\n    /**\n     * To select the element by selected data indexes.\n     */\n    AccumulationSelection.prototype.selectDataIndex = function (indexes, accumulation) {\n        var element;\n        for (var _i = 0, indexes_2 = indexes; _i < indexes_2.length; _i++) {\n            var index = indexes_2[_i];\n            element = this.getElementByIndex(index);\n            if (element) {\n                this.performSelection(index, accumulation, element);\n            }\n        }\n    };\n    /**\n     * To remove the selection styles for multi selection process.\n     */\n    AccumulationSelection.prototype.removeMultiSelectEelments = function (accumulation, index, currentIndex, seriesCollection) {\n        var series;\n        for (var i = 0; i < index.length; i++) {\n            series = seriesCollection[index[i].series];\n            if (!this.checkEquals(index[i], currentIndex)) {\n                this.removeStyles(this.findElements(accumulation, series, index[i]), index[i]);\n                index.splice(i, 1);\n                i--;\n            }\n        }\n    };\n    /**\n     * To apply the opacity effect for accumulation chart series elements.\n     */\n    AccumulationSelection.prototype.blurEffect = function (pieId, visibleSeries) {\n        var visibility = (this.checkVisibility(this.highlightDataIndexes) ||\n            this.checkVisibility(this.selectedDataIndexes)); // legend click scenario\n        for (var _i = 0, visibleSeries_1 = visibleSeries; _i < visibleSeries_1.length; _i++) {\n            var series = visibleSeries_1[_i];\n            if (series.visible) {\n                this.checkSelectionElements(document.getElementById(pieId + '_SeriesCollection'), this.generateStyle(series), visibility);\n            }\n        }\n    };\n    /**\n     * To check selection elements by style class name.\n     */\n    AccumulationSelection.prototype.checkSelectionElements = function (element, className, visibility) {\n        var children = element.childNodes[0].childNodes;\n        var legendShape;\n        var elementClass;\n        var parentClass;\n        var selectElement = element;\n        for (var i = 0; i < children.length; i++) {\n            elementClass = children[i].getAttribute('class') || '';\n            parentClass = children[i].parentNode.getAttribute('class') || '';\n            if (this.accumulation.selectionMode !== 'None' && this.accumulation.highlightMode !== 'None') {\n                className = elementClass.indexOf('selection') > 0 ||\n                    elementClass.indexOf('highlight') > 0 ? elementClass : className;\n                className = (parentClass.indexOf('selection') > 0 ||\n                    parentClass.indexOf('highlight') > 0) ? parentClass : className;\n            }\n            if (elementClass.indexOf(className) === -1 && parentClass.indexOf(className) === -1 && visibility) {\n                this.addSvgClass(children[i], this.unselected);\n            }\n            else {\n                this.removeSvgClass(children[i], this.unselected);\n            }\n            if (elementClass.indexOf(className) === -1 &&\n                parentClass.indexOf(className) === -1 && visibility) {\n                this.addSvgClass(children[i], this.unselected);\n            }\n            else {\n                selectElement = children[i];\n                this.removeSvgClass(children[i], this.unselected);\n                this.removeSvgClass(children[i].parentNode, this.unselected);\n            }\n            if (this.control.accumulationLegendModule && this.control.legendSettings.visible) {\n                legendShape = document.getElementById(this.control.element.id + '_chart_legend_shape_' + i);\n                if (legendShape) {\n                    if (elementClass.indexOf(className) === -1 && parentClass.indexOf(className) === -1 && visibility) {\n                        this.addSvgClass(legendShape, this.unselected);\n                    }\n                    else {\n                        this.removeSvgClass(legendShape, this.unselected);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * To apply selection style for elements.\n     */\n    AccumulationSelection.prototype.applyStyles = function (elements, index) {\n        var accumulationTooltip = this.control.accumulationTooltipModule;\n        for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n            var element = elements_1[_i];\n            var legendShape = void 0;\n            if (element) {\n                if (this.control.accumulationLegendModule && this.control.legendSettings.visible) {\n                    legendShape = document.getElementById(this.control.element.id + '_chart_legend_shape_' + index.point);\n                    this.removeSvgClass(legendShape, legendShape.getAttribute('class'));\n                    this.addSvgClass(legendShape, this.getSelectionClass(legendShape.id));\n                }\n                this.removeSvgClass(element.parentNode, this.unselected);\n                this.removeSvgClass(element, this.unselected);\n                var opacity = accumulationTooltip && (accumulationTooltip.previousPoints.length > 0 &&\n                    accumulationTooltip.previousPoints[0].point.index !== index.point) ?\n                    accumulationTooltip.svgTooltip.opacity : this.series[index.series].opacity;\n                element.setAttribute('opacity', opacity.toString());\n                this.addSvgClass(element, this.getSelectionClass(element.id));\n            }\n        }\n    };\n    /**\n     * To get selection style class name by id\n     */\n    AccumulationSelection.prototype.getSelectionClass = function (id) {\n        return this.generateStyle(this.control.series[indexFinder(id).series]);\n    };\n    /**\n     * To remove selection style for elements.\n     */\n    AccumulationSelection.prototype.removeStyles = function (elements, index) {\n        var accumulationTooltip = this.control.accumulationTooltipModule;\n        var legendShape;\n        for (var _i = 0, elements_2 = elements; _i < elements_2.length; _i++) {\n            var element = elements_2[_i];\n            if (element) {\n                if (this.control.accumulationLegendModule && this.control.legendSettings.visible) {\n                    legendShape = document.getElementById(this.control.element.id + '_chart_legend_shape_' + index.point);\n                    this.removeSvgClass(legendShape, this.getSelectionClass(legendShape.id));\n                }\n                var opacity = accumulationTooltip && accumulationTooltip.previousPoints.length > 0\n                    && (accumulationTooltip.previousPoints[0].point.index === index.point) ?\n                    accumulationTooltip.svgTooltip.opacity : this.series[index.series].opacity;\n                element.setAttribute('opacity', opacity.toString());\n                this.removeSvgClass(element, this.getSelectionClass(element.id));\n            }\n        }\n    };\n    /**\n     * To apply or remove selected elements index.\n     */\n    AccumulationSelection.prototype.addOrRemoveIndex = function (indexes, index, add) {\n        for (var i = 0; i < indexes.length; i++) {\n            if (this.checkEquals(indexes[i], index)) {\n                indexes.splice(i, 1);\n                i--;\n            }\n        }\n        if (add) {\n            indexes.push(index);\n        }\n    };\n    /**\n     * To check two index, point and series are equal\n     */\n    AccumulationSelection.prototype.checkEquals = function (first, second) {\n        return ((first.point === second.point) && (first.series === second.series));\n    };\n    /** @private */\n    AccumulationSelection.prototype.mouseMove = function (event) {\n        var accumulation = this.accumulation;\n        var targetElement = event.target;\n        if (accumulation.highlightMode !== 'None') {\n            if (!isNullOrUndefined(targetElement)) {\n                if (event.target.id.indexOf('text') > 1) {\n                    targetElement = getElement(event.target.id.replace('text', 'shape'));\n                }\n                if ((targetElement).hasAttribute('class') && (targetElement).getAttribute('class').indexOf('highlight') > -1) {\n                    return;\n                }\n                this.calculateSelectedElements(accumulation, event);\n                return;\n            }\n        }\n        if (accumulation.selectionMode === 'None') {\n            return;\n        }\n    };\n    /**\n     * To check selected points are visibility\n     */\n    AccumulationSelection.prototype.checkPointVisibility = function (selectedDataIndexes) {\n        var visible = false;\n        for (var _i = 0, selectedDataIndexes_1 = selectedDataIndexes; _i < selectedDataIndexes_1.length; _i++) {\n            var data = selectedDataIndexes_1[_i];\n            if (pointByIndex(data.point, this.control.visibleSeries[0].points).visible) {\n                visible = true;\n                break;\n            }\n        }\n        return visible;\n    };\n    /**\n     * Get module name.\n     */\n    AccumulationSelection.prototype.getModuleName = function () {\n        return 'AccumulationSelection';\n    };\n    /**\n     * To destroy the selection.\n     *\n     * @returns {void}\n     * @private\n     */\n    AccumulationSelection.prototype.destroy = function () {\n        // Destroy method performed here\n        this.removeEventListener();\n    };\n    return AccumulationSelection;\n}(BaseSelection));\nexport { AccumulationSelection };\n"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;EACrD,IAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;IAChCF,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;MAAEC,SAAS,EAAE;IAAb,aAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;MAAED,CAAC,CAACI,SAAF,GAAcH,CAAd;IAAkB,CAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;MAAE,KAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;IAAc,CAF9E;;IAGA,OAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;EACH,CALD;;EAMA,OAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;IACnBF,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;IACA,SAASO,EAAT,GAAc;MAAE,KAAKC,WAAL,GAAmBT,CAAnB;IAAuB;;IACvCA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;EACH,CAJD;AAKH,CAZ2C,EAA5C;AAaA;;AACA;;AACA;;AACA;;AACA;AACA;AACA;;;AACA,SAASI,OAAT,EAAkBC,MAAlB,EAA0BC,iBAA1B,QAAmD,sBAAnD;AACA,SAASC,WAAT,EAAsBC,UAAtB,QAAwC,2BAAxC;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,KAAT,QAAsB,yBAAtB;AACA,SAASC,aAAT,QAA8B,yCAA9B;AACA,SAASC,iBAAT,QAAkC,8BAAlC;AACA;AACA;AACA;;AACA,IAAIC,qBAAqB;AAAG;AAAe,UAAUC,MAAV,EAAkB;EACzDxB,SAAS,CAACuB,qBAAD,EAAwBC,MAAxB,CAAT;;EACA,SAASD,qBAAT,CAA+BE,YAA/B,EAA6C;IACzC,IAAIC,KAAK,GAAGF,MAAM,CAACG,IAAP,CAAY,IAAZ,EAAkBF,YAAlB,KAAmC,IAA/C;;IACAC,KAAK,CAACD,YAAN,GAAqBA,YAArB;IACAC,KAAK,CAACE,QAAN,GAAiBH,YAAY,CAACG,QAA9B;;IACAF,KAAK,CAACG,gBAAN;;IACA,OAAOH,KAAP;EACH;EACD;AACJ;AACA;;;EACIH,qBAAqB,CAACX,SAAtB,CAAgCiB,gBAAhC,GAAmD,YAAY;IAC3D,IAAI,KAAKJ,YAAL,CAAkBK,WAAtB,EAAmC;MAC/B;IACH;;IACD,IAAIC,WAAW,GAAGjB,OAAO,CAACkB,SAAR,GAAoB,cAApB,GAAqC,YAAvD;IACA,KAAKP,YAAL,CAAkBQ,EAAlB,CAAqBnB,OAAO,CAACoB,cAA7B,EAA6C,KAAKC,SAAlD,EAA6D,IAA7D;IACA,KAAKV,YAAL,CAAkBQ,EAAlB,CAAqB,OAArB,EAA8B,KAAKG,yBAAnC,EAA8D,IAA9D;EACH,CAPD;EAQA;AACJ;AACA;;;EACIb,qBAAqB,CAACX,SAAtB,CAAgCyB,mBAAhC,GAAsD,YAAY;IAC9D,IAAI,KAAKZ,YAAL,CAAkBK,WAAtB,EAAmC;MAC/B;IACH;;IACD,KAAKL,YAAL,CAAkBa,GAAlB,CAAsBxB,OAAO,CAACoB,cAA9B,EAA8C,KAAKC,SAAnD;IACA,KAAKV,YAAL,CAAkBa,GAAlB,CAAsB,OAAtB,EAA+B,KAAKF,yBAApC;EACH,CAND;EAOA;AACJ;AACA;;;EACIb,qBAAqB,CAACX,SAAtB,CAAgC2B,oBAAhC,GAAuD,UAAUd,YAAV,EAAwB;IAC3E,KAAKe,OAAL,GAAef,YAAY,CAACgB,OAAb,CAAqBC,EAArB,GAA0B,sBAAzC;IACA,KAAKC,UAAL,GAAkBlB,YAAY,CAACgB,OAAb,CAAqBC,EAArB,GAA0B,iBAA5C;IACA,KAAKE,mBAAL,GAA2B,EAA3B;IACA,KAAKC,UAAL,GAAkB,IAAlB;EACH,CALD;EAMA;AACJ;AACA;AACA;AACA;AACA;;;EACItB,qBAAqB,CAACX,SAAtB,CAAgCkC,eAAhC,GAAkD,UAAUrB,YAAV,EAAwB;IACtE,KAAKc,oBAAL,CAA0Bd,YAA1B;IACA,KAAKsB,MAAL,GAAchC,MAAM,CAAC,EAAD,EAAKU,YAAY,CAACuB,aAAlB,EAAiC,IAAjC,EAAuC,IAAvC,CAApB;IACA,KAAKC,YAAL;IACA,KAAKC,WAAL,GAAmBzB,YAAY,CAAC0B,aAAhC;IACA,KAAKC,eAAL,CAAqB,KAAKC,aAAL,CAAmB5B,YAAY,CAACmB,mBAAhC,EAAqD,KAAKA,mBAA1D,CAArB,EAAqGnB,YAArG;EACH,CAND;EAOA;AACJ;AACA;;;EACIF,qBAAqB,CAACX,SAAtB,CAAgC0C,aAAhC,GAAgD,UAAUP,MAAV,EAAkB;IAC9D,OAAQA,MAAM,CAACQ,cAAP,IAAyB,KAAKf,OAAL,GAAe,UAAf,GAA4BO,MAAM,CAACS,KAApE;EACH,CAFD;EAGA;AACJ;AACA;;;EACIjC,qBAAqB,CAACX,SAAtB,CAAgC6C,wBAAhC,GAA2D,UAAUV,MAAV,EAAkBW,KAAlB,EAAyB;IAChF,IAAIA,KAAK,CAACC,IAAN,KAAe,WAAnB,EAAgC;MAC5B,KAAKnB,OAAL,GAAe,KAAKf,YAAL,CAAkBgB,OAAlB,CAA0BC,EAA1B,GAA+B,sBAA9C;IACH,CAFD,MAGK,IAAIgB,KAAK,CAACC,IAAN,KAAe,OAAnB,EAA4B;MAC7B,KAAKnB,OAAL,GAAe,KAAKf,YAAL,CAAkBgB,OAAlB,CAA0BC,EAA1B,GAA+B,sBAA9C;IACH;;IACD,OAAQK,MAAM,CAACQ,cAAP,IAAyB,KAAKf,OAAL,GAAe,UAAf,GAA4BO,MAAM,CAACS,KAApE;EACH,CARD;EASA;AACJ;AACA;;;EACIjC,qBAAqB,CAACX,SAAtB,CAAgCgD,YAAhC,GAA+C,UAAUnC,YAAV,EAAwBsB,MAAxB,EAAgCS,KAAhC,EAAuC;IAClF,OAAO,CAAC,KAAKK,iBAAL,CAAuBL,KAAvB,CAAD,CAAP;EACH,CAFD;EAGA;AACJ;AACA;;;EACIjC,qBAAqB,CAACX,SAAtB,CAAgCiD,iBAAhC,GAAoD,UAAUL,KAAV,EAAiB;IACjE,IAAIM,SAAS,GAAG,KAAKC,OAAL,CAAatB,OAAb,CAAqBC,EAArB,GAA0B,UAA1B,GAAuCc,KAAK,CAACT,MAA7C,GAAsD,SAAtD,GAAkES,KAAK,CAACQ,KAAxF;IACA,OAAOC,QAAQ,CAACC,cAAT,CAAwBJ,SAAxB,CAAP;EACH,CAHD;EAIA;AACJ;AACA;AACA;AACA;;;EACIvC,qBAAqB,CAACX,SAAtB,CAAgCuD,iBAAhC,GAAoD,UAAUT,KAAV,EAAiB;IACjE,IAAIA,KAAK,CAACC,IAAN,KAAe,WAAnB,EAAgC;MAC5B,KAAKT,WAAL,GAAmB,KAAKzB,YAAL,CAAkB2C,aAArC;MACA,KAAKC,oBAAL,GAA4B,EAA5B;MACA,KAAK7B,OAAL,GAAe,KAAKf,YAAL,CAAkBgB,OAAlB,CAA0BC,EAA1B,GAA+B,sBAA9C;IACH,CAJD,MAKK,IAAIgB,KAAK,CAACC,IAAN,KAAe,OAAnB,EAA4B;MAC7B,KAAKT,WAAL,GAAmB,KAAKzB,YAAL,CAAkB0B,aAArC;MACA,KAAKX,OAAL,GAAe,KAAKf,YAAL,CAAkBgB,OAAlB,CAA0BC,EAA1B,GAA+B,sBAA9C;IACH;;IACD,IAAI,KAAKjB,YAAL,CAAkB2C,aAAlB,KAAoC,MAApC,IAA8C,KAAK3C,YAAL,CAAkB0B,aAAlB,KAAoC,MAAtF,EAA8F;MAC1F,IAAIO,KAAK,CAACC,IAAN,KAAe,OAAnB,EAA4B;QACxB,OAAO,KAAP;MACH;IACJ;;IACD,IAAIW,aAAa,GAAGZ,KAAK,CAACa,MAA1B;;IACA,IAAK,KAAK9C,YAAL,CAAkB2C,aAAlB,KAAoC,MAApC,IAA8C,KAAKI,uBAAnD,IAA8E,KAAKA,uBAAL,CAA6B,CAA7B,CAAnF,EAAqH;MACjH,IAAIC,YAAY,GAAGH,aAAa,CAACI,UAAd,CAAyBhC,EAA5C;MACA,IAAIiC,cAAc,GAAG,KAAK,CAA1B;;MACA,IAAIL,aAAa,CAACI,UAAlB,EAA8B;QAC1BC,cAAc,GAAIF,YAAY,CAACG,OAAb,CAAqB,aAArB,IAAsC,CAAtC,IACdH,YAAY,CAACG,OAAb,CAAqB,aAArB,IAAsC,CADzB,GAC8B,IAD9B,GACqC,KADtD;MAEH;;MACD,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKL,uBAAL,CAA6BM,MAAjD,EAAyDD,CAAC,EAA1D,EAA8D;QAC1D,IAAI,KAAKL,uBAAL,CAA6BK,CAA7B,EAAgCE,YAAhC,CAA6C,OAA7C,CAAJ,EAA2D;UACvD,IAAI,KAAKP,uBAAL,CAA6BK,CAA7B,EAAgCG,YAAhC,CAA6C,OAA7C,EAAsDJ,OAAtD,CAA8D,WAA9D,IAA6E,CAAC,CAA9E,KAAoFD,cAAc,IAAIjB,KAAK,CAACC,IAAN,KAAe,OAArH,CAAJ,EAAmI;YAC/H,KAAKa,uBAAL,CAA6BK,CAA7B,EAAgCI,eAAhC,CAAgD,OAAhD;YACA,KAAKC,gBAAL,CAAsB,KAAKb,oBAA3B,EAAiDpD,WAAW,CAAC,KAAKuD,uBAAL,CAA6BK,CAA7B,EAAgCnC,EAAjC,CAA5D;UACH,CAHD,MAIK,IAAI,CAACiC,cAAD,IAAmB,KAAKH,uBAAL,CAA6BK,CAA7B,EAAgCG,YAAhC,CAA6C,OAA7C,EAAsDJ,OAAtD,CAA8D,WAA9D,IAA6E,CAAC,CAArG,EAAwG;YACzG,KAAKO,gBAAL,CAAsBlE,WAAW,CAAC,KAAKuD,uBAAL,CAA6BK,CAA7B,EAAgCnC,EAAjC,CAAjC,EAAuE,KAAKjB,YAA5E,EAA0F,KAAK+C,uBAAL,CAA6BK,CAA7B,CAA1F;UACH;QACJ;MACJ;IACJ;;IACD,OAAO,IAAP;EACH,CApCD;EAqCA;AACJ;AACA;AACA;AACA;;;EACItD,qBAAqB,CAACX,SAAtB,CAAgCwB,yBAAhC,GAA4D,UAAUX,YAAV,EAAwBiC,KAAxB,EAA+B;IACvF,IAAI1C,iBAAiB,CAAC0C,KAAK,CAACa,MAAP,CAArB,EAAqC;MACjC;IACH;;IACD,IAAIa,SAAS,GAAG1B,KAAK,CAACa,MAAtB;;IACA,IAAK9C,YAAY,CAAC2C,aAAb,KAA+B,MAA/B,IAAyC3C,YAAY,CAAC0B,aAAb,KAA+B,MAAzE,IACAiC,SAAS,CAAC1C,EAAV,CAAakC,OAAb,CAAqBnD,YAAY,CAACgB,OAAb,CAAqBC,EAArB,GAA0B,GAA/C,MAAwD,CAAC,CAD7D,EACgE;MAC5D;IACH;;IACD,IAAIgB,KAAK,CAACC,IAAN,KAAe,WAAnB,EAAgC;MAC5B,IAAI,CAAC3C,iBAAiB,CAACoE,SAAS,CAACV,UAAX,CAAlB,IAA4CU,SAAS,CAACV,UAAV,CAAqBK,YAArB,CAAkC,OAAlC,CAA5C,KACCK,SAAS,CAACV,UAAV,CAAqBM,YAArB,CAAkC,OAAlC,EAA2CJ,OAA3C,CAAmD,WAAnD,IAAkE,CAAlE,IACGQ,SAAS,CAACV,UAAV,CAAqBM,YAArB,CAAkC,OAAlC,EAA2CJ,OAA3C,CAAmD,WAAnD,IAAkE,CAFtE,CAAJ,EAE8E;QAC1E;MACH;IACJ;;IACD,IAAIQ,SAAS,CAACJ,YAAV,CAAuB,IAAvB,EAA6BJ,OAA7B,CAAqC,aAArC,IAAsD,CAAC,CAA3D,EAA8D;MAC1D;IACH,CAFD,MAGK;MACD,KAAKT,iBAAL,CAAuBT,KAAvB;;MACA,IAAI0B,SAAS,CAAC1C,EAAV,CAAakC,OAAb,CAAqB,UAArB,IAAmC,CAAC,CAApC,IAAyCQ,SAAS,CAAC1C,EAAV,CAAakC,OAAb,CAAqB,aAArB,IAAsC,CAAC,CAApF,EAAuF;QACnF,KAAKO,gBAAL,CAAsBlE,WAAW,CAACmE,SAAS,CAAC1C,EAAX,CAAjC,EAAiDjB,YAAjD,EAA+DiC,KAAK,CAACa,MAArE;MACH;IACJ;EACJ,CAzBD;EA0BA;AACJ;AACA;;;EACIhD,qBAAqB,CAACX,SAAtB,CAAgCuE,gBAAhC,GAAmD,UAAU3B,KAAV,EAAiB/B,YAAjB,EAA+BgB,OAA/B,EAAwC;IACvFA,OAAO,GAAGA,OAAO,CAACC,EAAR,CAAWkC,OAAX,CAAmB,WAAnB,IAAkC,CAAC,CAAnC,GACNnD,YAAY,CAAC4D,gBAAb,GAAgCC,UAAhC,CAA2C9B,KAAK,CAACT,MAAjD,EAAyDuC,UAAzD,CAAoE9B,KAAK,CAACQ,KAA1E,CADM,GAEJvB,OAFN;;IAGA,QAAQ,KAAKS,WAAb;MACI,KAAK,OAAL;QACI,IAAI,CAACqC,KAAK,CAAC/B,KAAK,CAACQ,KAAP,CAAV,EAAyB;UACrB,KAAKwB,SAAL,CAAe/D,YAAf,EAA6B+B,KAA7B,EAAoC,CAACf,OAAD,CAApC;UACA,KAAKnB,iBAAL,CAAuBG,YAAvB,EAAqCA,YAAY,CAACsB,MAAb,CAAoB,CAApB,CAArC;UACA,KAAK0C,UAAL,CAAgBhE,YAAY,CAACgB,OAAb,CAAqBC,EAArC,EAAyCjB,YAAY,CAACuB,aAAtD;QACH;;QACD;IAPR;EASH,CAbD;EAcA;AACJ;AACA;AACA;AACA;;;EACIzB,qBAAqB,CAACX,SAAtB,CAAgCU,iBAAhC,GAAoD,UAAUG,YAAV,EAAwBsB,MAAxB,EAAgC;IAChF,IAAI2C,UAAJ;IACA,IAAIC,mBAAmB,GAAG,EAA1B;;IACA,KAAK,IAAId,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjC,mBAAL,CAAyBkC,MAA7C,EAAqDD,CAAC,EAAtD,EAA0D;MACtDa,UAAU,GAAG,KAAK9C,mBAAL,CAAyBiC,CAAzB,EAA4Bb,KAAzC;;MACA,IAAI,CAACuB,KAAK,CAACG,UAAD,CAAV,EAAwB;QACpBC,mBAAmB,CAACC,IAApB,CAAyB;UACrBC,CAAC,EAAE9C,MAAM,CAAC+C,UAAP,CAAkBJ,UAAlB,EAA8B3C,MAAM,CAACgD,KAArC,CADkB;UAC2BC,CAAC,EAAEjD,MAAM,CAACkD,MAAP,CAAcP,UAAd,EAA0BM,CADxD;UAErBE,WAAW,EAAE,KAAKtD,mBAAL,CAAyBiC,CAAzB,EAA4B9B,MAFpB;UAE4B2C,UAAU,EAAEA;QAFxC,CAAzB;MAIH;IACJ;;IACD,IAAIS,IAAI,GAAG;MACPC,IAAI,EAAE9E,iBADC;MAEP+E,kBAAkB,EAAEV,mBAFb;MAGPW,MAAM,EAAE;IAHD,CAAX;IAKA7E,YAAY,CAAC8E,OAAb,CAAqBjF,iBAArB,EAAwC6E,IAAxC;EACH,CAlBD;EAmBA;AACJ;AACA;;;EACI5E,qBAAqB,CAACX,SAAtB,CAAgC4E,SAAhC,GAA4C,UAAU/D,YAAV,EAAwB+B,KAAxB,EAA+BgD,gBAA/B,EAAiD;IACzF,IAAI,CAAC/E,YAAY,CAACgF,aAAd,IAA+B,KAAKjE,OAAL,CAAaoC,OAAb,CAAqB,WAArB,MAAsC,CAAC,CAAtE,IACAnD,YAAY,CAAC0B,aAAb,KAA+B,MADnC,EAC2C;MACvC,KAAKuD,yBAAL,CAA+BjF,YAA/B,EAA6C,KAAKmB,mBAAlD,EAAuEY,KAAvE,EAA8E/B,YAAY,CAACsB,MAA3F;IACH;;IACD,IAAI4D,SAAS,GAAGH,gBAAgB,CAAC,CAAD,CAAhB,KAAwBA,gBAAgB,CAAC,CAAD,CAAhB,CAAoBxB,YAApB,CAAiC,OAAjC,KAA6C,EAArE,CAAhB;;IACA,IAAIwB,gBAAgB,CAAC,CAAD,CAAhB,IAAuBG,SAAS,CAAC/B,OAAV,CAAkB,KAAKgC,iBAAL,CAAuBJ,gBAAgB,CAAC,CAAD,CAAhB,CAAoB9D,EAA3C,CAAlB,IAAoE,CAAC,CAAhG,EAAmG;MAC/F,KAAKmE,YAAL,CAAkBL,gBAAlB,EAAoChD,KAApC;;MACA,IAAI,KAAKhB,OAAL,CAAaoC,OAAb,CAAqB,WAArB,IAAoC,CAApC,IAAyCnD,YAAY,CAAC2C,aAAb,KAA+B,MAA5E,EAAoF;QAChF,KAAKc,gBAAL,CAAsB,KAAKb,oBAA3B,EAAiDb,KAAjD;MACH,CAFD,MAGK;QACD,KAAK0B,gBAAL,CAAsB,KAAKtC,mBAA3B,EAAgDY,KAAhD;MACH;;MACD,IAAI/B,YAAY,CAACqF,uBAAjB,EAA0C;QACtC,IAAIC,aAAa,GAAG9C,QAAQ,CAACC,cAAT,CAAwBsC,gBAAgB,CAAC,CAAD,CAAhB,CAAoB9D,EAApB,CAAuBsE,KAAvB,CAA6B,GAA7B,EAAkC,CAAlC,IAAuC,mBAA/D,CAApB;;QACA,IAAI,CAAChG,iBAAiB,CAAC+F,aAAD,CAAtB,EAAuC;UACnC,KAAKE,cAAL,CAAoBF,aAApB,EAAmCA,aAAa,CAAC/B,YAAd,CAA2B,OAA3B,CAAnC;QACH;MACJ;IACJ,CAdD,MAeK;MACD,KAAKR,uBAAL,GAA+B/C,YAAY,CAAC2C,aAAb,KAA+B,MAA/B,GAAwCoC,gBAAxC,GAA2D,EAA1F;;MACA,IAAIG,SAAS,CAAC/B,OAAV,CAAkB,WAAlB,IAAiC,CAArC,EAAwC;QACpC,KAAKsC,WAAL,CAAiBV,gBAAjB,EAAmChD,KAAnC;MACH;;MACD,IAAI/B,YAAY,CAACqF,uBAAjB,EAA0C;QACtC,IAAIC,aAAa,GAAG9C,QAAQ,CAACC,cAAT,CAAwBsC,gBAAgB,CAAC,CAAD,CAAhB,CAAoB9D,EAApB,CAAuBsE,KAAvB,CAA6B,GAA7B,EAAkC,CAAlC,IAAuC,mBAA/D,CAApB;;QACA,IAAI,CAAChG,iBAAiB,CAAC+F,aAAD,CAAtB,EAAuC;UACnC,KAAKE,cAAL,CAAoBF,aAApB,EAAmCA,aAAa,CAAC/B,YAAd,CAA2B,OAA3B,CAAnC;UACA,KAAKmC,WAAL,CAAiBJ,aAAjB,EAAgCP,gBAAgB,CAAC,CAAD,CAAhB,CAAoBxB,YAApB,CAAiC,OAAjC,CAAhC;QACH;MACJ;;MACD,IAAI,KAAKxC,OAAL,CAAaoC,OAAb,CAAqB,WAArB,IAAoC,CAApC,IAAyCnD,YAAY,CAAC2C,aAAb,KAA+B,MAA5E,EAAoF;QAChF,KAAKc,gBAAL,CAAsB,KAAKb,oBAA3B,EAAiDb,KAAjD,EAAwD,IAAxD;MACH,CAFD,MAGK;QACD,KAAK0B,gBAAL,CAAsB,KAAKtC,mBAA3B,EAAgDY,KAAhD,EAAuD,IAAvD;MACH;IACJ;EACJ,CAxCD;EAyCA;AACJ;AACA;AACA;AACA;;;EACIjC,qBAAqB,CAACX,SAAtB,CAAgCwG,eAAhC,GAAkD,UAAU3F,YAAV,EAAwB;IACtE,IAAImB,mBAAmB,GAAG7B,MAAM,CAAC,EAAD,EAAK,KAAK6B,mBAAV,EAA+B,IAA/B,EAAqC,IAArC,CAAhC;IACA,IAAIyB,oBAAoB,GAAGtD,MAAM,CAAC,EAAD,EAAK,KAAKsD,oBAAV,EAAgC,IAAhC,EAAsC,IAAtC,CAAjC;;IACA,IAAI,KAAK7B,OAAL,CAAaoC,OAAb,CAAqB,WAArB,IAAoC,CAApC,IAAyCP,oBAAoB,CAACS,MAArB,GAA8B,CAA3E,EAA8E;MAC1E,KAAKuC,sBAAL,CAA4B5F,YAA5B,EAA0C,KAAK4C,oBAA/C;MACAzB,mBAAmB,GAAGyB,oBAAtB;IACH,CAHD,MAIK;MACD,KAAKgD,sBAAL,CAA4B5F,YAA5B,EAA0C,KAAKmB,mBAA/C;IACH;;IACD,KAAK6C,UAAL,CAAgBhE,YAAY,CAACgB,OAAb,CAAqBC,EAArC,EAAyCjB,YAAY,CAACuB,aAAtD;IACA,KAAKI,eAAL,CAAqBR,mBAArB,EAA0CnB,YAA1C;EACH,CAZD;EAaA;AACJ;AACA;;;EACIF,qBAAqB,CAACX,SAAtB,CAAgCyG,sBAAhC,GAAyD,UAAU5F,YAAV,EAAwB6F,OAAxB,EAAiC;IACtF,KAAK,IAAIC,EAAE,GAAG,CAAT,EAAYC,SAAS,GAAGF,OAA7B,EAAsCC,EAAE,GAAGC,SAAS,CAAC1C,MAArD,EAA6DyC,EAAE,EAA/D,EAAmE;MAC/D,IAAI/D,KAAK,GAAGgE,SAAS,CAACD,EAAD,CAArB;MACA,KAAKV,YAAL,CAAkB,CAAC,KAAKhD,iBAAL,CAAuBL,KAAvB,CAAD,CAAlB,EAAmDA,KAAnD;IACH;EACJ,CALD;EAMA;AACJ;AACA;AACA;AACA;;;EACIjC,qBAAqB,CAACX,SAAtB,CAAgC6G,eAAhC,GAAkD,UAAUhG,YAAV,EAAwBsB,MAAxB,EAAgC2C,UAAhC,EAA4ChC,KAA5C,EAAmD;IACjG,IAAI0B,SAAS,GAAG1B,KAAK,CAACa,MAAtB;;IACA,IAAIb,KAAK,CAACC,IAAN,KAAe,WAAnB,EAAgC;MAC5B,IAAID,KAAK,CAACa,MAAN,CAAa7B,EAAb,CAAgBkC,OAAhB,CAAwB,MAAxB,IAAkC,CAAtC,EAAyC;QACrCQ,SAAS,GAAGlE,UAAU,CAACwC,KAAK,CAACa,MAAN,CAAa7B,EAAb,CAAgBgF,OAAhB,CAAwB,MAAxB,EAAgC,OAAhC,CAAD,CAAtB;MACH;;MACD,IAAItC,SAAS,CAACL,YAAV,CAAuB,OAAvB,MAAoCK,SAAS,CAACJ,YAAV,CAAuB,OAAvB,EAAgCJ,OAAhC,CAAwC,WAAxC,IAAuD,CAAC,CAAxD,IACpCQ,SAAS,CAACJ,YAAV,CAAuB,OAAvB,EAAgCJ,OAAhC,CAAwC,WAAxC,IAAuD,CAAC,CADxD,CAAJ,EACgE;QAC5D;MACH;;MACD,KAAK1B,WAAL,GAAmB,KAAKzB,YAAL,CAAkB2C,aAArC;IACH;;IACD,IAAIuD,aAAa,GAAG,KAAKxD,iBAAL,CAAuBT,KAAvB,CAApB;;IACA,IAAIiE,aAAJ,EAAmB;MACf,IAAIlF,OAAO,GAAGhB,YAAY,CAAC4D,gBAAb,GAAgCC,UAAhC,CAA2CvC,MAA3C,EAAmDuC,UAAnD,CAA8DI,UAA9D,CAAd;MACA,IAAIkC,WAAW,GAAG,KAAKnE,wBAAL,CAA8BhC,YAAY,CAACuB,aAAb,CAA2BD,MAA3B,CAA9B,EAAkEW,KAAlE,CAAlB;MACA,IAAImE,cAAc,GAAGpG,YAAY,CAAC4D,gBAAb,GAAgCC,UAAhC,CAA2CvC,MAA3C,EAAmDuC,UAAnD,CAA8DI,UAA9D,CAArB;MACA,KAAKF,SAAL,CAAe/D,YAAf,EAA6B,IAAIL,KAAJ,CAAU2B,MAAV,EAAkB2C,UAAlB,CAA7B,EAA4D,CAACmC,cAAD,CAA5D;MACA,KAAKpC,UAAL,CAAgBhE,YAAY,CAACgB,OAAb,CAAqBC,EAArC,EAAyCjB,YAAY,CAACuB,aAAtD;IACH;EACJ,CApBD;EAqBA;AACJ;AACA;;;EACIzB,qBAAqB,CAACX,SAAtB,CAAgCwC,eAAhC,GAAkD,UAAUkE,OAAV,EAAmB7F,YAAnB,EAAiC;IAC/E,IAAIgB,OAAJ;;IACA,KAAK,IAAI8E,EAAE,GAAG,CAAT,EAAYO,SAAS,GAAGR,OAA7B,EAAsCC,EAAE,GAAGO,SAAS,CAAChD,MAArD,EAA6DyC,EAAE,EAA/D,EAAmE;MAC/D,IAAI/D,KAAK,GAAGsE,SAAS,CAACP,EAAD,CAArB;MACA9E,OAAO,GAAG,KAAKoB,iBAAL,CAAuBL,KAAvB,CAAV;;MACA,IAAIf,OAAJ,EAAa;QACT,KAAK0C,gBAAL,CAAsB3B,KAAtB,EAA6B/B,YAA7B,EAA2CgB,OAA3C;MACH;IACJ;EACJ,CATD;EAUA;AACJ;AACA;;;EACIlB,qBAAqB,CAACX,SAAtB,CAAgC8F,yBAAhC,GAA4D,UAAUjF,YAAV,EAAwB+B,KAAxB,EAA+BuE,YAA/B,EAA6CC,gBAA7C,EAA+D;IACvH,IAAIjF,MAAJ;;IACA,KAAK,IAAI8B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrB,KAAK,CAACsB,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;MACnC9B,MAAM,GAAGiF,gBAAgB,CAACxE,KAAK,CAACqB,CAAD,CAAL,CAAS9B,MAAV,CAAzB;;MACA,IAAI,CAAC,KAAKkF,WAAL,CAAiBzE,KAAK,CAACqB,CAAD,CAAtB,EAA2BkD,YAA3B,CAAL,EAA+C;QAC3C,KAAKlB,YAAL,CAAkB,KAAKjD,YAAL,CAAkBnC,YAAlB,EAAgCsB,MAAhC,EAAwCS,KAAK,CAACqB,CAAD,CAA7C,CAAlB,EAAqErB,KAAK,CAACqB,CAAD,CAA1E;QACArB,KAAK,CAAC0E,MAAN,CAAarD,CAAb,EAAgB,CAAhB;QACAA,CAAC;MACJ;IACJ;EACJ,CAVD;EAWA;AACJ;AACA;;;EACItD,qBAAqB,CAACX,SAAtB,CAAgC6E,UAAhC,GAA6C,UAAU0C,KAAV,EAAiBnF,aAAjB,EAAgC;IACzE,IAAIoF,UAAU,GAAI,KAAKC,eAAL,CAAqB,KAAKhE,oBAA1B,KACd,KAAKgE,eAAL,CAAqB,KAAKzF,mBAA1B,CADJ,CADyE,CAEpB;;IACrD,KAAK,IAAI2E,EAAE,GAAG,CAAT,EAAYe,eAAe,GAAGtF,aAAnC,EAAkDuE,EAAE,GAAGe,eAAe,CAACxD,MAAvE,EAA+EyC,EAAE,EAAjF,EAAqF;MACjF,IAAIxE,MAAM,GAAGuF,eAAe,CAACf,EAAD,CAA5B;;MACA,IAAIxE,MAAM,CAACwF,OAAX,EAAoB;QAChB,KAAKC,sBAAL,CAA4BvE,QAAQ,CAACC,cAAT,CAAwBiE,KAAK,GAAG,mBAAhC,CAA5B,EAAkF,KAAK7E,aAAL,CAAmBP,MAAnB,CAAlF,EAA8GqF,UAA9G;MACH;IACJ;EACJ,CATD;EAUA;AACJ;AACA;;;EACI7G,qBAAqB,CAACX,SAAtB,CAAgC4H,sBAAhC,GAAyD,UAAU/F,OAAV,EAAmBkE,SAAnB,EAA8ByB,UAA9B,EAA0C;IAC/F,IAAIK,QAAQ,GAAGhG,OAAO,CAAC6C,UAAR,CAAmB,CAAnB,EAAsBA,UAArC;IACA,IAAIoD,WAAJ;IACA,IAAIC,YAAJ;IACA,IAAIC,WAAJ;IACA,IAAIC,aAAa,GAAGpG,OAApB;;IACA,KAAK,IAAIoC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4D,QAAQ,CAAC3D,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;MACtC8D,YAAY,GAAGF,QAAQ,CAAC5D,CAAD,CAAR,CAAYG,YAAZ,CAAyB,OAAzB,KAAqC,EAApD;MACA4D,WAAW,GAAGH,QAAQ,CAAC5D,CAAD,CAAR,CAAYH,UAAZ,CAAuBM,YAAvB,CAAoC,OAApC,KAAgD,EAA9D;;MACA,IAAI,KAAKvD,YAAL,CAAkB0B,aAAlB,KAAoC,MAApC,IAA8C,KAAK1B,YAAL,CAAkB2C,aAAlB,KAAoC,MAAtF,EAA8F;QAC1FuC,SAAS,GAAGgC,YAAY,CAAC/D,OAAb,CAAqB,WAArB,IAAoC,CAApC,IACR+D,YAAY,CAAC/D,OAAb,CAAqB,WAArB,IAAoC,CAD5B,GACgC+D,YADhC,GAC+ChC,SAD3D;QAEAA,SAAS,GAAIiC,WAAW,CAAChE,OAAZ,CAAoB,WAApB,IAAmC,CAAnC,IACTgE,WAAW,CAAChE,OAAZ,CAAoB,WAApB,IAAmC,CAD3B,GACgCgE,WADhC,GAC8CjC,SAD1D;MAEH;;MACD,IAAIgC,YAAY,CAAC/D,OAAb,CAAqB+B,SAArB,MAAoC,CAAC,CAArC,IAA0CiC,WAAW,CAAChE,OAAZ,CAAoB+B,SAApB,MAAmC,CAAC,CAA9E,IAAmFyB,UAAvF,EAAmG;QAC/F,KAAKjB,WAAL,CAAiBsB,QAAQ,CAAC5D,CAAD,CAAzB,EAA8B,KAAKlC,UAAnC;MACH,CAFD,MAGK;QACD,KAAKsE,cAAL,CAAoBwB,QAAQ,CAAC5D,CAAD,CAA5B,EAAiC,KAAKlC,UAAtC;MACH;;MACD,IAAIgG,YAAY,CAAC/D,OAAb,CAAqB+B,SAArB,MAAoC,CAAC,CAArC,IACAiC,WAAW,CAAChE,OAAZ,CAAoB+B,SAApB,MAAmC,CAAC,CADpC,IACyCyB,UAD7C,EACyD;QACrD,KAAKjB,WAAL,CAAiBsB,QAAQ,CAAC5D,CAAD,CAAzB,EAA8B,KAAKlC,UAAnC;MACH,CAHD,MAIK;QACDkG,aAAa,GAAGJ,QAAQ,CAAC5D,CAAD,CAAxB;QACA,KAAKoC,cAAL,CAAoBwB,QAAQ,CAAC5D,CAAD,CAA5B,EAAiC,KAAKlC,UAAtC;QACA,KAAKsE,cAAL,CAAoBwB,QAAQ,CAAC5D,CAAD,CAAR,CAAYH,UAAhC,EAA4C,KAAK/B,UAAjD;MACH;;MACD,IAAI,KAAKoB,OAAL,CAAa+E,wBAAb,IAAyC,KAAK/E,OAAL,CAAagF,cAAb,CAA4BR,OAAzE,EAAkF;QAC9EG,WAAW,GAAGzE,QAAQ,CAACC,cAAT,CAAwB,KAAKH,OAAL,CAAatB,OAAb,CAAqBC,EAArB,GAA0B,sBAA1B,GAAmDmC,CAA3E,CAAd;;QACA,IAAI6D,WAAJ,EAAiB;UACb,IAAIC,YAAY,CAAC/D,OAAb,CAAqB+B,SAArB,MAAoC,CAAC,CAArC,IAA0CiC,WAAW,CAAChE,OAAZ,CAAoB+B,SAApB,MAAmC,CAAC,CAA9E,IAAmFyB,UAAvF,EAAmG;YAC/F,KAAKjB,WAAL,CAAiBuB,WAAjB,EAA8B,KAAK/F,UAAnC;UACH,CAFD,MAGK;YACD,KAAKsE,cAAL,CAAoByB,WAApB,EAAiC,KAAK/F,UAAtC;UACH;QACJ;MACJ;IACJ;EACJ,CA1CD;EA2CA;AACJ;AACA;;;EACIpB,qBAAqB,CAACX,SAAtB,CAAgCsG,WAAhC,GAA8C,UAAU8B,QAAV,EAAoBxF,KAApB,EAA2B;IACrE,IAAIyF,mBAAmB,GAAG,KAAKlF,OAAL,CAAamF,yBAAvC;;IACA,KAAK,IAAI3B,EAAE,GAAG,CAAT,EAAY4B,UAAU,GAAGH,QAA9B,EAAwCzB,EAAE,GAAG4B,UAAU,CAACrE,MAAxD,EAAgEyC,EAAE,EAAlE,EAAsE;MAClE,IAAI9E,OAAO,GAAG0G,UAAU,CAAC5B,EAAD,CAAxB;MACA,IAAImB,WAAW,GAAG,KAAK,CAAvB;;MACA,IAAIjG,OAAJ,EAAa;QACT,IAAI,KAAKsB,OAAL,CAAa+E,wBAAb,IAAyC,KAAK/E,OAAL,CAAagF,cAAb,CAA4BR,OAAzE,EAAkF;UAC9EG,WAAW,GAAGzE,QAAQ,CAACC,cAAT,CAAwB,KAAKH,OAAL,CAAatB,OAAb,CAAqBC,EAArB,GAA0B,sBAA1B,GAAmDc,KAAK,CAACQ,KAAjF,CAAd;UACA,KAAKiD,cAAL,CAAoByB,WAApB,EAAiCA,WAAW,CAAC1D,YAAZ,CAAyB,OAAzB,CAAjC;UACA,KAAKmC,WAAL,CAAiBuB,WAAjB,EAA8B,KAAK9B,iBAAL,CAAuB8B,WAAW,CAAChG,EAAnC,CAA9B;QACH;;QACD,KAAKuE,cAAL,CAAoBxE,OAAO,CAACiC,UAA5B,EAAwC,KAAK/B,UAA7C;QACA,KAAKsE,cAAL,CAAoBxE,OAApB,EAA6B,KAAKE,UAAlC;QACA,IAAIyG,OAAO,GAAGH,mBAAmB,IAAKA,mBAAmB,CAACI,cAApB,CAAmCvE,MAAnC,GAA4C,CAA5C,IAClCmE,mBAAmB,CAACI,cAApB,CAAmC,CAAnC,EAAsCrF,KAAtC,CAA4CR,KAA5C,KAAsDA,KAAK,CAACQ,KADlD,GAEViF,mBAAmB,CAACK,UAApB,CAA+BF,OAFrB,GAE+B,KAAKrG,MAAL,CAAYS,KAAK,CAACT,MAAlB,EAA0BqG,OAFvE;QAGA3G,OAAO,CAAC8G,YAAR,CAAqB,SAArB,EAAgCH,OAAO,CAACI,QAAR,EAAhC;QACA,KAAKrC,WAAL,CAAiB1E,OAAjB,EAA0B,KAAKmE,iBAAL,CAAuBnE,OAAO,CAACC,EAA/B,CAA1B;MACH;IACJ;EACJ,CApBD;EAqBA;AACJ;AACA;;;EACInB,qBAAqB,CAACX,SAAtB,CAAgCgG,iBAAhC,GAAoD,UAAUlE,EAAV,EAAc;IAC9D,OAAO,KAAKY,aAAL,CAAmB,KAAKS,OAAL,CAAahB,MAAb,CAAoB9B,WAAW,CAACyB,EAAD,CAAX,CAAgBK,MAApC,CAAnB,CAAP;EACH,CAFD;EAGA;AACJ;AACA;;;EACIxB,qBAAqB,CAACX,SAAtB,CAAgCiG,YAAhC,GAA+C,UAAUmC,QAAV,EAAoBxF,KAApB,EAA2B;IACtE,IAAIyF,mBAAmB,GAAG,KAAKlF,OAAL,CAAamF,yBAAvC;IACA,IAAIR,WAAJ;;IACA,KAAK,IAAInB,EAAE,GAAG,CAAT,EAAYkC,UAAU,GAAGT,QAA9B,EAAwCzB,EAAE,GAAGkC,UAAU,CAAC3E,MAAxD,EAAgEyC,EAAE,EAAlE,EAAsE;MAClE,IAAI9E,OAAO,GAAGgH,UAAU,CAAClC,EAAD,CAAxB;;MACA,IAAI9E,OAAJ,EAAa;QACT,IAAI,KAAKsB,OAAL,CAAa+E,wBAAb,IAAyC,KAAK/E,OAAL,CAAagF,cAAb,CAA4BR,OAAzE,EAAkF;UAC9EG,WAAW,GAAGzE,QAAQ,CAACC,cAAT,CAAwB,KAAKH,OAAL,CAAatB,OAAb,CAAqBC,EAArB,GAA0B,sBAA1B,GAAmDc,KAAK,CAACQ,KAAjF,CAAd;UACA,KAAKiD,cAAL,CAAoByB,WAApB,EAAiC,KAAK9B,iBAAL,CAAuB8B,WAAW,CAAChG,EAAnC,CAAjC;QACH;;QACD,IAAI0G,OAAO,GAAGH,mBAAmB,IAAIA,mBAAmB,CAACI,cAApB,CAAmCvE,MAAnC,GAA4C,CAAnE,IACNmE,mBAAmB,CAACI,cAApB,CAAmC,CAAnC,EAAsCrF,KAAtC,CAA4CR,KAA5C,KAAsDA,KAAK,CAACQ,KADtD,GAEViF,mBAAmB,CAACK,UAApB,CAA+BF,OAFrB,GAE+B,KAAKrG,MAAL,CAAYS,KAAK,CAACT,MAAlB,EAA0BqG,OAFvE;QAGA3G,OAAO,CAAC8G,YAAR,CAAqB,SAArB,EAAgCH,OAAO,CAACI,QAAR,EAAhC;QACA,KAAKvC,cAAL,CAAoBxE,OAApB,EAA6B,KAAKmE,iBAAL,CAAuBnE,OAAO,CAACC,EAA/B,CAA7B;MACH;IACJ;EACJ,CAjBD;EAkBA;AACJ;AACA;;;EACInB,qBAAqB,CAACX,SAAtB,CAAgCsE,gBAAhC,GAAmD,UAAUoC,OAAV,EAAmB9D,KAAnB,EAA0BkG,GAA1B,EAA+B;IAC9E,KAAK,IAAI7E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyC,OAAO,CAACxC,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;MACrC,IAAI,KAAKoD,WAAL,CAAiBX,OAAO,CAACzC,CAAD,CAAxB,EAA6BrB,KAA7B,CAAJ,EAAyC;QACrC8D,OAAO,CAACY,MAAR,CAAerD,CAAf,EAAkB,CAAlB;QACAA,CAAC;MACJ;IACJ;;IACD,IAAI6E,GAAJ,EAAS;MACLpC,OAAO,CAAC1B,IAAR,CAAapC,KAAb;IACH;EACJ,CAVD;EAWA;AACJ;AACA;;;EACIjC,qBAAqB,CAACX,SAAtB,CAAgCqH,WAAhC,GAA8C,UAAU0B,KAAV,EAAiBC,MAAjB,EAAyB;IACnE,OAASD,KAAK,CAAC3F,KAAN,KAAgB4F,MAAM,CAAC5F,KAAxB,IAAmC2F,KAAK,CAAC5G,MAAN,KAAiB6G,MAAM,CAAC7G,MAAnE;EACH,CAFD;EAGA;;;EACAxB,qBAAqB,CAACX,SAAtB,CAAgCuB,SAAhC,GAA4C,UAAUuB,KAAV,EAAiB;IACzD,IAAIjC,YAAY,GAAG,KAAKA,YAAxB;IACA,IAAI6C,aAAa,GAAGZ,KAAK,CAACa,MAA1B;;IACA,IAAI9C,YAAY,CAAC2C,aAAb,KAA+B,MAAnC,EAA2C;MACvC,IAAI,CAACpD,iBAAiB,CAACsD,aAAD,CAAtB,EAAuC;QACnC,IAAIZ,KAAK,CAACa,MAAN,CAAa7B,EAAb,CAAgBkC,OAAhB,CAAwB,MAAxB,IAAkC,CAAtC,EAAyC;UACrCN,aAAa,GAAGpD,UAAU,CAACwC,KAAK,CAACa,MAAN,CAAa7B,EAAb,CAAgBgF,OAAhB,CAAwB,MAAxB,EAAgC,OAAhC,CAAD,CAA1B;QACH;;QACD,IAAKpD,aAAD,CAAgBS,YAAhB,CAA6B,OAA7B,KAA0CT,aAAD,CAAgBU,YAAhB,CAA6B,OAA7B,EAAsCJ,OAAtC,CAA8C,WAA9C,IAA6D,CAAC,CAA3G,EAA8G;UAC1G;QACH;;QACD,KAAKxC,yBAAL,CAA+BX,YAA/B,EAA6CiC,KAA7C;QACA;MACH;IACJ;;IACD,IAAIjC,YAAY,CAAC0B,aAAb,KAA+B,MAAnC,EAA2C;MACvC;IACH;EACJ,CAlBD;EAmBA;AACJ;AACA;;;EACI5B,qBAAqB,CAACX,SAAtB,CAAgCiJ,oBAAhC,GAAuD,UAAUjH,mBAAV,EAA+B;IAClF,IAAI2F,OAAO,GAAG,KAAd;;IACA,KAAK,IAAIhB,EAAE,GAAG,CAAT,EAAYuC,qBAAqB,GAAGlH,mBAAzC,EAA8D2E,EAAE,GAAGuC,qBAAqB,CAAChF,MAAzF,EAAiGyC,EAAE,EAAnG,EAAuG;MACnG,IAAIwC,IAAI,GAAGD,qBAAqB,CAACvC,EAAD,CAAhC;;MACA,IAAIpG,YAAY,CAAC4I,IAAI,CAAC/F,KAAN,EAAa,KAAKD,OAAL,CAAaf,aAAb,CAA2B,CAA3B,EAA8BiD,MAA3C,CAAZ,CAA+DsC,OAAnE,EAA4E;QACxEA,OAAO,GAAG,IAAV;QACA;MACH;IACJ;;IACD,OAAOA,OAAP;EACH,CAVD;EAWA;AACJ;AACA;;;EACIhH,qBAAqB,CAACX,SAAtB,CAAgCoJ,aAAhC,GAAgD,YAAY;IACxD,OAAO,uBAAP;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;AACA;;;EACIzI,qBAAqB,CAACX,SAAtB,CAAgCqJ,OAAhC,GAA0C,YAAY;IAClD;IACA,KAAK5H,mBAAL;EACH,CAHD;;EAIA,OAAOd,qBAAP;AACH,CAtf0C,CAsfzCF,aAtfyC,CAA3C;;AAufA,SAASE,qBAAT"},"metadata":{},"sourceType":"module"}