{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable max-len */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { isNullOrUndefined, setStyleAttribute, extend, EventHandler, createElement } from '@syncfusion/ej2-base';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\nimport { MonthEvent } from './month';\nvar EVENT_GAP = 2;\nvar BLOCK_INDICATOR_WIDTH = 22;\nvar BLOCK_INDICATOR_HEIGHT = 18;\n/**\n * Timeline view events render\n */\n\nvar TimelineEvent =\n/** @class */\nfunction (_super) {\n  __extends(TimelineEvent, _super);\n\n  function TimelineEvent(parent, type) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.startHour = _this.parent.activeView.getStartHour();\n    _this.endHour = _this.parent.activeView.getEndHour();\n    _this.slotCount = _this.parent.activeViewOptions.timeScale.slotCount;\n    _this.interval = _this.parent.activeViewOptions.timeScale.interval;\n    _this.day = 0;\n    _this.rowIndex = 0;\n    _this.cellTops = [];\n    _this.renderType = type;\n    _this.eventContainers = [].slice.call(_this.element.querySelectorAll('.' + cls.APPOINTMENT_CONTAINER_CLASS));\n    var tr = [].slice.call(_this.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody tr'));\n    _this.dayLength = tr.length === 0 ? 0 : tr[0].children.length;\n    _this.content = _this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n    return _this;\n  }\n\n  TimelineEvent.prototype.getSlotDates = function () {\n    this.slots = [];\n    this.slots.push(this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.headerRows.length > 0 && this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n      this.renderType = 'day';\n      this.cellWidth = this.content.offsetWidth / this.dateRender.length;\n      this.slotsPerDay = 1;\n    } else {\n      this.slotsPerDay = this.dayLength / this.dateRender.length;\n    }\n  };\n\n  TimelineEvent.prototype.getOverlapEvents = function (date, appointments) {\n    var appointmentsList = [];\n\n    if (this.renderType === 'day') {\n      for (var _i = 0, appointments_1 = appointments; _i < appointments_1.length; _i++) {\n        var app = appointments_1[_i];\n\n        if (util.resetTime(app[this.fields.startTime]).getTime() <= util.resetTime(new Date(date.getTime())).getTime() && util.resetTime(app[this.fields.endTime]).getTime() >= util.resetTime(new Date(date.getTime())).getTime()) {\n          appointmentsList.push(app);\n        }\n      }\n    } else {\n      for (var _a = 0, appointments_2 = appointments; _a < appointments_2.length; _a++) {\n        var app = appointments_2[_a];\n        var eventData = app.data;\n\n        if (eventData.trimStartTime.getTime() <= date.getTime() && eventData.trimEndTime.getTime() > date.getTime()) {\n          appointmentsList.push(app);\n        }\n      }\n    }\n\n    return appointmentsList;\n  };\n\n  TimelineEvent.prototype.getSortComparerIndex = function (startDate, endDate) {\n    var appIndex = -1;\n    var appointments = this.renderedEvents;\n\n    if (appointments.length > 0) {\n      var appointmentsList = this.getOverlapSortComparerEvents(startDate, endDate, appointments);\n      var appLevel = appointmentsList.map(function (obj) {\n        return obj.Index;\n      });\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  };\n\n  TimelineEvent.prototype.getOverlapSortComparerEvents = function (startDate, endDate, appointmentsCollection) {\n    var appointments = [];\n\n    for (var _i = 0, appointmentsCollection_1 = appointmentsCollection; _i < appointmentsCollection_1.length; _i++) {\n      var app = appointmentsCollection_1[_i];\n\n      if (this.renderType === 'day') {\n        if (util.resetTime(app[this.fields.startTime]).getTime() <= util.resetTime(new Date(startDate.getTime())).getTime() && util.resetTime(app[this.fields.endTime]).getTime() >= util.resetTime(new Date(startDate.getTime())).getTime()) {\n          appointments.push(app);\n        }\n      } else {\n        var eventData = app.data;\n\n        if (eventData.trimStartTime.getTime() <= startDate.getTime() && startDate.getTime() < eventData.trimEndTime.getTime() || startDate.getTime() <= eventData.trimStartTime.getTime() && eventData.trimStartTime.getTime() < endDate.getTime()) {\n          appointments.push(app);\n        }\n      }\n    }\n\n    return appointments;\n  };\n\n  TimelineEvent.prototype.renderResourceEvents = function () {\n    this.removeHeightProperty(cls.RESOURCE_COLUMN_TABLE_CLASS);\n    var resources = this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.renderedResources;\n\n    if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n      for (var i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n        var source = this.parent.crudModule.crudObj.sourceEvent[i];\n        this.rowIndex = source.groupIndex;\n        this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, source);\n\n        if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !== this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n          var target = this.parent.crudModule.crudObj.targetEvent[i];\n          this.rowIndex = target.groupIndex;\n          this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, target);\n        }\n      }\n\n      this.parent.crudModule.crudObj.isCrudAction = false;\n    } else {\n      for (var i = 0; i < resources.length; i++) {\n        this.rowIndex = i;\n        this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, resources[i]);\n      }\n    }\n  };\n\n  TimelineEvent.prototype.renderEvents = function (event, resIndex, appointmentsList) {\n    var startTime = event[this.fields.startTime];\n    var endTime = event[this.fields.endTime];\n\n    if (startTime.getTime() < this.parent.minDate.getTime() || endTime.getTime() > this.parent.maxDate.getTime()) {\n      return;\n    }\n\n    var eventData = event.data;\n    startTime = this.getStartTime(event, eventData);\n    endTime = this.getEndTime(event, eventData);\n    var startEndHours = util.getStartEndHours(event[this.fields.startTime], this.startHour, this.endHour);\n    var eventDates = this.updateEventMinimumDuration(startEndHours, startTime, endTime);\n    startTime = eventDates.startDate;\n    endTime = eventDates.endDate;\n    this.day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n\n    if (this.day < 0) {\n      return;\n    }\n\n    var cellTd = this.getCellTd();\n    var overlapCount = isNullOrUndefined(this.parent.eventSettings.sortComparer) ? this.getIndex(startTime) : this.getSortComparerIndex(startTime, endTime);\n    event.Index = overlapCount;\n    var appHeight = this.eventHeight;\n    var diffInDays = eventData.count;\n    var eventObj = extend({}, event, null, true);\n    eventObj[this.fields.startTime] = eventData[this.fields.startTime];\n    eventObj[this.fields.endTime] = eventData[this.fields.endTime];\n    var currentDate = util.resetTime(new Date(this.dateRender[this.day].getTime()));\n    var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n    var isValidEvent = this.isValidEvent(eventObj, startTime, endTime, schedule);\n\n    if (startTime <= endTime && isValidEvent) {\n      var appWidth_1 = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n      appWidth_1 = this.renderType === 'day' ? appWidth_1 - 2 : appWidth_1;\n      var appLeft = 0;\n      var appRight = 0;\n      var position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], this.day);\n      appWidth_1 = appWidth_1 <= 0 ? this.cellWidth : appWidth_1; // appWidth 0 when start and end time as same\n\n      this.renderedEvents.push(extend({}, event, null, true));\n\n      if (isNullOrUndefined(this.cellTops[resIndex])) {\n        this.cellTops[resIndex] = this.getRowTop(resIndex);\n      }\n\n      var top_1 = this.cellTops[resIndex];\n      var appTop = top_1 + (this.maxHeight ? 0 : EVENT_GAP) + overlapCount * (appHeight + EVENT_GAP);\n      appLeft = this.parent.enableRtl ? 0 : position;\n      appRight = this.parent.enableRtl ? position : 0;\n      var height = (overlapCount + 1) * (appHeight + EVENT_GAP) + this.moreIndicatorHeight;\n      var renderApp = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n\n      if (this.parent.rowAutoHeight || renderApp) {\n        var appointmentElement = void 0;\n\n        if (isNullOrUndefined(this.inlineValue)) {\n          appointmentElement = this.createAppointmentElement(event, resIndex);\n        } else {\n          appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n        }\n\n        this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n        setStyleAttribute(appointmentElement, {\n          'width': appWidth_1 + 'px',\n          'left': appLeft + 'px',\n          'right': appRight + 'px',\n          'top': appTop + 'px'\n        });\n        this.wireAppointmentEvents(appointmentElement, event);\n        this.renderEventElement(event, appointmentElement, cellTd);\n\n        if (this.parent.rowAutoHeight) {\n          var firstChild = this.getFirstChild(resIndex);\n          this.updateCellHeight(firstChild, height);\n        }\n\n        if (this.parent.activeViewOptions.option !== 'TimelineMonth' && this.parent.activeViewOptions.timeScale.enable && appWidth_1 < this.cellWidth) {\n          var resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + cls.EVENT_RESIZE_CLASS));\n          resizeHandlers.forEach(function (resizeHandler) {\n            resizeHandler.style.width = Math.ceil(appWidth_1 / resizeHandler.getBoundingClientRect().width) + 'px';\n          });\n        }\n      } else {\n        for (var i = 0; i < diffInDays; i++) {\n          var moreIndicator = cellTd.querySelector('.' + cls.MORE_INDICATOR_CLASS);\n          var appPos = this.parent.enableRtl ? appRight : appLeft;\n          appPos = Math.floor(appPos / this.cellWidth) * this.cellWidth;\n          var interval = this.interval / this.slotCount;\n          var startDate = this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day' || i !== 0 ? new Date(this.dateRender[this.day + i].getTime()) : new Date(startTime);\n          var endDate = util.addDays(this.dateRender[this.day + i], 1);\n\n          if (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day') {\n            var position_1 = this.getPosition(startDate, endDate, event[this.fields.isAllDay], this.day + i);\n            this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top_1, appLeft, appRight, cellTd, moreIndicator, appPos, position_1);\n          } else {\n            var slotCount = (util.getUniversalTime(endTime) - util.getUniversalTime(startTime)) / util.MS_PER_MINUTE * this.slotCount / this.interval;\n\n            for (var k = 0; k < slotCount; k++) {\n              startDate = k === 0 ? new Date(startDate.getTime()) : new Date(startDate.getTime() + 60000 * interval);\n              endDate = new Date(startDate.getTime() + 60000 * interval);\n\n              if (endDate.getTime() > endTime.getTime()) {\n                break;\n              }\n\n              var position_2 = this.getPosition(startDate, endDate, false, this.day + i);\n\n              if (appPos > position_2) {\n                break;\n              }\n\n              appPos = position_2;\n              this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top_1, appLeft, appRight, cellTd, moreIndicator, appPos, position_2);\n            }\n          }\n        }\n      }\n    }\n\n    this.parent.renderTemplates();\n  };\n\n  TimelineEvent.prototype.renderTimelineMoreIndicator = function (startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position) {\n    appLeft = this.parent.enableRtl ? appRight = position : position;\n    appPos = this.parent.enableRtl ? appRight : appLeft;\n    appPos = Math.floor(appPos / this.cellWidth) * this.cellWidth;\n\n    if (cellTd && isNullOrUndefined(moreIndicator) || !this.isAlreadyAvail(appPos, cellTd)) {\n      var startDateTime = this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day' ? new Date(+startTime) : startDate;\n      var slotStartTime = new Date(startDateTime.setMinutes(Math.floor(startDateTime.getMinutes() / interval) * interval));\n      var slotEndTime = new Date(slotStartTime.getTime() + 60000 * interval);\n      var groupIndex = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(resIndex)) {\n        groupIndex = resIndex.toString();\n      }\n\n      var filterEvents = this.getFilterEvents(startDate, endDate, slotStartTime, slotEndTime, groupIndex, appointmentsList);\n      var appArea = this.cellHeight - this.moreIndicatorHeight;\n      appHeight = this.withIndicator ? appArea - EVENT_GAP : appHeight;\n      var renderedAppCount = Math.floor(appArea / (appHeight + EVENT_GAP));\n      var count = filterEvents.length - renderedAppCount <= 0 ? 1 : filterEvents.length - renderedAppCount;\n      var moreIndicatorElement = void 0;\n\n      if (this.renderType === 'day') {\n        moreIndicatorElement = this.getMoreIndicatorElement(count, startDate, endDate);\n      } else {\n        moreIndicatorElement = this.getMoreIndicatorElement(count, slotStartTime, slotEndTime);\n      }\n\n      if (!isNullOrUndefined(groupIndex)) {\n        moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n      }\n\n      moreIndicatorElement.style.top = top + appArea + 'px';\n      moreIndicatorElement.style.width = this.cellWidth + 'px';\n      moreIndicatorElement.style.left = Math.floor(appLeft / this.cellWidth) * this.cellWidth + 'px';\n      moreIndicatorElement.style.right = Math.floor(appRight / this.cellWidth) * this.cellWidth + 'px';\n      this.renderElement(cellTd, moreIndicatorElement);\n      EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n    }\n  };\n\n  TimelineEvent.prototype.updateCellHeight = function (cell, height) {\n    if (height > this.cellHeight) {\n      setStyleAttribute(cell, {\n        'height': height + 'px'\n      });\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        var resourceCell = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_TABLE_CLASS + ' ' + 'tbody td[data-group-index=\"' + cell.getAttribute('data-group-index') + '\"]');\n\n        if (resourceCell) {\n          setStyleAttribute(resourceCell, {\n            'height': height + 'px'\n          });\n        }\n      }\n\n      var monthHeader = this.parent.element.querySelector('.e-month-header-wrapper table tr:nth-child(' + (cell.parentElement.rowIndex + 1) + ') td');\n\n      if (monthHeader) {\n        setStyleAttribute(monthHeader, {\n          'height': height + 'px'\n        });\n      }\n    }\n  };\n\n  TimelineEvent.prototype.getFirstChild = function (index) {\n    var query = '.' + cls.CONTENT_TABLE_CLASS + ' tbody td';\n    var groupIndex = '';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      groupIndex = '[data-group-index=\"' + index.toString() + '\"]';\n    }\n\n    var td = this.parent.element.querySelector(query + groupIndex);\n    return td;\n  };\n\n  TimelineEvent.prototype.updateBlockElements = function () {\n    var blockElement = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS));\n\n    for (var _i = 0, blockElement_1 = blockElement; _i < blockElement_1.length; _i++) {\n      var element = blockElement_1[_i];\n      var resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n      var firstChild = this.getFirstChild(resIndex);\n      element.style.height = firstChild.offsetHeight + 'px';\n      var width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n      element.style.width = firstChild.offsetWidth * width + 'px';\n    }\n\n    var blockIndicator = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_INDICATOR_CLASS));\n\n    for (var _a = 0, blockIndicator_1 = blockIndicator; _a < blockIndicator_1.length; _a++) {\n      var element = blockIndicator_1[_a];\n      var resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n      element.style.top = this.getRowTop(resIndex) + this.getFirstChild(resIndex).offsetHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n    }\n  };\n\n  TimelineEvent.prototype.getStartTime = function (event, eventData) {\n    var startTime = event[this.fields.startTime];\n    var schedule = util.getStartEndHours(startTime, this.startHour, this.endHour);\n\n    if (schedule.startHour.getTime() >= eventData[this.fields.startTime]) {\n      startTime = schedule.startHour;\n    } else if (schedule.endHour.getTime() <= eventData[this.fields.startTime]) {\n      startTime = this.getNextDay(schedule.startHour, eventData);\n    } else {\n      startTime = eventData[this.fields.startTime];\n    } // To overcome the overflow\n\n\n    eventData.trimStartTime = event[this.fields.isAllDay] ? schedule.startHour : eventData[this.fields.startTime];\n    return startTime;\n  };\n\n  TimelineEvent.prototype.getNextDay = function (startTime, eventData) {\n    var startDate;\n\n    for (var i = 1; i <= this.dateRender.length; i++) {\n      startDate = util.addDays(startTime, i);\n\n      if (this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime()))) !== -1) {\n        eventData.count = eventData.count - 1;\n        return startDate;\n      }\n    }\n\n    return startDate;\n  };\n\n  TimelineEvent.prototype.getEndTime = function (event, eventData) {\n    var endTime = event[this.fields.endTime];\n    var schedule = util.getStartEndHours(endTime, this.startHour, this.endHour);\n\n    if (this.parent.currentView === 'TimelineMonth' || !this.parent.activeViewOptions.timeScale.enable || this.parent.activeViewOptions.headerRows.length > 0 && this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n      endTime = eventData[this.fields.endTime];\n    } else {\n      endTime = eventData[this.fields.endTime];\n\n      if (schedule.endHour.getTime() <= eventData[this.fields.endTime]) {\n        endTime = schedule.endHour;\n      }\n\n      if (schedule.startHour.getTime() >= eventData[this.fields.endTime].getTime() && !event.isAllDay) {\n        endTime = this.getPreviousDay(schedule.startHour, schedule.endHour, eventData);\n      }\n    } // To overcome the overflow\n\n\n    eventData.trimEndTime = event[this.fields.isAllDay] ? schedule.endHour : eventData[this.fields.endTime];\n    return endTime;\n  };\n\n  TimelineEvent.prototype.getPreviousDay = function (startTime, endTime, eventData) {\n    for (var i = 1; i <= this.dateRender.length; i++) {\n      var endDate = util.addDays(endTime, -i);\n\n      if (this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime()))) !== -1) {\n        endDate = util.resetTime(new Date(endDate.getTime()));\n        endDate.setHours(endTime.getHours(), endTime.getMinutes(), endTime.getSeconds());\n        var count = eventData.count;\n        var actualEndTime = eventData[this.fields.endTime];\n        eventData.count = actualEndTime.getHours() !== 0 || actualEndTime.getMinutes() !== 0 ? count - 1 : count;\n        return endDate;\n      }\n    }\n\n    return eventData[this.fields.endTime];\n  };\n\n  TimelineEvent.prototype.getEventWidth = function (startDate, endDate, isAllDay, count) {\n    if (this.renderType === 'day' || isAllDay) {\n      return count * this.slotsPerDay * this.cellWidth;\n    }\n\n    if (this.isSameDay(startDate, endDate)) {\n      return this.getSameDayEventsWidth(startDate, endDate);\n    } else {\n      return this.getSpannedEventsWidth(startDate, endDate, count);\n    }\n  };\n\n  TimelineEvent.prototype.getSameDayEventsWidth = function (startDate, endDate) {\n    return (util.getUniversalTime(endDate) - util.getUniversalTime(startDate)) / util.MS_PER_MINUTE * (this.cellWidth * this.slotCount) / this.interval;\n  };\n\n  TimelineEvent.prototype.getSpannedEventsWidth = function (startDate, endDate, diffInDays) {\n    var width = diffInDays * this.slotsPerDay * this.cellWidth;\n    var endWidth;\n    var start = util.getStartEndHours(util.resetTime(new Date(startDate.getTime())), this.startHour, this.endHour);\n    var startWidth = this.getSameDayEventsWidth(start.startHour, startDate);\n\n    if (this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(endDate.getTime()))) === -1) {\n      endWidth = 0;\n    } else {\n      var end = util.getStartEndHours(util.resetTime(new Date(endDate.getTime())), this.startHour, this.endHour);\n      endWidth = this.getSameDayEventsWidth(endDate, end.endHour);\n      endWidth = this.slotsPerDay * this.cellWidth === endWidth ? 0 : endWidth;\n    }\n\n    var spannedWidth = startWidth + endWidth;\n    return width > spannedWidth ? width - spannedWidth : width - startWidth;\n  };\n\n  TimelineEvent.prototype.isSameDay = function (startTime, endTime) {\n    var startDay = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n    var endDay = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(endTime.getTime())));\n    return startDay === endDay;\n  };\n\n  TimelineEvent.prototype.getAppointmentLeft = function (schedule, startTime, day) {\n    var slotTd = this.isSameDay(startTime, schedule.startHour) ? (util.getUniversalTime(startTime) - util.getUniversalTime(schedule.startHour)) / (util.MS_PER_MINUTE * this.interval) * this.slotCount : 0;\n\n    if (day === 0) {\n      return slotTd;\n    } else {\n      var daySlot = Math.round((util.getUniversalTime(schedule.endHour) - util.getUniversalTime(schedule.startHour)) / util.MS_PER_MINUTE / this.interval * this.slotCount);\n      return daySlot * day + slotTd;\n    }\n  };\n\n  TimelineEvent.prototype.getPosition = function (startTime, endTime, isAllDay, day) {\n    if (this.renderType === 'day' || isAllDay) {\n      return day * this.slotsPerDay * this.cellWidth;\n    }\n\n    var currentDate = util.resetTime(new Date(this.dateRender[day].getTime()));\n    var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n    var cellIndex;\n\n    if (schedule.endHour.getTime() <= endTime.getTime() && schedule.startHour.getTime() >= startTime.getTime()) {\n      cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n    } else if (schedule.endHour.getTime() <= endTime.getTime()) {\n      cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n    } else if (schedule.startHour.getTime() >= startTime.getTime()) {\n      cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n    } else {\n      cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n    }\n\n    return cellIndex * this.cellWidth;\n  };\n\n  TimelineEvent.prototype.getFilterEvents = function (startDate, endDate, startTime, endTime, gIndex, eventsList) {\n    if (this.renderType === 'day') {\n      return this.getFilteredEvents(startDate, endDate, gIndex, eventsList);\n    } else {\n      return this.getFilteredEvents(startTime, endTime, gIndex, eventsList);\n    }\n  };\n\n  TimelineEvent.prototype.isAlreadyAvail = function (appPos, cellTd) {\n    var moreIndicator = [].slice.call(cellTd.querySelectorAll('.' + cls.MORE_INDICATOR_CLASS));\n\n    for (var i = 0; i < moreIndicator.length; i++) {\n      var indicatorPos = void 0;\n\n      if (moreIndicator) {\n        indicatorPos = this.parent.enableRtl ? moreIndicator[i].style.right : moreIndicator[i].style.left;\n      }\n\n      if (parseInt(indicatorPos, 10) === Math.floor(appPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  TimelineEvent.prototype.getRowTop = function (resIndex) {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      return this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'tbody td[data-group-index=\"' + resIndex.toString() + '\"]').offsetTop;\n    }\n\n    return 0;\n  };\n\n  TimelineEvent.prototype.getCellTd = function () {\n    var wrapIndex = this.parent.uiStateValues.isGroupAdaptive ? 0 : this.rowIndex;\n    return this.eventContainers[wrapIndex];\n  };\n\n  TimelineEvent.prototype.renderBlockIndicator = function (cellTd, position, resIndex) {\n    // No need to render block icon for Year, Month and Week header rows\n    if (this.parent.headerRows.length > 0 && (this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Hour' || this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Date')) {\n      return;\n    }\n\n    position = Math.floor(position / this.cellWidth) * this.cellWidth + this.cellWidth - BLOCK_INDICATOR_WIDTH;\n\n    if (!this.isAlreadyAvail(position, cellTd)) {\n      var blockIndicator = createElement('div', {\n        className: 'e-icons ' + cls.BLOCK_INDICATOR_CLASS\n      });\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        blockIndicator.setAttribute('data-group-index', resIndex.toString());\n      }\n\n      if (this.parent.enableRtl) {\n        blockIndicator.style.right = position + 'px';\n      } else {\n        blockIndicator.style.left = position + 'px';\n      }\n\n      blockIndicator.style.top = this.getRowTop(resIndex) + this.cellHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n      this.renderElement(cellTd, blockIndicator);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  TimelineEvent.prototype.setMaxEventHeight = function (event, cell) {\n    setStyleAttribute(event, {\n      'height': this.cellHeight - (this.maxHeight ? 0 : EVENT_GAP) - (this.maxHeight ? 0 : this.moreIndicatorHeight) + 'px'\n    });\n  };\n\n  TimelineEvent.prototype.destroy = function () {\n    this.renderType = null;\n    this.eventContainers = null;\n    this.dayLength = null;\n    this.content = null;\n\n    _super.prototype.destroy.call(this);\n\n    this.parent = null;\n  };\n\n  return TimelineEvent;\n}(MonthEvent);\n\nexport { TimelineEvent };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","isNullOrUndefined","setStyleAttribute","extend","EventHandler","createElement","cls","util","MonthEvent","EVENT_GAP","BLOCK_INDICATOR_WIDTH","BLOCK_INDICATOR_HEIGHT","TimelineEvent","_super","parent","type","_this","call","startHour","activeView","getStartHour","endHour","getEndHour","slotCount","activeViewOptions","timeScale","interval","day","rowIndex","cellTops","renderType","eventContainers","slice","element","querySelectorAll","APPOINTMENT_CONTAINER_CLASS","tr","CONTENT_TABLE_CLASS","dayLength","length","children","content","querySelector","getSlotDates","slots","push","renderDates","map","date","headerRows","option","cellWidth","offsetWidth","dateRender","slotsPerDay","getOverlapEvents","appointments","appointmentsList","_i","appointments_1","app","resetTime","fields","startTime","getTime","Date","endTime","_a","appointments_2","eventData","data","trimStartTime","trimEndTime","getSortComparerIndex","startDate","endDate","appIndex","renderedEvents","getOverlapSortComparerEvents","appLevel","obj","Index","getSmallestMissingNumber","appointmentsCollection","appointmentsCollection_1","renderResourceEvents","removeHeightProperty","RESOURCE_COLUMN_TABLE_CLASS","resources","uiStateValues","isGroupAdaptive","resourceBase","lastResourceLevel","groupIndex","renderedResources","crudModule","crudObj","isCrudAction","i","len","sourceEvent","source","renderEventsHandler","workDays","targetEvent","target","renderEvents","event","resIndex","minDate","maxDate","getStartTime","getEndTime","startEndHours","getStartEndHours","eventDates","updateEventMinimumDuration","getIndexOfDate","cellTd","getCellTd","overlapCount","eventSettings","sortComparer","getIndex","appHeight","eventHeight","diffInDays","count","eventObj","currentDate","schedule","isValidEvent","appWidth_1","getEventWidth","isAllDay","appLeft","appRight","position","getPosition","getRowTop","top_1","appTop","maxHeight","enableRtl","height","moreIndicatorHeight","renderApp","maxOrIndicator","cellHeight","rowAutoHeight","appointmentElement","inlineValue","createAppointmentElement","inlineModule","createInlineAppointmentElement","applyResourceColor","groupOrder","wireAppointmentEvents","renderEventElement","firstChild","getFirstChild","updateCellHeight","enable","resizeHandlers","EVENT_RESIZE_CLASS","forEach","resizeHandler","style","width","Math","ceil","getBoundingClientRect","moreIndicator","MORE_INDICATOR_CLASS","appPos","floor","addDays","position_1","renderTimelineMoreIndicator","getUniversalTime","MS_PER_MINUTE","k","position_2","renderTemplates","top","isAlreadyAvail","startDateTime","slotStartTime","setMinutes","getMinutes","slotEndTime","group","toString","filterEvents","getFilterEvents","appArea","withIndicator","renderedAppCount","moreIndicatorElement","getMoreIndicatorElement","setAttribute","left","right","renderElement","add","moreIndicatorClick","cell","resourceCell","getAttribute","monthHeader","parentElement","index","query","td","updateBlockElements","blockElement","BLOCK_APPOINTMENT_CLASS","blockElement_1","parseInt","offsetHeight","round","blockIndicator","BLOCK_INDICATOR_CLASS","blockIndicator_1","getNextDay","currentView","getPreviousDay","setHours","getHours","getSeconds","actualEndTime","isSameDay","getSameDayEventsWidth","getSpannedEventsWidth","endWidth","start","startWidth","end","spannedWidth","startDay","endDay","getAppointmentLeft","slotTd","daySlot","cellIndex","gIndex","eventsList","getFilteredEvents","indicatorPos","CONTENT_WRAP_CLASS","offsetTop","wrapIndex","renderBlockIndicator","className","setMaxEventHeight","destroy"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/timeline-view.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable max-len */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isNullOrUndefined, setStyleAttribute, extend, EventHandler, createElement } from '@syncfusion/ej2-base';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\nimport { MonthEvent } from './month';\nvar EVENT_GAP = 2;\nvar BLOCK_INDICATOR_WIDTH = 22;\nvar BLOCK_INDICATOR_HEIGHT = 18;\n/**\n * Timeline view events render\n */\nvar TimelineEvent = /** @class */ (function (_super) {\n    __extends(TimelineEvent, _super);\n    function TimelineEvent(parent, type) {\n        var _this = _super.call(this, parent) || this;\n        _this.startHour = _this.parent.activeView.getStartHour();\n        _this.endHour = _this.parent.activeView.getEndHour();\n        _this.slotCount = _this.parent.activeViewOptions.timeScale.slotCount;\n        _this.interval = _this.parent.activeViewOptions.timeScale.interval;\n        _this.day = 0;\n        _this.rowIndex = 0;\n        _this.cellTops = [];\n        _this.renderType = type;\n        _this.eventContainers = [].slice.call(_this.element.querySelectorAll('.' + cls.APPOINTMENT_CONTAINER_CLASS));\n        var tr = [].slice.call(_this.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody tr'));\n        _this.dayLength = tr.length === 0 ? 0 : tr[0].children.length;\n        _this.content = _this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS);\n        return _this;\n    }\n    TimelineEvent.prototype.getSlotDates = function () {\n        this.slots = [];\n        this.slots.push(this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.headerRows.length > 0 &&\n            this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n            this.renderType = 'day';\n            this.cellWidth = this.content.offsetWidth / this.dateRender.length;\n            this.slotsPerDay = 1;\n        }\n        else {\n            this.slotsPerDay = (this.dayLength / this.dateRender.length);\n        }\n    };\n    TimelineEvent.prototype.getOverlapEvents = function (date, appointments) {\n        var appointmentsList = [];\n        if (this.renderType === 'day') {\n            for (var _i = 0, appointments_1 = appointments; _i < appointments_1.length; _i++) {\n                var app = appointments_1[_i];\n                if ((util.resetTime(app[this.fields.startTime]).getTime() <= util.resetTime(new Date(date.getTime())).getTime()) &&\n                    (util.resetTime(app[this.fields.endTime]).getTime() >= util.resetTime(new Date(date.getTime())).getTime())) {\n                    appointmentsList.push(app);\n                }\n            }\n        }\n        else {\n            for (var _a = 0, appointments_2 = appointments; _a < appointments_2.length; _a++) {\n                var app = appointments_2[_a];\n                var eventData = app.data;\n                if (eventData.trimStartTime.getTime() <= date.getTime() &&\n                    eventData.trimEndTime.getTime() > date.getTime()) {\n                    appointmentsList.push(app);\n                }\n            }\n        }\n        return appointmentsList;\n    };\n    TimelineEvent.prototype.getSortComparerIndex = function (startDate, endDate) {\n        var appIndex = -1;\n        var appointments = this.renderedEvents;\n        if (appointments.length > 0) {\n            var appointmentsList = this.getOverlapSortComparerEvents(startDate, endDate, appointments);\n            var appLevel = appointmentsList.map(function (obj) { return obj.Index; });\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\n        }\n        return (appIndex === -1) ? 0 : appIndex;\n    };\n    TimelineEvent.prototype.getOverlapSortComparerEvents = function (startDate, endDate, appointmentsCollection) {\n        var appointments = [];\n        for (var _i = 0, appointmentsCollection_1 = appointmentsCollection; _i < appointmentsCollection_1.length; _i++) {\n            var app = appointmentsCollection_1[_i];\n            if (this.renderType === 'day') {\n                if ((util.resetTime(app[this.fields.startTime]).getTime() <= util.resetTime(new Date(startDate.getTime())).getTime()) &&\n                    (util.resetTime(app[this.fields.endTime]).getTime() >= util.resetTime(new Date(startDate.getTime())).getTime())) {\n                    appointments.push(app);\n                }\n            }\n            else {\n                var eventData = app.data;\n                if (((eventData.trimStartTime.getTime() <= startDate.getTime()) && (startDate.getTime() < eventData.trimEndTime.getTime())) ||\n                    ((startDate.getTime() <= eventData.trimStartTime.getTime()) && (eventData.trimStartTime.getTime() < endDate.getTime()))) {\n                    appointments.push(app);\n                }\n            }\n        }\n        return appointments;\n    };\n    TimelineEvent.prototype.renderResourceEvents = function () {\n        this.removeHeightProperty(cls.RESOURCE_COLUMN_TABLE_CLASS);\n        var resources = this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.resourceBase.renderedResources;\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n            for (var i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                var source = this.parent.crudModule.crudObj.sourceEvent[i];\n                this.rowIndex = source.groupIndex;\n                this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, source);\n                if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                    this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n                    var target = this.parent.crudModule.crudObj.targetEvent[i];\n                    this.rowIndex = target.groupIndex;\n                    this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, target);\n                }\n            }\n            this.parent.crudModule.crudObj.isCrudAction = false;\n        }\n        else {\n            for (var i = 0; i < resources.length; i++) {\n                this.rowIndex = i;\n                this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, resources[i]);\n            }\n        }\n    };\n    TimelineEvent.prototype.renderEvents = function (event, resIndex, appointmentsList) {\n        var startTime = event[this.fields.startTime];\n        var endTime = event[this.fields.endTime];\n        if ((startTime.getTime() < this.parent.minDate.getTime()) || (endTime.getTime() > this.parent.maxDate.getTime())) {\n            return;\n        }\n        var eventData = event.data;\n        startTime = this.getStartTime(event, eventData);\n        endTime = this.getEndTime(event, eventData);\n        var startEndHours = util.getStartEndHours(event[this.fields.startTime], this.startHour, this.endHour);\n        var eventDates = this.updateEventMinimumDuration(startEndHours, startTime, endTime);\n        startTime = eventDates.startDate;\n        endTime = eventDates.endDate;\n        this.day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n        if (this.day < 0) {\n            return;\n        }\n        var cellTd = this.getCellTd();\n        var overlapCount = (isNullOrUndefined(this.parent.eventSettings.sortComparer)) ? this.getIndex(startTime) : this.getSortComparerIndex(startTime, endTime);\n        event.Index = overlapCount;\n        var appHeight = this.eventHeight;\n        var diffInDays = eventData.count;\n        var eventObj = extend({}, event, null, true);\n        eventObj[this.fields.startTime] = eventData[this.fields.startTime];\n        eventObj[this.fields.endTime] = eventData[this.fields.endTime];\n        var currentDate = util.resetTime(new Date(this.dateRender[this.day].getTime()));\n        var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n        var isValidEvent = this.isValidEvent(eventObj, startTime, endTime, schedule);\n        if (startTime <= endTime && isValidEvent) {\n            var appWidth_1 = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n            appWidth_1 = this.renderType === 'day' ? appWidth_1 - 2 : appWidth_1;\n            var appLeft = 0;\n            var appRight = 0;\n            var position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], this.day);\n            appWidth_1 = (appWidth_1 <= 0) ? this.cellWidth : appWidth_1; // appWidth 0 when start and end time as same\n            this.renderedEvents.push(extend({}, event, null, true));\n            if (isNullOrUndefined(this.cellTops[resIndex])) {\n                this.cellTops[resIndex] = this.getRowTop(resIndex);\n            }\n            var top_1 = this.cellTops[resIndex];\n            var appTop = (top_1 + (this.maxHeight ? 0 : EVENT_GAP)) + (overlapCount * (appHeight + EVENT_GAP));\n            appLeft = (this.parent.enableRtl) ? 0 : position;\n            appRight = (this.parent.enableRtl) ? position : 0;\n            var height = ((overlapCount + 1) * (appHeight + EVENT_GAP)) + this.moreIndicatorHeight;\n            var renderApp = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n            if (this.parent.rowAutoHeight || renderApp) {\n                var appointmentElement = void 0;\n                if (isNullOrUndefined(this.inlineValue)) {\n                    appointmentElement = this.createAppointmentElement(event, resIndex);\n                }\n                else {\n                    appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n                }\n                this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n                setStyleAttribute(appointmentElement, {\n                    'width': appWidth_1 + 'px', 'left': appLeft + 'px', 'right': appRight + 'px', 'top': appTop + 'px'\n                });\n                this.wireAppointmentEvents(appointmentElement, event);\n                this.renderEventElement(event, appointmentElement, cellTd);\n                if (this.parent.rowAutoHeight) {\n                    var firstChild = this.getFirstChild(resIndex);\n                    this.updateCellHeight(firstChild, height);\n                }\n                if (this.parent.activeViewOptions.option !== 'TimelineMonth' && this.parent.activeViewOptions.timeScale.enable\n                    && appWidth_1 < this.cellWidth) {\n                    var resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + cls.EVENT_RESIZE_CLASS));\n                    resizeHandlers.forEach(function (resizeHandler) {\n                        resizeHandler.style.width = Math.ceil(appWidth_1 / resizeHandler.getBoundingClientRect().width) + 'px';\n                    });\n                }\n            }\n            else {\n                for (var i = 0; i < diffInDays; i++) {\n                    var moreIndicator = cellTd.querySelector('.' + cls.MORE_INDICATOR_CLASS);\n                    var appPos = (this.parent.enableRtl) ? appRight : appLeft;\n                    appPos = (Math.floor(appPos / this.cellWidth) * this.cellWidth);\n                    var interval = this.interval / this.slotCount;\n                    var startDate = (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day' || i !== 0) ?\n                        new Date(this.dateRender[this.day + i].getTime()) : new Date(startTime);\n                    var endDate = util.addDays(this.dateRender[this.day + i], 1);\n                    if (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day') {\n                        var position_1 = this.getPosition(startDate, endDate, event[this.fields.isAllDay], (this.day + i));\n                        this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top_1, appLeft, appRight, cellTd, moreIndicator, appPos, position_1);\n                    }\n                    else {\n                        var slotCount = (util.getUniversalTime(endTime) - util.getUniversalTime(startTime)) / util.MS_PER_MINUTE *\n                            this.slotCount / this.interval;\n                        for (var k = 0; k < slotCount; k++) {\n                            startDate = (k === 0) ? new Date(startDate.getTime()) : new Date(startDate.getTime() + (60000 * interval));\n                            endDate = new Date(startDate.getTime() + (60000 * interval));\n                            if (endDate.getTime() > endTime.getTime()) {\n                                break;\n                            }\n                            var position_2 = this.getPosition(startDate, endDate, false, (this.day + i));\n                            if (appPos > position_2) {\n                                break;\n                            }\n                            appPos = position_2;\n                            this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top_1, appLeft, appRight, cellTd, moreIndicator, appPos, position_2);\n                        }\n                    }\n                }\n            }\n        }\n        this.parent.renderTemplates();\n    };\n    TimelineEvent.prototype.renderTimelineMoreIndicator = function (startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position) {\n        appLeft = (this.parent.enableRtl) ? appRight = position : position;\n        appPos = (this.parent.enableRtl) ? appRight : appLeft;\n        appPos = (Math.floor(appPos / this.cellWidth) * this.cellWidth);\n        if ((cellTd && isNullOrUndefined(moreIndicator)) ||\n            (!this.isAlreadyAvail(appPos, cellTd))) {\n            var startDateTime = (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day') ? new Date(+startTime) : startDate;\n            var slotStartTime = (new Date(startDateTime.setMinutes(Math.floor(startDateTime.getMinutes() / interval) * interval)));\n            var slotEndTime = new Date(slotStartTime.getTime() + (60000 * interval));\n            var groupIndex = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(resIndex)) {\n                groupIndex = resIndex.toString();\n            }\n            var filterEvents = this.getFilterEvents(startDate, endDate, slotStartTime, slotEndTime, groupIndex, appointmentsList);\n            var appArea = this.cellHeight - this.moreIndicatorHeight;\n            appHeight = this.withIndicator ? appArea - EVENT_GAP : appHeight;\n            var renderedAppCount = Math.floor(appArea / (appHeight + EVENT_GAP));\n            var count = (filterEvents.length - renderedAppCount) <= 0 ? 1 : (filterEvents.length - renderedAppCount);\n            var moreIndicatorElement = void 0;\n            if (this.renderType === 'day') {\n                moreIndicatorElement = this.getMoreIndicatorElement(count, startDate, endDate);\n            }\n            else {\n                moreIndicatorElement = this.getMoreIndicatorElement(count, slotStartTime, slotEndTime);\n            }\n            if (!isNullOrUndefined(groupIndex)) {\n                moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n            }\n            moreIndicatorElement.style.top = top + appArea + 'px';\n            moreIndicatorElement.style.width = this.cellWidth + 'px';\n            moreIndicatorElement.style.left = (Math.floor(appLeft / this.cellWidth) * this.cellWidth) + 'px';\n            moreIndicatorElement.style.right = (Math.floor(appRight / this.cellWidth) * this.cellWidth) + 'px';\n            this.renderElement(cellTd, moreIndicatorElement);\n            EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n        }\n    };\n    TimelineEvent.prototype.updateCellHeight = function (cell, height) {\n        if ((height > this.cellHeight)) {\n            setStyleAttribute(cell, { 'height': height + 'px' });\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                var resourceCell = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_TABLE_CLASS + ' ' + 'tbody td[data-group-index=\"' +\n                    cell.getAttribute('data-group-index') + '\"]');\n                if (resourceCell) {\n                    setStyleAttribute(resourceCell, { 'height': height + 'px' });\n                }\n            }\n            var monthHeader = this.parent.element.querySelector('.e-month-header-wrapper table tr:nth-child(' +\n                (cell.parentElement.rowIndex + 1) + ') td');\n            if (monthHeader) {\n                setStyleAttribute(monthHeader, { 'height': height + 'px' });\n            }\n        }\n    };\n    TimelineEvent.prototype.getFirstChild = function (index) {\n        var query = '.' + cls.CONTENT_TABLE_CLASS + ' tbody td';\n        var groupIndex = '';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            groupIndex = '[data-group-index=\"' + index.toString() + '\"]';\n        }\n        var td = this.parent.element.querySelector(query + groupIndex);\n        return td;\n    };\n    TimelineEvent.prototype.updateBlockElements = function () {\n        var blockElement = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS));\n        for (var _i = 0, blockElement_1 = blockElement; _i < blockElement_1.length; _i++) {\n            var element = blockElement_1[_i];\n            var resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n            var firstChild = this.getFirstChild(resIndex);\n            element.style.height = firstChild.offsetHeight + 'px';\n            var width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n            element.style.width = (firstChild.offsetWidth * width) + 'px';\n        }\n        var blockIndicator = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_INDICATOR_CLASS));\n        for (var _a = 0, blockIndicator_1 = blockIndicator; _a < blockIndicator_1.length; _a++) {\n            var element = blockIndicator_1[_a];\n            var resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n            element.style.top = this.getRowTop(resIndex) +\n                this.getFirstChild(resIndex).offsetHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n        }\n    };\n    TimelineEvent.prototype.getStartTime = function (event, eventData) {\n        var startTime = event[this.fields.startTime];\n        var schedule = util.getStartEndHours(startTime, this.startHour, this.endHour);\n        if (schedule.startHour.getTime() >= eventData[this.fields.startTime]) {\n            startTime = schedule.startHour;\n        }\n        else if (schedule.endHour.getTime() <= eventData[this.fields.startTime]) {\n            startTime = this.getNextDay(schedule.startHour, eventData);\n        }\n        else {\n            startTime = eventData[this.fields.startTime];\n        }\n        // To overcome the overflow\n        eventData.trimStartTime = (event[this.fields.isAllDay]) ? schedule.startHour : eventData[this.fields.startTime];\n        return startTime;\n    };\n    TimelineEvent.prototype.getNextDay = function (startTime, eventData) {\n        var startDate;\n        for (var i = 1; i <= this.dateRender.length; i++) {\n            startDate = util.addDays(startTime, i);\n            if (this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime()))) !== -1) {\n                eventData.count = eventData.count - 1;\n                return startDate;\n            }\n        }\n        return startDate;\n    };\n    TimelineEvent.prototype.getEndTime = function (event, eventData) {\n        var endTime = event[this.fields.endTime];\n        var schedule = util.getStartEndHours(endTime, this.startHour, this.endHour);\n        if (this.parent.currentView === 'TimelineMonth' || !this.parent.activeViewOptions.timeScale.enable ||\n            (this.parent.activeViewOptions.headerRows.length > 0 &&\n                this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour')) {\n            endTime = eventData[this.fields.endTime];\n        }\n        else {\n            endTime = eventData[this.fields.endTime];\n            if (schedule.endHour.getTime() <= eventData[this.fields.endTime]) {\n                endTime = schedule.endHour;\n            }\n            if (schedule.startHour.getTime() >= eventData[this.fields.endTime].getTime() && !event.isAllDay) {\n                endTime = this.getPreviousDay(schedule.startHour, schedule.endHour, eventData);\n            }\n        }\n        // To overcome the overflow\n        eventData.trimEndTime = (event[this.fields.isAllDay]) ? schedule.endHour : eventData[this.fields.endTime];\n        return endTime;\n    };\n    TimelineEvent.prototype.getPreviousDay = function (startTime, endTime, eventData) {\n        for (var i = 1; i <= this.dateRender.length; i++) {\n            var endDate = util.addDays(endTime, -i);\n            if (this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime()))) !== -1) {\n                endDate = util.resetTime(new Date(endDate.getTime()));\n                endDate.setHours(endTime.getHours(), endTime.getMinutes(), endTime.getSeconds());\n                var count = eventData.count;\n                var actualEndTime = eventData[this.fields.endTime];\n                eventData.count = actualEndTime.getHours() !== 0 || actualEndTime.getMinutes() !== 0 ? count - 1 : count;\n                return endDate;\n            }\n        }\n        return eventData[this.fields.endTime];\n    };\n    TimelineEvent.prototype.getEventWidth = function (startDate, endDate, isAllDay, count) {\n        if (this.renderType === 'day' || isAllDay) {\n            return (count * this.slotsPerDay) * this.cellWidth;\n        }\n        if (this.isSameDay(startDate, endDate)) {\n            return this.getSameDayEventsWidth(startDate, endDate);\n        }\n        else {\n            return this.getSpannedEventsWidth(startDate, endDate, count);\n        }\n    };\n    TimelineEvent.prototype.getSameDayEventsWidth = function (startDate, endDate) {\n        return ((util.getUniversalTime(endDate) - util.getUniversalTime(startDate)) /\n            util.MS_PER_MINUTE * (this.cellWidth * this.slotCount) / this.interval);\n    };\n    TimelineEvent.prototype.getSpannedEventsWidth = function (startDate, endDate, diffInDays) {\n        var width = (diffInDays * this.slotsPerDay) * this.cellWidth;\n        var endWidth;\n        var start = util.getStartEndHours(util.resetTime(new Date(startDate.getTime())), this.startHour, this.endHour);\n        var startWidth = this.getSameDayEventsWidth(start.startHour, startDate);\n        if (this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(endDate.getTime()))) === -1) {\n            endWidth = 0;\n        }\n        else {\n            var end = util.getStartEndHours(util.resetTime(new Date(endDate.getTime())), this.startHour, this.endHour);\n            endWidth = this.getSameDayEventsWidth(endDate, end.endHour);\n            endWidth = ((this.slotsPerDay * this.cellWidth) === endWidth) ? 0 : endWidth;\n        }\n        var spannedWidth = startWidth + endWidth;\n        return (width > spannedWidth) ? width - spannedWidth : width - startWidth;\n    };\n    TimelineEvent.prototype.isSameDay = function (startTime, endTime) {\n        var startDay = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n        var endDay = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(endTime.getTime())));\n        return (startDay === endDay);\n    };\n    TimelineEvent.prototype.getAppointmentLeft = function (schedule, startTime, day) {\n        var slotTd = (this.isSameDay(startTime, schedule.startHour)) ?\n            ((util.getUniversalTime(startTime) - util.getUniversalTime(schedule.startHour)) /\n                (util.MS_PER_MINUTE * this.interval)) * this.slotCount : 0;\n        if (day === 0) {\n            return slotTd;\n        }\n        else {\n            var daySlot = Math.round((((util.getUniversalTime(schedule.endHour) - util.getUniversalTime(schedule.startHour)) /\n                util.MS_PER_MINUTE) / this.interval) * this.slotCount);\n            return (daySlot * day) + slotTd;\n        }\n    };\n    TimelineEvent.prototype.getPosition = function (startTime, endTime, isAllDay, day) {\n        if (this.renderType === 'day' || isAllDay) {\n            return (day * this.slotsPerDay) * this.cellWidth;\n        }\n        var currentDate = util.resetTime(new Date(this.dateRender[day].getTime()));\n        var schedule = util.getStartEndHours(currentDate, this.startHour, this.endHour);\n        var cellIndex;\n        if (schedule.endHour.getTime() <= endTime.getTime() && schedule.startHour.getTime() >= startTime.getTime()) {\n            cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n        }\n        else if (schedule.endHour.getTime() <= endTime.getTime()) {\n            cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n        }\n        else if (schedule.startHour.getTime() >= startTime.getTime()) {\n            cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n        }\n        else {\n            cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n        }\n        return cellIndex * this.cellWidth;\n    };\n    TimelineEvent.prototype.getFilterEvents = function (startDate, endDate, startTime, endTime, gIndex, eventsList) {\n        if (this.renderType === 'day') {\n            return this.getFilteredEvents(startDate, endDate, gIndex, eventsList);\n        }\n        else {\n            return this.getFilteredEvents(startTime, endTime, gIndex, eventsList);\n        }\n    };\n    TimelineEvent.prototype.isAlreadyAvail = function (appPos, cellTd) {\n        var moreIndicator = [].slice.call(cellTd.querySelectorAll('.' + cls.MORE_INDICATOR_CLASS));\n        for (var i = 0; i < moreIndicator.length; i++) {\n            var indicatorPos = void 0;\n            if (moreIndicator) {\n                indicatorPos = (this.parent.enableRtl) ? moreIndicator[i].style.right : moreIndicator[i].style.left;\n            }\n            if (parseInt(indicatorPos, 10) === Math.floor(appPos)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    TimelineEvent.prototype.getRowTop = function (resIndex) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            return this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS +\n                ' ' + 'tbody td[data-group-index=\"' + resIndex.toString() + '\"]').offsetTop;\n        }\n        return 0;\n    };\n    TimelineEvent.prototype.getCellTd = function () {\n        var wrapIndex = this.parent.uiStateValues.isGroupAdaptive ? 0 : this.rowIndex;\n        return this.eventContainers[wrapIndex];\n    };\n    TimelineEvent.prototype.renderBlockIndicator = function (cellTd, position, resIndex) {\n        // No need to render block icon for Year, Month and Week header rows\n        if (this.parent.headerRows.length > 0 &&\n            (this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Hour' ||\n                this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Date')) {\n            return;\n        }\n        position = (Math.floor(position / this.cellWidth) * this.cellWidth) + this.cellWidth - BLOCK_INDICATOR_WIDTH;\n        if (!this.isAlreadyAvail(position, cellTd)) {\n            var blockIndicator = createElement('div', { className: 'e-icons ' + cls.BLOCK_INDICATOR_CLASS });\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                blockIndicator.setAttribute('data-group-index', resIndex.toString());\n            }\n            if (this.parent.enableRtl) {\n                blockIndicator.style.right = position + 'px';\n            }\n            else {\n                blockIndicator.style.left = position + 'px';\n            }\n            blockIndicator.style.top = this.getRowTop(resIndex) + this.cellHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n            this.renderElement(cellTd, blockIndicator);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    TimelineEvent.prototype.setMaxEventHeight = function (event, cell) {\n        setStyleAttribute(event, {\n            'height': (this.cellHeight - (this.maxHeight ? 0 : EVENT_GAP) - (this.maxHeight ? 0 : this.moreIndicatorHeight)) + 'px'\n        });\n    };\n    TimelineEvent.prototype.destroy = function () {\n        this.renderType = null;\n        this.eventContainers = null;\n        this.dayLength = null;\n        this.content = null;\n        _super.prototype.destroy.call(this);\n        this.parent = null;\n    };\n    return TimelineEvent;\n}(MonthEvent));\nexport { TimelineEvent };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}