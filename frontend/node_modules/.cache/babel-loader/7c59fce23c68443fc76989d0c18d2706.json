{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { EventHandler, formatUnit, createElement, addClass, closest, prepend } from '@syncfusion/ej2-base';\nimport { ViewBase } from './view-base';\nimport { YearEvent } from '../event-renderer/year';\nimport * as util from '../base/util';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * year view\n */\n\nvar Year =\n/** @class */\nfunction (_super) {\n  __extends(Year, _super);\n\n  function Year(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.viewClass = 'e-year-view';\n    _this.isInverseTableSelect = false;\n    _this.yearEventModule = null;\n    return _this;\n  }\n\n  Year.prototype.getModuleName = function () {\n    return 'year';\n  };\n\n  Year.prototype.renderLayout = function (className) {\n    if (this.parent.resourceBase) {\n      this.parent.resourceBase.generateResourceLevels([{\n        renderDates: this.parent.activeView.renderDates\n      }]);\n    }\n\n    this.setPanel(createElement('div', {\n      className: cls.TABLE_WRAP_CLASS\n    }));\n    var viewTypeClass = this.parent.activeViewOptions.orientation === 'Horizontal' ? 'e-horizontal' : 'e-vertical';\n    addClass([this.element], [this.viewClass, viewTypeClass, className]);\n    this.renderPanel(className);\n    var calendarTable = this.createTableLayout(cls.OUTER_TABLE_CLASS);\n    this.element.appendChild(calendarTable);\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    var calendarTBody = calendarTable.querySelector('tbody');\n    this.rowCount = this.getRowColumnCount('row');\n    this.columnCount = this.getRowColumnCount('column');\n    this.renderHeader(calendarTBody);\n    this.renderContent(calendarTBody);\n\n    if (this.parent.currentView !== 'Year' && this.parent.uiStateValues.isGroupAdaptive) {\n      this.generateColumnLevels();\n      this.renderResourceMobileLayout();\n    }\n\n    this.wireEvents(this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS), 'scroll');\n    this.parent.notify(event.contentReady, {});\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Year.prototype.renderHeader = function (headerWrapper) {};\n\n  Year.prototype.renderContent = function (content) {\n    var tr = createElement('tr');\n    content.appendChild(tr);\n    var td = createElement('td');\n    tr.appendChild(td);\n    this.element.querySelector('tbody').appendChild(tr);\n    var contentWrapper = createElement('div', {\n      className: cls.CONTENT_WRAP_CLASS\n    });\n    td.appendChild(contentWrapper);\n    var calendarTable = this.createTableLayout('e-calendar-table');\n    contentWrapper.appendChild(calendarTable);\n    var cTr = createElement('tr');\n    calendarTable.querySelector('tbody').appendChild(cTr);\n    var cTd = createElement('td');\n    cTr.appendChild(cTd);\n    var calendarWrapper = createElement('div', {\n      className: 'e-calendar-wrapper'\n    });\n    cTd.appendChild(calendarWrapper);\n    var months = this.getMonths();\n\n    for (var _i = 0, months_1 = months; _i < months_1.length; _i++) {\n      var month = months_1[_i];\n      var currentMonth = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n      var calendarElement = createElement('div', {\n        className: 'e-month-calendar e-calendar',\n        attrs: {\n          'data-role': 'calendar'\n        }\n      });\n      calendarElement.appendChild(this.renderCalendarHeader(currentMonth));\n      calendarElement.appendChild(this.renderCalendarContent(currentMonth));\n      calendarWrapper.appendChild(calendarElement);\n    }\n  };\n\n  Year.prototype.renderCalendarHeader = function (currentDate) {\n    var headerWrapper = createElement('div', {\n      className: 'e-header e-month'\n    });\n    var headerContent = createElement('div', {\n      className: 'e-day e-title',\n      innerHTML: this.getMonthName(currentDate)\n    });\n    headerWrapper.appendChild(headerContent);\n    this.parent.trigger(event.renderCell, {\n      elementType: 'headerCells',\n      element: headerContent,\n      date: currentDate\n    });\n    return headerWrapper;\n  };\n\n  Year.prototype.renderCalendarContent = function (currentDate) {\n    var dateCollection = this.getMonthDates(currentDate);\n    var contentWrapper = createElement('div', {\n      className: 'e-content e-month'\n    });\n    var contentTable = this.createTableLayout('e-calendar-table ' + cls.CONTENT_TABLE_CLASS);\n    contentWrapper.appendChild(contentTable);\n    var thead = createElement('thead', {\n      className: 'e-week-header'\n    });\n    var tr = createElement('tr');\n    var currentWeek = util.getWeekFirstDate(util.firstDateOfMonth(currentDate), this.parent.firstDayOfWeek);\n\n    if (this.parent.activeViewOptions.showWeekNumber) {\n      tr.appendChild(createElement('th'));\n    }\n\n    for (var i = 0; i < util.WEEK_LENGTH; i++) {\n      tr.appendChild(createElement('th', {\n        innerHTML: this.parent.getDayNames('narrow')[currentWeek.getDay()]\n      }));\n      currentWeek = new Date(currentWeek.getTime() + util.MS_PER_DAY);\n    }\n\n    thead.appendChild(tr);\n    prepend([thead], contentTable);\n    var tbody = contentTable.querySelector('tbody');\n\n    while (dateCollection.length > 0) {\n      var weekDates = dateCollection.splice(0, util.WEEK_LENGTH);\n      var tr_1 = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n\n      if (this.parent.activeViewOptions.showWeekNumber) {\n        var weekNumber = this.parent.getWeekNumberContent(weekDates);\n        var td = createElement('td', {\n          className: 'e-week-number',\n          attrs: {\n            'role': 'gridcell',\n            'title': this.parent.localeObj.getConstant('week') + ' ' + weekNumber\n          },\n          innerHTML: weekNumber\n        });\n        tr_1.appendChild(td);\n        this.parent.trigger(event.renderCell, {\n          elementType: 'weekNumberCells',\n          element: td\n        });\n      }\n\n      for (var _i = 0, weekDates_1 = weekDates; _i < weekDates_1.length; _i++) {\n        var date = weekDates_1[_i];\n        var td = createElement('td', {\n          className: 'e-cell ' + cls.WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false',\n            'data-date': date.getTime().toString()\n          }\n        });\n        var span = createElement('span', {\n          className: 'e-day',\n          innerHTML: this.parent.globalize.formatDate(date, {\n            skeleton: 'd',\n            calendar: this.parent.getCalendarMode()\n          }),\n          attrs: {\n            title: this.parent.globalize.formatDate(date, {\n              type: 'date',\n              skeleton: 'full'\n            })\n          }\n        });\n        td.appendChild(span);\n        var classList = [];\n\n        if (currentDate.getMonth() !== date.getMonth()) {\n          classList.push(cls.OTHERMONTH_CLASS);\n        }\n\n        if (this.isCurrentDate(date) && currentDate.getMonth() === date.getMonth()) {\n          classList = classList.concat(['e-today', 'e-selected']);\n        }\n\n        if (classList.length > 0) {\n          addClass([td], classList);\n        }\n\n        tr_1.appendChild(td);\n        this.wireEvents(td, 'cell');\n        this.parent.trigger(event.renderCell, {\n          elementType: 'workCells',\n          element: td,\n          date: date\n        });\n      }\n\n      tbody.appendChild(tr_1);\n    }\n\n    return contentWrapper;\n  };\n\n  Year.prototype.createTableColGroup = function (count) {\n    var colGroupEle = createElement('colgroup');\n\n    for (var i = 0; i < count; i++) {\n      colGroupEle.appendChild(createElement('col'));\n    }\n\n    return colGroupEle;\n  };\n\n  Year.prototype.getMonthName = function (date) {\n    var month = this.parent.globalize.formatDate(date, {\n      format: this.parent.activeViewOptions.dateFormat || 'MMMM y',\n      calendar: this.parent.getCalendarMode()\n    });\n    return util.capitalizeFirstWord(month, 'multiple');\n  };\n\n  Year.prototype.generateColumnLevels = function () {\n    var colLevels = [];\n    var level = this.getDateSlots([this.parent.selectedDate], this.parent.activeViewOptions.workDays);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      colLevels = this.parent.resourceBase.generateResourceLevels(level);\n\n      if (this.parent.uiStateValues.isGroupAdaptive) {\n        var resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        colLevels = [this.getDateSlots([this.parent.selectedDate], resourceLevel.workDays)];\n      }\n    } else {\n      colLevels.push(level);\n    }\n\n    colLevels.pop();\n    this.colLevels = colLevels;\n    return colLevels;\n  }; // eslint-disable-next-line max-len\n\n\n  Year.prototype.getDateSlots = function (renderDates, workDays, startHour, endHour) {\n    if (startHour === void 0) {\n      startHour = this.parent.workHours.start;\n    }\n\n    if (endHour === void 0) {\n      endHour = this.parent.workHours.end;\n    }\n\n    var dateCol = [{\n      date: renderDates[0],\n      type: 'dateHeader',\n      className: [cls.HEADER_CELLS_CLASS],\n      colSpan: 1,\n      workDays: workDays,\n      startHour: new Date(+this.parent.globalize.parseDate(startHour, {\n        skeleton: 'Hm'\n      })),\n      endHour: new Date(+this.parent.globalize.parseDate(endHour, {\n        skeleton: 'Hm'\n      }))\n    }];\n    return dateCol;\n  };\n\n  Year.prototype.getMonthDates = function (date) {\n    var startDate = util.getWeekFirstDate(util.firstDateOfMonth(date), this.parent.firstDayOfWeek);\n    var endDate = util.addDays(new Date(+startDate), 6 * util.WEEK_LENGTH);\n    var dateCollection = [];\n\n    for (var start = startDate; start.getTime() < endDate.getTime(); start = util.addDays(start, 1)) {\n      dateCollection.push(util.resetTime(new Date(start)));\n    }\n\n    return dateCollection;\n  };\n\n  Year.prototype.getRowColumnCount = function (type) {\n    var months = this.getMonths();\n    var year = this.parent.selectedDate.getFullYear();\n    var monthDaysCount = [];\n\n    for (var _i = 0, months_2 = months; _i < months_2.length; _i++) {\n      var month = months_2[_i];\n      monthDaysCount.push(new Date(year, month, 1).getDay() + new Date(year, month + 1, 0).getDate());\n    }\n\n    var maxCount = Math.max.apply(Math, monthDaysCount);\n    var count;\n\n    if (type === 'row') {\n      count = this.parent.activeViewOptions.orientation === 'Horizontal' ? months.length : maxCount;\n    } else {\n      count = this.parent.activeViewOptions.orientation === 'Horizontal' ? maxCount : months.length;\n    }\n\n    return count;\n  };\n\n  Year.prototype.isCurrentDate = function (date) {\n    return util.resetTime(new Date()).getTime() === util.resetTime(new Date(date.getTime())).getTime();\n  };\n\n  Year.prototype.getMonths = function () {\n    var _this = this; // eslint-disable-next-line prefer-spread\n\n\n    return Array.apply(null, {\n      length: this.parent.activeViewOptions.monthsCount\n    }).map(function (value, index) {\n      return _this.parent.firstMonthOfYear + index;\n    });\n  };\n\n  Year.prototype.onCellClick = function (e) {\n    var target = closest(e.target, '.' + cls.WORK_CELLS_CLASS);\n    var startDate = this.parent.getDateFromElement(target);\n    this.parent.activeCellsData = this.parent.getCellDetails(target);\n    var isPrevious = startDate.getTime() < this.getStartDate().getTime();\n\n    if (isPrevious || startDate.getTime() > this.getEndDate().getTime()) {\n      this.parent.changeDate(this.parent.activeView.getNextPreviousDate(isPrevious ? 'previous' : 'next'), e);\n      var activeDate = this.parent.activeCellsData.startTime.getTime();\n      var inRange = activeDate >= this.getStartDate().getTime() && activeDate <= this.getEndDate().getTime();\n      var dateAttr = inRange ? activeDate : (isPrevious ? this.getEndDate() : this.getStartDate()).getTime();\n      var selectedCell = this.parent.element.querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + dateAttr + '\"]');\n      this.parent.selectCell(selectedCell);\n      this.parent.activeCellsData = this.parent.getCellDetails(selectedCell);\n    } else {\n      var endDate = util.addDays(new Date(startDate.getTime()), 1);\n      var filteredEvents = this.parent.eventBase.filterEvents(startDate, endDate);\n      var moreEventArgs = {\n        date: startDate,\n        event: filteredEvents,\n        element: e.target\n      };\n\n      if (target.classList.contains(cls.OTHERMONTH_CLASS)) {\n        target = this.parent.element.querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + target.getAttribute('data-date') + '\"]');\n      }\n\n      this.parent.activeCellsData = this.parent.getCellDetails(target);\n      this.parent.quickPopup.moreEventClick(moreEventArgs, endDate);\n    }\n  };\n\n  Year.prototype.onContentScroll = function (e) {\n    var target = e.target;\n    var headerWrapper = this.getDatesHeaderElement();\n\n    if (headerWrapper) {\n      headerWrapper.firstElementChild.scrollLeft = target.scrollLeft;\n    }\n\n    var scrollTopSelector = \".\" + cls.MONTH_HEADER_WRAPPER + \",.\" + cls.RESOURCE_COLUMN_WRAP_CLASS;\n    var scrollTopElement = this.element.querySelector(scrollTopSelector);\n\n    if (scrollTopElement) {\n      scrollTopElement.scrollTop = target.scrollTop;\n    }\n\n    this.setPersistence();\n  };\n\n  Year.prototype.onScrollUiUpdate = function (args) {\n    var height = this.parent.element.offsetHeight - this.getHeaderBarHeight();\n    var headerWrapper = this.element.querySelector('.' + cls.DATE_HEADER_CONTAINER_CLASS);\n\n    if (headerWrapper) {\n      height -= headerWrapper.offsetHeight;\n    }\n\n    var contentWrapper = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (contentWrapper) {\n      contentWrapper.style.height = formatUnit(height);\n    }\n\n    if (!this.parent.isAdaptive && headerWrapper) {\n      var scrollBarWidth = util.getScrollBarWidth();\n\n      if (contentWrapper.offsetWidth - contentWrapper.clientWidth > 0) {\n        headerWrapper.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n        headerWrapper.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n      } else {\n        headerWrapper.firstElementChild.style[args.cssProperties.border] = '';\n        headerWrapper.style[args.cssProperties.padding] = '';\n      }\n    }\n\n    this.setColWidth(this.getContentAreaElement());\n    var leftPanelSelector = \".\" + cls.MONTH_HEADER_WRAPPER + \",.\" + cls.RESOURCE_COLUMN_WRAP_CLASS;\n    var leftPanelElement = this.element.querySelector(leftPanelSelector);\n\n    if (leftPanelElement) {\n      var isYScroll = contentWrapper.scrollWidth > contentWrapper.clientWidth;\n      leftPanelElement.style.height = formatUnit(height - (isYScroll ? 17 : 0));\n    }\n\n    this.retainScrollPosition();\n  };\n\n  Year.prototype.getStartDate = function () {\n    return new Date(this.parent.selectedDate.getFullYear(), this.parent.firstMonthOfYear % 12, 1);\n  };\n\n  Year.prototype.getEndDate = function () {\n    return util.addDays(util.addMonths(this.getStartDate(), this.parent.monthsCount), -1);\n  };\n\n  Year.prototype.startDate = function () {\n    return this.parent.currentView === 'Year' ? util.getWeekFirstDate(this.getStartDate(), this.parent.firstDayOfWeek) : this.getStartDate();\n  };\n\n  Year.prototype.endDate = function () {\n    return this.parent.currentView === 'Year' ? util.addDays(util.getWeekLastDate(this.getEndDate(), this.parent.firstDayOfWeek), 1) : this.getEndDate();\n  };\n\n  Year.prototype.getEndDateFromStartDate = function (start) {\n    var date = new Date(start.getTime());\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      date = util.lastDateOfMonth(date);\n    }\n\n    return util.addDays(new Date(date.getTime()), 1);\n  };\n\n  Year.prototype.getNextPreviousDate = function (type) {\n    return util.addYears(this.parent.selectedDate, type === 'next' ? 1 : -1);\n  };\n\n  Year.prototype.getDateRangeText = function () {\n    var startDate = this.getStartDate();\n    var endDate = this.getEndDate();\n\n    if (startDate.getFullYear() !== endDate.getFullYear()) {\n      return this.parent.globalize.formatDate(startDate, {\n        skeleton: 'yMMM'\n      }) + ' - ' + this.parent.globalize.formatDate(endDate, {\n        skeleton: 'yMMM'\n      });\n    } else {\n      return this.parent.globalize.formatDate(this.parent.selectedDate, {\n        skeleton: 'y'\n      });\n    }\n  };\n\n  Year.prototype.addEventListener = function () {\n    this.parent.on(event.scrollUiUpdate, this.onScrollUiUpdate, this);\n    this.parent.on(event.dataReady, this.onDataReady, this);\n  };\n\n  Year.prototype.removeEventListener = function () {\n    if (this.parent) {\n      this.parent.off(event.scrollUiUpdate, this.onScrollUiUpdate);\n      this.parent.off(event.dataReady, this.onDataReady);\n    }\n  };\n\n  Year.prototype.onDataReady = function (args) {\n    this.yearEventModule = new YearEvent(this.parent);\n    this.yearEventModule.renderAppointments();\n    this.parent.notify(event.eventsLoaded, args);\n  };\n\n  Year.prototype.wireEvents = function (element, type) {\n    if (type === 'cell') {\n      if (this.parent.currentView !== 'TimelineYear') {\n        EventHandler.add(element, 'click', this.onCellClick, this);\n      } else {\n        EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n        EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n\n        if (!this.parent.isAdaptive) {\n          EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n        }\n      }\n    } else {\n      EventHandler.add(element, 'scroll', this.onContentScroll, this);\n    }\n  };\n\n  Year.prototype.destroy = function () {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      var contentScroll = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      if (contentScroll) {\n        EventHandler.remove(contentScroll, 'scroll', this.onContentScroll);\n      }\n\n      if (this.yearEventModule) {\n        this.yearEventModule.destroy();\n        this.yearEventModule = null;\n      }\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      _super.prototype.destroy.call(this);\n    }\n  };\n\n  return Year;\n}(ViewBase);\n\nexport { Year };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EventHandler","formatUnit","createElement","addClass","closest","prepend","ViewBase","YearEvent","util","event","cls","Year","_super","parent","_this","call","viewClass","isInverseTableSelect","yearEventModule","getModuleName","renderLayout","className","resourceBase","generateResourceLevels","renderDates","activeView","setPanel","TABLE_WRAP_CLASS","viewTypeClass","activeViewOptions","orientation","element","renderPanel","calendarTable","createTableLayout","OUTER_TABLE_CLASS","appendChild","querySelector","setAttribute","calendarTBody","rowCount","getRowColumnCount","columnCount","renderHeader","renderContent","currentView","uiStateValues","isGroupAdaptive","generateColumnLevels","renderResourceMobileLayout","wireEvents","CONTENT_WRAP_CLASS","notify","contentReady","headerWrapper","content","tr","td","contentWrapper","cTr","cTd","calendarWrapper","months","getMonths","_i","months_1","length","month","currentMonth","Date","selectedDate","getFullYear","calendarElement","attrs","renderCalendarHeader","renderCalendarContent","currentDate","headerContent","innerHTML","getMonthName","trigger","renderCell","elementType","date","dateCollection","getMonthDates","contentTable","CONTENT_TABLE_CLASS","thead","currentWeek","getWeekFirstDate","firstDateOfMonth","firstDayOfWeek","showWeekNumber","i","WEEK_LENGTH","getDayNames","getDay","getTime","MS_PER_DAY","tbody","weekDates","splice","tr_1","weekNumber","getWeekNumberContent","localeObj","getConstant","weekDates_1","WORK_CELLS_CLASS","toString","span","globalize","formatDate","skeleton","calendar","getCalendarMode","title","type","classList","getMonth","push","OTHERMONTH_CLASS","isCurrentDate","concat","createTableColGroup","count","colGroupEle","format","dateFormat","capitalizeFirstWord","colLevels","level","getDateSlots","workDays","group","resources","resourceLevel","lastResourceLevel","groupIndex","pop","startHour","endHour","workHours","start","end","dateCol","HEADER_CELLS_CLASS","colSpan","parseDate","startDate","endDate","addDays","resetTime","year","monthDaysCount","months_2","getDate","maxCount","Math","max","apply","monthsCount","map","value","index","firstMonthOfYear","onCellClick","e","target","getDateFromElement","activeCellsData","getCellDetails","isPrevious","getStartDate","getEndDate","changeDate","getNextPreviousDate","activeDate","startTime","inRange","dateAttr","selectedCell","selectCell","filteredEvents","eventBase","filterEvents","moreEventArgs","contains","getAttribute","quickPopup","moreEventClick","onContentScroll","getDatesHeaderElement","firstElementChild","scrollLeft","scrollTopSelector","MONTH_HEADER_WRAPPER","RESOURCE_COLUMN_WRAP_CLASS","scrollTopElement","scrollTop","setPersistence","onScrollUiUpdate","args","height","offsetHeight","getHeaderBarHeight","DATE_HEADER_CONTAINER_CLASS","style","isAdaptive","scrollBarWidth","getScrollBarWidth","offsetWidth","clientWidth","cssProperties","border","padding","setColWidth","getContentAreaElement","leftPanelSelector","leftPanelElement","isYScroll","scrollWidth","retainScrollPosition","addMonths","getWeekLastDate","getEndDateFromStartDate","lastDateOfMonth","addYears","getDateRangeText","addEventListener","on","scrollUiUpdate","dataReady","onDataReady","removeEventListener","off","renderAppointments","eventsLoaded","add","workCellAction","cellMouseDown","cellClick","cellDblClick","destroy","isDestroyed","contentScroll","remove"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-schedule/src/schedule/renderer/year.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { EventHandler, formatUnit, createElement, addClass, closest, prepend } from '@syncfusion/ej2-base';\nimport { ViewBase } from './view-base';\nimport { YearEvent } from '../event-renderer/year';\nimport * as util from '../base/util';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\n * year view\n */\nvar Year = /** @class */ (function (_super) {\n    __extends(Year, _super);\n    function Year(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.viewClass = 'e-year-view';\n        _this.isInverseTableSelect = false;\n        _this.yearEventModule = null;\n        return _this;\n    }\n    Year.prototype.getModuleName = function () {\n        return 'year';\n    };\n    Year.prototype.renderLayout = function (className) {\n        if (this.parent.resourceBase) {\n            this.parent.resourceBase.generateResourceLevels([{ renderDates: this.parent.activeView.renderDates }]);\n        }\n        this.setPanel(createElement('div', { className: cls.TABLE_WRAP_CLASS }));\n        var viewTypeClass = this.parent.activeViewOptions.orientation === 'Horizontal' ? 'e-horizontal' : 'e-vertical';\n        addClass([this.element], [this.viewClass, viewTypeClass, className]);\n        this.renderPanel(className);\n        var calendarTable = this.createTableLayout(cls.OUTER_TABLE_CLASS);\n        this.element.appendChild(calendarTable);\n        this.element.querySelector('table').setAttribute('role', 'presentation');\n        var calendarTBody = calendarTable.querySelector('tbody');\n        this.rowCount = this.getRowColumnCount('row');\n        this.columnCount = this.getRowColumnCount('column');\n        this.renderHeader(calendarTBody);\n        this.renderContent(calendarTBody);\n        if (this.parent.currentView !== 'Year' && this.parent.uiStateValues.isGroupAdaptive) {\n            this.generateColumnLevels();\n            this.renderResourceMobileLayout();\n        }\n        this.wireEvents(this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS), 'scroll');\n        this.parent.notify(event.contentReady, {});\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Year.prototype.renderHeader = function (headerWrapper) { };\n    Year.prototype.renderContent = function (content) {\n        var tr = createElement('tr');\n        content.appendChild(tr);\n        var td = createElement('td');\n        tr.appendChild(td);\n        this.element.querySelector('tbody').appendChild(tr);\n        var contentWrapper = createElement('div', { className: cls.CONTENT_WRAP_CLASS });\n        td.appendChild(contentWrapper);\n        var calendarTable = this.createTableLayout('e-calendar-table');\n        contentWrapper.appendChild(calendarTable);\n        var cTr = createElement('tr');\n        calendarTable.querySelector('tbody').appendChild(cTr);\n        var cTd = createElement('td');\n        cTr.appendChild(cTd);\n        var calendarWrapper = createElement('div', { className: 'e-calendar-wrapper' });\n        cTd.appendChild(calendarWrapper);\n        var months = this.getMonths();\n        for (var _i = 0, months_1 = months; _i < months_1.length; _i++) {\n            var month = months_1[_i];\n            var currentMonth = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n            var calendarElement = createElement('div', {\n                className: 'e-month-calendar e-calendar',\n                attrs: { 'data-role': 'calendar' }\n            });\n            calendarElement.appendChild(this.renderCalendarHeader(currentMonth));\n            calendarElement.appendChild(this.renderCalendarContent(currentMonth));\n            calendarWrapper.appendChild(calendarElement);\n        }\n    };\n    Year.prototype.renderCalendarHeader = function (currentDate) {\n        var headerWrapper = createElement('div', { className: 'e-header e-month' });\n        var headerContent = createElement('div', { className: 'e-day e-title', innerHTML: this.getMonthName(currentDate) });\n        headerWrapper.appendChild(headerContent);\n        this.parent.trigger(event.renderCell, { elementType: 'headerCells', element: headerContent, date: currentDate });\n        return headerWrapper;\n    };\n    Year.prototype.renderCalendarContent = function (currentDate) {\n        var dateCollection = this.getMonthDates(currentDate);\n        var contentWrapper = createElement('div', { className: 'e-content e-month' });\n        var contentTable = this.createTableLayout('e-calendar-table ' + cls.CONTENT_TABLE_CLASS);\n        contentWrapper.appendChild(contentTable);\n        var thead = createElement('thead', { className: 'e-week-header' });\n        var tr = createElement('tr');\n        var currentWeek = util.getWeekFirstDate(util.firstDateOfMonth(currentDate), this.parent.firstDayOfWeek);\n        if (this.parent.activeViewOptions.showWeekNumber) {\n            tr.appendChild(createElement('th'));\n        }\n        for (var i = 0; i < util.WEEK_LENGTH; i++) {\n            tr.appendChild(createElement('th', { innerHTML: this.parent.getDayNames('narrow')[currentWeek.getDay()] }));\n            currentWeek = new Date(currentWeek.getTime() + util.MS_PER_DAY);\n        }\n        thead.appendChild(tr);\n        prepend([thead], contentTable);\n        var tbody = contentTable.querySelector('tbody');\n        while (dateCollection.length > 0) {\n            var weekDates = dateCollection.splice(0, util.WEEK_LENGTH);\n            var tr_1 = createElement('tr', { attrs: { 'role': 'row' } });\n            if (this.parent.activeViewOptions.showWeekNumber) {\n                var weekNumber = this.parent.getWeekNumberContent(weekDates);\n                var td = createElement('td', {\n                    className: 'e-week-number',\n                    attrs: { 'role': 'gridcell', 'title': this.parent.localeObj.getConstant('week') + ' ' + weekNumber },\n                    innerHTML: weekNumber\n                });\n                tr_1.appendChild(td);\n                this.parent.trigger(event.renderCell, { elementType: 'weekNumberCells', element: td });\n            }\n            for (var _i = 0, weekDates_1 = weekDates; _i < weekDates_1.length; _i++) {\n                var date = weekDates_1[_i];\n                var td = createElement('td', {\n                    className: 'e-cell ' + cls.WORK_CELLS_CLASS,\n                    attrs: { 'role': 'gridcell', 'aria-selected': 'false', 'data-date': date.getTime().toString() }\n                });\n                var span = createElement('span', {\n                    className: 'e-day', innerHTML: this.parent.globalize.formatDate(date, { skeleton: 'd', calendar: this.parent.getCalendarMode() }),\n                    attrs: { title: this.parent.globalize.formatDate(date, { type: 'date', skeleton: 'full' }) }\n                });\n                td.appendChild(span);\n                var classList = [];\n                if (currentDate.getMonth() !== date.getMonth()) {\n                    classList.push(cls.OTHERMONTH_CLASS);\n                }\n                if (this.isCurrentDate(date) && currentDate.getMonth() === date.getMonth()) {\n                    classList = classList.concat(['e-today', 'e-selected']);\n                }\n                if (classList.length > 0) {\n                    addClass([td], classList);\n                }\n                tr_1.appendChild(td);\n                this.wireEvents(td, 'cell');\n                this.parent.trigger(event.renderCell, { elementType: 'workCells', element: td, date: date });\n            }\n            tbody.appendChild(tr_1);\n        }\n        return contentWrapper;\n    };\n    Year.prototype.createTableColGroup = function (count) {\n        var colGroupEle = createElement('colgroup');\n        for (var i = 0; i < count; i++) {\n            colGroupEle.appendChild(createElement('col'));\n        }\n        return colGroupEle;\n    };\n    Year.prototype.getMonthName = function (date) {\n        var month = this.parent.globalize.formatDate(date, {\n            format: this.parent.activeViewOptions.dateFormat || 'MMMM y',\n            calendar: this.parent.getCalendarMode()\n        });\n        return util.capitalizeFirstWord(month, 'multiple');\n    };\n    Year.prototype.generateColumnLevels = function () {\n        var colLevels = [];\n        var level = this.getDateSlots([this.parent.selectedDate], this.parent.activeViewOptions.workDays);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            colLevels = this.parent.resourceBase.generateResourceLevels(level);\n            if (this.parent.uiStateValues.isGroupAdaptive) {\n                var resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n                colLevels = [this.getDateSlots([this.parent.selectedDate], resourceLevel.workDays)];\n            }\n        }\n        else {\n            colLevels.push(level);\n        }\n        colLevels.pop();\n        this.colLevels = colLevels;\n        return colLevels;\n    };\n    // eslint-disable-next-line max-len\n    Year.prototype.getDateSlots = function (renderDates, workDays, startHour, endHour) {\n        if (startHour === void 0) { startHour = this.parent.workHours.start; }\n        if (endHour === void 0) { endHour = this.parent.workHours.end; }\n        var dateCol = [{\n                date: renderDates[0], type: 'dateHeader', className: [cls.HEADER_CELLS_CLASS], colSpan: 1, workDays: workDays,\n                startHour: new Date(+this.parent.globalize.parseDate(startHour, { skeleton: 'Hm' })),\n                endHour: new Date(+this.parent.globalize.parseDate(endHour, { skeleton: 'Hm' }))\n            }];\n        return dateCol;\n    };\n    Year.prototype.getMonthDates = function (date) {\n        var startDate = util.getWeekFirstDate(util.firstDateOfMonth(date), this.parent.firstDayOfWeek);\n        var endDate = util.addDays(new Date(+startDate), (6 * util.WEEK_LENGTH));\n        var dateCollection = [];\n        for (var start = startDate; start.getTime() < endDate.getTime(); start = util.addDays(start, 1)) {\n            dateCollection.push(util.resetTime(new Date(start)));\n        }\n        return dateCollection;\n    };\n    Year.prototype.getRowColumnCount = function (type) {\n        var months = this.getMonths();\n        var year = this.parent.selectedDate.getFullYear();\n        var monthDaysCount = [];\n        for (var _i = 0, months_2 = months; _i < months_2.length; _i++) {\n            var month = months_2[_i];\n            monthDaysCount.push(new Date(year, month, 1).getDay() + new Date(year, month + 1, 0).getDate());\n        }\n        var maxCount = Math.max.apply(Math, monthDaysCount);\n        var count;\n        if (type === 'row') {\n            count = this.parent.activeViewOptions.orientation === 'Horizontal' ? months.length : maxCount;\n        }\n        else {\n            count = this.parent.activeViewOptions.orientation === 'Horizontal' ? maxCount : months.length;\n        }\n        return count;\n    };\n    Year.prototype.isCurrentDate = function (date) {\n        return util.resetTime(new Date()).getTime() === util.resetTime(new Date(date.getTime())).getTime();\n    };\n    Year.prototype.getMonths = function () {\n        var _this = this;\n        // eslint-disable-next-line prefer-spread\n        return Array.apply(null, { length: this.parent.activeViewOptions.monthsCount }).map(function (value, index) {\n            return _this.parent.firstMonthOfYear + index;\n        });\n    };\n    Year.prototype.onCellClick = function (e) {\n        var target = closest(e.target, '.' + cls.WORK_CELLS_CLASS);\n        var startDate = this.parent.getDateFromElement(target);\n        this.parent.activeCellsData = this.parent.getCellDetails(target);\n        var isPrevious = startDate.getTime() < this.getStartDate().getTime();\n        if (isPrevious || startDate.getTime() > this.getEndDate().getTime()) {\n            this.parent.changeDate(this.parent.activeView.getNextPreviousDate(isPrevious ? 'previous' : 'next'), e);\n            var activeDate = this.parent.activeCellsData.startTime.getTime();\n            var inRange = activeDate >= this.getStartDate().getTime() && activeDate <= this.getEndDate().getTime();\n            var dateAttr = inRange ? activeDate : (isPrevious ? this.getEndDate() : this.getStartDate()).getTime();\n            var selectedCell = this.parent.element.querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + dateAttr + '\"]');\n            this.parent.selectCell(selectedCell);\n            this.parent.activeCellsData = this.parent.getCellDetails(selectedCell);\n        }\n        else {\n            var endDate = util.addDays(new Date(startDate.getTime()), 1);\n            var filteredEvents = this.parent.eventBase.filterEvents(startDate, endDate);\n            var moreEventArgs = { date: startDate, event: filteredEvents, element: e.target };\n            if (target.classList.contains(cls.OTHERMONTH_CLASS)) {\n                target = this.parent.element.querySelector(':not(.' + cls.OTHERMONTH_CLASS + ')[data-date=\"' + target.getAttribute('data-date') + '\"]');\n            }\n            this.parent.activeCellsData = this.parent.getCellDetails(target);\n            this.parent.quickPopup.moreEventClick(moreEventArgs, endDate);\n        }\n    };\n    Year.prototype.onContentScroll = function (e) {\n        var target = e.target;\n        var headerWrapper = this.getDatesHeaderElement();\n        if (headerWrapper) {\n            headerWrapper.firstElementChild.scrollLeft = target.scrollLeft;\n        }\n        var scrollTopSelector = \".\" + cls.MONTH_HEADER_WRAPPER + \",.\" + cls.RESOURCE_COLUMN_WRAP_CLASS;\n        var scrollTopElement = this.element.querySelector(scrollTopSelector);\n        if (scrollTopElement) {\n            scrollTopElement.scrollTop = target.scrollTop;\n        }\n        this.setPersistence();\n    };\n    Year.prototype.onScrollUiUpdate = function (args) {\n        var height = this.parent.element.offsetHeight - this.getHeaderBarHeight();\n        var headerWrapper = this.element.querySelector('.' + cls.DATE_HEADER_CONTAINER_CLASS);\n        if (headerWrapper) {\n            height -= headerWrapper.offsetHeight;\n        }\n        var contentWrapper = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (contentWrapper) {\n            contentWrapper.style.height = formatUnit(height);\n        }\n        if (!this.parent.isAdaptive && headerWrapper) {\n            var scrollBarWidth = util.getScrollBarWidth();\n            if (contentWrapper.offsetWidth - contentWrapper.clientWidth > 0) {\n                headerWrapper.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n                headerWrapper.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n            }\n            else {\n                headerWrapper.firstElementChild.style[args.cssProperties.border] = '';\n                headerWrapper.style[args.cssProperties.padding] = '';\n            }\n        }\n        this.setColWidth(this.getContentAreaElement());\n        var leftPanelSelector = \".\" + cls.MONTH_HEADER_WRAPPER + \",.\" + cls.RESOURCE_COLUMN_WRAP_CLASS;\n        var leftPanelElement = this.element.querySelector(leftPanelSelector);\n        if (leftPanelElement) {\n            var isYScroll = contentWrapper.scrollWidth > contentWrapper.clientWidth;\n            leftPanelElement.style.height = formatUnit(height - (isYScroll ? 17 : 0));\n        }\n        this.retainScrollPosition();\n    };\n    Year.prototype.getStartDate = function () {\n        return new Date(this.parent.selectedDate.getFullYear(), this.parent.firstMonthOfYear % 12, 1);\n    };\n    Year.prototype.getEndDate = function () {\n        return util.addDays(util.addMonths(this.getStartDate(), this.parent.monthsCount), -1);\n    };\n    Year.prototype.startDate = function () {\n        return this.parent.currentView === 'Year' ? util.getWeekFirstDate(this.getStartDate(), this.parent.firstDayOfWeek) : this.getStartDate();\n    };\n    Year.prototype.endDate = function () {\n        return this.parent.currentView === 'Year' ? util.addDays(util.getWeekLastDate(this.getEndDate(), this.parent.firstDayOfWeek), 1) : this.getEndDate();\n    };\n    Year.prototype.getEndDateFromStartDate = function (start) {\n        var date = new Date(start.getTime());\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            date = util.lastDateOfMonth(date);\n        }\n        return util.addDays(new Date(date.getTime()), 1);\n    };\n    Year.prototype.getNextPreviousDate = function (type) {\n        return util.addYears(this.parent.selectedDate, ((type === 'next') ? 1 : -1));\n    };\n    Year.prototype.getDateRangeText = function () {\n        var startDate = this.getStartDate();\n        var endDate = this.getEndDate();\n        if (startDate.getFullYear() !== endDate.getFullYear()) {\n            return this.parent.globalize.formatDate(startDate, { skeleton: 'yMMM' }) + ' - ' + this.parent.globalize.formatDate(endDate, { skeleton: 'yMMM' });\n        }\n        else {\n            return this.parent.globalize.formatDate(this.parent.selectedDate, { skeleton: 'y' });\n        }\n    };\n    Year.prototype.addEventListener = function () {\n        this.parent.on(event.scrollUiUpdate, this.onScrollUiUpdate, this);\n        this.parent.on(event.dataReady, this.onDataReady, this);\n    };\n    Year.prototype.removeEventListener = function () {\n        if (this.parent) {\n            this.parent.off(event.scrollUiUpdate, this.onScrollUiUpdate);\n            this.parent.off(event.dataReady, this.onDataReady);\n        }\n    };\n    Year.prototype.onDataReady = function (args) {\n        this.yearEventModule = new YearEvent(this.parent);\n        this.yearEventModule.renderAppointments();\n        this.parent.notify(event.eventsLoaded, args);\n    };\n    Year.prototype.wireEvents = function (element, type) {\n        if (type === 'cell') {\n            if (this.parent.currentView !== 'TimelineYear') {\n                EventHandler.add(element, 'click', this.onCellClick, this);\n            }\n            else {\n                EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n                EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n                if (!this.parent.isAdaptive) {\n                    EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n                }\n            }\n        }\n        else {\n            EventHandler.add(element, 'scroll', this.onContentScroll, this);\n        }\n    };\n    Year.prototype.destroy = function () {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.element) {\n            var contentScroll = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (contentScroll) {\n                EventHandler.remove(contentScroll, 'scroll', this.onContentScroll);\n            }\n            if (this.yearEventModule) {\n                this.yearEventModule.destroy();\n                this.yearEventModule = null;\n            }\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.destroy();\n            }\n            _super.prototype.destroy.call(this);\n        }\n    };\n    return Year;\n}(ViewBase));\nexport { Year };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}