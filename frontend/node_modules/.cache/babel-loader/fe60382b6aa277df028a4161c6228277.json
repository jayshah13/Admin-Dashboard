{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { closest, EventHandler, isNullOrUndefined, formatUnit, append } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, createElement, remove, extend } from '@syncfusion/ej2-base';\nimport { Dialog, Popup, isCollide } from '@syncfusion/ej2-popups';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { FieldValidator } from './form-validator';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\nvar EVENT_FIELD = 'e-field';\n/**\n * Quick Popups interactions\n */\n\nvar QuickPopups =\n/** @class */\nfunction () {\n  function QuickPopups(parent) {\n    this.isMultipleEventSelect = false;\n    this.isCrudAction = false;\n    this.parent = parent;\n    this.l10n = this.parent.localeObj;\n    this.fieldValidator = new FieldValidator();\n    this.render();\n    this.addEventListener();\n  }\n\n  QuickPopups.prototype.render = function () {\n    this.renderQuickPopup();\n    this.renderMorePopup();\n    this.renderQuickDialog();\n  };\n\n  QuickPopups.prototype.renderQuickPopup = function () {\n    var quickPopupWrapper = createElement('div', {\n      className: cls.POPUP_WRAPPER_CLASS + ' e-popup-close'\n    });\n\n    if (this.parent.isAdaptive) {\n      document.body.appendChild(quickPopupWrapper);\n      addClass([quickPopupWrapper], cls.DEVICE_CLASS);\n    } else {\n      this.parent.element.appendChild(quickPopupWrapper);\n    }\n\n    this.quickPopup = new Popup(quickPopupWrapper, {\n      targetType: this.parent.isAdaptive ? 'container' : 'relative',\n      enableRtl: this.parent.enableRtl,\n      open: this.quickPopupOpen.bind(this),\n      close: this.quickPopupClose.bind(this),\n      hideAnimation: this.parent.isAdaptive ? {\n        name: 'ZoomOut'\n      } : {\n        name: 'FadeOut',\n        duration: 150\n      },\n      showAnimation: this.parent.isAdaptive ? {\n        name: 'ZoomIn'\n      } : {\n        name: 'FadeIn',\n        duration: 150\n      },\n      collision: this.parent.isAdaptive ? {\n        X: 'fit',\n        Y: 'fit'\n      } : this.parent.enableRtl ? {\n        X: 'flip',\n        Y: 'fit'\n      } : {\n        X: 'none',\n        Y: 'fit'\n      },\n      position: this.parent.isAdaptive || this.parent.enableRtl ? {\n        X: 'left',\n        Y: 'top'\n      } : {\n        X: 'right',\n        Y: 'top'\n      },\n      viewPortElement: this.parent.isAdaptive ? document.body : this.parent.element,\n      zIndex: this.parent.isAdaptive ? 1004 : 3\n    });\n  };\n\n  QuickPopups.prototype.renderMorePopup = function () {\n    var moreEventPopup = \"<div class=\\\"\" + cls.MORE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_CLASS + \"\\\">\" + (\"<div class=\\\"\" + cls.MORE_EVENT_CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\" tabindex=\\\"0\\\"></div>\") + (\"<div class=\\\"\" + cls.MORE_EVENT_DATE_HEADER_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_DAY_CLASS + \"\\\"></div>\") + (\"<div class=\\\"\" + cls.MORE_EVENT_HEADER_DATE_CLASS + \" \" + cls.NAVIGATE_CLASS + \"\\\" tabindex=\\\"0\\\"></div></div></div></div>\");\n    var moreEventWrapper = createElement('div', {\n      className: cls.MORE_POPUP_WRAPPER_CLASS + ' e-popup-close',\n      innerHTML: moreEventPopup\n    });\n\n    if (this.parent.isAdaptive) {\n      document.body.appendChild(moreEventWrapper);\n      addClass([moreEventWrapper], cls.DEVICE_CLASS);\n    } else {\n      this.parent.element.appendChild(moreEventWrapper);\n    }\n\n    this.morePopup = new Popup(moreEventWrapper, {\n      targetType: this.parent.isAdaptive ? 'container' : 'relative',\n      enableRtl: this.parent.enableRtl,\n      hideAnimation: {\n        name: 'ZoomOut',\n        duration: 300\n      },\n      showAnimation: {\n        name: 'ZoomIn',\n        duration: 300\n      },\n      open: this.morePopupOpen.bind(this),\n      close: this.morePopupClose.bind(this),\n      collision: this.parent.isAdaptive ? {\n        X: 'fit',\n        Y: 'fit'\n      } : this.parent.enableRtl ? {\n        X: 'flip',\n        Y: 'fit'\n      } : {\n        X: 'flip',\n        Y: 'flip'\n      },\n      viewPortElement: this.parent.isAdaptive ? document.body : this.parent.element,\n      zIndex: this.parent.isAdaptive ? 1002 : 2\n    });\n    var closeButton = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CLOSE_CLASS);\n    this.renderButton('e-round', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeButton, this.closeClick);\n    EventHandler.add(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS), 'click', this.navigationClick, this);\n  };\n\n  QuickPopups.prototype.renderQuickDialog = function () {\n    var buttonModel = [{\n      buttonModel: {\n        cssClass: 'e-quick-alertok e-flat',\n        isPrimary: true\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-quick-alertcancel e-flat',\n        isPrimary: false\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-quick-dialog-cancel e-disable e-flat',\n        isPrimary: false\n      },\n      click: this.dialogButtonClick.bind(this)\n    }];\n\n    if (this.parent.eventSettings.editFollowingEvents) {\n      var followingSeriesButton = {\n        buttonModel: {\n          cssClass: 'e-quick-alertfollowing e-flat',\n          isPrimary: false\n        },\n        click: this.dialogButtonClick.bind(this)\n      };\n      buttonModel.splice(1, 0, followingSeriesButton);\n    }\n\n    this.quickDialog = new Dialog({\n      animationSettings: {\n        effect: 'Zoom'\n      },\n      buttons: buttonModel,\n      cssClass: cls.QUICK_DIALOG_CLASS,\n      closeOnEscape: true,\n      enableRtl: this.parent.enableRtl,\n      beforeClose: this.beforeQuickDialogClose.bind(this),\n      isModal: true,\n      position: {\n        X: 'center',\n        Y: 'center'\n      },\n      showCloseIcon: true,\n      target: document.body,\n      visible: false,\n      width: 'auto'\n    });\n    var dialogElement = createElement('div', {\n      id: this.parent.element.id + 'QuickDialog'\n    });\n    this.parent.element.appendChild(dialogElement);\n    this.quickDialog.appendTo(dialogElement);\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.setAttribute('aria-label', this.l10n.getConstant('occurrence'));\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.setAttribute('aria-label', this.l10n.getConstant('series'));\n      cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    if (this.quickDialog.element.querySelector('.e-dlg-closeicon-btn')) {\n      this.quickDialog.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n    }\n  }; // eslint-disable-next-line max-len\n\n\n  QuickPopups.prototype.renderButton = function (className, iconName, isDisabled, element, clickEvent) {\n    var buttonObj = new Button({\n      cssClass: className,\n      disabled: isDisabled,\n      enableRtl: this.parent.enableRtl,\n      iconCss: iconName\n    });\n    buttonObj.appendTo(element);\n    EventHandler.add(element, 'click', clickEvent, this);\n    removeClass([element], cls.ICON);\n  };\n\n  QuickPopups.prototype.quickDialogClass = function (action) {\n    var classList = [cls.QUICK_DIALOG_OCCURRENCE_CLASS, cls.QUICK_DIALOG_SERIES_CLASS, cls.QUICK_DIALOG_DELETE_CLASS, cls.QUICK_DIALOG_CANCEL_CLASS, cls.QUICK_DIALOG_ALERT_BTN_CLASS, cls.DISABLE_CLASS];\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n    var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n    removeClass([okButton, cancelButton], classList);\n    addClass([this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS)], cls.DISABLE_CLASS);\n\n    if (this.parent.eventSettings.editFollowingEvents) {\n      addClass([followingEventButton], cls.DISABLE_CLASS);\n      removeClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n    }\n\n    switch (action) {\n      case 'Recurrence':\n        addClass([okButton], cls.QUICK_DIALOG_OCCURRENCE_CLASS);\n        addClass([cancelButton], cls.QUICK_DIALOG_SERIES_CLASS);\n\n        if (this.parent.eventSettings.editFollowingEvents) {\n          removeClass([followingEventButton], cls.DISABLE_CLASS);\n          addClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n          addClass([followingEventButton], cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS);\n        }\n\n        break;\n\n      case 'Delete':\n        addClass([okButton], cls.QUICK_DIALOG_DELETE_CLASS);\n        addClass([cancelButton], cls.QUICK_DIALOG_CANCEL_CLASS);\n        break;\n\n      case 'Alert':\n        addClass([okButton], [cls.QUICK_DIALOG_ALERT_OK, cls.QUICK_DIALOG_ALERT_BTN_CLASS]);\n        addClass([cancelButton], [cls.QUICK_DIALOG_ALERT_CANCEL, cls.DISABLE_CLASS]);\n        break;\n    }\n  };\n\n  QuickPopups.prototype.applyFormValidation = function () {\n    var form = this.quickPopup.element.querySelector('.' + cls.FORM_CLASS);\n    var rules = {};\n    rules[this.parent.eventSettings.fields.subject.name] = this.parent.eventSettings.fields.subject.validation;\n    this.fieldValidator.renderFormValidator(form, rules, this.quickPopup.element, this.parent.locale);\n  };\n\n  QuickPopups.prototype.openRecurrenceAlert = function () {\n    var editDeleteOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (editDeleteOnly) {\n      editDeleteOnly.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteEvent' : 'editEvent');\n      editDeleteOnly.setAttribute('aria-label', editDeleteOnly.innerHTML);\n    }\n\n    var editFollowingEventsOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n\n    if (editFollowingEventsOnly) {\n      editFollowingEventsOnly.innerHTML = this.l10n.getConstant('editFollowingEvent');\n      editFollowingEventsOnly.setAttribute('aria-label', editFollowingEventsOnly.innerHTML);\n    }\n\n    var editDeleteSeries = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (editDeleteSeries) {\n      editDeleteSeries.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteSeries' : 'editSeries');\n      editDeleteSeries.setAttribute('aria-label', editDeleteSeries.innerHTML);\n    }\n\n    this.quickDialog.content = this.l10n.getConstant('editContent');\n    this.quickDialog.header = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteTitle' : 'editTitle');\n    this.quickDialogClass('Recurrence');\n    var activeEvent = this.parent.activeEventData.event;\n\n    if (this.parent.eventSettings.editFollowingEvents && this.parent.currentAction === 'EditOccurrence' && !isNullOrUndefined(activeEvent[this.parent.eventFields.recurrenceID]) && activeEvent[this.parent.eventFields.recurrenceID] !== activeEvent[this.parent.eventFields.id]) {\n      var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n      addClass([followingEventButton], cls.DISABLE_CLASS);\n    }\n\n    this.showQuickDialog('RecurrenceAlert');\n  };\n\n  QuickPopups.prototype.openRecurrenceValidationAlert = function (type) {\n    this.quickDialogClass('Alert');\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n    okButton.innerHTML = this.l10n.getConstant('ok');\n    okButton.setAttribute('aria-label', okButton.innerHTML);\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n    cancelButton.innerHTML = this.l10n.getConstant('cancel');\n    cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    this.quickDialog.header = this.l10n.getConstant('alert');\n    var dialogCancel;\n\n    switch (type) {\n      case 'wrongPattern':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('wrongPattern');\n        break;\n\n      case 'createError':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('createError');\n        break;\n\n      case 'sameDayAlert':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('sameDayAlert');\n        break;\n\n      case 'seriesChangeAlert':\n        dialogCancel = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS);\n        removeClass([cancelButton, dialogCancel], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('seriesChangeAlert');\n        okButton.innerHTML = this.l10n.getConstant('yes');\n        cancelButton.innerHTML = this.l10n.getConstant('no');\n        dialogCancel.innerHTML = this.l10n.getConstant('cancel');\n        break;\n\n      case 'occurrenceAlert':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('occurenceAlert');\n        break;\n    }\n\n    if (!this.parent.enableRecurrenceValidation && type === 'wrongPattern' || this.parent.enableRecurrenceValidation) {\n      this.showQuickDialog('RecurrenceValidationAlert');\n    }\n  };\n\n  QuickPopups.prototype.openDeleteAlert = function () {\n    if (this.parent.activeViewOptions.readonly) {\n      return;\n    }\n\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.innerHTML = this.l10n.getConstant('delete');\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.innerHTML = this.l10n.getConstant('cancel');\n      cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    this.quickDialog.content = this.parent.activeEventData.event.length > 1 ? this.l10n.getConstant('deleteMultipleContent') : this.l10n.getConstant('deleteContent');\n    this.quickDialog.header = this.parent.activeEventData.event.length > 1 ? this.l10n.getConstant('deleteMultipleEvent') : this.l10n.getConstant('deleteEvent');\n    this.quickDialogClass('Delete');\n    this.showQuickDialog('DeleteAlert');\n  };\n\n  QuickPopups.prototype.openValidationError = function (type, eventData) {\n    this.quickDialog.header = this.l10n.getConstant('alert');\n    this.quickDialog.content = this.l10n.getConstant(type);\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.innerHTML = this.l10n.getConstant('ok');\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.innerHTML = this.l10n.getConstant('cancel');\n      okButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    this.quickDialogClass('Alert');\n    this.showQuickDialog('ValidationAlert', eventData);\n  };\n\n  QuickPopups.prototype.showQuickDialog = function (popupType, eventData) {\n    var _this = this;\n\n    this.quickDialog.dataBind();\n    var eventProp = {\n      type: popupType,\n      cancel: false,\n      element: this.quickDialog.element,\n      data: extend({}, eventData || this.parent.activeEventData.event, null, true)\n    };\n    this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n      if (!popupArgs.cancel) {\n        _this.quickDialog.show();\n      }\n    });\n  };\n\n  QuickPopups.prototype.createMoreEventList = function (eventCollection, groupOrder, groupIndex) {\n    var _this = this;\n\n    var fields = this.parent.eventFields;\n    var moreEventContentEle = createElement('div', {\n      className: cls.MORE_EVENT_CONTENT_CLASS\n    });\n    var moreEventWrapperEle = createElement('div', {\n      className: cls.MORE_EVENT_WRAPPER_CLASS\n    });\n\n    if (eventCollection.length === 0) {\n      moreEventWrapperEle = createElement('div', {\n        className: cls.MORE_EVENT_CONTENT_CLASS,\n        innerHTML: this.l10n.getConstant('emptyContainer')\n      });\n    } else {\n      var _loop_1 = function (eventData) {\n        var eventText = eventData[fields.subject] || this_1.parent.eventSettings.fields.subject.default || this_1.parent.localeObj.getConstant('addTitle');\n        var appointmentElement = createElement('div', {\n          className: cls.APPOINTMENT_CLASS,\n          attrs: {\n            'data-id': '' + eventData[fields.id],\n            'data-guid': eventData.Guid,\n            'role': 'button',\n            'tabindex': '0',\n            'aria-readonly': this_1.parent.eventBase.getReadonlyAttribute(eventData),\n            'aria-selected': 'false',\n            'aria-grabbed': 'true',\n            'aria-label': this_1.parent.getAnnouncementString(eventData)\n          }\n        });\n        var templateElement = void 0;\n\n        if (!isNullOrUndefined(this_1.parent.activeViewOptions.eventTemplate)) {\n          var tempId = this_1.parent.element.id + '_' + this_1.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n          templateElement = this_1.parent.getAppointmentTemplate()(eventData, this_1.parent, 'eventTemplate', tempId, false);\n          append(templateElement, appointmentElement);\n        } else {\n          appointmentElement.appendChild(createElement('div', {\n            className: cls.SUBJECT_CLASS,\n            innerHTML: eventText\n          }));\n        }\n\n        if (!isNullOrUndefined(groupIndex)) {\n          appointmentElement.setAttribute('data-group-index', groupIndex);\n        }\n\n        if (!isNullOrUndefined(eventData[fields.recurrenceRule])) {\n          var iconClass = eventData[fields.id] === eventData[fields.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n          appointmentElement.appendChild(createElement('div', {\n            className: cls.ICON + ' ' + iconClass\n          }));\n        }\n\n        var args = {\n          data: extend({}, eventData, null, true),\n          element: appointmentElement,\n          cancel: false\n        };\n        this_1.parent.trigger(event.eventRendered, args, function (eventArgs) {\n          if (!eventArgs.cancel) {\n            moreEventWrapperEle.appendChild(appointmentElement);\n            var isPreventCrud = _this.parent.isAdaptive || _this.parent.currentView === 'Year';\n\n            _this.parent.eventBase.wireAppointmentEvents(appointmentElement, eventData, isPreventCrud);\n\n            _this.parent.eventBase.applyResourceColor(appointmentElement, eventData, 'backgroundColor', groupOrder);\n          }\n        });\n      };\n\n      var this_1 = this;\n\n      for (var _i = 0, eventCollection_1 = eventCollection; _i < eventCollection_1.length; _i++) {\n        var eventData = eventCollection_1[_i];\n\n        _loop_1(eventData);\n      }\n    }\n\n    moreEventContentEle.appendChild(moreEventWrapperEle);\n    return moreEventContentEle;\n  };\n\n  QuickPopups.prototype.tapHoldEventPopup = function (e) {\n    var target = closest(e.target, '.' + cls.APPOINTMENT_CLASS);\n    this.isMultipleEventSelect = false;\n    this.parent.selectedElements = [];\n    this.isMultipleEventSelect = true;\n    this.parent.eventBase.getSelectedEventElements(target);\n    this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n    var guid = target.getAttribute('data-guid');\n    var eventObj = this.parent.eventBase.getEventByGuid(guid);\n\n    if (isNullOrUndefined(eventObj)) {\n      return;\n    }\n\n    var eventTitle = eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle');\n    var eventTemplate = \"<div class=\\\"\" + cls.MULTIPLE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.POPUP_HEADER_CLASS + \"\\\">\" + (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button>\") + (\"<div class=\\\"\" + cls.SUBJECT_CLASS + \"\\\">\" + eventTitle + \"</div>\") + (\"<button class=\\\"\" + cls.EDIT_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") + (\"<button class=\\\"\" + cls.DELETE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button></div></div>\");\n    this.quickPopup.element.innerHTML = eventTemplate;\n    var closeIcon = this.quickPopup.element.querySelector('.' + cls.CLOSE_CLASS);\n    this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.closeClick);\n    var readonly = this.parent.activeViewOptions.readonly || eventObj[this.parent.eventFields.isReadonly];\n    var editAction = !this.parent.eventSettings.allowEditing || readonly;\n    var deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n    var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n\n    if (editIcon) {\n      this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n    }\n\n    var deleteIcon = this.quickPopup.element.querySelector('.' + cls.DELETE_CLASS);\n\n    if (deleteIcon) {\n      this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n    }\n\n    this.beforeQuickPopupOpen(target);\n  };\n\n  QuickPopups.prototype.isCellBlocked = function (args) {\n    var tempObj = {};\n    tempObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    tempObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    tempObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      var targetCell = args.element instanceof Array ? args.element[0] : args.element;\n      var groupIndex = parseInt(targetCell.getAttribute('data-group-index'), 10);\n      this.parent.resourceBase.setResourceValues(tempObj, isNaN(groupIndex) ? null : groupIndex);\n    }\n\n    return this.parent.eventBase.isBlockRange(tempObj);\n  };\n\n  QuickPopups.prototype.cellClick = function (args) {\n    var date = new Date(args.startTime.getTime());\n\n    if (!this.parent.showQuickInfo || !this.parent.eventSettings.allowAdding || this.parent.currentView === 'MonthAgenda' || this.isCellBlocked(args) || !this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n      this.quickPopupHide();\n      return;\n    }\n\n    var targetEle = args.event.target;\n\n    if (this.parent.isAdaptive) {\n      this.quickPopupHide();\n      var newEventClone = this.parent.element.querySelector('.' + cls.NEW_EVENT_CLASS);\n\n      if (isNullOrUndefined(newEventClone)) {\n        newEventClone = createElement('div', {\n          className: cls.NEW_EVENT_CLASS,\n          innerHTML: \"<div class=\\\"e-title\\\">+ \" + this.l10n.getConstant('newEvent') + \"</div>\"\n        });\n      }\n\n      var targetCell = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS);\n\n      if (targetCell) {\n        targetCell.appendChild(newEventClone);\n      }\n\n      return;\n    }\n\n    var target = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' + cls.HEADER_CELLS_CLASS);\n\n    if (isNullOrUndefined(target) || targetEle.classList.contains(cls.MORE_INDICATOR_CLASS)) {\n      return;\n    }\n\n    var isSameTarget = this.quickPopup.relateTo === target;\n\n    if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      var subjectElement_1 = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (subjectElement_1) {\n        subjectElement_1.focus();\n      }\n\n      return;\n    }\n\n    var temp = {};\n    temp[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    temp[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    temp[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n    var quickCellPopup = createElement('div', {\n      className: cls.CELL_POPUP_CLASS\n    });\n    quickCellPopup.appendChild(this.getPopupHeader('Cell', temp));\n    quickCellPopup.appendChild(this.getPopupContent('Cell', args, temp));\n    quickCellPopup.appendChild(this.getPopupFooter('Cell', temp));\n    var subjectElement = quickCellPopup.querySelector('.' + cls.SUBJECT_CLASS);\n\n    if (subjectElement) {\n      Input.createInput({\n        element: subjectElement,\n        properties: {\n          placeholder: this.l10n.getConstant('addTitle')\n        }\n      });\n    }\n\n    if (!isNullOrUndefined(this.parent.eventSettings.fields.subject.default)) {\n      subjectElement.value = this.parent.eventSettings.fields.subject.default;\n    }\n\n    var closeIcon = quickCellPopup.querySelector('.' + cls.CLOSE_CLASS);\n\n    if (closeIcon) {\n      this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n    }\n\n    var moreButton = quickCellPopup.querySelector('.' + cls.QUICK_POPUP_EVENT_DETAILS_CLASS);\n\n    if (moreButton) {\n      this.renderButton('e-flat', '', false, moreButton, this.detailsClick);\n    }\n\n    var saveButton = quickCellPopup.querySelector('.' + cls.EVENT_CREATE_CLASS);\n\n    if (saveButton) {\n      this.renderButton('e-flat e-primary', '', this.parent.activeViewOptions.readonly, saveButton, this.saveClick);\n    }\n\n    if (this.morePopup) {\n      this.morePopup.hide();\n    }\n\n    this.quickPopup.content = quickCellPopup;\n    this.quickPopup.relateTo = target;\n    this.quickPopup.dataBind();\n    this.beforeQuickPopupOpen(target);\n  };\n\n  QuickPopups.prototype.isSameEventClick = function (events) {\n    var isSameTarget = this.quickPopup.relateTo === closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n\n    if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n\n      if (editIcon) {\n        editIcon.focus();\n      }\n\n      if (!this.parent.isAdaptive) {\n        var editButton = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n\n        if (editButton) {\n          editButton.focus();\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  QuickPopups.prototype.isQuickTemplate = function (type) {\n    return this.parent.quickInfoTemplates.templateType === 'Both' || this.parent.quickInfoTemplates.templateType === type;\n  };\n\n  QuickPopups.prototype.eventClick = function (events) {\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.close();\n    }\n\n    if (!this.parent.showQuickInfo) {\n      return;\n    }\n\n    if (this.parent.isAdaptive && this.isMultipleEventSelect) {\n      this.updateTapHoldEventPopup(closest(events.element, '.' + cls.APPOINTMENT_CLASS));\n    } else {\n      var isSameTarget = this.isSameEventClick(events);\n\n      if (isSameTarget) {\n        return;\n      }\n\n      var eventData = events.event;\n      var quickEventPopup = createElement('div', {\n        className: cls.EVENT_POPUP_CLASS\n      });\n      quickEventPopup.appendChild(this.getPopupHeader('Event', eventData));\n      quickEventPopup.appendChild(this.getPopupContent('Event', events, eventData));\n      quickEventPopup.appendChild(this.getPopupFooter('Event', eventData));\n      var readonly = this.parent.activeViewOptions.readonly || eventData[this.parent.eventFields.isReadonly];\n      var editAction = !this.parent.eventSettings.allowEditing || readonly;\n      var deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n      var editIcon = quickEventPopup.querySelector('.' + cls.EDIT_CLASS);\n      var buttonClass = 'e-flat e-round e-small';\n\n      if (editIcon) {\n        this.renderButton(buttonClass, cls.ICON + ' ' + cls.EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n      }\n\n      var deleteIcon = quickEventPopup.querySelector('.' + cls.DELETE_CLASS);\n\n      if (deleteIcon) {\n        this.renderButton(buttonClass, cls.ICON + ' ' + cls.DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n      }\n\n      var closeIcon = quickEventPopup.querySelector('.' + cls.CLOSE_CLASS);\n\n      if (closeIcon) {\n        this.renderButton(buttonClass, cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n      }\n\n      var editButton = quickEventPopup.querySelector('.' + cls.EDIT_EVENT_CLASS);\n\n      if (editButton) {\n        this.renderButton('e-flat e-primary', '', editAction, editButton, this.editClick);\n      }\n\n      var deleteButton = quickEventPopup.querySelector('.' + cls.DELETE_EVENT_CLASS);\n\n      if (deleteButton) {\n        this.renderButton('e-flat', '', deleteAction, deleteButton, this.deleteClick);\n      }\n\n      if (this.morePopup && !closest(events.element, '.' + cls.MORE_EVENT_WRAPPER_CLASS)) {\n        this.morePopup.hide();\n      }\n\n      this.quickPopup.content = quickEventPopup;\n      this.quickPopup.relateTo = this.parent.isAdaptive ? document.body : closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n      this.quickPopup.dataBind();\n      this.beforeQuickPopupOpen(events.element);\n    }\n  };\n\n  QuickPopups.prototype.getPopupHeader = function (headerType, headerData) {\n    var headerTemplate = createElement('div', {\n      className: cls.POPUP_HEADER_CLASS\n    });\n\n    if (this.isQuickTemplate(headerType) && this.parent.quickInfoTemplates.header) {\n      var headerArgs = extend({}, headerData, {\n        elementType: headerType.toLowerCase()\n      }, true);\n      var templateId = this.parent.element.id;\n      var headerTemp = [].slice.call(this.parent.getQuickInfoTemplatesHeader()(headerArgs, this.parent, 'header', templateId + '_headerTemplate', false));\n      append([].slice.call(headerTemp), headerTemplate);\n    } else {\n      var header = void 0;\n      var args = void 0;\n\n      switch (headerType) {\n        case 'Cell':\n          header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\"><button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\" + (\"\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\");\n          break;\n\n        case 'Event':\n          args = this.getFormattedString(headerData);\n          header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\">\" + (\"<button class=\\\"\" + (cls.EDIT_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") + (\"<button class=\\\"\" + (cls.DELETE_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button>\") + (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\") + (\"<div class=\\\"\" + cls.SUBJECT_WRAP + \"\\\"><div class=\\\"\" + cls.SUBJECT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" \") + (\"title=\\\"\" + args.eventSubject + \"\\\">\" + args.eventSubject + \"</div></div >\");\n          break;\n      }\n\n      var templateWrapper = createElement('div', {\n        innerHTML: header\n      });\n      append([].slice.call(templateWrapper.childNodes), headerTemplate);\n    }\n\n    return headerTemplate;\n  };\n\n  QuickPopups.prototype.getPopupContent = function (type, args, data) {\n    var contentTemplate = createElement('div', {\n      className: cls.POPUP_CONTENT_CLASS\n    });\n\n    if (this.isQuickTemplate(type) && this.parent.quickInfoTemplates.content) {\n      var contentArgs = extend({}, data, {\n        elementType: type.toLowerCase()\n      }, true);\n      var templateId = this.parent.element.id;\n      var contentTemp = [].slice.call(this.parent.getQuickInfoTemplatesContent()(contentArgs, this.parent, 'content', templateId + '_contentTemplate', false));\n      append([].slice.call(contentTemp), contentTemplate);\n    } else {\n      var content = void 0;\n      var cellDetails = void 0;\n      var argsData = void 0;\n      var resourceText = this.getResourceText(args, type.toLowerCase());\n\n      switch (type) {\n        case 'Cell':\n          cellDetails = this.getFormattedString(data);\n          content = \"<table class=\\\"\" + cls.POPUP_TABLE_CLASS + \"\\\"><tbody><tr><td><form class=\\\"\" + cls.FORM_CLASS + \"\\\" onsubmit=\" + (\"\\\"return false;\\\"><input class=\\\"\" + cls.SUBJECT_CLASS + \" \" + EVENT_FIELD + \"\\\" type=\\\"text\\\" name=\") + (\"\\\"\" + this.parent.eventFields.subject + \"\\\" /></form></td></tr><tr><td><div class=\\\"\" + cls.DATE_TIME_CLASS + \"\\\">\") + (\"<div class=\\\"\" + cls.DATE_TIME_ICON_CLASS + \" \" + cls.ICON + \"\\\"></div><div class=\\\"\" + cls.DATE_TIME_DETAILS_CLASS + \" \") + (cls.TEXT_ELLIPSIS + \"\\\">\" + cellDetails.details + \"</div></div>\") + ((this.parent.activeViewOptions.group.resources.length > 0 ? \"<div class=\\\"\" + cls.RESOURCE_CLASS + \"\\\">\" + (\"<div class=\\\"\" + cls.RESOURCE_ICON_CLASS + \" \" + cls.ICON + \" \\\"></div><div class=\\\"\" + cls.RESOURCE_DETAILS_CLASS + \" \") + (cls.TEXT_ELLIPSIS + \"\\\">\" + resourceText + \"</div></div>\") : '') + \"</td></tr></tbody></table>\");\n          break;\n\n        case 'Event':\n          argsData = this.getFormattedString(data);\n          content = '<div class=\"' + cls.DATE_TIME_CLASS + '\"><div class=\"' + cls.DATE_TIME_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.DATE_TIME_WRAPPER_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\"><div class=\"' + cls.DATE_TIME_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + argsData.details + '</div>';\n\n          if (data[this.parent.eventFields.recurrenceRule]) {\n            content += '<div class=\"' + cls.RECURRENCE_SUMMARY_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + this.getRecurrenceSummary(data) + '</div>';\n          }\n\n          content += '</div></div>';\n\n          if (data[this.parent.eventFields.location]) {\n            content += '<div class=\"' + cls.LOCATION_CLASS + '\"><div class=\"' + cls.LOCATION_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.LOCATION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + data[this.parent.eventFields.location] + '</div></div>';\n          }\n\n          if (data[this.parent.eventFields.startTimezone] || data[this.parent.eventFields.endTimezone]) {\n            content += '<div class=\"' + cls.TIME_ZONE_CLASS + '\"><div class=\"' + cls.TIME_ZONE_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.TIME_ZONE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + this.getTimezone(data) + '</div></div>';\n          }\n\n          if (data[this.parent.eventFields.description]) {\n            content += '<div class=\"' + cls.DESCRIPTION_CLASS + '\"><div class=\"' + cls.DESCRIPTION_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.DESCRIPTION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + data[this.parent.eventFields.description] + '</div></div>';\n          }\n\n          if (this.parent.resourceCollection.length > 0) {\n            content += '<div class=\"' + cls.RESOURCE_CLASS + '\"><div class=\"' + cls.RESOURCE_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.RESOURCE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + resourceText + '</div></div>';\n          }\n\n          break;\n      }\n\n      var templateWrapper = createElement('div', {\n        innerHTML: content\n      });\n      append([].slice.call(templateWrapper.childNodes), contentTemplate);\n    }\n\n    return contentTemplate;\n  };\n\n  QuickPopups.prototype.getPopupFooter = function (footerType, footerData) {\n    var footerTemplate = createElement('div', {\n      className: cls.POPUP_FOOTER_CLASS\n    });\n\n    if (this.isQuickTemplate(footerType) && this.parent.quickInfoTemplates.footer) {\n      var footerArgs = extend({}, footerData, {\n        elementType: footerType.toLowerCase()\n      }, true);\n      var templateId = this.parent.element.id;\n      var footerTemp = [].slice.call(this.parent.getQuickInfoTemplatesFooter()(footerArgs, this.parent, 'footer', templateId + '_footerTemplate', false));\n      append([].slice.call(footerTemp), footerTemplate);\n    } else {\n      var footer = void 0;\n\n      switch (footerType) {\n        case 'Cell':\n          footer = \"<button class=\\\"\" + (cls.QUICK_POPUP_EVENT_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS) + \"\\\" title=\" + (\"\\\"\" + this.l10n.getConstant('moreDetails') + \"\\\">\" + this.l10n.getConstant('moreDetails') + \"</button>\") + (\"<button class=\\\"\" + cls.EVENT_CREATE_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('save') + \"\\\">\") + (this.l10n.getConstant('save') + \"</button>\");\n          break;\n\n        case 'Event':\n          footer = \"\" + (this.parent.isAdaptive ? '' : \"<button class=\\\"\" + cls.EDIT_EVENT_CLASS + \" \" + (cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\">\" + this.l10n.getConstant('edit') + \"</button>\") + (\"<button class=\\\"\" + cls.DELETE_EVENT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\">\") + (this.l10n.getConstant('delete') + \"</button>\"));\n          break;\n      }\n\n      var templateWrapper = createElement('div', {\n        innerHTML: footer\n      });\n      append([].slice.call(templateWrapper.childNodes), footerTemplate);\n    }\n\n    return footerTemplate;\n  };\n\n  QuickPopups.prototype.getResourceText = function (args, type) {\n    if (this.parent.resourceCollection.length === 0) {\n      return null;\n    }\n\n    var resourceValue = '';\n\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      var resourceCollection_1 = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n      var resourceData = resourceCollection_1.dataSource;\n\n      if (type === 'event') {\n        var eventData = args.event;\n\n        var _loop_2 = function (data) {\n          var resourceId = eventData[resourceCollection_1.field];\n\n          if (resourceId instanceof Array) {\n            if (resourceId.indexOf(data[resourceCollection_1.idField]) > -1) {\n              var id_1 = resourceId[resourceId.indexOf(data[resourceCollection_1.idField])];\n              var resource = resourceData.filter(function (e) {\n                return e[resourceCollection_1.idField] === id_1;\n              })[0];\n              resourceValue += resourceValue === '' ? resource[resourceCollection_1.textField] : ', ' + resource[resourceCollection_1.textField];\n            }\n          } else if (data[resourceCollection_1.idField] === resourceId) {\n            resourceValue = data[resourceCollection_1.textField].toString();\n          }\n        };\n\n        for (var _i = 0, resourceData_1 = resourceData; _i < resourceData_1.length; _i++) {\n          var data = resourceData_1[_i];\n\n          _loop_2(data);\n        }\n      } else {\n        resourceValue = resourceData[0][resourceCollection_1.textField].toString();\n      }\n    } else {\n      if (type === 'event') {\n        var eventData = args.event;\n        var resourceData = void 0;\n        var lastResource_1;\n\n        for (var i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n          resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n\n          if (!isNullOrUndefined(resourceData)) {\n            lastResource_1 = this.parent.resourceBase.resourceCollection[i];\n            break;\n          }\n        }\n\n        if (!Array.isArray(resourceData)) {\n          resourceData = [resourceData];\n        }\n\n        var resNames_1 = [];\n        var lastResourceData_1 = lastResource_1.dataSource;\n        resourceData.forEach(function (value) {\n          var text;\n          var i = util.findIndexInData(lastResourceData_1, lastResource_1.idField, value);\n\n          if (i > -1) {\n            text = lastResourceData_1[i][lastResource_1.textField];\n          }\n\n          if (text) {\n            resNames_1.push(text);\n          }\n        });\n        resourceValue = resNames_1.join(', ');\n      } else {\n        var argsData = args;\n        var groupIndex = !isNullOrUndefined(argsData.groupIndex) ? argsData.groupIndex : 0;\n        var resourceDetails = this.parent.resourceBase.lastResourceLevel[groupIndex];\n        resourceValue = resourceDetails.resourceData[resourceDetails.resource.textField];\n      }\n    }\n\n    return resourceValue;\n  };\n\n  QuickPopups.prototype.getFormattedString = function (eventData) {\n    var fields = this.parent.eventFields;\n    var eventSubject = eventData[fields.subject] || this.l10n.getConstant('noTitle');\n    var startDate = eventData[fields.startTime];\n    var endDate = eventData[fields.endTime];\n    var startDateDetails = this.getDateFormat(startDate, 'long');\n    var endDateDetails = eventData[fields.isAllDay] && endDate.getHours() === 0 && endDate.getMinutes() === 0 ? this.getDateFormat(util.addDays(new Date(endDate.getTime()), -1), 'long') : this.getDateFormat(endDate, 'long');\n    var startTimeDetail = this.parent.getTimeString(startDate);\n    var endTimeDetail = this.parent.getTimeString(endDate);\n    var details = '';\n    var spanLength = endDate.getDate() !== startDate.getDate() && (endDate.getTime() - startDate.getTime()) / (60 * 60 * 1000) < 24 ? 1 : 0;\n\n    if (eventData[fields.isAllDay]) {\n      details = startDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n\n      if ((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY > 1) {\n        details += '&nbsp;-&nbsp;' + endDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n      }\n    } else if ((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY >= 1 || spanLength > 0) {\n      details = startDateDetails + ' (' + startTimeDetail + ')' + '&nbsp;-&nbsp;' + endDateDetails + ' (' + endTimeDetail + ')';\n    } else {\n      details = startDateDetails + ' (' + (startTimeDetail + '&nbsp;-&nbsp;' + endTimeDetail) + ')';\n    }\n\n    return {\n      eventSubject: eventSubject,\n      details: details\n    };\n  };\n\n  QuickPopups.prototype.moreEventClick = function (data, endDate, groupIndex) {\n    var _this = this;\n\n    this.quickPopupHide(true);\n    var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n\n    if (moreEventContentEle) {\n      remove(moreEventContentEle);\n    }\n\n    var selectedDate = data.date.getTime().toString();\n    var target = closest(data.element, '.' + cls.MORE_INDICATOR_CLASS + ',.' + cls.WORK_CELLS_CLASS);\n    var day = this.parent.globalize.formatDate(data.date, {\n      format: 'E',\n      calendar: this.parent.getCalendarMode()\n    });\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DAY_CLASS).innerHTML = util.capitalizeFirstWord(day, 'single');\n    var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n    dateElement.innerHTML = this.getDateFormat(data.date, 'd');\n    dateElement.setAttribute('data-date', selectedDate);\n    dateElement.setAttribute('data-end-date', endDate.getTime().toString());\n    var groupOrder;\n\n    if (!isNullOrUndefined(groupIndex)) {\n      dateElement.setAttribute('data-group-index', groupIndex);\n      groupOrder = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)].groupOrder;\n    }\n\n    var moreEventElements = this.createMoreEventList(data.event, groupOrder, groupIndex);\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreEventElements);\n    removeClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n\n    if (util.resetTime(data.date).getTime() === util.resetTime(this.parent.getCurrentTime()).getTime()) {\n      addClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n    }\n\n    if (!this.parent.isAdaptive) {\n      if (this.parent.currentView.indexOf('Timeline') !== -1) {\n        var gIndex = target.getAttribute('data-group-index');\n        var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n        startDate.setHours(startDate.getHours(), startDate.getMinutes(), 0);\n        var tdDate = startDate.getTime().toString();\n\n        if (isNullOrUndefined(gIndex)) {\n          this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' tbody tr td[data-date=\"' + tdDate + '\"]');\n        } else {\n          this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' tbody tr td[data-group-index=\"' + gIndex + '\"][data-date=\"' + tdDate + '\"]');\n\n          if (isNullOrUndefined(this.morePopup.relateTo)) {\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' tbody tr td[data-group-index=\"' + gIndex + '\"]'));\n\n            for (var i = 0; i < workCells.length; i++) {\n              var date = workCells[i].getAttribute('data-date');\n\n              if (date < tdDate) {\n                this.morePopup.relateTo = workCells[i];\n              }\n            }\n          }\n        }\n      } else {\n        this.morePopup.relateTo = closest(target, '.' + cls.WORK_CELLS_CLASS);\n      }\n    }\n\n    this.parent.renderTemplates();\n    var eventProp = {\n      type: 'EventContainer',\n      cancel: false,\n      element: this.morePopup.element,\n      data: data\n    };\n    this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n      if (!popupArgs.cancel) {\n        _this.morePopup.show();\n      }\n    });\n  };\n\n  QuickPopups.prototype.saveClick = function (event) {\n    this.applyFormValidation();\n    this.dialogEvent = event;\n    this.isCrudAction = true;\n    this.quickPopupHide();\n  };\n\n  QuickPopups.prototype.detailsClick = function (event) {\n    var subjectEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n    if (subjectEle && subjectEle.value !== '') {\n      extend(this.parent.activeCellsData, {\n        subject: subjectEle.value\n      });\n    }\n\n    this.dialogEvent = event;\n    this.isCrudAction = false;\n    this.fieldValidator.destroyToolTip();\n    this.quickPopupHide();\n    this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n  };\n\n  QuickPopups.prototype.editClick = function (event) {\n    this.dialogEvent = event;\n    this.quickPopupHide(true);\n    var data = this.parent.activeEventData.event;\n    this.parent.currentAction = 'EditSeries';\n\n    if (!isNullOrUndefined(data[this.parent.eventFields.recurrenceRule])) {\n      this.parent.currentAction = 'EditOccurrence';\n      this.openRecurrenceAlert();\n    } else {\n      this.parent.eventWindow.openEditor(data, this.parent.currentAction);\n    }\n  };\n\n  QuickPopups.prototype.deleteClick = function (event) {\n    this.dialogEvent = event;\n    this.quickPopupHide(true);\n    this.parent.currentAction = 'Delete';\n\n    if (this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) {\n      this.openRecurrenceAlert();\n    } else {\n      this.openDeleteAlert();\n    }\n  };\n\n  QuickPopups.prototype.updateMoreEventContent = function () {\n    if (this.morePopup.element.classList.contains('e-popup-close')) {\n      return;\n    }\n\n    var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n\n    if (moreEventContentEle) {\n      remove(moreEventContentEle);\n    }\n\n    var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n    var startDate = new Date(parseInt(dateElement.getAttribute('data-date'), 10));\n    var endDate = new Date(parseInt(dateElement.getAttribute('data-end-date'), 10));\n    var groupIndex = dateElement.getAttribute('data-group-index');\n    var data;\n    var groupOrder;\n\n    if (!isNullOrUndefined(groupIndex)) {\n      data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n      groupOrder = data.groupOrder;\n    }\n\n    var events = this.parent.eventBase.filterEvents(startDate, endDate, this.parent.eventsProcessed, data);\n    var moreElement = this.createMoreEventList(events, groupOrder, groupIndex);\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreElement);\n  };\n\n  QuickPopups.prototype.closeClick = function (event) {\n    this.dialogEvent = event;\n\n    if (this.parent.currentView === 'Year' && this.parent.activeCellsData && this.parent.activeCellsData.element) {\n      this.parent.selectCell(this.parent.activeCellsData.element);\n    }\n\n    this.quickPopupHide();\n    this.morePopup.hide();\n  };\n\n  QuickPopups.prototype.dialogButtonClick = function (event) {\n    this.dialogEvent = event;\n    this.quickDialog.hide();\n    var target = event.target;\n    var cancelBtn = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n    var eventData = this.parent.activeEventData.event;\n\n    if (target.classList.contains(cls.QUICK_DIALOG_OCCURRENCE_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteOccurrence' : 'EditOccurrence';\n\n      switch (this.parent.currentAction) {\n        case 'EditOccurrence':\n          this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n          break;\n\n        case 'DeleteOccurrence':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteFollowingEvents' : 'EditFollowingEvents';\n\n      switch (this.parent.currentAction) {\n        case 'EditFollowingEvents':\n          this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n          break;\n\n        case 'DeleteFollowingEvents':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(cls.QUICK_DIALOG_SERIES_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteSeries' : 'EditSeries';\n\n      switch (this.parent.currentAction) {\n        case 'EditSeries':\n          this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(eventData, true), this.parent.currentAction);\n          break;\n\n        case 'DeleteSeries':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(cls.QUICK_DIALOG_DELETE_CLASS)) {\n      this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n    } else if (!cancelBtn.classList.contains(cls.DISABLE_CLASS) && (target.classList.contains(cls.QUICK_DIALOG_ALERT_OK) || target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL) && !cancelBtn.classList.contains(cls.QUICK_DIALOG_CANCEL_CLASS))) {\n      this.parent.uiStateValues.isIgnoreOccurrence = target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL);\n      this.parent.eventWindow.eventSave(event, this.l10n.getConstant('ok'));\n    }\n  };\n\n  QuickPopups.prototype.updateTapHoldEventPopup = function (target) {\n    var selectedElements = this.parent.eventBase.getSelectedEventElements(target);\n    this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n\n    if (selectedElements.length > 0) {\n      var eventObj = this.parent.eventBase.getEventByGuid(selectedElements[0].getAttribute('data-guid'));\n      var titleContent = selectedElements.length === 1 ? eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle') : '(' + selectedElements.length + ')' + '&nbsp;' + this.l10n.getConstant('selectedItems');\n      this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS).innerHTML = titleContent;\n\n      if (selectedElements.length > 1) {\n        addClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n      } else {\n        removeClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n      }\n    } else {\n      this.parent.selectedElements = [];\n      this.quickPopupHide();\n    }\n  };\n\n  QuickPopups.prototype.getTimezone = function (event) {\n    var zoneDetails = '';\n    zoneDetails += event[this.parent.eventFields.startTimezone] || '';\n    zoneDetails += zoneDetails === '' ? '' : ' - ';\n    zoneDetails += event[this.parent.eventFields.endTimezone] || '';\n    return zoneDetails;\n  };\n\n  QuickPopups.prototype.getRecurrenceSummary = function (event) {\n    var recurrenceEditor = this.parent.eventWindow.getRecurrenceEditorInstance();\n\n    if (recurrenceEditor) {\n      var ruleSummary = recurrenceEditor.getRuleSummary(event[this.parent.eventFields.recurrenceRule]);\n      return ruleSummary.charAt(0).toUpperCase() + ruleSummary.slice(1);\n    }\n\n    return '';\n  };\n\n  QuickPopups.prototype.getDateFormat = function (date, skeletonString) {\n    return util.capitalizeFirstWord(this.parent.globalize.formatDate(date, {\n      skeleton: skeletonString,\n      calendar: this.parent.getCalendarMode()\n    }), 'single');\n  };\n\n  QuickPopups.prototype.getDataFromTarget = function (target) {\n    if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n      return this.parent.activeEventData.event;\n    } // Deprecated cells data in quick popups\n\n\n    var eventObj = {\n      startTime: this.parent.activeCellsData.startTime,\n      endTime: this.parent.activeCellsData.endTime,\n      isAllDay: this.parent.activeCellsData.isAllDay,\n      groupIndex: this.parent.activeCellsData.groupIndex\n    };\n    var cellsData = this.parent.activeCellsData;\n    this.parent.eventWindow.convertToEventData(cellsData, eventObj);\n    return eventObj;\n  };\n\n  QuickPopups.prototype.beforeQuickDialogClose = function (e) {\n    var _this = this;\n\n    var args = {\n      event: e.event || this.dialogEvent,\n      type: isNullOrUndefined(this.parent.activeEventData.event) ? 'ValidationAlert' : !isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) ? 'RecurrenceAlert' : 'DeleteAlert',\n      cancel: false,\n      data: this.parent.activeEventData.event,\n      element: this.quickDialog.element\n    };\n    this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n      if (!popupCloseArgs.cancel) {\n        _this.parent.eventBase.focusElement(true);\n      }\n    });\n  };\n\n  QuickPopups.prototype.beforeQuickPopupOpen = function (target) {\n    var _this = this;\n\n    this.parent.renderTemplates();\n    var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n    var popupType = this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo';\n    var eventProp = {\n      type: popupType,\n      cancel: false,\n      data: extend({}, this.getDataFromTarget(target), null, true),\n      target: target,\n      element: this.quickPopup.element\n    };\n    this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n      if (popupArgs.cancel) {\n        _this.quickPopupHide();\n\n        _this.destroyPopupButtons('quickPopup');\n\n        if (popupArgs.element.classList.contains(cls.POPUP_OPEN)) {\n          _this.quickPopupClose();\n        }\n\n        util.removeChildren(_this.quickPopup.element);\n        _this.isMultipleEventSelect = false;\n      } else {\n        var display = _this.quickPopup.element.style.display;\n        _this.quickPopup.element.style.display = 'block';\n\n        if (_this.parent.isAdaptive) {\n          _this.quickPopup.element.removeAttribute('style');\n\n          _this.quickPopup.element.style.display = 'block';\n          _this.quickPopup.element.style.height = formatUnit(popupType === 'EditEventInfo' ? 65 : window.innerHeight);\n        } else {\n          _this.quickPopup.offsetX = 10;\n          _this.quickPopup.collision = {\n            X: _this.parent.enableRtl ? 'flip' : 'none',\n            Y: 'fit'\n          };\n          _this.quickPopup.position = {\n            X: _this.parent.enableRtl ? 'left' : 'right',\n            Y: _this.parent.enableRtl ? 'bottom' : 'top'\n          };\n\n          _this.quickPopup.dataBind();\n\n          _this.quickPopup.refreshPosition(null, true);\n\n          var collide = isCollide(_this.quickPopup.element, _this.parent.element);\n\n          if (collide.indexOf(_this.parent.enableRtl ? 'left' : 'right') > -1) {\n            _this.quickPopup.offsetX = -target.offsetWidth - 10 - _this.quickPopup.element.offsetWidth;\n\n            _this.quickPopup.dataBind();\n\n            var leftCollide = isCollide(_this.quickPopup.element, _this.parent.element);\n\n            if (leftCollide.indexOf('left') > -1) {\n              _this.quickPopup.position = {\n                X: 'center',\n                Y: 'center'\n              };\n              _this.quickPopup.collision = {\n                X: 'fit',\n                Y: 'fit'\n              };\n              _this.quickPopup.offsetX = -(_this.quickPopup.element.offsetWidth / 2);\n\n              _this.quickPopup.dataBind();\n            }\n          }\n\n          if (_this.parent.virtualScrollModule && (collide.indexOf('top') > -1 || collide.indexOf('bottom') > -1)) {\n            var element = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n\n            var translateY = util.getTranslateY(element);\n            _this.quickPopup.offsetY = translateY;\n\n            _this.quickPopup.dataBind();\n          }\n        }\n\n        if (isEventPopup) {\n          _this.applyEventColor();\n        }\n\n        _this.quickPopup.element.style.display = display;\n\n        _this.quickPopup.dataBind();\n\n        _this.quickPopup.show();\n      }\n    });\n  };\n\n  QuickPopups.prototype.applyEventColor = function () {\n    var colorField = '';\n\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      colorField = this.parent.enableRtl ? 'border-right-color' : 'border-left-color';\n    } else {\n      colorField = 'background-color';\n    }\n\n    var color = this.parent.activeEventData.element.style[colorField];\n\n    if (color === '') {\n      return;\n    }\n\n    var colorEle = this.quickPopup.element.querySelector('.' + cls.POPUP_HEADER_CLASS);\n    var footerEle = this.quickPopup.element.querySelector('.' + cls.POPUP_FOOTER_CLASS);\n\n    if (footerEle && footerEle.offsetParent) {\n      colorEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (colorEle) {\n        colorEle.style.borderLeftColor = color;\n        color = \"rgba(\" + color.match(/\\d+/g).join() + \",0.3)\";\n      }\n    }\n\n    if (colorEle) {\n      colorEle.style.backgroundColor = color;\n    }\n  };\n\n  QuickPopups.prototype.quickPopupOpen = function () {\n    if (this.parent.isAdaptive) {\n      this.quickPopup.element.style.top = '0px';\n      return;\n    }\n\n    if (this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS)) {\n      var subjectElement = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (subjectElement) {\n        subjectElement.focus();\n      }\n    } else {\n      var editElement = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n\n      if (editElement) {\n        editElement.focus();\n      }\n\n      var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n\n      if (editIcon) {\n        editIcon.focus();\n      }\n    }\n  };\n\n  QuickPopups.prototype.quickPopupClose = function () {\n    this.parent.eventBase.focusElement();\n    this.quickPopup.relateTo = cls.WORK_CELLS_CLASS;\n    this.fieldValidator.destroyToolTip();\n\n    if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n      this.fieldValidator.destroy();\n    }\n\n    this.destroyPopupButtons('quickPopup');\n    util.removeChildren(this.quickPopup.element);\n  };\n\n  QuickPopups.prototype.morePopupOpen = function () {\n    if (this.parent.isAdaptive) {\n      this.morePopup.element.style.top = '0px';\n      this.morePopup.element.style.left = '0px';\n      this.morePopup.element.style.height = formatUnit(window.innerHeight);\n      return;\n    }\n\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS).focus();\n    this.morePopup.refreshPosition();\n  };\n\n  QuickPopups.prototype.morePopupClose = function () {\n    var moreWrapper = this.parent.element.querySelector('.' + cls.MORE_EVENT_WRAPPER_CLASS);\n\n    if (moreWrapper) {\n      remove(moreWrapper);\n    }\n  };\n\n  QuickPopups.prototype.popupClose = function (event) {\n    this.dialogEvent = event;\n    this.isCrudAction = false;\n    this.quickPopupHide(true);\n  };\n\n  QuickPopups.prototype.quickPopupHide = function (hideAnimation) {\n    var _this = this;\n\n    if (!this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      return;\n    }\n\n    var isCellPopup = this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS);\n    var popupData;\n\n    if (isCellPopup) {\n      var formvalidator = this.quickPopup.element.querySelector('.e-formvalidator');\n\n      if (this.isCrudAction && formvalidator && !formvalidator.ej2_instances[0].validate()) {\n        return;\n      }\n\n      var fields = this.parent.eventFields;\n      var saveObj = this.parent.eventWindow.getObjectFromFormData(cls.POPUP_WRAPPER_CLASS);\n      this.parent.eventWindow.setDefaultValueToObject(saveObj);\n      saveObj[fields.id] = this.parent.eventBase.getEventMaxID();\n      saveObj[fields.startTime] = this.parent.activeCellsData.startTime;\n      saveObj[fields.endTime] = this.parent.activeCellsData.endTime;\n      saveObj[fields.isAllDay] = this.parent.activeCellsData.isAllDay;\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.setResourceValues(saveObj);\n      }\n\n      popupData = saveObj;\n    } else {\n      popupData = this.parent.activeEventData.event;\n    }\n\n    var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n    var args = {\n      event: this.dialogEvent,\n      type: this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo',\n      cancel: false,\n      data: popupData,\n      element: this.quickPopup.element,\n      target: isCellPopup ? this.parent.activeCellsData.element : this.parent.activeEventData.element\n    };\n    this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n      if (!popupCloseArgs.cancel) {\n        if (_this.quickPopup.element.classList.contains('e-popup-open')) {\n          if (isCellPopup && _this.isCrudAction) {\n            _this.parent.currentAction = 'Add';\n\n            _this.parent.crudModule.addEvent(popupCloseArgs.data);\n          }\n\n          if (hideAnimation) {\n            var animation = _this.quickPopup.hideAnimation;\n            _this.quickPopup.hideAnimation = null;\n\n            _this.quickPopup.hide();\n\n            _this.quickPopup.hideAnimation = animation;\n          } else {\n            _this.quickPopup.hide();\n          }\n\n          _this.isMultipleEventSelect = false;\n          _this.isCrudAction = false;\n        }\n      }\n    });\n  };\n\n  QuickPopups.prototype.navigationClick = function (e) {\n    var navigateEle = closest(e.target, '.' + cls.NAVIGATE_CLASS);\n\n    if (!isNullOrUndefined(navigateEle)) {\n      var date = this.parent.getDateFromElement(e.currentTarget);\n\n      if (!isNullOrUndefined(date)) {\n        this.closeClick(e);\n        this.parent.setProperties({\n          selectedDate: date\n        }, true);\n        this.parent.changeView(this.parent.getNavigateView(), e);\n      }\n    }\n  };\n\n  QuickPopups.prototype.documentClick = function (e) {\n    var target = e.event.target;\n    var classNames = '.' + cls.POPUP_WRAPPER_CLASS + ',.' + cls.HEADER_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' + cls.WORK_CELLS_CLASS + ',.' + cls.APPOINTMENT_CLASS + ',.e-popup';\n    var popupWrap = this.parent.element.querySelector('.' + cls.POPUP_WRAPPER_CLASS);\n\n    if (popupWrap && popupWrap.childElementCount > 0 && !closest(target, classNames) || !closest(target, classNames)) {\n      this.quickPopupHide();\n      this.parent.removeNewEventElement();\n    }\n\n    var tar = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n\n    if (tar && tar !== target && this.parent.allowInline) {\n      this.parent.inlineModule.documentClick();\n    }\n\n    if (closest(target, '.' + cls.APPOINTMENT_CLASS + ',.' + cls.HEADER_CELLS_CLASS)) {\n      this.parent.removeNewEventElement();\n    }\n\n    if (!closest(target, '.' + cls.MORE_POPUP_WRAPPER_CLASS) && target.classList && !target.classList.contains(cls.MORE_INDICATOR_CLASS) && !closest(target, '.' + cls.POPUP_OPEN) && !closest(target, '.' + cls.WORK_CELLS_CLASS)) {\n      this.morePopup.hide();\n    }\n  };\n\n  QuickPopups.prototype.onClosePopup = function (event) {\n    if (!isNullOrUndefined(event)) {\n      this.dialogEvent = event;\n    }\n\n    this.quickPopupHide();\n    this.parent.eventBase.focusElement();\n  };\n\n  QuickPopups.prototype.addEventListener = function () {\n    this.parent.on(event.cellClick, this.cellClick, this);\n    this.parent.on(event.eventClick, this.eventClick, this);\n    this.parent.on(event.documentClick, this.documentClick, this);\n    this.parent.on(event.dataReady, this.updateMoreEventContent, this);\n  };\n\n  QuickPopups.prototype.removeEventListener = function () {\n    this.parent.off(event.cellClick, this.cellClick);\n    this.parent.off(event.eventClick, this.eventClick);\n    this.parent.off(event.documentClick, this.documentClick);\n    this.parent.off(event.dataReady, this.updateMoreEventContent);\n  };\n\n  QuickPopups.prototype.destroyPopupButtons = function (popupName) {\n    var popup = popupName === 'quickPopup' ? this.quickPopup : this.morePopup;\n    var buttonCollections = [].slice.call(popup.element.querySelectorAll('.e-control.e-btn'));\n\n    for (var _i = 0, buttonCollections_1 = buttonCollections; _i < buttonCollections_1.length; _i++) {\n      var button = buttonCollections_1[_i];\n      var instance = button.ej2_instances[0];\n\n      if (instance) {\n        instance.destroy();\n      }\n    }\n  };\n\n  QuickPopups.prototype.refreshQuickDialog = function () {\n    this.destroyQuickDialog();\n    this.renderQuickDialog();\n  };\n\n  QuickPopups.prototype.refreshQuickPopup = function () {\n    this.destroyQuickPopup();\n    this.renderQuickPopup();\n  };\n\n  QuickPopups.prototype.refreshMorePopup = function () {\n    this.destroyMorePopup();\n    this.renderMorePopup();\n  };\n\n  QuickPopups.prototype.destroyQuickDialog = function () {\n    if (this.quickDialog.element) {\n      this.quickDialog.destroy();\n      remove(this.quickDialog.element);\n      this.quickDialog = null;\n    }\n  };\n\n  QuickPopups.prototype.destroyQuickPopup = function () {\n    if (this.quickPopup.element) {\n      this.destroyPopupButtons('quickPopup');\n      this.quickPopup.destroy();\n      remove(this.quickPopup.element);\n      this.quickPopup = null;\n    }\n  };\n\n  QuickPopups.prototype.destroyMorePopup = function () {\n    if (this.morePopup.element) {\n      this.destroyPopupButtons('morePopup');\n      this.morePopup.destroy();\n      remove(this.morePopup.element);\n      this.morePopup = null;\n    }\n  };\n\n  QuickPopups.prototype.destroy = function () {\n    if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n      this.fieldValidator.destroy();\n    }\n\n    this.removeEventListener();\n    this.destroyQuickPopup();\n    this.destroyMorePopup();\n    this.destroyQuickDialog();\n    this.parent = null;\n    this.l10n = null;\n    this.isCrudAction = null;\n    this.fieldValidator = null;\n    this.isMultipleEventSelect = null;\n  };\n\n  return QuickPopups;\n}();\n\nexport { QuickPopups };","map":{"version":3,"names":["closest","EventHandler","isNullOrUndefined","formatUnit","append","addClass","removeClass","createElement","remove","extend","Dialog","Popup","isCollide","Button","Input","FieldValidator","event","cls","util","EVENT_FIELD","QuickPopups","parent","isMultipleEventSelect","isCrudAction","l10n","localeObj","fieldValidator","render","addEventListener","prototype","renderQuickPopup","renderMorePopup","renderQuickDialog","quickPopupWrapper","className","POPUP_WRAPPER_CLASS","isAdaptive","document","body","appendChild","DEVICE_CLASS","element","quickPopup","targetType","enableRtl","open","quickPopupOpen","bind","close","quickPopupClose","hideAnimation","name","duration","showAnimation","collision","X","Y","position","viewPortElement","zIndex","moreEventPopup","MORE_EVENT_POPUP_CLASS","MORE_EVENT_HEADER_CLASS","MORE_EVENT_CLOSE_CLASS","getConstant","MORE_EVENT_DATE_HEADER_CLASS","MORE_EVENT_HEADER_DAY_CLASS","MORE_EVENT_HEADER_DATE_CLASS","NAVIGATE_CLASS","moreEventWrapper","MORE_POPUP_WRAPPER_CLASS","innerHTML","morePopup","morePopupOpen","morePopupClose","closeButton","querySelector","renderButton","ICON","CLOSE_ICON_CLASS","closeClick","add","navigationClick","buttonModel","cssClass","isPrimary","click","dialogButtonClick","eventSettings","editFollowingEvents","followingSeriesButton","splice","quickDialog","animationSettings","effect","buttons","QUICK_DIALOG_CLASS","closeOnEscape","beforeClose","beforeQuickDialogClose","isModal","showCloseIcon","target","visible","width","dialogElement","id","appendTo","okButton","QUICK_DIALOG_ALERT_OK","setAttribute","cancelButton","QUICK_DIALOG_ALERT_CANCEL","iconName","isDisabled","clickEvent","buttonObj","disabled","iconCss","quickDialogClass","action","classList","QUICK_DIALOG_OCCURRENCE_CLASS","QUICK_DIALOG_SERIES_CLASS","QUICK_DIALOG_DELETE_CLASS","QUICK_DIALOG_CANCEL_CLASS","QUICK_DIALOG_ALERT_BTN_CLASS","DISABLE_CLASS","followingEventButton","QUICK_DIALOG_ALERT_FOLLOWING","FOLLOWING_EVENTS_DIALOG","QUICK_DIALOG_FOLLOWING_EVENTS_CLASS","applyFormValidation","form","FORM_CLASS","rules","fields","subject","validation","renderFormValidator","locale","openRecurrenceAlert","editDeleteOnly","currentAction","editFollowingEventsOnly","editDeleteSeries","content","header","activeEvent","activeEventData","eventFields","recurrenceID","showQuickDialog","openRecurrenceValidationAlert","type","dialogCancel","enableRecurrenceValidation","openDeleteAlert","activeViewOptions","readonly","length","openValidationError","eventData","popupType","_this","dataBind","eventProp","cancel","data","trigger","popupOpen","popupArgs","show","createMoreEventList","eventCollection","groupOrder","groupIndex","moreEventContentEle","MORE_EVENT_CONTENT_CLASS","moreEventWrapperEle","MORE_EVENT_WRAPPER_CLASS","_loop_1","eventText","this_1","default","appointmentElement","APPOINTMENT_CLASS","attrs","Guid","eventBase","getReadonlyAttribute","getAnnouncementString","templateElement","eventTemplate","tempId","eventTemplateName","getAppointmentTemplate","SUBJECT_CLASS","recurrenceRule","iconClass","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","args","eventRendered","eventArgs","isPreventCrud","currentView","wireAppointmentEvents","applyResourceColor","_i","eventCollection_1","tapHoldEventPopup","e","selectedElements","getSelectedEventElements","getSelectedEvents","guid","getAttribute","eventObj","getEventByGuid","eventTitle","MULTIPLE_EVENT_POPUP_CLASS","POPUP_HEADER_CLASS","CLOSE_CLASS","EDIT_CLASS","DELETE_CLASS","closeIcon","isReadonly","editAction","allowEditing","deleteAction","allowDeleting","editIcon","EDIT_ICON_CLASS","editClick","deleteIcon","DELETE_ICON_CLASS","deleteClick","beforeQuickPopupOpen","isCellBlocked","tempObj","startTime","activeCellsData","endTime","isAllDay","group","resources","targetCell","Array","parseInt","resourceBase","setResourceValues","isNaN","isBlockRange","cellClick","date","Date","getTime","showQuickInfo","allowAdding","isMinMaxDate","setHours","quickPopupHide","targetEle","newEventClone","NEW_EVENT_CLASS","WORK_CELLS_CLASS","ALLDAY_CELLS_CLASS","HEADER_CELLS_CLASS","contains","MORE_INDICATOR_CLASS","isSameTarget","relateTo","POPUP_OPEN","subjectElement_1","focus","temp","quickCellPopup","CELL_POPUP_CLASS","getPopupHeader","getPopupContent","getPopupFooter","subjectElement","createInput","properties","placeholder","value","popupClose","moreButton","QUICK_POPUP_EVENT_DETAILS_CLASS","detailsClick","saveButton","EVENT_CREATE_CLASS","saveClick","hide","isSameEventClick","events","editButton","EDIT_EVENT_CLASS","isQuickTemplate","quickInfoTemplates","templateType","eventClick","eventTooltip","updateTapHoldEventPopup","quickEventPopup","EVENT_POPUP_CLASS","buttonClass","deleteButton","DELETE_EVENT_CLASS","headerType","headerData","headerTemplate","headerArgs","elementType","toLowerCase","templateId","headerTemp","slice","call","getQuickInfoTemplatesHeader","POPUP_HEADER_ICON_WRAPPER","getFormattedString","SUBJECT_WRAP","TEXT_ELLIPSIS","eventSubject","templateWrapper","childNodes","contentTemplate","POPUP_CONTENT_CLASS","contentArgs","contentTemp","getQuickInfoTemplatesContent","cellDetails","argsData","resourceText","getResourceText","POPUP_TABLE_CLASS","DATE_TIME_CLASS","DATE_TIME_ICON_CLASS","DATE_TIME_DETAILS_CLASS","details","RESOURCE_CLASS","RESOURCE_ICON_CLASS","RESOURCE_DETAILS_CLASS","DATE_TIME_WRAPPER_CLASS","RECURRENCE_SUMMARY_CLASS","getRecurrenceSummary","location","LOCATION_CLASS","LOCATION_ICON_CLASS","LOCATION_DETAILS_CLASS","startTimezone","endTimezone","TIME_ZONE_CLASS","TIME_ZONE_ICON_CLASS","TIME_ZONE_DETAILS_CLASS","getTimezone","description","DESCRIPTION_CLASS","DESCRIPTION_ICON_CLASS","DESCRIPTION_DETAILS_CLASS","resourceCollection","footerType","footerData","footerTemplate","POPUP_FOOTER_CLASS","footer","footerArgs","footerTemp","getQuickInfoTemplatesFooter","resourceValue","resourceCollection_1","resourceData","dataSource","_loop_2","resourceId","field","indexOf","idField","id_1","resource","filter","textField","toString","resourceData_1","lastResource_1","i","isArray","resNames_1","lastResourceData_1","forEach","text","findIndexInData","push","join","resourceDetails","lastResourceLevel","startDate","endDate","startDateDetails","getDateFormat","endDateDetails","getHours","getMinutes","addDays","startTimeDetail","getTimeString","endTimeDetail","spanLength","getDate","MS_PER_DAY","moreEventClick","selectedDate","day","globalize","formatDate","format","calendar","getCalendarMode","capitalizeFirstWord","dateElement","moreEventElements","CURRENTDATE_CLASS","resetTime","getCurrentTime","gIndex","tdDate","CONTENT_WRAP_CLASS","workCells","querySelectorAll","renderTemplates","dialogEvent","subjectEle","destroyToolTip","eventWindow","openEditor","updateMoreEventContent","filterEvents","eventsProcessed","moreElement","selectCell","cancelBtn","crudModule","deleteEvent","getParentEvent","uiStateValues","isIgnoreOccurrence","eventSave","titleContent","HIDDEN_CLASS","zoneDetails","recurrenceEditor","getRecurrenceEditorInstance","ruleSummary","getRuleSummary","charAt","toUpperCase","skeletonString","skeleton","getDataFromTarget","cellsData","convertToEventData","popupCloseArgs","focusElement","isEventPopup","destroyPopupButtons","removeChildren","display","style","removeAttribute","height","window","innerHeight","offsetX","refreshPosition","collide","offsetWidth","leftCollide","virtualScrollModule","translateY","getTranslateY","offsetY","applyEventColor","colorField","color","colorEle","footerEle","offsetParent","borderLeftColor","match","backgroundColor","top","editElement","destroy","left","moreWrapper","isCellPopup","popupData","formvalidator","ej2_instances","validate","saveObj","getObjectFromFormData","setDefaultValueToObject","getEventMaxID","addEvent","animation","navigateEle","getDateFromElement","currentTarget","setProperties","changeView","getNavigateView","documentClick","classNames","popupWrap","childElementCount","removeNewEventElement","tar","INLINE_SUBJECT_CLASS","allowInline","inlineModule","onClosePopup","on","dataReady","removeEventListener","off","popupName","popup","buttonCollections","buttonCollections_1","button","instance","refreshQuickDialog","destroyQuickDialog","refreshQuickPopup","destroyQuickPopup","refreshMorePopup","destroyMorePopup"],"sources":["C:/Users/shahj/OneDrive/Documents/GitHub/Multifunctional-React-Dashboard/node_modules/@syncfusion/ej2-schedule/src/schedule/popups/quick-popups.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { closest, EventHandler, isNullOrUndefined, formatUnit, append } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, createElement, remove, extend } from '@syncfusion/ej2-base';\nimport { Dialog, Popup, isCollide } from '@syncfusion/ej2-popups';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { FieldValidator } from './form-validator';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\nvar EVENT_FIELD = 'e-field';\n/**\n * Quick Popups interactions\n */\nvar QuickPopups = /** @class */ (function () {\n    function QuickPopups(parent) {\n        this.isMultipleEventSelect = false;\n        this.isCrudAction = false;\n        this.parent = parent;\n        this.l10n = this.parent.localeObj;\n        this.fieldValidator = new FieldValidator();\n        this.render();\n        this.addEventListener();\n    }\n    QuickPopups.prototype.render = function () {\n        this.renderQuickPopup();\n        this.renderMorePopup();\n        this.renderQuickDialog();\n    };\n    QuickPopups.prototype.renderQuickPopup = function () {\n        var quickPopupWrapper = createElement('div', { className: cls.POPUP_WRAPPER_CLASS + ' e-popup-close' });\n        if (this.parent.isAdaptive) {\n            document.body.appendChild(quickPopupWrapper);\n            addClass([quickPopupWrapper], cls.DEVICE_CLASS);\n        }\n        else {\n            this.parent.element.appendChild(quickPopupWrapper);\n        }\n        this.quickPopup = new Popup(quickPopupWrapper, {\n            targetType: (this.parent.isAdaptive ? 'container' : 'relative'),\n            enableRtl: this.parent.enableRtl,\n            open: this.quickPopupOpen.bind(this),\n            close: this.quickPopupClose.bind(this),\n            hideAnimation: (this.parent.isAdaptive ? { name: 'ZoomOut' } : { name: 'FadeOut', duration: 150 }),\n            showAnimation: (this.parent.isAdaptive ? { name: 'ZoomIn' } : { name: 'FadeIn', duration: 150 }),\n            collision: (this.parent.isAdaptive ? { X: 'fit', Y: 'fit' } :\n                (this.parent.enableRtl ? { X: 'flip', Y: 'fit' } : { X: 'none', Y: 'fit' })),\n            position: (this.parent.isAdaptive || this.parent.enableRtl ? { X: 'left', Y: 'top' } : { X: 'right', Y: 'top' }),\n            viewPortElement: (this.parent.isAdaptive ? document.body : this.parent.element),\n            zIndex: (this.parent.isAdaptive ? 1004 : 3)\n        });\n    };\n    QuickPopups.prototype.renderMorePopup = function () {\n        var moreEventPopup = \"<div class=\\\"\" + cls.MORE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_CLASS + \"\\\">\" +\n            (\"<div class=\\\"\" + cls.MORE_EVENT_CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\" tabindex=\\\"0\\\"></div>\") +\n            (\"<div class=\\\"\" + cls.MORE_EVENT_DATE_HEADER_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_DAY_CLASS + \"\\\"></div>\") +\n            (\"<div class=\\\"\" + cls.MORE_EVENT_HEADER_DATE_CLASS + \" \" + cls.NAVIGATE_CLASS + \"\\\" tabindex=\\\"0\\\"></div></div></div></div>\");\n        var moreEventWrapper = createElement('div', {\n            className: cls.MORE_POPUP_WRAPPER_CLASS + ' e-popup-close',\n            innerHTML: moreEventPopup\n        });\n        if (this.parent.isAdaptive) {\n            document.body.appendChild(moreEventWrapper);\n            addClass([moreEventWrapper], cls.DEVICE_CLASS);\n        }\n        else {\n            this.parent.element.appendChild(moreEventWrapper);\n        }\n        this.morePopup = new Popup(moreEventWrapper, {\n            targetType: (this.parent.isAdaptive ? 'container' : 'relative'),\n            enableRtl: this.parent.enableRtl,\n            hideAnimation: { name: 'ZoomOut', duration: 300 },\n            showAnimation: { name: 'ZoomIn', duration: 300 },\n            open: this.morePopupOpen.bind(this),\n            close: this.morePopupClose.bind(this),\n            collision: (this.parent.isAdaptive ? { X: 'fit', Y: 'fit' } :\n                (this.parent.enableRtl ? { X: 'flip', Y: 'fit' } : { X: 'flip', Y: 'flip' })),\n            viewPortElement: (this.parent.isAdaptive ? document.body : this.parent.element),\n            zIndex: (this.parent.isAdaptive ? 1002 : 2)\n        });\n        var closeButton = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CLOSE_CLASS);\n        this.renderButton('e-round', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeButton, this.closeClick);\n        EventHandler.add(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS), 'click', this.navigationClick, this);\n    };\n    QuickPopups.prototype.renderQuickDialog = function () {\n        var buttonModel = [\n            { buttonModel: { cssClass: 'e-quick-alertok e-flat', isPrimary: true }, click: this.dialogButtonClick.bind(this) },\n            { buttonModel: { cssClass: 'e-quick-alertcancel e-flat', isPrimary: false }, click: this.dialogButtonClick.bind(this) },\n            {\n                buttonModel: { cssClass: 'e-quick-dialog-cancel e-disable e-flat', isPrimary: false },\n                click: this.dialogButtonClick.bind(this)\n            }\n        ];\n        if (this.parent.eventSettings.editFollowingEvents) {\n            var followingSeriesButton = {\n                buttonModel: { cssClass: 'e-quick-alertfollowing e-flat', isPrimary: false }, click: this.dialogButtonClick.bind(this)\n            };\n            buttonModel.splice(1, 0, followingSeriesButton);\n        }\n        this.quickDialog = new Dialog({\n            animationSettings: { effect: 'Zoom' },\n            buttons: buttonModel,\n            cssClass: cls.QUICK_DIALOG_CLASS,\n            closeOnEscape: true,\n            enableRtl: this.parent.enableRtl,\n            beforeClose: this.beforeQuickDialogClose.bind(this),\n            isModal: true,\n            position: { X: 'center', Y: 'center' },\n            showCloseIcon: true,\n            target: document.body,\n            visible: false,\n            width: 'auto'\n        });\n        var dialogElement = createElement('div', { id: this.parent.element.id + 'QuickDialog' });\n        this.parent.element.appendChild(dialogElement);\n        this.quickDialog.appendTo(dialogElement);\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.setAttribute('aria-label', this.l10n.getConstant('occurrence'));\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.setAttribute('aria-label', this.l10n.getConstant('series'));\n            cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        if (this.quickDialog.element.querySelector('.e-dlg-closeicon-btn')) {\n            this.quickDialog.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n        }\n    };\n    // eslint-disable-next-line max-len\n    QuickPopups.prototype.renderButton = function (className, iconName, isDisabled, element, clickEvent) {\n        var buttonObj = new Button({\n            cssClass: className,\n            disabled: isDisabled,\n            enableRtl: this.parent.enableRtl,\n            iconCss: iconName\n        });\n        buttonObj.appendTo(element);\n        EventHandler.add(element, 'click', clickEvent, this);\n        removeClass([element], cls.ICON);\n    };\n    QuickPopups.prototype.quickDialogClass = function (action) {\n        var classList = [\n            cls.QUICK_DIALOG_OCCURRENCE_CLASS, cls.QUICK_DIALOG_SERIES_CLASS, cls.QUICK_DIALOG_DELETE_CLASS,\n            cls.QUICK_DIALOG_CANCEL_CLASS, cls.QUICK_DIALOG_ALERT_BTN_CLASS, cls.DISABLE_CLASS\n        ];\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n        removeClass([okButton, cancelButton], classList);\n        addClass([this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS)], cls.DISABLE_CLASS);\n        if (this.parent.eventSettings.editFollowingEvents) {\n            addClass([followingEventButton], cls.DISABLE_CLASS);\n            removeClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n        }\n        switch (action) {\n            case 'Recurrence':\n                addClass([okButton], cls.QUICK_DIALOG_OCCURRENCE_CLASS);\n                addClass([cancelButton], cls.QUICK_DIALOG_SERIES_CLASS);\n                if (this.parent.eventSettings.editFollowingEvents) {\n                    removeClass([followingEventButton], cls.DISABLE_CLASS);\n                    addClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n                    addClass([followingEventButton], cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS);\n                }\n                break;\n            case 'Delete':\n                addClass([okButton], cls.QUICK_DIALOG_DELETE_CLASS);\n                addClass([cancelButton], cls.QUICK_DIALOG_CANCEL_CLASS);\n                break;\n            case 'Alert':\n                addClass([okButton], [cls.QUICK_DIALOG_ALERT_OK, cls.QUICK_DIALOG_ALERT_BTN_CLASS]);\n                addClass([cancelButton], [cls.QUICK_DIALOG_ALERT_CANCEL, cls.DISABLE_CLASS]);\n                break;\n        }\n    };\n    QuickPopups.prototype.applyFormValidation = function () {\n        var form = this.quickPopup.element.querySelector('.' + cls.FORM_CLASS);\n        var rules = {};\n        rules[this.parent.eventSettings.fields.subject.name] = this.parent.eventSettings.fields.subject.validation;\n        this.fieldValidator.renderFormValidator(form, rules, this.quickPopup.element, this.parent.locale);\n    };\n    QuickPopups.prototype.openRecurrenceAlert = function () {\n        var editDeleteOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (editDeleteOnly) {\n            editDeleteOnly.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteEvent' : 'editEvent');\n            editDeleteOnly.setAttribute('aria-label', editDeleteOnly.innerHTML);\n        }\n        var editFollowingEventsOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n        if (editFollowingEventsOnly) {\n            editFollowingEventsOnly.innerHTML = this.l10n.getConstant('editFollowingEvent');\n            editFollowingEventsOnly.setAttribute('aria-label', editFollowingEventsOnly.innerHTML);\n        }\n        var editDeleteSeries = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (editDeleteSeries) {\n            editDeleteSeries.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteSeries' : 'editSeries');\n            editDeleteSeries.setAttribute('aria-label', editDeleteSeries.innerHTML);\n        }\n        this.quickDialog.content = this.l10n.getConstant('editContent');\n        this.quickDialog.header = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteTitle' : 'editTitle');\n        this.quickDialogClass('Recurrence');\n        var activeEvent = this.parent.activeEventData.event;\n        if (this.parent.eventSettings.editFollowingEvents && this.parent.currentAction === 'EditOccurrence'\n            && !isNullOrUndefined(activeEvent[this.parent.eventFields.recurrenceID]) && activeEvent[this.parent.eventFields.recurrenceID]\n            !== activeEvent[this.parent.eventFields.id]) {\n            var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n            addClass([followingEventButton], cls.DISABLE_CLASS);\n        }\n        this.showQuickDialog('RecurrenceAlert');\n    };\n    QuickPopups.prototype.openRecurrenceValidationAlert = function (type) {\n        this.quickDialogClass('Alert');\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        okButton.innerHTML = this.l10n.getConstant('ok');\n        okButton.setAttribute('aria-label', okButton.innerHTML);\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        cancelButton.innerHTML = this.l10n.getConstant('cancel');\n        cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        this.quickDialog.header = this.l10n.getConstant('alert');\n        var dialogCancel;\n        switch (type) {\n            case 'wrongPattern':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('wrongPattern');\n                break;\n            case 'createError':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('createError');\n                break;\n            case 'sameDayAlert':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('sameDayAlert');\n                break;\n            case 'seriesChangeAlert':\n                dialogCancel = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS);\n                removeClass([cancelButton, dialogCancel], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('seriesChangeAlert');\n                okButton.innerHTML = this.l10n.getConstant('yes');\n                cancelButton.innerHTML = this.l10n.getConstant('no');\n                dialogCancel.innerHTML = this.l10n.getConstant('cancel');\n                break;\n            case 'occurrenceAlert':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('occurenceAlert');\n                break;\n        }\n        if ((!this.parent.enableRecurrenceValidation && type === 'wrongPattern') || this.parent.enableRecurrenceValidation) {\n            this.showQuickDialog('RecurrenceValidationAlert');\n        }\n    };\n    QuickPopups.prototype.openDeleteAlert = function () {\n        if (this.parent.activeViewOptions.readonly) {\n            return;\n        }\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.innerHTML = this.l10n.getConstant('delete');\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.innerHTML = this.l10n.getConstant('cancel');\n            cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        this.quickDialog.content = (this.parent.activeEventData.event.length > 1) ?\n            this.l10n.getConstant('deleteMultipleContent') : this.l10n.getConstant('deleteContent');\n        this.quickDialog.header = (this.parent.activeEventData.event.length > 1) ?\n            this.l10n.getConstant('deleteMultipleEvent') : this.l10n.getConstant('deleteEvent');\n        this.quickDialogClass('Delete');\n        this.showQuickDialog('DeleteAlert');\n    };\n    QuickPopups.prototype.openValidationError = function (type, eventData) {\n        this.quickDialog.header = this.l10n.getConstant('alert');\n        this.quickDialog.content = this.l10n.getConstant(type);\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.innerHTML = this.l10n.getConstant('ok');\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.innerHTML = this.l10n.getConstant('cancel');\n            okButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        this.quickDialogClass('Alert');\n        this.showQuickDialog('ValidationAlert', eventData);\n    };\n    QuickPopups.prototype.showQuickDialog = function (popupType, eventData) {\n        var _this = this;\n        this.quickDialog.dataBind();\n        var eventProp = {\n            type: popupType, cancel: false, element: this.quickDialog.element,\n            data: extend({}, (eventData || this.parent.activeEventData.event), null, true)\n        };\n        this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n            if (!popupArgs.cancel) {\n                _this.quickDialog.show();\n            }\n        });\n    };\n    QuickPopups.prototype.createMoreEventList = function (eventCollection, groupOrder, groupIndex) {\n        var _this = this;\n        var fields = this.parent.eventFields;\n        var moreEventContentEle = createElement('div', { className: cls.MORE_EVENT_CONTENT_CLASS });\n        var moreEventWrapperEle = createElement('div', { className: cls.MORE_EVENT_WRAPPER_CLASS });\n        if (eventCollection.length === 0) {\n            moreEventWrapperEle = createElement('div', {\n                className: cls.MORE_EVENT_CONTENT_CLASS,\n                innerHTML: this.l10n.getConstant('emptyContainer')\n            });\n        }\n        else {\n            var _loop_1 = function (eventData) {\n                var eventText = (eventData[fields.subject] || this_1.parent.eventSettings.fields.subject.default\n                    || this_1.parent.localeObj.getConstant('addTitle'));\n                var appointmentElement = createElement('div', {\n                    className: cls.APPOINTMENT_CLASS,\n                    attrs: {\n                        'data-id': '' + eventData[fields.id],\n                        'data-guid': eventData.Guid, 'role': 'button', 'tabindex': '0',\n                        'aria-readonly': this_1.parent.eventBase.getReadonlyAttribute(eventData),\n                        'aria-selected': 'false', 'aria-grabbed': 'true', 'aria-label': this_1.parent.getAnnouncementString(eventData)\n                    }\n                });\n                var templateElement = void 0;\n                if (!isNullOrUndefined(this_1.parent.activeViewOptions.eventTemplate)) {\n                    var tempId = this_1.parent.element.id + '_' + this_1.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n                    templateElement = this_1.parent.getAppointmentTemplate()(eventData, this_1.parent, 'eventTemplate', tempId, false);\n                    append(templateElement, appointmentElement);\n                }\n                else {\n                    appointmentElement.appendChild(createElement('div', { className: cls.SUBJECT_CLASS, innerHTML: eventText }));\n                }\n                if (!isNullOrUndefined(groupIndex)) {\n                    appointmentElement.setAttribute('data-group-index', groupIndex);\n                }\n                if (!isNullOrUndefined(eventData[fields.recurrenceRule])) {\n                    var iconClass = (eventData[fields.id] === eventData[fields.recurrenceID]) ?\n                        cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n                    appointmentElement.appendChild(createElement('div', { className: cls.ICON + ' ' + iconClass }));\n                }\n                var args = {\n                    data: extend({}, eventData, null, true),\n                    element: appointmentElement, cancel: false\n                };\n                this_1.parent.trigger(event.eventRendered, args, function (eventArgs) {\n                    if (!eventArgs.cancel) {\n                        moreEventWrapperEle.appendChild(appointmentElement);\n                        var isPreventCrud = _this.parent.isAdaptive || _this.parent.currentView === 'Year';\n                        _this.parent.eventBase.wireAppointmentEvents(appointmentElement, eventData, isPreventCrud);\n                        _this.parent.eventBase.applyResourceColor(appointmentElement, eventData, 'backgroundColor', groupOrder);\n                    }\n                });\n            };\n            var this_1 = this;\n            for (var _i = 0, eventCollection_1 = eventCollection; _i < eventCollection_1.length; _i++) {\n                var eventData = eventCollection_1[_i];\n                _loop_1(eventData);\n            }\n        }\n        moreEventContentEle.appendChild(moreEventWrapperEle);\n        return moreEventContentEle;\n    };\n    QuickPopups.prototype.tapHoldEventPopup = function (e) {\n        var target = closest(e.target, '.' + cls.APPOINTMENT_CLASS);\n        this.isMultipleEventSelect = false;\n        this.parent.selectedElements = [];\n        this.isMultipleEventSelect = true;\n        this.parent.eventBase.getSelectedEventElements(target);\n        this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n        var guid = target.getAttribute('data-guid');\n        var eventObj = this.parent.eventBase.getEventByGuid(guid);\n        if (isNullOrUndefined(eventObj)) {\n            return;\n        }\n        var eventTitle = (eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle'));\n        var eventTemplate = \"<div class=\\\"\" + cls.MULTIPLE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.POPUP_HEADER_CLASS + \"\\\">\" +\n            (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button>\") +\n            (\"<div class=\\\"\" + cls.SUBJECT_CLASS + \"\\\">\" + eventTitle + \"</div>\") +\n            (\"<button class=\\\"\" + cls.EDIT_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") +\n            (\"<button class=\\\"\" + cls.DELETE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button></div></div>\");\n        this.quickPopup.element.innerHTML = eventTemplate;\n        var closeIcon = this.quickPopup.element.querySelector('.' + cls.CLOSE_CLASS);\n        this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.closeClick);\n        var readonly = this.parent.activeViewOptions.readonly || eventObj[this.parent.eventFields.isReadonly];\n        var editAction = !this.parent.eventSettings.allowEditing || readonly;\n        var deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n        var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n        if (editIcon) {\n            this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n        }\n        var deleteIcon = this.quickPopup.element.querySelector('.' + cls.DELETE_CLASS);\n        if (deleteIcon) {\n            this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n        }\n        this.beforeQuickPopupOpen(target);\n    };\n    QuickPopups.prototype.isCellBlocked = function (args) {\n        var tempObj = {};\n        tempObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        tempObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        tempObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            var targetCell = args.element instanceof Array ? args.element[0] : args.element;\n            var groupIndex = parseInt(targetCell.getAttribute('data-group-index'), 10);\n            this.parent.resourceBase.setResourceValues(tempObj, isNaN(groupIndex) ? null : groupIndex);\n        }\n        return this.parent.eventBase.isBlockRange(tempObj);\n    };\n    QuickPopups.prototype.cellClick = function (args) {\n        var date = new Date(args.startTime.getTime());\n        if (!this.parent.showQuickInfo || !this.parent.eventSettings.allowAdding ||\n            this.parent.currentView === 'MonthAgenda' || this.isCellBlocked(args) ||\n            !this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n            this.quickPopupHide();\n            return;\n        }\n        var targetEle = args.event.target;\n        if (this.parent.isAdaptive) {\n            this.quickPopupHide();\n            var newEventClone = this.parent.element.querySelector('.' + cls.NEW_EVENT_CLASS);\n            if (isNullOrUndefined(newEventClone)) {\n                newEventClone = createElement('div', {\n                    className: cls.NEW_EVENT_CLASS,\n                    innerHTML: \"<div class=\\\"e-title\\\">+ \" + this.l10n.getConstant('newEvent') + \"</div>\"\n                });\n            }\n            var targetCell = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS);\n            if (targetCell) {\n                targetCell.appendChild(newEventClone);\n            }\n            return;\n        }\n        var target = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' +\n            cls.HEADER_CELLS_CLASS);\n        if (isNullOrUndefined(target) || targetEle.classList.contains(cls.MORE_INDICATOR_CLASS)) {\n            return;\n        }\n        var isSameTarget = this.quickPopup.relateTo === target;\n        if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            var subjectElement_1 = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n            if (subjectElement_1) {\n                subjectElement_1.focus();\n            }\n            return;\n        }\n        var temp = {};\n        temp[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        temp[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        temp[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        var quickCellPopup = createElement('div', { className: cls.CELL_POPUP_CLASS });\n        quickCellPopup.appendChild(this.getPopupHeader('Cell', temp));\n        quickCellPopup.appendChild(this.getPopupContent('Cell', args, temp));\n        quickCellPopup.appendChild(this.getPopupFooter('Cell', temp));\n        var subjectElement = quickCellPopup.querySelector('.' + cls.SUBJECT_CLASS);\n        if (subjectElement) {\n            Input.createInput({ element: subjectElement, properties: { placeholder: this.l10n.getConstant('addTitle') } });\n        }\n        if (!isNullOrUndefined(this.parent.eventSettings.fields.subject.default)) {\n            subjectElement.value = this.parent.eventSettings.fields.subject.default;\n        }\n        var closeIcon = quickCellPopup.querySelector('.' + cls.CLOSE_CLASS);\n        if (closeIcon) {\n            this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n        }\n        var moreButton = quickCellPopup.querySelector('.' + cls.QUICK_POPUP_EVENT_DETAILS_CLASS);\n        if (moreButton) {\n            this.renderButton('e-flat', '', false, moreButton, this.detailsClick);\n        }\n        var saveButton = quickCellPopup.querySelector('.' + cls.EVENT_CREATE_CLASS);\n        if (saveButton) {\n            this.renderButton('e-flat e-primary', '', this.parent.activeViewOptions.readonly, saveButton, this.saveClick);\n        }\n        if (this.morePopup) {\n            this.morePopup.hide();\n        }\n        this.quickPopup.content = quickCellPopup;\n        this.quickPopup.relateTo = target;\n        this.quickPopup.dataBind();\n        this.beforeQuickPopupOpen(target);\n    };\n    QuickPopups.prototype.isSameEventClick = function (events) {\n        var isSameTarget = this.quickPopup.relateTo === closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n        if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n            if (editIcon) {\n                editIcon.focus();\n            }\n            if (!this.parent.isAdaptive) {\n                var editButton = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n                if (editButton) {\n                    editButton.focus();\n                }\n            }\n            return true;\n        }\n        return false;\n    };\n    QuickPopups.prototype.isQuickTemplate = function (type) {\n        return this.parent.quickInfoTemplates.templateType === 'Both' || this.parent.quickInfoTemplates.templateType === type;\n    };\n    QuickPopups.prototype.eventClick = function (events) {\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.close();\n        }\n        if (!this.parent.showQuickInfo) {\n            return;\n        }\n        if (this.parent.isAdaptive && this.isMultipleEventSelect) {\n            this.updateTapHoldEventPopup(closest(events.element, '.' + cls.APPOINTMENT_CLASS));\n        }\n        else {\n            var isSameTarget = this.isSameEventClick(events);\n            if (isSameTarget) {\n                return;\n            }\n            var eventData = events.event;\n            var quickEventPopup = createElement('div', { className: cls.EVENT_POPUP_CLASS });\n            quickEventPopup.appendChild(this.getPopupHeader('Event', eventData));\n            quickEventPopup.appendChild(this.getPopupContent('Event', events, eventData));\n            quickEventPopup.appendChild(this.getPopupFooter('Event', eventData));\n            var readonly = this.parent.activeViewOptions.readonly || eventData[this.parent.eventFields.isReadonly];\n            var editAction = !this.parent.eventSettings.allowEditing || readonly;\n            var deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n            var editIcon = quickEventPopup.querySelector('.' + cls.EDIT_CLASS);\n            var buttonClass = 'e-flat e-round e-small';\n            if (editIcon) {\n                this.renderButton(buttonClass, cls.ICON + ' ' + cls.EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n            }\n            var deleteIcon = quickEventPopup.querySelector('.' + cls.DELETE_CLASS);\n            if (deleteIcon) {\n                this.renderButton(buttonClass, cls.ICON + ' ' + cls.DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n            }\n            var closeIcon = quickEventPopup.querySelector('.' + cls.CLOSE_CLASS);\n            if (closeIcon) {\n                this.renderButton(buttonClass, cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n            }\n            var editButton = quickEventPopup.querySelector('.' + cls.EDIT_EVENT_CLASS);\n            if (editButton) {\n                this.renderButton('e-flat e-primary', '', editAction, editButton, this.editClick);\n            }\n            var deleteButton = quickEventPopup.querySelector('.' + cls.DELETE_EVENT_CLASS);\n            if (deleteButton) {\n                this.renderButton('e-flat', '', deleteAction, deleteButton, this.deleteClick);\n            }\n            if (this.morePopup && !closest(events.element, '.' + cls.MORE_EVENT_WRAPPER_CLASS)) {\n                this.morePopup.hide();\n            }\n            this.quickPopup.content = quickEventPopup;\n            this.quickPopup.relateTo = this.parent.isAdaptive ? document.body :\n                closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n            this.quickPopup.dataBind();\n            this.beforeQuickPopupOpen(events.element);\n        }\n    };\n    QuickPopups.prototype.getPopupHeader = function (headerType, headerData) {\n        var headerTemplate = createElement('div', { className: cls.POPUP_HEADER_CLASS });\n        if (this.isQuickTemplate(headerType) && this.parent.quickInfoTemplates.header) {\n            var headerArgs = extend({}, headerData, { elementType: headerType.toLowerCase() }, true);\n            var templateId = this.parent.element.id;\n            var headerTemp = [].slice.call(this.parent.getQuickInfoTemplatesHeader()(headerArgs, this.parent, 'header', templateId + '_headerTemplate', false));\n            append([].slice.call(headerTemp), headerTemplate);\n        }\n        else {\n            var header = void 0;\n            var args = void 0;\n            switch (headerType) {\n                case 'Cell':\n                    header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\"><button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\" +\n                        (\"\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\");\n                    break;\n                case 'Event':\n                    args = this.getFormattedString(headerData);\n                    header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\">\" +\n                        (\"<button class=\\\"\" + (cls.EDIT_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") +\n                        (\"<button class=\\\"\" + (cls.DELETE_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button>\") +\n                        (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\") +\n                        (\"<div class=\\\"\" + cls.SUBJECT_WRAP + \"\\\"><div class=\\\"\" + cls.SUBJECT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" \") +\n                        (\"title=\\\"\" + args.eventSubject + \"\\\">\" + args.eventSubject + \"</div></div >\");\n                    break;\n            }\n            var templateWrapper = createElement('div', { innerHTML: header });\n            append([].slice.call(templateWrapper.childNodes), headerTemplate);\n        }\n        return headerTemplate;\n    };\n    QuickPopups.prototype.getPopupContent = function (type, args, data) {\n        var contentTemplate = createElement('div', { className: cls.POPUP_CONTENT_CLASS });\n        if (this.isQuickTemplate(type) && this.parent.quickInfoTemplates.content) {\n            var contentArgs = extend({}, data, { elementType: type.toLowerCase() }, true);\n            var templateId = this.parent.element.id;\n            var contentTemp = [].slice.call(this.parent.getQuickInfoTemplatesContent()(contentArgs, this.parent, 'content', templateId + '_contentTemplate', false));\n            append([].slice.call(contentTemp), contentTemplate);\n        }\n        else {\n            var content = void 0;\n            var cellDetails = void 0;\n            var argsData = void 0;\n            var resourceText = this.getResourceText(args, type.toLowerCase());\n            switch (type) {\n                case 'Cell':\n                    cellDetails = this.getFormattedString(data);\n                    content = \"<table class=\\\"\" + cls.POPUP_TABLE_CLASS + \"\\\"><tbody><tr><td><form class=\\\"\" + cls.FORM_CLASS + \"\\\" onsubmit=\" +\n                        (\"\\\"return false;\\\"><input class=\\\"\" + cls.SUBJECT_CLASS + \" \" + EVENT_FIELD + \"\\\" type=\\\"text\\\" name=\") +\n                        (\"\\\"\" + this.parent.eventFields.subject + \"\\\" /></form></td></tr><tr><td><div class=\\\"\" + cls.DATE_TIME_CLASS + \"\\\">\") +\n                        (\"<div class=\\\"\" + cls.DATE_TIME_ICON_CLASS + \" \" + cls.ICON + \"\\\"></div><div class=\\\"\" + cls.DATE_TIME_DETAILS_CLASS + \" \") +\n                        (cls.TEXT_ELLIPSIS + \"\\\">\" + cellDetails.details + \"</div></div>\") +\n                        ((this.parent.activeViewOptions.group.resources.length > 0 ? \"<div class=\\\"\" + cls.RESOURCE_CLASS + \"\\\">\" +\n                            (\"<div class=\\\"\" + cls.RESOURCE_ICON_CLASS + \" \" + cls.ICON + \" \\\"></div><div class=\\\"\" + cls.RESOURCE_DETAILS_CLASS + \" \") +\n                            (cls.TEXT_ELLIPSIS + \"\\\">\" + resourceText + \"</div></div>\") : '') + \"</td></tr></tbody></table>\");\n                    break;\n                case 'Event':\n                    argsData = this.getFormattedString(data);\n                    content = '<div class=\"' + cls.DATE_TIME_CLASS + '\"><div class=\"' + cls.DATE_TIME_ICON_CLASS + ' ' + cls.ICON +\n                        '\"></div><div class=\"' + cls.DATE_TIME_WRAPPER_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\"><div class=\"' +\n                        cls.DATE_TIME_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + argsData.details + '</div>';\n                    if (data[this.parent.eventFields.recurrenceRule]) {\n                        content += '<div class=\"' + cls.RECURRENCE_SUMMARY_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            this.getRecurrenceSummary(data) + '</div>';\n                    }\n                    content += '</div></div>';\n                    if (data[this.parent.eventFields.location]) {\n                        content += '<div class=\"' + cls.LOCATION_CLASS + '\"><div class=\"' + cls.LOCATION_ICON_CLASS + ' ' +\n                            cls.ICON + '\"></div><div class=\"' + cls.LOCATION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            data[this.parent.eventFields.location] + '</div></div>';\n                    }\n                    if (data[this.parent.eventFields.startTimezone] || data[this.parent.eventFields.endTimezone]) {\n                        content += '<div class=\"' + cls.TIME_ZONE_CLASS + '\"><div class=\"' + cls.TIME_ZONE_ICON_CLASS + ' ' + cls.ICON +\n                            '\"></div><div class=\"' + cls.TIME_ZONE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            this.getTimezone(data) + '</div></div>';\n                    }\n                    if (data[this.parent.eventFields.description]) {\n                        content += '<div class=\"' + cls.DESCRIPTION_CLASS + '\"><div class=\"' + cls.DESCRIPTION_ICON_CLASS + ' ' + cls.ICON +\n                            '\"></div><div class=\"' + cls.DESCRIPTION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            data[this.parent.eventFields.description] + '</div></div>';\n                    }\n                    if (this.parent.resourceCollection.length > 0) {\n                        content += '<div class=\"' + cls.RESOURCE_CLASS + '\"><div class=\"' + cls.RESOURCE_ICON_CLASS + ' ' + cls.ICON +\n                            '\"></div><div class=\"' + cls.RESOURCE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            resourceText + '</div></div>';\n                    }\n                    break;\n            }\n            var templateWrapper = createElement('div', { innerHTML: content });\n            append([].slice.call(templateWrapper.childNodes), contentTemplate);\n        }\n        return contentTemplate;\n    };\n    QuickPopups.prototype.getPopupFooter = function (footerType, footerData) {\n        var footerTemplate = createElement('div', { className: cls.POPUP_FOOTER_CLASS });\n        if (this.isQuickTemplate(footerType) && this.parent.quickInfoTemplates.footer) {\n            var footerArgs = extend({}, footerData, { elementType: footerType.toLowerCase() }, true);\n            var templateId = this.parent.element.id;\n            var footerTemp = [].slice.call(this.parent.getQuickInfoTemplatesFooter()(footerArgs, this.parent, 'footer', templateId + '_footerTemplate', false));\n            append([].slice.call(footerTemp), footerTemplate);\n        }\n        else {\n            var footer = void 0;\n            switch (footerType) {\n                case 'Cell':\n                    footer = \"<button class=\\\"\" + (cls.QUICK_POPUP_EVENT_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS) + \"\\\" title=\" +\n                        (\"\\\"\" + this.l10n.getConstant('moreDetails') + \"\\\">\" + this.l10n.getConstant('moreDetails') + \"</button>\") +\n                        (\"<button class=\\\"\" + cls.EVENT_CREATE_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('save') + \"\\\">\") +\n                        (this.l10n.getConstant('save') + \"</button>\");\n                    break;\n                case 'Event':\n                    footer = \"\" + (this.parent.isAdaptive ? '' : \"<button class=\\\"\" + cls.EDIT_EVENT_CLASS + \" \" +\n                        (cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\">\" + this.l10n.getConstant('edit') + \"</button>\") +\n                        (\"<button class=\\\"\" + cls.DELETE_EVENT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\">\") +\n                        (this.l10n.getConstant('delete') + \"</button>\"));\n                    break;\n            }\n            var templateWrapper = createElement('div', { innerHTML: footer });\n            append([].slice.call(templateWrapper.childNodes), footerTemplate);\n        }\n        return footerTemplate;\n    };\n    QuickPopups.prototype.getResourceText = function (args, type) {\n        if (this.parent.resourceCollection.length === 0) {\n            return null;\n        }\n        var resourceValue = '';\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            var resourceCollection_1 = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n            var resourceData = resourceCollection_1.dataSource;\n            if (type === 'event') {\n                var eventData = args.event;\n                var _loop_2 = function (data) {\n                    var resourceId = eventData[resourceCollection_1.field];\n                    if (resourceId instanceof Array) {\n                        if (resourceId.indexOf(data[resourceCollection_1.idField]) > -1) {\n                            var id_1 = resourceId[resourceId.indexOf(data[resourceCollection_1.idField])];\n                            var resource = resourceData.filter(function (e) {\n                                return e[resourceCollection_1.idField] === id_1;\n                            })[0];\n                            resourceValue += (resourceValue === '') ? resource[resourceCollection_1.textField] :\n                                ', ' + resource[resourceCollection_1.textField];\n                        }\n                    }\n                    else if (data[resourceCollection_1.idField] === resourceId) {\n                        resourceValue = data[resourceCollection_1.textField].toString();\n                    }\n                };\n                for (var _i = 0, resourceData_1 = resourceData; _i < resourceData_1.length; _i++) {\n                    var data = resourceData_1[_i];\n                    _loop_2(data);\n                }\n            }\n            else {\n                resourceValue = resourceData[0][resourceCollection_1.textField].toString();\n            }\n        }\n        else {\n            if (type === 'event') {\n                var eventData = args.event;\n                var resourceData = void 0;\n                var lastResource_1;\n                for (var i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n                    resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n                    if (!isNullOrUndefined(resourceData)) {\n                        lastResource_1 = this.parent.resourceBase.resourceCollection[i];\n                        break;\n                    }\n                }\n                if (!Array.isArray(resourceData)) {\n                    resourceData = [resourceData];\n                }\n                var resNames_1 = [];\n                var lastResourceData_1 = lastResource_1.dataSource;\n                resourceData.forEach(function (value) {\n                    var text;\n                    var i = util.findIndexInData(lastResourceData_1, lastResource_1.idField, value);\n                    if (i > -1) {\n                        text = lastResourceData_1[i][lastResource_1.textField];\n                    }\n                    if (text) {\n                        resNames_1.push(text);\n                    }\n                });\n                resourceValue = resNames_1.join(', ');\n            }\n            else {\n                var argsData = args;\n                var groupIndex = !isNullOrUndefined(argsData.groupIndex) ? argsData.groupIndex : 0;\n                var resourceDetails = this.parent.resourceBase.lastResourceLevel[groupIndex];\n                resourceValue = resourceDetails.resourceData[resourceDetails.resource.textField];\n            }\n        }\n        return resourceValue;\n    };\n    QuickPopups.prototype.getFormattedString = function (eventData) {\n        var fields = this.parent.eventFields;\n        var eventSubject = (eventData[fields.subject] || this.l10n.getConstant('noTitle'));\n        var startDate = eventData[fields.startTime];\n        var endDate = eventData[fields.endTime];\n        var startDateDetails = this.getDateFormat(startDate, 'long');\n        var endDateDetails = (eventData[fields.isAllDay] && endDate.getHours() === 0 && endDate.getMinutes() === 0) ?\n            this.getDateFormat(util.addDays(new Date(endDate.getTime()), -1), 'long') :\n            this.getDateFormat(endDate, 'long');\n        var startTimeDetail = this.parent.getTimeString(startDate);\n        var endTimeDetail = this.parent.getTimeString(endDate);\n        var details = '';\n        var spanLength = endDate.getDate() !== startDate.getDate() &&\n            (endDate.getTime() - startDate.getTime()) / (60 * 60 * 1000) < 24 ? 1 : 0;\n        if (eventData[fields.isAllDay]) {\n            details = startDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n            if (((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY) > 1) {\n                details += '&nbsp;-&nbsp;' + endDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n            }\n        }\n        else if ((((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY) >= 1) || spanLength > 0) {\n            details = startDateDetails + ' (' + startTimeDetail + ')' + '&nbsp;-&nbsp;' + endDateDetails + ' (' + endTimeDetail + ')';\n        }\n        else {\n            details = startDateDetails + ' (' + (startTimeDetail + '&nbsp;-&nbsp;' + endTimeDetail) + ')';\n        }\n        return { eventSubject: eventSubject, details: details };\n    };\n    QuickPopups.prototype.moreEventClick = function (data, endDate, groupIndex) {\n        var _this = this;\n        this.quickPopupHide(true);\n        var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n        if (moreEventContentEle) {\n            remove(moreEventContentEle);\n        }\n        var selectedDate = ((data.date).getTime()).toString();\n        var target = closest(data.element, '.' + cls.MORE_INDICATOR_CLASS + ',.' + cls.WORK_CELLS_CLASS);\n        var day = this.parent.globalize.formatDate(data.date, { format: 'E', calendar: this.parent.getCalendarMode() });\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DAY_CLASS).innerHTML = util.capitalizeFirstWord(day, 'single');\n        var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n        dateElement.innerHTML = this.getDateFormat(data.date, 'd');\n        dateElement.setAttribute('data-date', selectedDate);\n        dateElement.setAttribute('data-end-date', endDate.getTime().toString());\n        var groupOrder;\n        if (!isNullOrUndefined(groupIndex)) {\n            dateElement.setAttribute('data-group-index', groupIndex);\n            groupOrder = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)].groupOrder;\n        }\n        var moreEventElements = this.createMoreEventList(data.event, groupOrder, groupIndex);\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreEventElements);\n        removeClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n        if (util.resetTime(data.date).getTime() === util.resetTime(this.parent.getCurrentTime()).getTime()) {\n            addClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n        }\n        if (!this.parent.isAdaptive) {\n            if (this.parent.currentView.indexOf('Timeline') !== -1) {\n                var gIndex = target.getAttribute('data-group-index');\n                var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n                startDate.setHours(startDate.getHours(), startDate.getMinutes(), 0);\n                var tdDate = startDate.getTime().toString();\n                if (isNullOrUndefined(gIndex)) {\n                    this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS +\n                        ' tbody tr td[data-date=\"' + tdDate + '\"]');\n                }\n                else {\n                    this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS +\n                        ' tbody tr td[data-group-index=\"' + gIndex + '\"][data-date=\"' + tdDate + '\"]');\n                    if (isNullOrUndefined(this.morePopup.relateTo)) {\n                        var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS +\n                            ' tbody tr td[data-group-index=\"' + gIndex + '\"]'));\n                        for (var i = 0; i < workCells.length; i++) {\n                            var date = workCells[i].getAttribute('data-date');\n                            if (date < tdDate) {\n                                this.morePopup.relateTo = workCells[i];\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                this.morePopup.relateTo = closest(target, '.' + cls.WORK_CELLS_CLASS);\n            }\n        }\n        this.parent.renderTemplates();\n        var eventProp = {\n            type: 'EventContainer', cancel: false,\n            element: this.morePopup.element, data: data\n        };\n        this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n            if (!popupArgs.cancel) {\n                _this.morePopup.show();\n            }\n        });\n    };\n    QuickPopups.prototype.saveClick = function (event) {\n        this.applyFormValidation();\n        this.dialogEvent = event;\n        this.isCrudAction = true;\n        this.quickPopupHide();\n    };\n    QuickPopups.prototype.detailsClick = function (event) {\n        var subjectEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n        if (subjectEle && subjectEle.value !== '') {\n            extend(this.parent.activeCellsData, { subject: subjectEle.value });\n        }\n        this.dialogEvent = event;\n        this.isCrudAction = false;\n        this.fieldValidator.destroyToolTip();\n        this.quickPopupHide();\n        this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n    };\n    QuickPopups.prototype.editClick = function (event) {\n        this.dialogEvent = event;\n        this.quickPopupHide(true);\n        var data = this.parent.activeEventData.event;\n        this.parent.currentAction = 'EditSeries';\n        if (!isNullOrUndefined(data[this.parent.eventFields.recurrenceRule])) {\n            this.parent.currentAction = 'EditOccurrence';\n            this.openRecurrenceAlert();\n        }\n        else {\n            this.parent.eventWindow.openEditor(data, this.parent.currentAction);\n        }\n    };\n    QuickPopups.prototype.deleteClick = function (event) {\n        this.dialogEvent = event;\n        this.quickPopupHide(true);\n        this.parent.currentAction = 'Delete';\n        if (this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) {\n            this.openRecurrenceAlert();\n        }\n        else {\n            this.openDeleteAlert();\n        }\n    };\n    QuickPopups.prototype.updateMoreEventContent = function () {\n        if (this.morePopup.element.classList.contains('e-popup-close')) {\n            return;\n        }\n        var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n        if (moreEventContentEle) {\n            remove(moreEventContentEle);\n        }\n        var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n        var startDate = new Date(parseInt(dateElement.getAttribute('data-date'), 10));\n        var endDate = new Date(parseInt(dateElement.getAttribute('data-end-date'), 10));\n        var groupIndex = dateElement.getAttribute('data-group-index');\n        var data;\n        var groupOrder;\n        if (!isNullOrUndefined(groupIndex)) {\n            data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n            groupOrder = data.groupOrder;\n        }\n        var events = this.parent.eventBase.filterEvents(startDate, endDate, this.parent.eventsProcessed, data);\n        var moreElement = this.createMoreEventList(events, groupOrder, groupIndex);\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreElement);\n    };\n    QuickPopups.prototype.closeClick = function (event) {\n        this.dialogEvent = event;\n        if (this.parent.currentView === 'Year' && this.parent.activeCellsData && this.parent.activeCellsData.element) {\n            this.parent.selectCell(this.parent.activeCellsData.element);\n        }\n        this.quickPopupHide();\n        this.morePopup.hide();\n    };\n    QuickPopups.prototype.dialogButtonClick = function (event) {\n        this.dialogEvent = event;\n        this.quickDialog.hide();\n        var target = event.target;\n        var cancelBtn = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        var eventData = this.parent.activeEventData.event;\n        if (target.classList.contains(cls.QUICK_DIALOG_OCCURRENCE_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteOccurrence' : 'EditOccurrence';\n            switch (this.parent.currentAction) {\n                case 'EditOccurrence':\n                    this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n                    break;\n                case 'DeleteOccurrence':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteFollowingEvents' : 'EditFollowingEvents';\n            switch (this.parent.currentAction) {\n                case 'EditFollowingEvents':\n                    this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n                    break;\n                case 'DeleteFollowingEvents':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(cls.QUICK_DIALOG_SERIES_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteSeries' : 'EditSeries';\n            switch (this.parent.currentAction) {\n                case 'EditSeries':\n                    this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(eventData, true), this.parent.currentAction);\n                    break;\n                case 'DeleteSeries':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(cls.QUICK_DIALOG_DELETE_CLASS)) {\n            this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n        }\n        else if (!cancelBtn.classList.contains(cls.DISABLE_CLASS) && (target.classList.contains(cls.QUICK_DIALOG_ALERT_OK) ||\n            (target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL) && !cancelBtn.classList.contains(cls.QUICK_DIALOG_CANCEL_CLASS)))) {\n            this.parent.uiStateValues.isIgnoreOccurrence = target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL);\n            this.parent.eventWindow.eventSave(event, this.l10n.getConstant('ok'));\n        }\n    };\n    QuickPopups.prototype.updateTapHoldEventPopup = function (target) {\n        var selectedElements = this.parent.eventBase.getSelectedEventElements(target);\n        this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n        if (selectedElements.length > 0) {\n            var eventObj = this.parent.eventBase.getEventByGuid(selectedElements[0].getAttribute('data-guid'));\n            var titleContent = (selectedElements.length === 1) ?\n                (eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle')) :\n                '(' + selectedElements.length + ')' + '&nbsp;' + this.l10n.getConstant('selectedItems');\n            this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS).innerHTML = titleContent;\n            if (selectedElements.length > 1) {\n                addClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n            }\n            else {\n                removeClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n            }\n        }\n        else {\n            this.parent.selectedElements = [];\n            this.quickPopupHide();\n        }\n    };\n    QuickPopups.prototype.getTimezone = function (event) {\n        var zoneDetails = '';\n        zoneDetails += event[this.parent.eventFields.startTimezone] || '';\n        zoneDetails += zoneDetails === '' ? '' : ' - ';\n        zoneDetails += event[this.parent.eventFields.endTimezone] || '';\n        return zoneDetails;\n    };\n    QuickPopups.prototype.getRecurrenceSummary = function (event) {\n        var recurrenceEditor = this.parent.eventWindow.getRecurrenceEditorInstance();\n        if (recurrenceEditor) {\n            var ruleSummary = recurrenceEditor.getRuleSummary(event[this.parent.eventFields.recurrenceRule]);\n            return ruleSummary.charAt(0).toUpperCase() + ruleSummary.slice(1);\n        }\n        return '';\n    };\n    QuickPopups.prototype.getDateFormat = function (date, skeletonString) {\n        return util.capitalizeFirstWord(this.parent.globalize.formatDate(date, { skeleton: skeletonString, calendar: this.parent.getCalendarMode() }), 'single');\n    };\n    QuickPopups.prototype.getDataFromTarget = function (target) {\n        if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n            return this.parent.activeEventData.event;\n        }\n        // Deprecated cells data in quick popups\n        var eventObj = {\n            startTime: this.parent.activeCellsData.startTime,\n            endTime: this.parent.activeCellsData.endTime,\n            isAllDay: this.parent.activeCellsData.isAllDay,\n            groupIndex: this.parent.activeCellsData.groupIndex\n        };\n        var cellsData = this.parent.activeCellsData;\n        this.parent.eventWindow.convertToEventData(cellsData, eventObj);\n        return eventObj;\n    };\n    QuickPopups.prototype.beforeQuickDialogClose = function (e) {\n        var _this = this;\n        var args = {\n            event: e.event || this.dialogEvent,\n            type: (isNullOrUndefined(this.parent.activeEventData.event)) ? 'ValidationAlert' :\n                !isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])\n                    ? 'RecurrenceAlert' : 'DeleteAlert', cancel: false, data: this.parent.activeEventData.event,\n            element: this.quickDialog.element\n        };\n        this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n            if (!popupCloseArgs.cancel) {\n                _this.parent.eventBase.focusElement(true);\n            }\n        });\n    };\n    QuickPopups.prototype.beforeQuickPopupOpen = function (target) {\n        var _this = this;\n        this.parent.renderTemplates();\n        var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n        var popupType = this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo';\n        var eventProp = {\n            type: popupType, cancel: false, data: extend({}, this.getDataFromTarget(target), null, true),\n            target: target, element: this.quickPopup.element\n        };\n        this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n            if (popupArgs.cancel) {\n                _this.quickPopupHide();\n                _this.destroyPopupButtons('quickPopup');\n                if (popupArgs.element.classList.contains(cls.POPUP_OPEN)) {\n                    _this.quickPopupClose();\n                }\n                util.removeChildren(_this.quickPopup.element);\n                _this.isMultipleEventSelect = false;\n            }\n            else {\n                var display = _this.quickPopup.element.style.display;\n                _this.quickPopup.element.style.display = 'block';\n                if (_this.parent.isAdaptive) {\n                    _this.quickPopup.element.removeAttribute('style');\n                    _this.quickPopup.element.style.display = 'block';\n                    _this.quickPopup.element.style.height = formatUnit((popupType === 'EditEventInfo') ? 65 : window.innerHeight);\n                }\n                else {\n                    _this.quickPopup.offsetX = 10;\n                    _this.quickPopup.collision = { X: _this.parent.enableRtl ? 'flip' : 'none', Y: 'fit' };\n                    _this.quickPopup.position = { X: _this.parent.enableRtl ? 'left' : 'right', Y: _this.parent.enableRtl ? 'bottom' : 'top' };\n                    _this.quickPopup.dataBind();\n                    _this.quickPopup.refreshPosition(null, true);\n                    var collide = isCollide(_this.quickPopup.element, _this.parent.element);\n                    if (collide.indexOf(_this.parent.enableRtl ? 'left' : 'right') > -1) {\n                        _this.quickPopup.offsetX = -target.offsetWidth - 10 - _this.quickPopup.element.offsetWidth;\n                        _this.quickPopup.dataBind();\n                        var leftCollide = isCollide(_this.quickPopup.element, _this.parent.element);\n                        if (leftCollide.indexOf('left') > -1) {\n                            _this.quickPopup.position = { X: 'center', Y: 'center' };\n                            _this.quickPopup.collision = { X: 'fit', Y: 'fit' };\n                            _this.quickPopup.offsetX = -(_this.quickPopup.element.offsetWidth / 2);\n                            _this.quickPopup.dataBind();\n                        }\n                    }\n                    if (_this.parent.virtualScrollModule && (collide.indexOf('top') > -1 || collide.indexOf('bottom') > -1)) {\n                        var element = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n                        var translateY = util.getTranslateY(element);\n                        _this.quickPopup.offsetY = translateY;\n                        _this.quickPopup.dataBind();\n                    }\n                }\n                if (isEventPopup) {\n                    _this.applyEventColor();\n                }\n                _this.quickPopup.element.style.display = display;\n                _this.quickPopup.dataBind();\n                _this.quickPopup.show();\n            }\n        });\n    };\n    QuickPopups.prototype.applyEventColor = function () {\n        var colorField = '';\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            colorField = this.parent.enableRtl ? 'border-right-color' : 'border-left-color';\n        }\n        else {\n            colorField = 'background-color';\n        }\n        var color = this.parent.activeEventData.element.style[colorField];\n        if (color === '') {\n            return;\n        }\n        var colorEle = this.quickPopup.element.querySelector('.' + cls.POPUP_HEADER_CLASS);\n        var footerEle = this.quickPopup.element.querySelector('.' + cls.POPUP_FOOTER_CLASS);\n        if (footerEle && footerEle.offsetParent) {\n            colorEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n            if (colorEle) {\n                colorEle.style.borderLeftColor = color;\n                color = \"rgba(\" + color.match(/\\d+/g).join() + \",0.3)\";\n            }\n        }\n        if (colorEle) {\n            colorEle.style.backgroundColor = color;\n        }\n    };\n    QuickPopups.prototype.quickPopupOpen = function () {\n        if (this.parent.isAdaptive) {\n            this.quickPopup.element.style.top = '0px';\n            return;\n        }\n        if (this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS)) {\n            var subjectElement = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n            if (subjectElement) {\n                subjectElement.focus();\n            }\n        }\n        else {\n            var editElement = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n            if (editElement) {\n                editElement.focus();\n            }\n            var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n            if (editIcon) {\n                editIcon.focus();\n            }\n        }\n    };\n    QuickPopups.prototype.quickPopupClose = function () {\n        this.parent.eventBase.focusElement();\n        this.quickPopup.relateTo = cls.WORK_CELLS_CLASS;\n        this.fieldValidator.destroyToolTip();\n        if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n            this.fieldValidator.destroy();\n        }\n        this.destroyPopupButtons('quickPopup');\n        util.removeChildren(this.quickPopup.element);\n    };\n    QuickPopups.prototype.morePopupOpen = function () {\n        if (this.parent.isAdaptive) {\n            this.morePopup.element.style.top = '0px';\n            this.morePopup.element.style.left = '0px';\n            this.morePopup.element.style.height = formatUnit(window.innerHeight);\n            return;\n        }\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS).focus();\n        this.morePopup.refreshPosition();\n    };\n    QuickPopups.prototype.morePopupClose = function () {\n        var moreWrapper = this.parent.element.querySelector('.' + cls.MORE_EVENT_WRAPPER_CLASS);\n        if (moreWrapper) {\n            remove(moreWrapper);\n        }\n    };\n    QuickPopups.prototype.popupClose = function (event) {\n        this.dialogEvent = event;\n        this.isCrudAction = false;\n        this.quickPopupHide(true);\n    };\n    QuickPopups.prototype.quickPopupHide = function (hideAnimation) {\n        var _this = this;\n        if (!this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            return;\n        }\n        var isCellPopup = this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS);\n        var popupData;\n        if (isCellPopup) {\n            var formvalidator = this.quickPopup.element.querySelector('.e-formvalidator');\n            if (this.isCrudAction && formvalidator &&\n                !formvalidator.ej2_instances[0].validate()) {\n                return;\n            }\n            var fields = this.parent.eventFields;\n            var saveObj = this.parent.eventWindow.getObjectFromFormData(cls.POPUP_WRAPPER_CLASS);\n            this.parent.eventWindow.setDefaultValueToObject(saveObj);\n            saveObj[fields.id] = this.parent.eventBase.getEventMaxID();\n            saveObj[fields.startTime] = this.parent.activeCellsData.startTime;\n            saveObj[fields.endTime] = this.parent.activeCellsData.endTime;\n            saveObj[fields.isAllDay] = this.parent.activeCellsData.isAllDay;\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.setResourceValues(saveObj);\n            }\n            popupData = saveObj;\n        }\n        else {\n            popupData = this.parent.activeEventData.event;\n        }\n        var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n        var args = {\n            event: this.dialogEvent,\n            type: this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo',\n            cancel: false, data: popupData, element: this.quickPopup.element,\n            target: (isCellPopup ? this.parent.activeCellsData.element : this.parent.activeEventData.element)\n        };\n        this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n            if (!popupCloseArgs.cancel) {\n                if (_this.quickPopup.element.classList.contains('e-popup-open')) {\n                    if (isCellPopup && _this.isCrudAction) {\n                        _this.parent.currentAction = 'Add';\n                        _this.parent.crudModule.addEvent(popupCloseArgs.data);\n                    }\n                    if (hideAnimation) {\n                        var animation = _this.quickPopup.hideAnimation;\n                        _this.quickPopup.hideAnimation = null;\n                        _this.quickPopup.hide();\n                        _this.quickPopup.hideAnimation = animation;\n                    }\n                    else {\n                        _this.quickPopup.hide();\n                    }\n                    _this.isMultipleEventSelect = false;\n                    _this.isCrudAction = false;\n                }\n            }\n        });\n    };\n    QuickPopups.prototype.navigationClick = function (e) {\n        var navigateEle = closest(e.target, '.' + cls.NAVIGATE_CLASS);\n        if (!isNullOrUndefined(navigateEle)) {\n            var date = this.parent.getDateFromElement(e.currentTarget);\n            if (!isNullOrUndefined(date)) {\n                this.closeClick(e);\n                this.parent.setProperties({ selectedDate: date }, true);\n                this.parent.changeView(this.parent.getNavigateView(), e);\n            }\n        }\n    };\n    QuickPopups.prototype.documentClick = function (e) {\n        var target = e.event.target;\n        var classNames = '.' + cls.POPUP_WRAPPER_CLASS + ',.' + cls.HEADER_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS +\n            ',.' + cls.WORK_CELLS_CLASS + ',.' + cls.APPOINTMENT_CLASS + ',.e-popup';\n        var popupWrap = this.parent.element.querySelector('.' + cls.POPUP_WRAPPER_CLASS);\n        if ((popupWrap && popupWrap.childElementCount > 0 && !closest(target, classNames)) || !closest(target, classNames)) {\n            this.quickPopupHide();\n            this.parent.removeNewEventElement();\n        }\n        var tar = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n        if (tar && tar !== target && this.parent.allowInline) {\n            this.parent.inlineModule.documentClick();\n        }\n        if (closest(target, '.' + cls.APPOINTMENT_CLASS + ',.' + cls.HEADER_CELLS_CLASS)) {\n            this.parent.removeNewEventElement();\n        }\n        if (!closest(target, '.' + cls.MORE_POPUP_WRAPPER_CLASS) && (target.classList &&\n            !target.classList.contains(cls.MORE_INDICATOR_CLASS))\n            && (!closest(target, '.' + cls.POPUP_OPEN)) && !closest(target, '.' + cls.WORK_CELLS_CLASS)) {\n            this.morePopup.hide();\n        }\n    };\n    QuickPopups.prototype.onClosePopup = function (event) {\n        if (!isNullOrUndefined(event)) {\n            this.dialogEvent = event;\n        }\n        this.quickPopupHide();\n        this.parent.eventBase.focusElement();\n    };\n    QuickPopups.prototype.addEventListener = function () {\n        this.parent.on(event.cellClick, this.cellClick, this);\n        this.parent.on(event.eventClick, this.eventClick, this);\n        this.parent.on(event.documentClick, this.documentClick, this);\n        this.parent.on(event.dataReady, this.updateMoreEventContent, this);\n    };\n    QuickPopups.prototype.removeEventListener = function () {\n        this.parent.off(event.cellClick, this.cellClick);\n        this.parent.off(event.eventClick, this.eventClick);\n        this.parent.off(event.documentClick, this.documentClick);\n        this.parent.off(event.dataReady, this.updateMoreEventContent);\n    };\n    QuickPopups.prototype.destroyPopupButtons = function (popupName) {\n        var popup = popupName === 'quickPopup' ? this.quickPopup : this.morePopup;\n        var buttonCollections = [].slice.call(popup.element.querySelectorAll('.e-control.e-btn'));\n        for (var _i = 0, buttonCollections_1 = buttonCollections; _i < buttonCollections_1.length; _i++) {\n            var button = buttonCollections_1[_i];\n            var instance = button.ej2_instances[0];\n            if (instance) {\n                instance.destroy();\n            }\n        }\n    };\n    QuickPopups.prototype.refreshQuickDialog = function () {\n        this.destroyQuickDialog();\n        this.renderQuickDialog();\n    };\n    QuickPopups.prototype.refreshQuickPopup = function () {\n        this.destroyQuickPopup();\n        this.renderQuickPopup();\n    };\n    QuickPopups.prototype.refreshMorePopup = function () {\n        this.destroyMorePopup();\n        this.renderMorePopup();\n    };\n    QuickPopups.prototype.destroyQuickDialog = function () {\n        if (this.quickDialog.element) {\n            this.quickDialog.destroy();\n            remove(this.quickDialog.element);\n            this.quickDialog = null;\n        }\n    };\n    QuickPopups.prototype.destroyQuickPopup = function () {\n        if (this.quickPopup.element) {\n            this.destroyPopupButtons('quickPopup');\n            this.quickPopup.destroy();\n            remove(this.quickPopup.element);\n            this.quickPopup = null;\n        }\n    };\n    QuickPopups.prototype.destroyMorePopup = function () {\n        if (this.morePopup.element) {\n            this.destroyPopupButtons('morePopup');\n            this.morePopup.destroy();\n            remove(this.morePopup.element);\n            this.morePopup = null;\n        }\n    };\n    QuickPopups.prototype.destroy = function () {\n        if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n            this.fieldValidator.destroy();\n        }\n        this.removeEventListener();\n        this.destroyQuickPopup();\n        this.destroyMorePopup();\n        this.destroyQuickDialog();\n        this.parent = null;\n        this.l10n = null;\n        this.isCrudAction = null;\n        this.fieldValidator = null;\n        this.isMultipleEventSelect = null;\n    };\n    return QuickPopups;\n}());\nexport { QuickPopups };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}